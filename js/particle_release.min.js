!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function i(t){var e="length"in t&&t.length,i=J.type(t);return"function"===i||J.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t}function n(t,e,i){if(J.isFunction(e))return J.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return J.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(se.test(e))return J.filter(e,t,i);e=J.filter(e,t)}return J.grep(t,function(t){return X.call(e,t)>=0!==i})}function r(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function o(t){var e=pe[t]={};return J.each(t.match(fe)||[],function(t,i){e[i]=!0}),e}function a(){Q.removeEventListener("DOMContentLoaded",a,!1),t.removeEventListener("load",a,!1),J.ready()}function s(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=J.expando+s.uid++}function l(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(xe,"-$1").toLowerCase(),i=t.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:Ee.test(i)?J.parseJSON(i):i}catch(r){}ye.set(t,e,i)}else i=void 0;return i}function h(){return!0}function c(){return!1}function u(){try{return Q.activeElement}catch(t){}}function d(t,e){return J.nodeName(t,"table")&&J.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function f(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function p(t){var e=Ne.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function m(t,e){for(var i=0,n=t.length;n>i;i++)ve.set(t[i],"globalEval",!e||ve.get(e[i],"globalEval"))}function g(t,e){var i,n,r,o,a,s,l,h;if(1===e.nodeType){if(ve.hasData(t)&&(o=ve.access(t),a=ve.set(e,o),h=o.events)){delete a.handle,a.events={};for(r in h)for(i=0,n=h[r].length;n>i;i++)J.event.add(e,r,h[r][i])}ye.hasData(t)&&(s=ye.access(t),l=J.extend({},s),ye.set(e,l))}}function v(t,e){var i=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&J.nodeName(t,e)?J.merge([t],i):i}function y(t,e){var i=e.nodeName.toLowerCase();"input"===i&&we.test(t.type)?e.checked=t.checked:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}function E(e,i){var n,r=J(i.createElement(e)).appendTo(i.body),o=t.getDefaultComputedStyle&&(n=t.getDefaultComputedStyle(r[0]))?n.display:J.css(r[0],"display");return r.detach(),o}function x(t){var e=Q,i=ke[t];return i||(i=E(t,e),"none"!==i&&i||(Ie=(Ie||J("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=Ie[0].contentDocument,e.write(),e.close(),i=E(t,e),Ie.detach()),ke[t]=i),i}function T(t,e,i){var n,r,o,a,s=t.style;return i=i||je(t),i&&(a=i.getPropertyValue(e)||i[e]),i&&(""!==a||J.contains(t.ownerDocument,t)||(a=J.style(t,e)),Be.test(a)&&Ve.test(e)&&(n=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=n,s.minWidth=r,s.maxWidth=o)),void 0!==a?a+"":a}function _(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function b(t,e){if(e in t)return e;for(var i=e[0].toUpperCase()+e.slice(1),n=e,r=Ke.length;r--;)if(e=Ke[r]+i,e in t)return e;return n}function w(t,e,i){var n=We.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function R(t,e,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===i&&(a+=J.css(t,i+_e[o],!0,r)),n?("content"===i&&(a-=J.css(t,"padding"+_e[o],!0,r)),"margin"!==i&&(a-=J.css(t,"border"+_e[o]+"Width",!0,r))):(a+=J.css(t,"padding"+_e[o],!0,r),"padding"!==i&&(a+=J.css(t,"border"+_e[o]+"Width",!0,r)));return a}function S(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=je(t),a="border-box"===J.css(t,"boxSizing",!1,o);if(0>=r||null==r){if(r=T(t,e,o),(0>r||null==r)&&(r=t.style[e]),Be.test(r))return r;n=a&&($.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+R(t,e,i||(a?"border":"content"),n,o)+"px"}function M(t,e){for(var i,n,r,o=[],a=0,s=t.length;s>a;a++)n=t[a],n.style&&(o[a]=ve.get(n,"olddisplay"),i=n.style.display,e?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&be(n)&&(o[a]=ve.access(n,"olddisplay",x(n.nodeName)))):(r=be(n),"none"===i&&r||ve.set(n,"olddisplay",r?i:J.css(n,"display"))));for(a=0;s>a;a++)n=t[a],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?o[a]||"":"none"));return t}function H(t,e,i,n,r){return new H.prototype.init(t,e,i,n,r)}function C(){return setTimeout(function(){$e=void 0}),$e=J.now()}function A(t,e){var i,n=0,r={height:t};for(e=e?1:0;4>n;n+=2-e)i=_e[n],r["margin"+i]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function P(t,e,i){for(var n,r=(ii[e]||[]).concat(ii["*"]),o=0,a=r.length;a>o;o++)if(n=r[o].call(i,e,t))return n}function L(t,e,i){var n,r,o,a,s,l,h,c,u=this,d={},f=t.style,p=t.nodeType&&be(t),m=ve.get(t,"fxshow");i.queue||(s=J._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,J.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],h=J.css(t,"display"),c="none"===h?ve.get(t,"olddisplay")||x(t.nodeName):h,"inline"===c&&"none"===J.css(t,"float")&&(f.display="inline-block")),i.overflow&&(f.overflow="hidden",u.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],Ze.exec(r)){if(delete e[n],o=o||"toggle"===r,r===(p?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;p=!0}d[n]=m&&m[n]||J.style(t,n)}else h=void 0;if(J.isEmptyObject(d))"inline"===("none"===h?x(t.nodeName):h)&&(f.display=h);else{m?"hidden"in m&&(p=m.hidden):m=ve.access(t,"fxshow",{}),o&&(m.hidden=!p),p?J(t).show():u.done(function(){J(t).hide()}),u.done(function(){var e;ve.remove(t,"fxshow");for(e in d)J.style(t,e,d[e])});for(n in d)a=P(p?m[n]:0,n,u),n in m||(m[n]=a.start,p&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function O(t,e){var i,n,r,o,a;for(i in t)if(n=J.camelCase(i),r=e[n],o=t[i],J.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),a=J.cssHooks[n],a&&"expand"in a){o=a.expand(o),delete t[n];for(i in o)i in t||(t[i]=o[i],e[i]=r)}else e[n]=r}function D(t,e,i){var n,r,o=0,a=ei.length,s=J.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=$e||C(),i=Math.max(0,h.startTime+h.duration-e),n=i/h.duration||0,o=1-n,a=0,l=h.tweens.length;l>a;a++)h.tweens[a].run(o);return s.notifyWith(t,[h,o,i]),1>o&&l?i:(s.resolveWith(t,[h]),!1)},h=s.promise({elem:t,props:J.extend({},e),opts:J.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:$e||C(),duration:i.duration,tweens:[],createTween:function(e,i){var n=J.Tween(t,h.opts,e,i,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(n),n},stop:function(e){var i=0,n=e?h.tweens.length:0;if(r)return this;for(r=!0;n>i;i++)h.tweens[i].run(1);return e?s.resolveWith(t,[h,e]):s.rejectWith(t,[h,e]),this}}),c=h.props;for(O(c,h.opts.specialEasing);a>o;o++)if(n=ei[o].call(h,t,c,h.opts))return n;return J.map(c,P,h),J.isFunction(h.opts.start)&&h.opts.start.call(t,h),J.fx.timer(J.extend(l,{elem:t,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function z(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,o=e.toLowerCase().match(fe)||[];if(J.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function N(t,e,i,n){function r(s){var l;return o[s]=!0,J.each(t[s]||[],function(t,s){var h=s(e,i,n);return"string"!=typeof h||a||o[h]?a?!(l=h):void 0:(e.dataTypes.unshift(h),r(h),!1)}),l}var o={},a=t===Ei;return r(e.dataTypes[0])||!o["*"]&&r("*")}function F(t,e){var i,n,r=J.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n||(n={}))[i]=e[i]);return n&&J.extend(!0,t,n),t}function U(t,e,i){for(var n,r,o,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in s)if(s[r]&&s[r].test(n)){l.unshift(r);break}if(l[0]in i)o=l[0];else{for(r in i){if(!l[0]||t.converters[r+" "+l[0]]){o=r;break}a||(a=r)}o=o||a}return o?(o!==l[0]&&l.unshift(o),i[o]):void 0}function I(t,e,i,n){var r,o,a,s,l,h={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)h[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=h[l+" "+o]||h["* "+o],!a)for(r in h)if(s=r.split(" "),s[1]===o&&(a=h[l+" "+s[0]]||h["* "+s[0]])){a===!0?a=h[r]:h[r]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}function k(t,e,i,n){var r;if(J.isArray(e))J.each(e,function(e,r){i||wi.test(t)?n(t,r):k(t+"["+("object"==typeof r?e:"")+"]",r,i,n)});else if(i||"object"!==J.type(e))n(t,e);else for(r in e)k(t+"["+r+"]",e[r],i,n)}function V(t){return J.isWindow(t)?t:9===t.nodeType&&t.defaultView}var B=[],j=B.slice,G=B.concat,W=B.push,X=B.indexOf,q={},Y=q.toString,K=q.hasOwnProperty,$={},Q=t.document,Z="2.1.4",J=function(t,e){return new J.fn.init(t,e)},te=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ee=/^-ms-/,ie=/-([\da-z])/gi,ne=function(t,e){return e.toUpperCase()};J.fn=J.prototype={jquery:Z,constructor:J,selector:"",length:0,toArray:function(){return j.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:j.call(this)},pushStack:function(t){var e=J.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return J.each(this,t,e)},map:function(t){return this.pushStack(J.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(j.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:W,sort:B.sort,splice:B.splice},J.extend=J.fn.extend=function(){var t,e,i,n,r,o,a=arguments[0]||{},s=1,l=arguments.length,h=!1;for("boolean"==typeof a&&(h=a,a=arguments[s]||{},s++),"object"==typeof a||J.isFunction(a)||(a={}),s===l&&(a=this,s--);l>s;s++)if(null!=(t=arguments[s]))for(e in t)i=a[e],n=t[e],a!==n&&(h&&n&&(J.isPlainObject(n)||(r=J.isArray(n)))?(r?(r=!1,o=i&&J.isArray(i)?i:[]):o=i&&J.isPlainObject(i)?i:{},a[e]=J.extend(h,o,n)):void 0!==n&&(a[e]=n));return a},J.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===J.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!J.isArray(t)&&t-parseFloat(t)+1>=0},isPlainObject:function(t){return"object"!==J.type(t)||t.nodeType||J.isWindow(t)?!1:t.constructor&&!K.call(t.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?q[Y.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;t=J.trim(t),t&&(1===t.indexOf("use strict")?(e=Q.createElement("script"),e.text=t,Q.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(ee,"ms-").replace(ie,ne)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var r,o=0,a=t.length,s=i(t);if(n){if(s)for(;a>o&&(r=e.apply(t[o],n),r!==!1);o++);else for(o in t)if(r=e.apply(t[o],n),r===!1)break}else if(s)for(;a>o&&(r=e.call(t[o],o,t[o]),r!==!1);o++);else for(o in t)if(r=e.call(t[o],o,t[o]),r===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(te,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?J.merge(n,"string"==typeof t?[t]:t):W.call(n,t)),n},inArray:function(t,e,i){return null==e?-1:X.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;i>n;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n,r=[],o=0,a=t.length,s=!i;a>o;o++)n=!e(t[o],o),n!==s&&r.push(t[o]);return r},map:function(t,e,n){var r,o=0,a=t.length,s=i(t),l=[];if(s)for(;a>o;o++)r=e(t[o],o,n),null!=r&&l.push(r);else for(o in t)r=e(t[o],o,n),null!=r&&l.push(r);return G.apply([],l)},guid:1,proxy:function(t,e){var i,n,r;return"string"==typeof e&&(i=t[e],e=t,t=i),J.isFunction(t)?(n=j.call(arguments,2),r=function(){return t.apply(e||this,n.concat(j.call(arguments)))},r.guid=t.guid=t.guid||J.guid++,r):void 0},now:Date.now,support:$}),J.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){q["[object "+e+"]"]=e.toLowerCase()});var re=function(t){function e(t,e,i,n){var r,o,a,s,l,h,u,f,p,m;if((e?e.ownerDocument||e:k)!==L&&P(e),e=e||L,i=i||[],s=e.nodeType,"string"!=typeof t||!t||1!==s&&9!==s&&11!==s)return i;if(!n&&D){if(11!==s&&(r=ye.exec(t)))if(a=r[1]){if(9===s){if(o=e.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&U(e,o)&&o.id===a)return i.push(o),i}else{if(r[2])return Z.apply(i,e.getElementsByTagName(t)),i;if((a=r[3])&&T.getElementsByClassName)return Z.apply(i,e.getElementsByClassName(a)),i}if(T.qsa&&(!z||!z.test(t))){if(f=u=I,p=e,m=1!==s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(h=R(t),(u=e.getAttribute("id"))?f=u.replace(xe,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",l=h.length;l--;)h[l]=f+d(h[l]);p=Ee.test(t)&&c(e.parentNode)||e,m=h.join(",")}if(m)try{return Z.apply(i,p.querySelectorAll(m)),i}catch(g){}finally{u||e.removeAttribute("id")}}}return M(t.replace(le,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>_.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[I]=!0,t}function r(t){var e=L.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),n=t.length;n--;)_.attrHandle[i[n]]=e}function a(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||q)-(~t.sourceIndex||q);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function s(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function l(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function h(t){return n(function(e){return e=+e,n(function(i,n){for(var r,o=t([],i.length,e),a=o.length;a--;)i[r=o[a]]&&(i[r]=!(n[r]=i[r]))})})}function c(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function u(){}function d(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function f(t,e,i){var n=e.dir,r=i&&"parentNode"===n,o=B++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,o)}:function(e,i,a){var s,l,h=[V,o];if(a){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,a))return!0}else for(;e=e[n];)if(1===e.nodeType||r){if(l=e[I]||(e[I]={}),(s=l[n])&&s[0]===V&&s[1]===o)return h[2]=s[2];if(l[n]=h,h[2]=t(e,i,a))return!0}}}function p(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function m(t,i,n){for(var r=0,o=i.length;o>r;r++)e(t,i[r],n);return n}function g(t,e,i,n,r){for(var o,a=[],s=0,l=t.length,h=null!=e;l>s;s++)(o=t[s])&&(!i||i(o,n,r))&&(a.push(o),h&&e.push(s));return a}function v(t,e,i,r,o,a){return r&&!r[I]&&(r=v(r)),o&&!o[I]&&(o=v(o,a)),n(function(n,a,s,l){var h,c,u,d=[],f=[],p=a.length,v=n||m(e||"*",s.nodeType?[s]:s,[]),y=!t||!n&&e?v:g(v,d,t,s,l),E=i?o||(n?t:p||r)?[]:a:y;if(i&&i(y,E,s,l),r)for(h=g(E,f),r(h,[],s,l),c=h.length;c--;)(u=h[c])&&(E[f[c]]=!(y[f[c]]=u));if(n){if(o||t){if(o){for(h=[],c=E.length;c--;)(u=E[c])&&h.push(y[c]=u);o(null,E=[],h,l)}for(c=E.length;c--;)(u=E[c])&&(h=o?te(n,u):d[c])>-1&&(n[h]=!(a[h]=u))}}else E=g(E===a?E.splice(p,E.length):E),o?o(null,a,E,l):Z.apply(a,E)})}function y(t){for(var e,i,n,r=t.length,o=_.relative[t[0].type],a=o||_.relative[" "],s=o?1:0,l=f(function(t){return t===e},a,!0),h=f(function(t){return te(e,t)>-1},a,!0),c=[function(t,i,n){var r=!o&&(n||i!==H)||((e=i).nodeType?l(t,i,n):h(t,i,n));return e=null,r}];r>s;s++)if(i=_.relative[t[s].type])c=[f(p(c),i)];else{if(i=_.filter[t[s].type].apply(null,t[s].matches),i[I]){for(n=++s;r>n&&!_.relative[t[n].type];n++);return v(s>1&&p(c),s>1&&d(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(le,"$1"),i,n>s&&y(t.slice(s,n)),r>n&&y(t=t.slice(n)),r>n&&d(t))}c.push(i)}return p(c)}function E(t,i){var r=i.length>0,o=t.length>0,a=function(n,a,s,l,h){var c,u,d,f=0,p="0",m=n&&[],v=[],y=H,E=n||o&&_.find.TAG("*",h),x=V+=null==y?1:Math.random()||.1,T=E.length;for(h&&(H=a!==L&&a);p!==T&&null!=(c=E[p]);p++){if(o&&c){for(u=0;d=t[u++];)if(d(c,a,s)){l.push(c);break}h&&(V=x)}r&&((c=!d&&c)&&f--,n&&m.push(c))}if(f+=p,r&&p!==f){for(u=0;d=i[u++];)d(m,v,a,s);if(n){if(f>0)for(;p--;)m[p]||v[p]||(v[p]=$.call(l));v=g(v)}Z.apply(l,v),h&&!n&&v.length>0&&f+i.length>1&&e.uniqueSort(l)}return h&&(V=x,H=y),m};return r?n(a):a}var x,T,_,b,w,R,S,M,H,C,A,P,L,O,D,z,N,F,U,I="sizzle"+1*new Date,k=t.document,V=0,B=0,j=i(),G=i(),W=i(),X=function(t,e){return t===e&&(A=!0),0},q=1<<31,Y={}.hasOwnProperty,K=[],$=K.pop,Q=K.push,Z=K.push,J=K.slice,te=function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},ee="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",re=ne.replace("w","w#"),oe="\\["+ie+"*("+ne+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+re+"))|)"+ie+"*\\]",ae=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+oe+")*)|.*)\\)|)",se=new RegExp(ie+"+","g"),le=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),he=new RegExp("^"+ie+"*,"+ie+"*"),ce=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),ue=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),de=new RegExp(ae),fe=new RegExp("^"+re+"$"),pe={ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne.replace("w","w*")+")"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+ee+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},me=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,ye=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ee=/[+~]/,xe=/'|\\/g,Te=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),_e=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},be=function(){P()};try{Z.apply(K=J.call(k.childNodes),k.childNodes),K[k.childNodes.length].nodeType}catch(we){Z={apply:K.length?function(t,e){Q.apply(t,J.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}T=e.support={},w=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},P=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:k;return n!==L&&9===n.nodeType&&n.documentElement?(L=n,O=n.documentElement,i=n.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",be,!1):i.attachEvent&&i.attachEvent("onunload",be)),D=!w(n),T.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),T.getElementsByTagName=r(function(t){return t.appendChild(n.createComment("")),!t.getElementsByTagName("*").length}),T.getElementsByClassName=ve.test(n.getElementsByClassName),T.getById=r(function(t){return O.appendChild(t).id=I,!n.getElementsByName||!n.getElementsByName(I).length}),T.getById?(_.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&D){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},_.filter.ID=function(t){var e=t.replace(Te,_e);return function(t){return t.getAttribute("id")===e}}):(delete _.find.ID,_.filter.ID=function(t){var e=t.replace(Te,_e);return function(t){var i="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}}),_.find.TAG=T.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):T.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},_.find.CLASS=T.getElementsByClassName&&function(t,e){return D?e.getElementsByClassName(t):void 0},N=[],z=[],(T.qsa=ve.test(n.querySelectorAll))&&(r(function(t){O.appendChild(t).innerHTML="<a id='"+I+"'></a><select id='"+I+"-\f]' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&z.push("[*^$]="+ie+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||z.push("\\["+ie+"*(?:value|"+ee+")"),t.querySelectorAll("[id~="+I+"-]").length||z.push("~="),t.querySelectorAll(":checked").length||z.push(":checked"),t.querySelectorAll("a#"+I+"+*").length||z.push(".#.+[+~]")}),r(function(t){var e=n.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&z.push("name"+ie+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||z.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),z.push(",.*:")})),(T.matchesSelector=ve.test(F=O.matches||O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&r(function(t){T.disconnectedMatch=F.call(t,"div"),F.call(t,"[s!='']:x"),N.push("!=",ae)}),z=z.length&&new RegExp(z.join("|")),N=N.length&&new RegExp(N.join("|")),e=ve.test(O.compareDocumentPosition),U=e||ve.test(O.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!!n&&1===n.nodeType&&!!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},X=e?function(t,e){if(t===e)return A=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i?i:(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!T.sortDetached&&e.compareDocumentPosition(t)===i?t===n||t.ownerDocument===k&&U(k,t)?-1:e===n||e.ownerDocument===k&&U(k,e)?1:C?te(C,t)-te(C,e):0:4&i?-1:1)}:function(t,e){if(t===e)return A=!0,0;var i,r=0,o=t.parentNode,s=e.parentNode,l=[t],h=[e];if(!o||!s)return t===n?-1:e===n?1:o?-1:s?1:C?te(C,t)-te(C,e):0;if(o===s)return a(t,e);for(i=t;i=i.parentNode;)l.unshift(i);for(i=e;i=i.parentNode;)h.unshift(i);for(;l[r]===h[r];)r++;return r?a(l[r],h[r]):l[r]===k?-1:h[r]===k?1:0},n):L},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==L&&P(t),i=i.replace(ue,"='$1']"),!(!T.matchesSelector||!D||N&&N.test(i)||z&&z.test(i)))try{var n=F.call(t,i);if(n||T.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(r){}return e(i,L,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==L&&P(t),U(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==L&&P(t);var i=_.attrHandle[e.toLowerCase()],n=i&&Y.call(_.attrHandle,e.toLowerCase())?i(t,e,!D):void 0;return void 0!==n?n:T.attributes||!D?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,r=0;if(A=!T.detectDuplicates,C=!T.sortStable&&t.slice(0),t.sort(X),A){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return C=null,t},b=e.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=b(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=b(e);return i},_=e.selectors={cacheLength:50,createPseudo:n,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(Te,_e),t[3]=(t[3]||t[4]||t[5]||"").replace(Te,_e),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return pe.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&de.test(i)&&(e=R(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(Te,_e).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=j[t+" "];return e||(e=new RegExp("(^|"+ie+")"+t+"("+ie+"|$)"))&&j(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(r){var o=e.attr(r,t);return null==o?"!="===i:i?(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(se," ")+" ").indexOf(n)>-1:"|="===i?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(t,e,i,n,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,l){var h,c,u,d,f,p,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!l&&!s;if(g){if(o){for(;m;){for(u=e;u=u[m];)if(s?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?g.firstChild:g.lastChild],a&&y){for(c=g[I]||(g[I]={}),h=c[t]||[],f=h[0]===V&&h[1],d=h[0]===V&&h[2],u=f&&g.childNodes[f];u=++f&&u&&u[m]||(d=f=0)||p.pop();)if(1===u.nodeType&&++d&&u===e){c[t]=[V,f,d];break}}else if(y&&(h=(e[I]||(e[I]={}))[t])&&h[0]===V)d=h[1];else for(;(u=++f&&u&&u[m]||(d=f=0)||p.pop())&&((s?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++d||(y&&((u[I]||(u[I]={}))[t]=[V,d]),u!==e)););return d-=r,d===n||d%n===0&&d/n>=0}}},PSEUDO:function(t,i){var r,o=_.pseudos[t]||_.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[I]?o(i):o.length>1?(r=[t,t,"",i],_.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,r=o(t,i),a=r.length;a--;)n=te(t,r[a]),t[n]=!(e[n]=r[a])}):function(t){return o(t,0,r)}):o}},pseudos:{not:n(function(t){var e=[],i=[],r=S(t.replace(le,"$1"));return r[I]?n(function(t,e,i,n){for(var o,a=r(t,null,n,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,n,o){return e[0]=t,r(e,null,o,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(Te,_e),function(e){return(e.textContent||e.innerText||b(e)).indexOf(t)>-1}}),lang:n(function(t){return fe.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(Te,_e).toLowerCase(),function(e){var i;do if(i=D?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===O},focus:function(t){return t===L.activeElement&&(!L.hasFocus||L.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!_.pseudos.empty(t)},header:function(t){return ge.test(t.nodeName)},input:function(t){return me.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:h(function(){return[0]}),last:h(function(t,e){return[e-1]}),eq:h(function(t,e,i){return[0>i?i+e:i]}),even:h(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:h(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:h(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:h(function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t})}},_.pseudos.nth=_.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[x]=s(x);for(x in{submit:!0,reset:!0})_.pseudos[x]=l(x);return u.prototype=_.filters=_.pseudos,_.setFilters=new u,R=e.tokenize=function(t,i){var n,r,o,a,s,l,h,c=G[t+" "];if(c)return i?0:c.slice(0);for(s=t,l=[],h=_.preFilter;s;){(!n||(r=he.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),n=!1,(r=ce.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(le," ")}),s=s.slice(n.length));for(a in _.filter)!(r=pe[a].exec(s))||h[a]&&!(r=h[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return i?s.length:s?e.error(t):G(t,l).slice(0)},S=e.compile=function(t,e){var i,n=[],r=[],o=W[t+" "];if(!o){for(e||(e=R(t)),i=e.length;i--;)o=y(e[i]),o[I]?n.push(o):r.push(o);o=W(t,E(r,n)),o.selector=t}return o},M=e.select=function(t,e,i,n){var r,o,a,s,l,h="function"==typeof t&&t,u=!n&&R(t=h.selector||t);if(i=i||[],1===u.length){if(o=u[0]=u[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&T.getById&&9===e.nodeType&&D&&_.relative[o[1].type]){if(e=(_.find.ID(a.matches[0].replace(Te,_e),e)||[])[0],!e)return i;h&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=pe.needsContext.test(t)?0:o.length;r--&&(a=o[r],!_.relative[s=a.type]);)if((l=_.find[s])&&(n=l(a.matches[0].replace(Te,_e),Ee.test(o[0].type)&&c(e.parentNode)||e))){if(o.splice(r,1),t=n.length&&d(o),!t)return Z.apply(i,n),i;break}}return(h||S(t,u))(n,e,!D,i,Ee.test(t)&&c(e.parentNode)||e),i},T.sortStable=I.split("").sort(X).join("")===I,T.detectDuplicates=!!A,P(),T.sortDetached=r(function(t){return 1&t.compareDocumentPosition(L.createElement("div"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),T.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(ee,function(t,e,i){var n;return i?void 0:t[e]===!0?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(t);J.find=re,J.expr=re.selectors,J.expr[":"]=J.expr.pseudos,J.unique=re.uniqueSort,J.text=re.getText,J.isXMLDoc=re.isXML,J.contains=re.contains;var oe=J.expr.match.needsContext,ae=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,se=/^.[^:#\[\.,]*$/;J.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?J.find.matchesSelector(n,t)?[n]:[]:J.find.matches(t,J.grep(e,function(t){return 1===t.nodeType}))},J.fn.extend({find:function(t){var e,i=this.length,n=[],r=this;
if("string"!=typeof t)return this.pushStack(J(t).filter(function(){for(e=0;i>e;e++)if(J.contains(r[e],this))return!0}));for(e=0;i>e;e++)J.find(t,r[e],n);return n=this.pushStack(i>1?J.unique(n):n),n.selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(n(this,t||[],!1))},not:function(t){return this.pushStack(n(this,t||[],!0))},is:function(t){return!!n(this,"string"==typeof t&&oe.test(t)?J(t):t||[],!1).length}});var le,he=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ce=J.fn.init=function(t,e){var i,n;if(!t)return this;if("string"==typeof t){if(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:he.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||le).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof J?e[0]:e,J.merge(this,J.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:Q,!0)),ae.test(i[1])&&J.isPlainObject(e))for(i in e)J.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return n=Q.getElementById(i[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=Q,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):J.isFunction(t)?"undefined"!=typeof le.ready?le.ready(t):t(J):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),J.makeArray(t,this))};ce.prototype=J.fn,le=J(Q);var ue=/^(?:parents|prev(?:Until|All))/,de={children:!0,contents:!0,next:!0,prev:!0};J.extend({dir:function(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&J(t).is(i))break;n.push(t)}return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),J.fn.extend({has:function(t){var e=J(t,this),i=e.length;return this.filter(function(){for(var t=0;i>t;t++)if(J.contains(this,e[t]))return!0})},closest:function(t,e){for(var i,n=0,r=this.length,o=[],a=oe.test(t)||"string"!=typeof t?J(t,e||this.context):0;r>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&J.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?J.unique(o):o)},index:function(t){return t?"string"==typeof t?X.call(J(t),this[0]):X.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(J.unique(J.merge(this.get(),J(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),J.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return J.dir(t,"parentNode")},parentsUntil:function(t,e,i){return J.dir(t,"parentNode",i)},next:function(t){return r(t,"nextSibling")},prev:function(t){return r(t,"previousSibling")},nextAll:function(t){return J.dir(t,"nextSibling")},prevAll:function(t){return J.dir(t,"previousSibling")},nextUntil:function(t,e,i){return J.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return J.dir(t,"previousSibling",i)},siblings:function(t){return J.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return J.sibling(t.firstChild)},contents:function(t){return t.contentDocument||J.merge([],t.childNodes)}},function(t,e){J.fn[t]=function(i,n){var r=J.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=J.filter(n,r)),this.length>1&&(de[t]||J.unique(r),ue.test(t)&&r.reverse()),this.pushStack(r)}});var fe=/\S+/g,pe={};J.Callbacks=function(t){t="string"==typeof t?pe[t]||o(t):J.extend({},t);var e,i,n,r,a,s,l=[],h=!t.once&&[],c=function(o){for(e=t.memory&&o,i=!0,s=r||0,r=0,a=l.length,n=!0;l&&a>s;s++)if(l[s].apply(o[0],o[1])===!1&&t.stopOnFalse){e=!1;break}n=!1,l&&(h?h.length&&c(h.shift()):e?l=[]:u.disable())},u={add:function(){if(l){var i=l.length;!function o(e){J.each(e,function(e,i){var n=J.type(i);"function"===n?t.unique&&u.has(i)||l.push(i):i&&i.length&&"string"!==n&&o(i)})}(arguments),n?a=l.length:e&&(r=i,c(e))}return this},remove:function(){return l&&J.each(arguments,function(t,e){for(var i;(i=J.inArray(e,l,i))>-1;)l.splice(i,1),n&&(a>=i&&a--,s>=i&&s--)}),this},has:function(t){return t?J.inArray(t,l)>-1:!!l&&!!l.length},empty:function(){return l=[],a=0,this},disable:function(){return l=h=e=void 0,this},disabled:function(){return!l},lock:function(){return h=void 0,e||u.disable(),this},locked:function(){return!h},fireWith:function(t,e){return!l||i&&!h||(e=e||[],e=[t,e.slice?e.slice():e],n?h.push(e):c(e)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},J.extend({Deferred:function(t){var e=[["resolve","done",J.Callbacks("once memory"),"resolved"],["reject","fail",J.Callbacks("once memory"),"rejected"],["notify","progress",J.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return J.Deferred(function(i){J.each(e,function(e,o){var a=J.isFunction(t[e])&&t[e];r[o[1]](function(){var t=a&&a.apply(this,arguments);t&&J.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?J.extend(t,n):n}},r={};return n.pipe=n.then,J.each(e,function(t,o){var a=o[2],s=o[3];n[o[1]]=a.add,s&&a.add(function(){i=s},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=a.fireWith}),n.promise(r),t&&t.call(r,r),r},when:function(t){var e,i,n,r=0,o=j.call(arguments),a=o.length,s=1!==a||t&&J.isFunction(t.promise)?a:0,l=1===s?t:J.Deferred(),h=function(t,i,n){return function(r){i[t]=this,n[t]=arguments.length>1?j.call(arguments):r,n===e?l.notifyWith(i,n):--s||l.resolveWith(i,n)}};if(a>1)for(e=new Array(a),i=new Array(a),n=new Array(a);a>r;r++)o[r]&&J.isFunction(o[r].promise)?o[r].promise().done(h(r,n,o)).fail(l.reject).progress(h(r,i,e)):--s;return s||l.resolveWith(n,o),l.promise()}});var me;J.fn.ready=function(t){return J.ready.promise().done(t),this},J.extend({isReady:!1,readyWait:1,holdReady:function(t){t?J.readyWait++:J.ready(!0)},ready:function(t){(t===!0?--J.readyWait:J.isReady)||(J.isReady=!0,t!==!0&&--J.readyWait>0||(me.resolveWith(Q,[J]),J.fn.triggerHandler&&(J(Q).triggerHandler("ready"),J(Q).off("ready"))))}}),J.ready.promise=function(e){return me||(me=J.Deferred(),"complete"===Q.readyState?setTimeout(J.ready):(Q.addEventListener("DOMContentLoaded",a,!1),t.addEventListener("load",a,!1))),me.promise(e)},J.ready.promise();var ge=J.access=function(t,e,i,n,r,o,a){var s=0,l=t.length,h=null==i;if("object"===J.type(i)){r=!0;for(s in i)J.access(t,e,s,i[s],!0,o,a)}else if(void 0!==n&&(r=!0,J.isFunction(n)||(a=!0),h&&(a?(e.call(t,n),e=null):(h=e,e=function(t,e,i){return h.call(J(t),i)})),e))for(;l>s;s++)e(t[s],i,a?n:n.call(t[s],s,e(t[s],i)));return r?t:h?e.call(t):l?e(t[0],i):o};J.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},s.uid=1,s.accepts=J.acceptData,s.prototype={key:function(t){if(!s.accepts(t))return 0;var e={},i=t[this.expando];if(!i){i=s.uid++;try{e[this.expando]={value:i},Object.defineProperties(t,e)}catch(n){e[this.expando]=i,J.extend(t,e)}}return this.cache[i]||(this.cache[i]={}),i},set:function(t,e,i){var n,r=this.key(t),o=this.cache[r];if("string"==typeof e)o[e]=i;else if(J.isEmptyObject(o))J.extend(this.cache[r],e);else for(n in e)o[n]=e[n];return o},get:function(t,e){var i=this.cache[this.key(t)];return void 0===e?i:i[e]},access:function(t,e,i){var n;return void 0===e||e&&"string"==typeof e&&void 0===i?(n=this.get(t,e),void 0!==n?n:this.get(t,J.camelCase(e))):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n,r,o=this.key(t),a=this.cache[o];if(void 0===e)this.cache[o]={};else{J.isArray(e)?n=e.concat(e.map(J.camelCase)):(r=J.camelCase(e),e in a?n=[e,r]:(n=r,n=n in a?[n]:n.match(fe)||[])),i=n.length;for(;i--;)delete a[n[i]]}},hasData:function(t){return!J.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var ve=new s,ye=new s,Ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,xe=/([A-Z])/g;J.extend({hasData:function(t){return ye.hasData(t)||ve.hasData(t)},data:function(t,e,i){return ye.access(t,e,i)},removeData:function(t,e){ye.remove(t,e)},_data:function(t,e,i){return ve.access(t,e,i)},_removeData:function(t,e){ve.remove(t,e)}}),J.fn.extend({data:function(t,e){var i,n,r,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(r=ye.get(o),1===o.nodeType&&!ve.get(o,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&(n=a[i].name,0===n.indexOf("data-")&&(n=J.camelCase(n.slice(5)),l(o,n,r[n])));ve.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){ye.set(this,t)}):ge(this,function(e){var i,n=J.camelCase(t);if(o&&void 0===e){if(i=ye.get(o,t),void 0!==i)return i;if(i=ye.get(o,n),void 0!==i)return i;if(i=l(o,n,void 0),void 0!==i)return i}else this.each(function(){var i=ye.get(this,n);ye.set(this,n,e),-1!==t.indexOf("-")&&void 0!==i&&ye.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){ye.remove(this,t)})}}),J.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=ve.get(t,e),i&&(!n||J.isArray(i)?n=ve.access(t,e,J.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=J.queue(t,e),n=i.length,r=i.shift(),o=J._queueHooks(t,e),a=function(){J.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,a,o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return ve.get(t,i)||ve.access(t,i,{empty:J.Callbacks("once memory").add(function(){ve.remove(t,[e+"queue",i])})})}}),J.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?J.queue(this[0],t):void 0===e?this:this.each(function(){var i=J.queue(this,t,e);J._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&J.dequeue(this,t)})},dequeue:function(t){return this.each(function(){J.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=J.Deferred(),o=this,a=this.length,s=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)i=ve.get(o[a],t+"queueHooks"),i&&i.empty&&(n++,i.empty.add(s));return s(),r.promise(e)}});var Te=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_e=["Top","Right","Bottom","Left"],be=function(t,e){return t=e||t,"none"===J.css(t,"display")||!J.contains(t.ownerDocument,t)},we=/^(?:checkbox|radio)$/i;!function(){var t=Q.createDocumentFragment("div"),e=t.appendChild(Q.createElement("div")),i=Q.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),$.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",$.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Re="undefined";$.focusinBubbles="onfocusin"in t;var Se=/^key/,Me=/^(?:mouse|pointer|contextmenu)|click/,He=/^(?:focusinfocus|focusoutblur)$/,Ce=/^([^.]*)(?:\.(.+)|)$/;J.event={global:{},add:function(t,e,i,n,r){var o,a,s,l,h,c,u,d,f,p,m,g=ve.get(t);if(g)for(i.handler&&(o=i,i=o.handler,r=o.selector),i.guid||(i.guid=J.guid++),(l=g.events)||(l=g.events={}),(a=g.handle)||(a=g.handle=function(e){return typeof J!==Re&&J.event.triggered!==e.type?J.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(fe)||[""],h=e.length;h--;)s=Ce.exec(e[h])||[],f=m=s[1],p=(s[2]||"").split(".").sort(),f&&(u=J.event.special[f]||{},f=(r?u.delegateType:u.bindType)||f,u=J.event.special[f]||{},c=J.extend({type:f,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&J.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=l[f])||(d=l[f]=[],d.delegateCount=0,u.setup&&u.setup.call(t,n,p,a)!==!1||t.addEventListener&&t.addEventListener(f,a,!1)),u.add&&(u.add.call(t,c),c.handler.guid||(c.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),J.event.global[f]=!0)},remove:function(t,e,i,n,r){var o,a,s,l,h,c,u,d,f,p,m,g=ve.hasData(t)&&ve.get(t);if(g&&(l=g.events)){for(e=(e||"").match(fe)||[""],h=e.length;h--;)if(s=Ce.exec(e[h])||[],f=m=s[1],p=(s[2]||"").split(".").sort(),f){for(u=J.event.special[f]||{},f=(n?u.delegateType:u.bindType)||f,d=l[f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)c=d[o],!r&&m!==c.origType||i&&i.guid!==c.guid||s&&!s.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,u.remove&&u.remove.call(t,c));a&&!d.length&&(u.teardown&&u.teardown.call(t,p,g.handle)!==!1||J.removeEvent(t,f,g.handle),delete l[f])}else for(f in l)J.event.remove(t,f+e[h],i,n,!0);J.isEmptyObject(l)&&(delete g.handle,ve.remove(t,"events"))}},trigger:function(e,i,n,r){var o,a,s,l,h,c,u,d=[n||Q],f=K.call(e,"type")?e.type:e,p=K.call(e,"namespace")?e.namespace.split("."):[];if(a=s=n=n||Q,3!==n.nodeType&&8!==n.nodeType&&!He.test(f+J.event.triggered)&&(f.indexOf(".")>=0&&(p=f.split("."),f=p.shift(),p.sort()),h=f.indexOf(":")<0&&"on"+f,e=e[J.expando]?e:new J.Event(f,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:J.makeArray(i,[e]),u=J.event.special[f]||{},r||!u.trigger||u.trigger.apply(n,i)!==!1)){if(!r&&!u.noBubble&&!J.isWindow(n)){for(l=u.delegateType||f,He.test(l+f)||(a=a.parentNode);a;a=a.parentNode)d.push(a),s=a;s===(n.ownerDocument||Q)&&d.push(s.defaultView||s.parentWindow||t)}for(o=0;(a=d[o++])&&!e.isPropagationStopped();)e.type=o>1?l:u.bindType||f,c=(ve.get(a,"events")||{})[e.type]&&ve.get(a,"handle"),c&&c.apply(a,i),c=h&&a[h],c&&c.apply&&J.acceptData(a)&&(e.result=c.apply(a,i),e.result===!1&&e.preventDefault());return e.type=f,r||e.isDefaultPrevented()||u._default&&u._default.apply(d.pop(),i)!==!1||!J.acceptData(n)||h&&J.isFunction(n[f])&&!J.isWindow(n)&&(s=n[h],s&&(n[h]=null),J.event.triggered=f,n[f](),J.event.triggered=void 0,s&&(n[h]=s)),e.result}},dispatch:function(t){t=J.event.fix(t);var e,i,n,r,o,a=[],s=j.call(arguments),l=(ve.get(this,"events")||{})[t.type]||[],h=J.event.special[t.type]||{};if(s[0]=t,t.delegateTarget=this,!h.preDispatch||h.preDispatch.call(this,t)!==!1){for(a=J.event.handlers.call(this,t,l),e=0;(r=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,i=0;(o=r.handlers[i++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(o.namespace))&&(t.handleObj=o,t.data=o.data,n=((J.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s),void 0!==n&&(t.result=n)===!1&&(t.preventDefault(),t.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,r,o,a=[],s=e.delegateCount,l=t.target;if(s&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==t.type){for(n=[],i=0;s>i;i++)o=e[i],r=o.selector+" ",void 0===n[r]&&(n[r]=o.needsContext?J(r,this).index(l)>=0:J.find(r,this,null,[l]).length),n[r]&&n.push(o);n.length&&a.push({elem:l,handlers:n})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,r,o=e.button;return null==t.pageX&&null!=e.clientX&&(i=t.target.ownerDocument||Q,n=i.documentElement,r=i.body,t.pageX=e.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[J.expando])return t;var e,i,n,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Me.test(r)?this.mouseHooks:Se.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,t=new J.Event(o),e=n.length;e--;)i=n[e],t[i]=o[i];return t.target||(t.target=Q),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==u()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&J.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return J.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var r=J.extend(new J.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?J.event.trigger(r,null,e):J.event.dispatch.call(e,r),r.isDefaultPrevented()&&i.preventDefault()}},J.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)},J.Event=function(t,e){return this instanceof J.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?h:c):this.type=t,e&&J.extend(this,e),this.timeStamp=t&&t.timeStamp||J.now(),void(this[J.expando]=!0)):new J.Event(t,e)},J.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=h,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=h,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=h,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},J.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){J.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,o=t.handleObj;return(!r||r!==n&&!J.contains(n,r))&&(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),$.focusinBubbles||J.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){J.event.simulate(e,t.target,J.event.fix(t),!0)};J.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=ve.access(n,e);r||n.addEventListener(t,i,!0),ve.access(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=ve.access(n,e)-1;r?ve.access(n,e,r):(n.removeEventListener(t,i,!0),ve.remove(n,e))}}}),J.fn.extend({on:function(t,e,i,n,r){var o,a;if("object"==typeof t){"string"!=typeof e&&(i=i||e,e=void 0);for(a in t)this.on(a,e,i,t[a],r);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),n===!1)n=c;else if(!n)return this;return 1===r&&(o=n,n=function(t){return J().off(t),o.apply(this,arguments)},n.guid=o.guid||(o.guid=J.guid++)),this.each(function(){J.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,J(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return(e===!1||"function"==typeof e)&&(i=e,e=void 0),i===!1&&(i=c),this.each(function(){J.event.remove(this,t,i,e)})},trigger:function(t,e){return this.each(function(){J.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?J.event.trigger(t,e,i,!0):void 0}});var Ae=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Pe=/<([\w:]+)/,Le=/<|&#?\w+;/,Oe=/<(?:script|style|link)/i,De=/checked\s*(?:[^=]|=\s*.checked.)/i,ze=/^$|\/(?:java|ecma)script/i,Ne=/^true\/(.*)/,Fe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ue={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ue.optgroup=Ue.option,Ue.tbody=Ue.tfoot=Ue.colgroup=Ue.caption=Ue.thead,Ue.th=Ue.td,J.extend({clone:function(t,e,i){var n,r,o,a,s=t.cloneNode(!0),l=J.contains(t.ownerDocument,t);if(!($.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||J.isXMLDoc(t)))for(a=v(s),o=v(t),n=0,r=o.length;r>n;n++)y(o[n],a[n]);if(e)if(i)for(o=o||v(t),a=a||v(s),n=0,r=o.length;r>n;n++)g(o[n],a[n]);else g(t,s);return a=v(s,"script"),a.length>0&&m(a,!l&&v(t,"script")),s},buildFragment:function(t,e,i,n){for(var r,o,a,s,l,h,c=e.createDocumentFragment("div"),u=[],d=0,f=t.length;f>d;d++)if(r=t[d],r||0===r)if("object"===J.type(r))J.merge(u,r.nodeType?[r]:r);else if(Le.test(r)){for(o=o||c.appendChild(e.createElement("div")),a=(Pe.exec(r)||["",""])[1].toLowerCase(),s=Ue[a]||Ue._default,o.innerHTML=s[1]+r.replace(Ae,"<$1></$2>")+s[2],h=s[0];h--;)o=o.lastChild;J.merge(u,o.childNodes),o=c.firstChild,o.textContent=""}else u.push(e.createTextNode(r));for(c.textContent="",d=0;r=u[d++];)if((!n||-1===J.inArray(r,n))&&(l=J.contains(r.ownerDocument,r),o=v(c.appendChild(r),"script"),l&&m(o),i))for(h=0;r=o[h++];)ze.test(r.type||"")&&i.push(r);return c},cleanData:function(t){for(var e,i,n,r,o=J.event.special,a=0;void 0!==(i=t[a]);a++){if(J.acceptData(i)&&(r=i[ve.expando],r&&(e=ve.cache[r]))){if(e.events)for(n in e.events)o[n]?J.event.remove(i,n):J.removeEvent(i,n,e.handle);ve.cache[r]&&delete ve.cache[r]}delete ye.cache[i[ye.expando]]}}}),J.fn.extend({text:function(t){return ge(this,function(t){return void 0===t?J.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=d(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=d(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?J.filter(t,this):this,r=0;null!=(i=n[r]);r++)e||1!==i.nodeType||J.cleanData(v(i)),i.parentNode&&(e&&J.contains(i.ownerDocument,i)&&m(v(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(J.cleanData(v(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return J.clone(this,t,e)})},html:function(t){return ge(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Oe.test(t)&&!Ue[(Pe.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Ae,"<$1></$2>");try{for(;n>i;i++)e=this[i]||{},1===e.nodeType&&(J.cleanData(v(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,J.cleanData(v(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=G.apply([],t);var i,n,r,o,a,s,l=0,h=this.length,c=this,u=h-1,d=t[0],m=J.isFunction(d);if(m||h>1&&"string"==typeof d&&!$.checkClone&&De.test(d))return this.each(function(i){var n=c.eq(i);m&&(t[0]=d.call(this,i,n.html())),n.domManip(t,e)});if(h&&(i=J.buildFragment(t,this[0].ownerDocument,!1,this),n=i.firstChild,1===i.childNodes.length&&(i=n),n)){for(r=J.map(v(i,"script"),f),o=r.length;h>l;l++)a=i,l!==u&&(a=J.clone(a,!0,!0),o&&J.merge(r,v(a,"script"))),e.call(this[l],a,l);if(o)for(s=r[r.length-1].ownerDocument,J.map(r,p),l=0;o>l;l++)a=r[l],ze.test(a.type||"")&&!ve.access(a,"globalEval")&&J.contains(s,a)&&(a.src?J._evalUrl&&J._evalUrl(a.src):J.globalEval(a.textContent.replace(Fe,"")))}return this}}),J.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){J.fn[t]=function(t){for(var i,n=[],r=J(t),o=r.length-1,a=0;o>=a;a++)i=a===o?this:this.clone(!0),J(r[a])[e](i),W.apply(n,i.get());return this.pushStack(n)}});var Ie,ke={},Ve=/^margin/,Be=new RegExp("^("+Te+")(?!px)[a-z%]+$","i"),je=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):t.getComputedStyle(e,null)};!function(){function e(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",r.appendChild(o);var e=t.getComputedStyle(a,null);i="1%"!==e.top,n="4px"===e.width,r.removeChild(o)}var i,n,r=Q.documentElement,o=Q.createElement("div"),a=Q.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",$.clearCloneStyle="content-box"===a.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(a),t.getComputedStyle&&J.extend($,{pixelPosition:function(){return e(),i},boxSizingReliable:function(){return null==n&&e(),n},reliableMarginRight:function(){var e,i=a.appendChild(Q.createElement("div"));return i.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",a.style.width="1px",r.appendChild(o),e=!parseFloat(t.getComputedStyle(i,null).marginRight),r.removeChild(o),a.removeChild(i),e}}))}(),J.swap=function(t,e,i,n){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];r=i.apply(t,n||[]);for(o in e)t.style[o]=a[o];return r};var Ge=/^(none|table(?!-c[ea]).+)/,We=new RegExp("^("+Te+")(.*)$","i"),Xe=new RegExp("^([+-])=("+Te+")","i"),qe={position:"absolute",visibility:"hidden",display:"block"},Ye={letterSpacing:"0",fontWeight:"400"},Ke=["Webkit","O","Moz","ms"];J.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=T(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=J.camelCase(e),l=t.style;return e=J.cssProps[s]||(J.cssProps[s]=b(l,s)),a=J.cssHooks[e]||J.cssHooks[s],void 0===i?a&&"get"in a&&void 0!==(r=a.get(t,!1,n))?r:l[e]:(o=typeof i,"string"===o&&(r=Xe.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(J.css(t,e)),o="number"),void(null!=i&&i===i&&("number"!==o||J.cssNumber[s]||(i+="px"),$.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,n))||(l[e]=i))))}},css:function(t,e,i,n){var r,o,a,s=J.camelCase(e);return e=J.cssProps[s]||(J.cssProps[s]=b(t.style,s)),a=J.cssHooks[e]||J.cssHooks[s],a&&"get"in a&&(r=a.get(t,!0,i)),void 0===r&&(r=T(t,e,n)),"normal"===r&&e in Ye&&(r=Ye[e]),""===i||i?(o=parseFloat(r),i===!0||J.isNumeric(o)?o||0:r):r}}),J.each(["height","width"],function(t,e){J.cssHooks[e]={get:function(t,i,n){return i?Ge.test(J.css(t,"display"))&&0===t.offsetWidth?J.swap(t,qe,function(){return S(t,e,n)}):S(t,e,n):void 0},set:function(t,i,n){var r=n&&je(t);return w(t,i,n?R(t,e,n,"border-box"===J.css(t,"boxSizing",!1,r),r):0)}}}),J.cssHooks.marginRight=_($.reliableMarginRight,function(t,e){return e?J.swap(t,{display:"inline-block"},T,[t,"marginRight"]):void 0}),J.each({margin:"",padding:"",border:"Width"},function(t,e){J.cssHooks[t+e]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];4>n;n++)r[t+_e[n]+e]=o[n]||o[n-2]||o[0];return r}},Ve.test(t)||(J.cssHooks[t+e].set=w)}),J.fn.extend({css:function(t,e){return ge(this,function(t,e,i){var n,r,o={},a=0;if(J.isArray(e)){for(n=je(t),r=e.length;r>a;a++)o[e[a]]=J.css(t,e[a],!1,n);return o}return void 0!==i?J.style(t,e,i):J.css(t,e)},t,e,arguments.length>1)},show:function(){return M(this,!0)},hide:function(){return M(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){be(this)?J(this).show():J(this).hide()})}}),J.Tween=H,H.prototype={constructor:H,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(J.cssNumber[i]?"":"px")},cur:function(){var t=H.propHooks[this.prop];return t&&t.get?t.get(this):H.propHooks._default.get(this)},run:function(t){var e,i=H.propHooks[this.prop];return this.pos=e=this.options.duration?J.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=J.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){J.fx.step[t.prop]?J.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[J.cssProps[t.prop]]||J.cssHooks[t.prop])?J.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},J.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},J.fx=H.prototype.init,J.fx.step={};var $e,Qe,Ze=/^(?:toggle|show|hide)$/,Je=new RegExp("^(?:([+-])=|)("+Te+")([a-z%]*)$","i"),ti=/queueHooks$/,ei=[L],ii={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),r=Je.exec(e),o=r&&r[3]||(J.cssNumber[t]?"":"px"),a=(J.cssNumber[t]||"px"!==o&&+n)&&Je.exec(J.css(i.elem,t)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],r=r||[],a=+n||1;do s=s||".5",a/=s,J.style(i.elem,t,a+o);while(s!==(s=i.cur()/n)&&1!==s&&--l)}return r&&(a=i.start=+a||+n||0,i.unit=o,i.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),i}]};J.Animation=J.extend(D,{tweener:function(t,e){J.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,r=t.length;r>n;n++)i=t[n],ii[i]=ii[i]||[],ii[i].unshift(e)},prefilter:function(t,e){e?ei.unshift(t):ei.push(t)}}),J.speed=function(t,e,i){var n=t&&"object"==typeof t?J.extend({},t):{complete:i||!i&&e||J.isFunction(t)&&t,duration:t,easing:i&&e||e&&!J.isFunction(e)&&e};return n.duration=J.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in J.fx.speeds?J.fx.speeds[n.duration]:J.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){J.isFunction(n.old)&&n.old.call(this),n.queue&&J.dequeue(this,n.queue)},n},J.fn.extend({fadeTo:function(t,e,i,n){return this.filter(be).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=J.isEmptyObject(t),o=J.speed(e,i,n),a=function(){var e=D(this,J.extend({},t),o);(r||ve.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=J.timers,a=ve.get(this);if(r)a[r]&&a[r].stop&&n(a[r]);else for(r in a)a[r]&&a[r].stop&&ti.test(r)&&n(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(i),e=!1,o.splice(r,1));(e||!i)&&J.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=ve.get(this),n=i[t+"queue"],r=i[t+"queueHooks"],o=J.timers,a=n?n.length:0;for(i.finish=!0,J.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));
for(e=0;a>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),J.each(["toggle","show","hide"],function(t,e){var i=J.fn[e];J.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(A(e,!0),t,n,r)}}),J.each({slideDown:A("show"),slideUp:A("hide"),slideToggle:A("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){J.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),J.timers=[],J.fx.tick=function(){var t,e=0,i=J.timers;for($e=J.now();e<i.length;e++)t=i[e],t()||i[e]!==t||i.splice(e--,1);i.length||J.fx.stop(),$e=void 0},J.fx.timer=function(t){J.timers.push(t),t()?J.fx.start():J.timers.pop()},J.fx.interval=13,J.fx.start=function(){Qe||(Qe=setInterval(J.fx.tick,J.fx.interval))},J.fx.stop=function(){clearInterval(Qe),Qe=null},J.fx.speeds={slow:600,fast:200,_default:400},J.fn.delay=function(t,e){return t=J.fx?J.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},function(){var t=Q.createElement("input"),e=Q.createElement("select"),i=e.appendChild(Q.createElement("option"));t.type="checkbox",$.checkOn=""!==t.value,$.optSelected=i.selected,e.disabled=!0,$.optDisabled=!i.disabled,t=Q.createElement("input"),t.value="t",t.type="radio",$.radioValue="t"===t.value}();var ni,ri,oi=J.expr.attrHandle;J.fn.extend({attr:function(t,e){return ge(this,J.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){J.removeAttr(this,t)})}}),J.extend({attr:function(t,e,i){var n,r,o=t.nodeType;return t&&3!==o&&8!==o&&2!==o?typeof t.getAttribute===Re?J.prop(t,e,i):(1===o&&J.isXMLDoc(t)||(e=e.toLowerCase(),n=J.attrHooks[e]||(J.expr.match.bool.test(e)?ri:ni)),void 0===i?n&&"get"in n&&null!==(r=n.get(t,e))?r:(r=J.find.attr(t,e),null==r?void 0:r):null!==i?n&&"set"in n&&void 0!==(r=n.set(t,i,e))?r:(t.setAttribute(e,i+""),i):void J.removeAttr(t,e)):void 0},removeAttr:function(t,e){var i,n,r=0,o=e&&e.match(fe);if(o&&1===t.nodeType)for(;i=o[r++];)n=J.propFix[i]||i,J.expr.match.bool.test(i)&&(t[n]=!1),t.removeAttribute(i)},attrHooks:{type:{set:function(t,e){if(!$.radioValue&&"radio"===e&&J.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),ri={set:function(t,e,i){return e===!1?J.removeAttr(t,i):t.setAttribute(i,i),i}},J.each(J.expr.match.bool.source.match(/\w+/g),function(t,e){var i=oi[e]||J.find.attr;oi[e]=function(t,e,n){var r,o;return n||(o=oi[e],oi[e]=r,r=null!=i(t,e,n)?e.toLowerCase():null,oi[e]=o),r}});var ai=/^(?:input|select|textarea|button)$/i;J.fn.extend({prop:function(t,e){return ge(this,J.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[J.propFix[t]||t]})}}),J.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,i){var n,r,o,a=t.nodeType;return t&&3!==a&&8!==a&&2!==a?(o=1!==a||!J.isXMLDoc(t),o&&(e=J.propFix[e]||e,r=J.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]):void 0},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||ai.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),$.optSelected||(J.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),J.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){J.propFix[this.toLowerCase()]=this});var si=/[\t\r\n\f]/g;J.fn.extend({addClass:function(t){var e,i,n,r,o,a,s="string"==typeof t&&t,l=0,h=this.length;if(J.isFunction(t))return this.each(function(e){J(this).addClass(t.call(this,e,this.className))});if(s)for(e=(t||"").match(fe)||[];h>l;l++)if(i=this[l],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(si," "):" ")){for(o=0;r=e[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");a=J.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(t){var e,i,n,r,o,a,s=0===arguments.length||"string"==typeof t&&t,l=0,h=this.length;if(J.isFunction(t))return this.each(function(e){J(this).removeClass(t.call(this,e,this.className))});if(s)for(e=(t||"").match(fe)||[];h>l;l++)if(i=this[l],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(si," "):"")){for(o=0;r=e[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");a=t?J.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):this.each(J.isFunction(t)?function(i){J(this).toggleClass(t.call(this,i,this.className,e),e)}:function(){if("string"===i)for(var e,n=0,r=J(this),o=t.match(fe)||[];e=o[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else(i===Re||"boolean"===i)&&(this.className&&ve.set(this,"__className__",this.className),this.className=this.className||t===!1?"":ve.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(si," ").indexOf(e)>=0)return!0;return!1}});var li=/\r/g;J.fn.extend({val:function(t){var e,i,n,r=this[0];return arguments.length?(n=J.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=n?t.call(this,i,J(this).val()):t,null==r?r="":"number"==typeof r?r+="":J.isArray(r)&&(r=J.map(r,function(t){return null==t?"":t+""})),e=J.valHooks[this.type]||J.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))})):r?(e=J.valHooks[r.type]||J.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(li,""):null==i?"":i)):void 0}}),J.extend({valHooks:{option:{get:function(t){var e=J.find.attr(t,"value");return null!=e?e:J.trim(J.text(t))}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,o="select-one"===t.type||0>r,a=o?null:[],s=o?r+1:n.length,l=0>r?s:o?r:0;s>l;l++)if(i=n[l],!(!i.selected&&l!==r||($.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&J.nodeName(i.parentNode,"optgroup"))){if(e=J(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,n,r=t.options,o=J.makeArray(e),a=r.length;a--;)n=r[a],(n.selected=J.inArray(n.value,o)>=0)&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),J.each(["radio","checkbox"],function(){J.valHooks[this]={set:function(t,e){return J.isArray(e)?t.checked=J.inArray(J(t).val(),e)>=0:void 0}},$.checkOn||(J.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),J.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){J.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),J.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var hi=J.now(),ci=/\?/;J.parseJSON=function(t){return JSON.parse(t+"")},J.parseXML=function(t){var e,i;if(!t||"string"!=typeof t)return null;try{i=new DOMParser,e=i.parseFromString(t,"text/xml")}catch(n){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&J.error("Invalid XML: "+t),e};var ui=/#.*$/,di=/([?&])_=[^&]*/,fi=/^(.*?):[ \t]*([^\r\n]*)$/gm,pi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,mi=/^(?:GET|HEAD)$/,gi=/^\/\//,vi=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,yi={},Ei={},xi="*/".concat("*"),Ti=t.location.href,_i=vi.exec(Ti.toLowerCase())||[];J.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ti,type:"GET",isLocal:pi.test(_i[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":xi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":J.parseJSON,"text xml":J.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?F(F(t,J.ajaxSettings),e):F(J.ajaxSettings,t)},ajaxPrefilter:z(yi),ajaxTransport:z(Ei),ajax:function(t,e){function i(t,e,i,a){var l,c,v,y,x,_=e;2!==E&&(E=2,s&&clearTimeout(s),n=void 0,o=a||"",T.readyState=t>0?4:0,l=t>=200&&300>t||304===t,i&&(y=U(u,T,i)),y=I(u,y,T,l),l?(u.ifModified&&(x=T.getResponseHeader("Last-Modified"),x&&(J.lastModified[r]=x),x=T.getResponseHeader("etag"),x&&(J.etag[r]=x)),204===t||"HEAD"===u.type?_="nocontent":304===t?_="notmodified":(_=y.state,c=y.data,v=y.error,l=!v)):(v=_,(t||!_)&&(_="error",0>t&&(t=0))),T.status=t,T.statusText=(e||_)+"",l?p.resolveWith(d,[c,_,T]):p.rejectWith(d,[T,_,v]),T.statusCode(g),g=void 0,h&&f.trigger(l?"ajaxSuccess":"ajaxError",[T,u,l?c:v]),m.fireWith(d,[T,_]),h&&(f.trigger("ajaxComplete",[T,u]),--J.active||J.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,r,o,a,s,l,h,c,u=J.ajaxSetup({},e),d=u.context||u,f=u.context&&(d.nodeType||d.jquery)?J(d):J.event,p=J.Deferred(),m=J.Callbacks("once memory"),g=u.statusCode||{},v={},y={},E=0,x="canceled",T={readyState:0,getResponseHeader:function(t){var e;if(2===E){if(!a)for(a={};e=fi.exec(o);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===E?o:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return E||(t=y[i]=y[i]||t,v[t]=e),this},overrideMimeType:function(t){return E||(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>E)for(e in t)g[e]=[g[e],t[e]];else T.always(t[T.status]);return this},abort:function(t){var e=t||x;return n&&n.abort(e),i(0,e),this}};if(p.promise(T).complete=m.add,T.success=T.done,T.error=T.fail,u.url=((t||u.url||Ti)+"").replace(ui,"").replace(gi,_i[1]+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=J.trim(u.dataType||"*").toLowerCase().match(fe)||[""],null==u.crossDomain&&(l=vi.exec(u.url.toLowerCase()),u.crossDomain=!(!l||l[1]===_i[1]&&l[2]===_i[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(_i[3]||("http:"===_i[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=J.param(u.data,u.traditional)),N(yi,u,e,T),2===E)return T;h=J.event&&u.global,h&&0===J.active++&&J.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!mi.test(u.type),r=u.url,u.hasContent||(u.data&&(r=u.url+=(ci.test(r)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=di.test(r)?r.replace(di,"$1_="+hi++):r+(ci.test(r)?"&":"?")+"_="+hi++)),u.ifModified&&(J.lastModified[r]&&T.setRequestHeader("If-Modified-Since",J.lastModified[r]),J.etag[r]&&T.setRequestHeader("If-None-Match",J.etag[r])),(u.data&&u.hasContent&&u.contentType!==!1||e.contentType)&&T.setRequestHeader("Content-Type",u.contentType),T.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+xi+"; q=0.01":""):u.accepts["*"]);for(c in u.headers)T.setRequestHeader(c,u.headers[c]);if(!u.beforeSend||u.beforeSend.call(d,T,u)!==!1&&2!==E){x="abort";for(c in{success:1,error:1,complete:1})T[c](u[c]);if(n=N(Ei,u,e,T)){T.readyState=1,h&&f.trigger("ajaxSend",[T,u]),u.async&&u.timeout>0&&(s=setTimeout(function(){T.abort("timeout")},u.timeout));try{E=1,n.send(v,i)}catch(_){if(!(2>E))throw _;i(-1,_)}}else i(-1,"No Transport");return T}return T.abort()},getJSON:function(t,e,i){return J.get(t,e,i,"json")},getScript:function(t,e){return J.get(t,void 0,e,"script")}}),J.each(["get","post"],function(t,e){J[e]=function(t,i,n,r){return J.isFunction(i)&&(r=r||n,n=i,i=void 0),J.ajax({url:t,type:e,dataType:r,data:i,success:n})}}),J._evalUrl=function(t){return J.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},J.fn.extend({wrapAll:function(t){var e;return J.isFunction(t)?this.each(function(e){J(this).wrapAll(t.call(this,e))}):(this[0]&&(e=J(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(J.isFunction(t)?function(e){J(this).wrapInner(t.call(this,e))}:function(){var e=J(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=J.isFunction(t);return this.each(function(i){J(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){J.nodeName(this,"body")||J(this).replaceWith(this.childNodes)}).end()}}),J.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},J.expr.filters.visible=function(t){return!J.expr.filters.hidden(t)};var bi=/%20/g,wi=/\[\]$/,Ri=/\r?\n/g,Si=/^(?:submit|button|image|reset|file)$/i,Mi=/^(?:input|select|textarea|keygen)/i;J.param=function(t,e){var i,n=[],r=function(t,e){e=J.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=J.ajaxSettings&&J.ajaxSettings.traditional),J.isArray(t)||t.jquery&&!J.isPlainObject(t))J.each(t,function(){r(this.name,this.value)});else for(i in t)k(i,t[i],e,r);return n.join("&").replace(bi,"+")},J.fn.extend({serialize:function(){return J.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=J.prop(this,"elements");return t?J.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!J(this).is(":disabled")&&Mi.test(this.nodeName)&&!Si.test(t)&&(this.checked||!we.test(t))}).map(function(t,e){var i=J(this).val();return null==i?null:J.isArray(i)?J.map(i,function(t){return{name:e.name,value:t.replace(Ri,"\r\n")}}):{name:e.name,value:i.replace(Ri,"\r\n")}}).get()}}),J.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Hi=0,Ci={},Ai={0:200,1223:204},Pi=J.ajaxSettings.xhr();t.attachEvent&&t.attachEvent("onunload",function(){for(var t in Ci)Ci[t]()}),$.cors=!!Pi&&"withCredentials"in Pi,$.ajax=Pi=!!Pi,J.ajaxTransport(function(t){var e;return $.cors||Pi&&!t.crossDomain?{send:function(i,n){var r,o=t.xhr(),a=++Hi;if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)o[r]=t.xhrFields[r];t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(r in i)o.setRequestHeader(r,i[r]);e=function(t){return function(){e&&(delete Ci[a],e=o.onload=o.onerror=null,"abort"===t?o.abort():"error"===t?n(o.status,o.statusText):n(Ai[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=e(),o.onerror=e("error"),e=Ci[a]=e("abort");try{}catch(s){if(e)throw s}},abort:function(){e&&e()}}:void 0}),J.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return J.globalEval(t),t}}}),J.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),J.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(n,r){e=J("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&r("error"===t.type?404:200,t.type)}),Q.head.appendChild(e[0])},abort:function(){i&&i()}}}});var Li=[],Oi=/(=)\?(?=&|$)|\?\?/;J.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Li.pop()||J.expando+"_"+hi++;return this[t]=!0,t}}),J.ajaxPrefilter("json jsonp",function(e,i,n){var r,o,a,s=e.jsonp!==!1&&(Oi.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Oi.test(e.data)&&"data");return s||"jsonp"===e.dataTypes[0]?(r=e.jsonpCallback=J.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Oi,"$1"+r):e.jsonp!==!1&&(e.url+=(ci.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return a||J.error(r+" was not called"),a[0]},e.dataTypes[0]="json",o=t[r],t[r]=function(){a=arguments},n.always(function(){t[r]=o,e[r]&&(e.jsonpCallback=i.jsonpCallback,Li.push(r)),a&&J.isFunction(o)&&o(a[0]),a=o=void 0}),"script"):void 0}),J.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||Q;var n=ae.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=J.buildFragment([t],e,r),r&&r.length&&J(r).remove(),J.merge([],n.childNodes))};var Di=J.fn.load;J.fn.load=function(t,e,i){if("string"!=typeof t&&Di)return Di.apply(this,arguments);var n,r,o,a=this,s=t.indexOf(" ");return s>=0&&(n=J.trim(t.slice(s)),t=t.slice(0,s)),J.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),a.length>0&&J.ajax({url:t,type:r,dataType:"html",data:e}).done(function(t){o=arguments,a.html(n?J("<div>").append(J.parseHTML(t)).find(n):t)}).complete(i&&function(t,e){a.each(i,o||[t.responseText,e,t])}),this},J.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){J.fn[e]=function(t){return this.on(e,t)}}),J.expr.filters.animated=function(t){return J.grep(J.timers,function(e){return t===e.elem}).length};var zi=t.document.documentElement;J.offset={setOffset:function(t,e,i){var n,r,o,a,s,l,h,c=J.css(t,"position"),u=J(t),d={};"static"===c&&(t.style.position="relative"),s=u.offset(),o=J.css(t,"top"),l=J.css(t,"left"),h=("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1,h?(n=u.position(),a=n.top,r=n.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),J.isFunction(e)&&(e=e.call(t,i,s)),null!=e.top&&(d.top=e.top-s.top+a),null!=e.left&&(d.left=e.left-s.left+r),"using"in e?e.using.call(t,d):u.css(d)}},J.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){J.offset.setOffset(this,t,e)});var e,i,n=this[0],r={top:0,left:0},o=n&&n.ownerDocument;return o?(e=o.documentElement,J.contains(e,n)?(typeof n.getBoundingClientRect!==Re&&(r=n.getBoundingClientRect()),i=V(o),{top:r.top+i.pageYOffset-e.clientTop,left:r.left+i.pageXOffset-e.clientLeft}):r):void 0},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===J.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),J.nodeName(t[0],"html")||(n=t.offset()),n.top+=J.css(t[0],"borderTopWidth",!0),n.left+=J.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-J.css(i,"marginTop",!0),left:e.left-n.left-J.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||zi;t&&!J.nodeName(t,"html")&&"static"===J.css(t,"position");)t=t.offsetParent;return t||zi})}}),J.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n="pageYOffset"===i;J.fn[e]=function(r){return ge(this,function(e,r,o){var a=V(e);return void 0===o?a?a[i]:e[r]:void(a?a.scrollTo(n?t.pageXOffset:o,n?o:t.pageYOffset):e[r]=o)},e,r,arguments.length,null)}}),J.each(["top","left"],function(t,e){J.cssHooks[e]=_($.pixelPosition,function(t,i){return i?(i=T(t,e),Be.test(i)?J(t).position()[e]+"px":i):void 0})}),J.each({Height:"height",Width:"width"},function(t,e){J.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){J.fn[n]=function(n,r){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(n===!0||r===!0?"margin":"border");return ge(this,function(e,i,n){var r;return J.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===n?J.css(e,i,a):J.style(e,i,n,a)},e,o?n:void 0,o,null)}})}),J.fn.size=function(){return this.length},J.fn.andSelf=J.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return J});var Ni=t.jQuery,Fi=t.$;return J.noConflict=function(e){return t.$===J&&(t.$=Fi),e&&t.jQuery===J&&(t.jQuery=Ni),J},typeof e===Re&&(t.jQuery=t.$=J),J}),!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define("Class",t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Class=t()}}(function(){return function t(e,i,n){function r(a,s){if(!i[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){var i=e[a][1][t];return r(i?i:t)},h,h.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e){var i=t("./baseClass"),n=function(t){var e=void 0;void 0===t&&(t={}),t.initialize?(e=t.initialize,delete t.initialize):e=function(){Array.prototype.splice.apply(arguments,[0,0,this]),n.parent.apply(void 0,arguments)},void 0!==t.Extends?(t.Extends.$$isConstructor=!0,e.prototype=Object.create(t.Extends.prototype),e.$$parentConstructor=t.Extends,delete t.Extends):(e.prototype=Object.create(i),e.$$parentConstructor=function(){}),e.prototype.$$getters={},e.prototype.$$setters={};for(var r in t)"function"==typeof t[r]?(t[r].$$name=r,t[r].$$owner=e.prototype,e.prototype[r]=t[r]):t[r]&&"object"==typeof t[r]&&(t[r].get||t[r].set)?(Object.defineProperty(e.prototype,r,t[r]),t[r].get&&(e.prototype.$$getters[r]=t[r].get,t[r].get.$$name=r,t[r].get.$$owner=e.prototype),t[r].set&&(e.prototype.$$setters[r]=t[r].set,t[r].set.$$name=r,t[r].set.$$owner=e.prototype)):e.prototype[r]=t[r];e.$$isConstructor=!0;for(var r=1;r<arguments.length;r++)arguments[r].compare(e);return e};n.parent=function(t){var e=n.parent.caller;if(arguments=Array.prototype.slice.apply(arguments,[1]),e.$$isConstructor)var i=e.$$parentConstructor;else{if(!e.$$name)throw"You cannot call parent here";var r=e.$$name,o=e.$$owner.$$getters[r],a=e.$$owner.$$setters[r];if(1==arguments.length&&a){var i=Object.getPrototypeOf(e.$$owner).$$setters[r];if(void 0===i)throw"No setter defined in parent"}else if(0==arguments.length&&o){var i=Object.getPrototypeOf(e.$$owner).$$getters[r];if(void 0===i)throw"No getter defined in parent"}else{if(a||o)throw"Incorrect amount of arguments sent to getter or setter";var i=Object.getPrototypeOf(e.$$owner)[r];if(void 0===i)throw"No parent function defined for "+r}}return i.apply(t,arguments)},e.exports=n},{"./baseClass":2}],2:[function(t,e){e.exports={parent:function(){if(this.parent.caller.$$isConstructor)var t=this.parent.caller.$$parentConstructor;else{if(!this.parent.caller.$$name)throw"You cannot call parent here";var e=this.parent.caller.$$name,i=this.parent.caller.$$owner.$$getters[e],n=this.parent.caller.$$owner.$$setters[e];if(1==arguments.length&&n){var t=Object.getPrototypeOf(this.parent.caller.$$owner).$$setters[e];if(void 0===t)throw"No setter defined in parent"}else if(0==arguments.length&&i){var t=Object.getPrototypeOf(this.parent.caller.$$owner).$$getters[e];if(void 0===t)throw"No getter defined in parent"}else{if(n||i)throw"Incorrect amount of arguments sent to getter or setter";var t=Object.getPrototypeOf(this.parent.caller.$$owner)[e];if(void 0===t)throw"No parent function defined for "+e}}return t.apply(this,arguments)}}},{}]},{},[1])(1)}),function(){function t(t,e,i){i=(i||0)-1;for(var n=t?t.length:0;++i<n;)if(t[i]===e)return i;return-1}function e(e,i){var n=typeof i;if(e=e.l,"boolean"==n||null==i)return e[i]?0:-1;"number"!=n&&"string"!=n&&(n="object");var r="number"==n?i:v+i;return e=(e=e[n])&&e[r],"object"==n?e&&-1<t(e,i)?0:-1:e?0:-1}function i(t){var e=this.l,i=typeof t;if("boolean"==i||null==t)e[t]=!0;else{"number"!=i&&"string"!=i&&(i="object");var n="number"==i?t:v+t,e=e[i]||(e[i]={});"object"==i?(e[n]||(e[n]=[])).push(t):e[n]=!0}}function n(t){return t.charCodeAt(0)}function r(t,e){for(var i=t.m,n=e.m,r=-1,o=i.length;++r<o;){var a=i[r],s=n[r];if(a!==s){if(a>s||"undefined"==typeof a)return 1;if(s>a||"undefined"==typeof s)return-1}}return t.n-e.n}function o(t){var e=-1,n=t.length,r=t[0],o=t[n/2|0],a=t[n-1];if(r&&"object"==typeof r&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;for(r=l(),r["false"]=r["null"]=r["true"]=r.undefined=!1,o=l(),o.k=t,o.l=r,o.push=i;++e<n;)o.push(t[e]);return o}function a(t){return"\\"+X[t]}function s(){return p.pop()||[]}function l(){return m.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,o:null}}function h(t){t.length=0,p.length<E&&p.push(t)}function c(t){var e=t.l;e&&c(e),t.k=t.l=t.m=t.object=t.number=t.string=t.o=null,m.length<E&&m.push(t)}function u(t,e,i){e||(e=0),"undefined"==typeof i&&(i=t?t.length:0);var n=-1;i=i-e||0;for(var r=Array(0>i?0:i);++n<i;)r[n]=t[e+n];return r}function d(i){function p(t,e,i){if(!t||!W[typeof t])return t;e=e&&"undefined"==typeof i?e:ee(e,i,3);for(var n=-1,r=W[typeof t]&&Ni(t),o=r?r.length:0;++n<o&&(i=r[n],!1!==e(t[i],i,t)););return t}function m(t,e,i){var n;if(!t||!W[typeof t])return t;e=e&&"undefined"==typeof i?e:ee(e,i,3);for(n in t)if(!1===e(t[n],n,t))break;return t}function E(t,e,i){var n,r=t,o=r;if(!r)return o;for(var a=arguments,s=0,l="number"==typeof i?2:a.length;++s<l;)if((r=a[s])&&W[typeof r])for(var h=-1,c=W[typeof r]&&Ni(r),u=c?c.length:0;++h<u;)n=c[h],"undefined"==typeof o[n]&&(o[n]=r[n]);return o}function X(t,e,i){var n,r=t,o=r;if(!r)return o;var a=arguments,s=0,l="number"==typeof i?2:a.length;if(l>3&&"function"==typeof a[l-2])var h=ee(a[--l-1],a[l--],2);else l>2&&"function"==typeof a[l-1]&&(h=a[--l]);for(;++s<l;)if((r=a[s])&&W[typeof r])for(var c=-1,u=W[typeof r]&&Ni(r),d=u?u.length:0;++c<d;)n=u[c],o[n]=h?h(o[n],r[n]):r[n];return o}function Y(t){var e,i=[];if(!t||!W[typeof t])return i;for(e in t)vi.call(t,e)&&i.push(e);return i}function K(t){return t&&"object"==typeof t&&!zi(t)&&vi.call(t,"__wrapped__")?t:new $(t)}function $(t,e){this.__chain__=!!e,this.__wrapped__=t}function Q(t){function e(){if(n){var t=u(n);yi.apply(t,arguments)}if(this instanceof e){var o=te(i.prototype),t=i.apply(o,t||arguments);return Te(t)?t:o}return i.apply(r,t||arguments)}var i=t[0],n=t[2],r=t[4];return Di(e,t),e}function J(t,e,i,n,r){if(i){var o=i(t);if("undefined"!=typeof o)return o}if(!Te(t))return t;var a=ci.call(t);if(!B[a])return t;var l=Li[a];switch(a){case z:case N:return new l(+t);case U:case V:return new l(t);case k:return o=l(t.source,R.exec(t)),o.lastIndex=t.lastIndex,o}if(a=zi(t),e){var c=!n;n||(n=s()),r||(r=s());for(var d=n.length;d--;)if(n[d]==t)return r[d];o=a?l(t.length):{}}else o=a?u(t):X({},t);return a&&(vi.call(t,"index")&&(o.index=t.index),vi.call(t,"input")&&(o.input=t.input)),e?(n.push(t),r.push(o),(a?Ce:p)(t,function(t,a){o[a]=J(t,e,i,n,r)}),c&&(h(n),h(r)),o):o}function te(t){return Te(t)?bi(t):{}}function ee(t,e,i){if("function"!=typeof t)return Xe;if("undefined"!=typeof e&&"prototype"in t){var n=t.__bindData__;if("undefined"==typeof n&&(Oi.funcNames&&(n=!t.name),n=n||!Oi.funcDecomp,!n)){var r=mi.call(t);Oi.funcNames||(n=!S.test(r)),n||(n=A.test(r),Di(t,n))}if(!1===n||!0!==n&&1&n[1])return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,o){return t.call(e,i,n,r,o)}}return Ge(t,e)}return t}function ie(t){function e(){var t=l?a:this;if(r){var p=u(r);yi.apply(p,arguments)}return(o||c)&&(p||(p=u(arguments)),o&&yi.apply(p,o),c&&p.length<s)?(n|=16,ie([i,d?n:-4&n,p,null,a,s])):(p||(p=arguments),h&&(i=t[f]),this instanceof e?(t=te(i.prototype),p=i.apply(t,p),Te(p)?p:t):i.apply(t,p))}var i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=1&n,h=2&n,c=4&n,d=8&n,f=i;return Di(e,t),e}function ne(i,n){var r=-1,a=de(),s=i?i.length:0,l=s>=y&&a===t,h=[];if(l){var u=o(n);u?(a=e,n=u):l=!1}for(;++r<s;)u=i[r],0>a(n,u)&&h.push(u);return l&&c(n),h}function re(t,e,i,n){n=(n||0)-1;for(var r=t?t.length:0,o=[];++n<r;){var a=t[n];if(a&&"object"==typeof a&&"number"==typeof a.length&&(zi(a)||ge(a))){e||(a=re(a,e,i));var s=-1,l=a.length,h=o.length;for(o.length+=l;++s<l;)o[h++]=a[s]}else i||o.push(a)}return o}function oe(t,e,i,n,r,o){if(i){var a=i(t,e);if("undefined"!=typeof a)return!!a}if(t===e)return 0!==t||1/t==1/e;if(t===t&&!(t&&W[typeof t]||e&&W[typeof e]))return!1;if(null==t||null==e)return t===e;var l=ci.call(t),c=ci.call(e);if(l==O&&(l=I),c==O&&(c=I),l!=c)return!1;switch(l){case z:case N:return+t==+e;case U:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case k:case V:return t==oi(e)}if(c=l==D,!c){var u=vi.call(t,"__wrapped__"),d=vi.call(e,"__wrapped__");if(u||d)return oe(u?t.__wrapped__:t,d?e.__wrapped__:e,i,n,r,o);if(l!=I)return!1;if(l=t.constructor,u=e.constructor,l!=u&&!(xe(l)&&l instanceof l&&xe(u)&&u instanceof u)&&"constructor"in t&&"constructor"in e)return!1}for(l=!r,r||(r=s()),o||(o=s()),u=r.length;u--;)if(r[u]==t)return o[u]==e;var f=0,a=!0;if(r.push(t),o.push(e),c){if(u=t.length,f=e.length,(a=f==u)||n)for(;f--;)if(c=u,d=e[f],n)for(;c--&&!(a=oe(t[c],d,i,n,r,o)););else if(!(a=oe(t[f],d,i,n,r,o)))break}else m(e,function(e,s,l){return vi.call(l,s)?(f++,a=vi.call(t,s)&&oe(t[s],e,i,n,r,o)):void 0}),a&&!n&&m(t,function(t,e,i){return vi.call(i,e)?a=-1<--f:void 0});return r.pop(),o.pop(),l&&(h(r),h(o)),a}function ae(t,e,i,n,r){(zi(e)?Ce:p)(e,function(e,o){var a,s,l=e,h=t[o];if(e&&((s=zi(e))||Vi(e))){for(l=n.length;l--;)if(a=n[l]==e){h=r[l];break}if(!a){var c;i&&(l=i(h,e),c="undefined"!=typeof l)&&(h=l),c||(h=s?zi(h)?h:[]:Vi(h)?h:{}),n.push(e),r.push(h),c||ae(h,e,i,n,r)}}else i&&(l=i(h,e),"undefined"==typeof l&&(l=e)),"undefined"!=typeof l&&(h=l);t[o]=h})}function se(t,e){return t+pi(Pi()*(e-t+1))}function le(i,n,r){var a=-1,l=de(),u=i?i.length:0,d=[],f=!n&&u>=y&&l===t,p=r||f?s():d;for(f&&(p=o(p),l=e);++a<u;){var m=i[a],g=r?r(m,a,i):m;(n?!a||p[p.length-1]!==g:0>l(p,g))&&((r||f)&&p.push(g),d.push(m))}return f?(h(p.k),c(p)):r&&h(p),d}function he(t){return function(e,i,n){var r={};i=K.createCallback(i,n,3),n=-1;var o=e?e.length:0;if("number"==typeof o)for(;++n<o;){var a=e[n];t(r,a,i(a,n,e),e)}else p(e,function(e,n,o){t(r,e,i(e,n,o),o)});return r}}function ce(t,e,i,n,r,o){var a=1&e,s=4&e,l=16&e,h=32&e;if(!(2&e||xe(t)))throw new ai;l&&!i.length&&(e&=-17,l=i=!1),h&&!n.length&&(e&=-33,h=n=!1);var c=t&&t.__bindData__;return c&&!0!==c?(c=u(c),c[2]&&(c[2]=u(c[2])),c[3]&&(c[3]=u(c[3])),!a||1&c[1]||(c[4]=r),!a&&1&c[1]&&(e|=8),!s||4&c[1]||(c[5]=o),l&&yi.apply(c[2]||(c[2]=[]),i),h&&Ti.apply(c[3]||(c[3]=[]),n),c[1]|=e,ce.apply(null,c)):(1==e||17===e?Q:ie)([t,e,i,n,r,o])}function ue(t){return Fi[t]}function de(){var e=(e=K.indexOf)===Ue?t:e;return e}function fe(t){return"function"==typeof t&&ui.test(t)}function pe(t){var e,i;return t&&ci.call(t)==I&&(e=t.constructor,!xe(e)||e instanceof e)?(m(t,function(t,e){i=e}),"undefined"==typeof i||vi.call(t,i)):!1}function me(t){return Ui[t]}function ge(t){return t&&"object"==typeof t&&"number"==typeof t.length&&ci.call(t)==O||!1}function ve(t,e,i){var n=Ni(t),r=n.length;for(e=ee(e,i,3);r--&&(i=n[r],!1!==e(t[i],i,t)););return t}function ye(t){var e=[];return m(t,function(t,i){xe(t)&&e.push(i)}),e.sort()}function Ee(t){for(var e=-1,i=Ni(t),n=i.length,r={};++e<n;){var o=i[e];r[t[o]]=o}return r}function xe(t){return"function"==typeof t}function Te(t){return!!t&&!!W[typeof t]}function _e(t){return"number"==typeof t||t&&"object"==typeof t&&ci.call(t)==U||!1}function be(t){return"string"==typeof t||t&&"object"==typeof t&&ci.call(t)==V||!1}function we(t){for(var e=-1,i=Ni(t),n=i.length,r=Qe(n);++e<n;)r[e]=t[i[e]];return r}function Re(t,e,i){var n=-1,r=de(),o=t?t.length:0,a=!1;return i=(0>i?Hi(0,o+i):i)||0,zi(t)?a=-1<r(t,e,i):"number"==typeof o?a=-1<(be(t)?t.indexOf(e,i):r(t,e,i)):p(t,function(t){return++n<i?void 0:!(a=t===e)}),a}function Se(t,e,i){var n=!0;e=K.createCallback(e,i,3),i=-1;var r=t?t.length:0;if("number"==typeof r)for(;++i<r&&(n=!!e(t[i],i,t)););else p(t,function(t,i,r){return n=!!e(t,i,r)});return n}function Me(t,e,i){var n=[];e=K.createCallback(e,i,3),i=-1;
var r=t?t.length:0;if("number"==typeof r)for(;++i<r;){var o=t[i];e(o,i,t)&&n.push(o)}else p(t,function(t,i,r){e(t,i,r)&&n.push(t)});return n}function He(t,e,i){e=K.createCallback(e,i,3),i=-1;var n=t?t.length:0;if("number"!=typeof n){var r;return p(t,function(t,i,n){return e(t,i,n)?(r=t,!1):void 0}),r}for(;++i<n;){var o=t[i];if(e(o,i,t))return o}}function Ce(t,e,i){var n=-1,r=t?t.length:0;if(e=e&&"undefined"==typeof i?e:ee(e,i,3),"number"==typeof r)for(;++n<r&&!1!==e(t[n],n,t););else p(t,e);return t}function Ae(t,e,i){var n=t?t.length:0;if(e=e&&"undefined"==typeof i?e:ee(e,i,3),"number"==typeof n)for(;n--&&!1!==e(t[n],n,t););else{var r=Ni(t),n=r.length;p(t,function(t,i,o){return i=r?r[--n]:--n,e(o[i],i,o)})}return t}function Pe(t,e,i){var n=-1,r=t?t.length:0;if(e=K.createCallback(e,i,3),"number"==typeof r)for(var o=Qe(r);++n<r;)o[n]=e(t[n],n,t);else o=[],p(t,function(t,i,r){o[++n]=e(t,i,r)});return o}function Le(t,e,i){var r=-1/0,o=r;if("function"!=typeof e&&i&&i[e]===t&&(e=null),null==e&&zi(t)){i=-1;for(var a=t.length;++i<a;){var s=t[i];s>o&&(o=s)}}else e=null==e&&be(t)?n:K.createCallback(e,i,3),Ce(t,function(t,i,n){i=e(t,i,n),i>r&&(r=i,o=t)});return o}function Oe(t,e,i,n){if(!t)return i;var r=3>arguments.length;e=K.createCallback(e,n,4);var o=-1,a=t.length;if("number"==typeof a)for(r&&(i=t[++o]);++o<a;)i=e(i,t[o],o,t);else p(t,function(t,n,o){i=r?(r=!1,t):e(i,t,n,o)});return i}function De(t,e,i,n){var r=3>arguments.length;return e=K.createCallback(e,n,4),Ae(t,function(t,n,o){i=r?(r=!1,t):e(i,t,n,o)}),i}function ze(t){var e=-1,i=t?t.length:0,n=Qe("number"==typeof i?i:0);return Ce(t,function(t){var i=se(0,++e);n[e]=n[i],n[i]=t}),n}function Ne(t,e,i){var n;e=K.createCallback(e,i,3),i=-1;var r=t?t.length:0;if("number"==typeof r)for(;++i<r&&!(n=e(t[i],i,t)););else p(t,function(t,i,r){return!(n=e(t,i,r))});return!!n}function Fe(t,e,i){var n=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=-1;for(e=K.createCallback(e,i,3);++o<r&&e(t[o],o,t);)n++}else if(n=e,null==n||i)return t?t[0]:f;return u(t,0,Ci(Hi(0,n),r))}function Ue(e,i,n){if("number"==typeof n){var r=e?e.length:0;n=0>n?Hi(0,r+n):n||0}else if(n)return n=ke(e,i),e[n]===i?n:-1;return t(e,i,n)}function Ie(t,e,i){if("number"!=typeof e&&null!=e){var n=0,r=-1,o=t?t.length:0;for(e=K.createCallback(e,i,3);++r<o&&e(t[r],r,t);)n++}else n=null==e||i?1:Hi(0,e);return u(t,n)}function ke(t,e,i,n){var r=0,o=t?t.length:r;for(i=i?K.createCallback(i,n,1):Xe,e=i(e);o>r;)n=r+o>>>1,i(t[n])<e?r=n+1:o=n;return r}function Ve(t,e,i,n){return"boolean"!=typeof e&&null!=e&&(n=i,i="function"!=typeof e&&n&&n[e]===t?null:e,e=!1),null!=i&&(i=K.createCallback(i,n,3)),le(t,e,i)}function Be(){for(var t=1<arguments.length?arguments:arguments[0],e=-1,i=t?Le(Wi(t,"length")):0,n=Qe(0>i?0:i);++e<i;)n[e]=Wi(t,e);return n}function je(t,e){var i=-1,n=t?t.length:0,r={};for(e||!n||zi(t[0])||(e=[]);++i<n;){var o=t[i];e?r[o]=e[i]:o&&(r[o[0]]=o[1])}return r}function Ge(t,e){return 2<arguments.length?ce(t,17,u(arguments,2),null,e):ce(t,1,null,null,e)}function We(t,e,i){function n(){c&&fi(c),a=c=u=f,(m||p!==e)&&(d=Xi(),s=t.apply(h,o),c||a||(o=h=null))}function r(){var i=e-(Xi()-l);i>0?c=Ei(r,i):(a&&fi(a),i=u,a=c=u=f,i&&(d=Xi(),s=t.apply(h,o),c||a||(o=h=null)))}var o,a,s,l,h,c,u,d=0,p=!1,m=!0;if(!xe(t))throw new ai;if(e=Hi(0,e)||0,!0===i)var g=!0,m=!1;else Te(i)&&(g=i.leading,p="maxWait"in i&&(Hi(e,i.maxWait)||0),m="trailing"in i?i.trailing:m);return function(){if(o=arguments,l=Xi(),h=this,u=m&&(c||!g),!1===p)var i=g&&!c;else{a||g||(d=l);var f=p-(l-d),v=0>=f;v?(a&&(a=fi(a)),d=l,s=t.apply(h,o)):a||(a=Ei(n,f))}return v&&c?c=fi(c):c||e===p||(c=Ei(r,e)),i&&(v=!0,s=t.apply(h,o)),!v||c||a||(o=h=null),s}}function Xe(t){return t}function qe(t,e,i){var n=!0,r=e&&ye(e);e&&(i||r.length)||(null==i&&(i=e),o=$,e=t,t=K,r=ye(e)),!1===i?n=!1:Te(i)&&"chain"in i&&(n=i.chain);var o=t,a=xe(o);Ce(r,function(i){var r=t[i]=e[i];a&&(o.prototype[i]=function(){var e=this.__chain__,i=this.__wrapped__,a=[i];if(yi.apply(a,arguments),a=r.apply(t,a),n||e){if(i===a&&Te(a))return this;a=new o(a),a.__chain__=e}return a})})}function Ye(){}function Ke(t){return function(e){return e[t]}}function $e(){return this.__wrapped__}i=i?Z.defaults(q.Object(),i,Z.pick(q,L)):q;var Qe=i.Array,Ze=i.Boolean,Je=i.Date,ti=i.Function,ei=i.Math,ii=i.Number,ni=i.Object,ri=i.RegExp,oi=i.String,ai=i.TypeError,si=[],li=ni.prototype,hi=i._,ci=li.toString,ui=ri("^"+oi(ci).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),di=ei.ceil,fi=i.clearTimeout,pi=ei.floor,mi=ti.prototype.toString,gi=fe(gi=ni.getPrototypeOf)&&gi,vi=li.hasOwnProperty,yi=si.push,Ei=i.setTimeout,xi=si.splice,Ti=si.unshift,_i=function(){try{var t={},e=fe(e=ni.defineProperty)&&e,i=e(t,t,t)&&e}catch(n){}return i}(),bi=fe(bi=ni.create)&&bi,wi=fe(wi=Qe.isArray)&&wi,Ri=i.isFinite,Si=i.isNaN,Mi=fe(Mi=ni.keys)&&Mi,Hi=ei.max,Ci=ei.min,Ai=i.parseInt,Pi=ei.random,Li={};Li[D]=Qe,Li[z]=Ze,Li[N]=Je,Li[F]=ti,Li[I]=ni,Li[U]=ii,Li[k]=ri,Li[V]=oi,$.prototype=K.prototype;var Oi=K.support={};Oi.funcDecomp=!fe(i.a)&&A.test(d),Oi.funcNames="string"==typeof ti.name,K.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:M,variable:"",imports:{_:K}},bi||(te=function(){function t(){}return function(e){if(Te(e)){t.prototype=e;var n=new t;t.prototype=null}return n||i.Object()}}());var Di=_i?function(t,e){G.value=e,_i(t,"__bindData__",G)}:Ye,zi=wi||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&ci.call(t)==D||!1},Ni=Mi?function(t){return Te(t)?Mi(t):[]}:Y,Fi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ui=Ee(Fi),Ii=ri("("+Ni(Ui).join("|")+")","g"),ki=ri("["+Ni(Fi).join("")+"]","g"),Vi=gi?function(t){if(!t||ci.call(t)!=I)return!1;var e=t.valueOf,i=fe(e)&&(i=gi(e))&&gi(i);return i?t==i||gi(t)==i:pe(t)}:pe,Bi=he(function(t,e,i){vi.call(t,i)?t[i]++:t[i]=1}),ji=he(function(t,e,i){(vi.call(t,i)?t[i]:t[i]=[]).push(e)}),Gi=he(function(t,e,i){t[i]=e}),Wi=Pe,Xi=fe(Xi=Je.now)&&Xi||function(){return(new Je).getTime()},qi=8==Ai(x+"08")?Ai:function(t,e){return Ai(be(t)?t.replace(H,""):t,e||0)};return K.after=function(t,e){if(!xe(e))throw new ai;return function(){return 1>--t?e.apply(this,arguments):void 0}},K.assign=X,K.at=function(t){for(var e=arguments,i=-1,n=re(e,!0,!1,1),e=e[2]&&e[2][e[1]]===t?1:n.length,r=Qe(e);++i<e;)r[i]=t[n[i]];return r},K.bind=Ge,K.bindAll=function(t){for(var e=1<arguments.length?re(arguments,!0,!1,1):ye(t),i=-1,n=e.length;++i<n;){var r=e[i];t[r]=ce(t[r],1,null,null,t)}return t},K.bindKey=function(t,e){return 2<arguments.length?ce(e,19,u(arguments,2),null,t):ce(e,3,null,null,t)},K.chain=function(t){return t=new $(t),t.__chain__=!0,t},K.compact=function(t){for(var e=-1,i=t?t.length:0,n=[];++e<i;){var r=t[e];r&&n.push(r)}return n},K.compose=function(){for(var t=arguments,e=t.length;e--;)if(!xe(t[e]))throw new ai;return function(){for(var e=arguments,i=t.length;i--;)e=[t[i].apply(this,e)];return e[0]}},K.constant=function(t){return function(){return t}},K.countBy=Bi,K.create=function(t,e){var i=te(t);return e?X(i,e):i},K.createCallback=function(t,e,i){var n=typeof t;if(null==t||"function"==n)return ee(t,e,i);if("object"!=n)return Ke(t);var r=Ni(t),o=r[0],a=t[o];return 1!=r.length||a!==a||Te(a)?function(e){for(var i=r.length,n=!1;i--&&(n=oe(e[r[i]],t[r[i]],null,!0)););return n}:function(t){return t=t[o],a===t&&(0!==a||1/a==1/t)}},K.curry=function(t,e){return e="number"==typeof e?e:+e||t.length,ce(t,4,null,null,null,e)},K.debounce=We,K.defaults=E,K.defer=function(t){if(!xe(t))throw new ai;var e=u(arguments,1);return Ei(function(){t.apply(f,e)},1)},K.delay=function(t,e){if(!xe(t))throw new ai;var i=u(arguments,2);return Ei(function(){t.apply(f,i)},e)},K.difference=function(t){return ne(t,re(arguments,!0,!0,1))},K.filter=Me,K.flatten=function(t,e,i,n){return"boolean"!=typeof e&&null!=e&&(n=i,i="function"!=typeof e&&n&&n[e]===t?null:e,e=!1),null!=i&&(t=Pe(t,i,n)),re(t,e)},K.forEach=Ce,K.forEachRight=Ae,K.forIn=m,K.forInRight=function(t,e,i){var n=[];m(t,function(t,e){n.push(e,t)});var r=n.length;for(e=ee(e,i,3);r--&&!1!==e(n[r--],n[r],t););return t},K.forOwn=p,K.forOwnRight=ve,K.functions=ye,K.groupBy=ji,K.indexBy=Gi,K.initial=function(t,e,i){var n=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=r;for(e=K.createCallback(e,i,3);o--&&e(t[o],o,t);)n++}else n=null==e||i?1:e||n;return u(t,0,Ci(Hi(0,r-n),r))},K.intersection=function(){for(var i=[],n=-1,r=arguments.length,a=s(),l=de(),u=l===t,d=s();++n<r;){var f=arguments[n];(zi(f)||ge(f))&&(i.push(f),a.push(u&&f.length>=y&&o(n?i[n]:d)))}var u=i[0],p=-1,m=u?u.length:0,g=[];t:for(;++p<m;){var v=a[0],f=u[p];if(0>(v?e(v,f):l(d,f))){for(n=r,(v||d).push(f);--n;)if(v=a[n],0>(v?e(v,f):l(i[n],f)))continue t;g.push(f)}}for(;r--;)(v=a[r])&&c(v);return h(a),h(d),g},K.invert=Ee,K.invoke=function(t,e){var i=u(arguments,2),n=-1,r="function"==typeof e,o=t?t.length:0,a=Qe("number"==typeof o?o:0);return Ce(t,function(t){a[++n]=(r?e:t[e]).apply(t,i)}),a},K.keys=Ni,K.map=Pe,K.mapValues=function(t,e,i){var n={};return e=K.createCallback(e,i,3),p(t,function(t,i,r){n[i]=e(t,i,r)}),n},K.max=Le,K.memoize=function(t,e){function i(){var n=i.cache,r=e?e.apply(this,arguments):v+arguments[0];return vi.call(n,r)?n[r]:n[r]=t.apply(this,arguments)}if(!xe(t))throw new ai;return i.cache={},i},K.merge=function(t){var e=arguments,i=2;if(!Te(t))return t;if("number"!=typeof e[2]&&(i=e.length),i>3&&"function"==typeof e[i-2])var n=ee(e[--i-1],e[i--],2);else i>2&&"function"==typeof e[i-1]&&(n=e[--i]);for(var e=u(arguments,1,i),r=-1,o=s(),a=s();++r<i;)ae(t,e[r],n,o,a);return h(o),h(a),t},K.min=function(t,e,i){var r=1/0,o=r;if("function"!=typeof e&&i&&i[e]===t&&(e=null),null==e&&zi(t)){i=-1;for(var a=t.length;++i<a;){var s=t[i];o>s&&(o=s)}}else e=null==e&&be(t)?n:K.createCallback(e,i,3),Ce(t,function(t,i,n){i=e(t,i,n),r>i&&(r=i,o=t)});return o},K.omit=function(t,e,i){var n={};if("function"!=typeof e){var r=[];m(t,function(t,e){r.push(e)});for(var r=ne(r,re(arguments,!0,!1,1)),o=-1,a=r.length;++o<a;){var s=r[o];n[s]=t[s]}}else e=K.createCallback(e,i,3),m(t,function(t,i,r){e(t,i,r)||(n[i]=t)});return n},K.once=function(t){var e,i;if(!xe(t))throw new ai;return function(){return e?i:(e=!0,i=t.apply(this,arguments),t=null,i)}},K.pairs=function(t){for(var e=-1,i=Ni(t),n=i.length,r=Qe(n);++e<n;){var o=i[e];r[e]=[o,t[o]]}return r},K.partial=function(t){return ce(t,16,u(arguments,1))},K.partialRight=function(t){return ce(t,32,null,u(arguments,1))},K.pick=function(t,e,i){var n={};if("function"!=typeof e)for(var r=-1,o=re(arguments,!0,!1,1),a=Te(t)?o.length:0;++r<a;){var s=o[r];s in t&&(n[s]=t[s])}else e=K.createCallback(e,i,3),m(t,function(t,i,r){e(t,i,r)&&(n[i]=t)});return n},K.pluck=Wi,K.property=Ke,K.pull=function(t){for(var e=arguments,i=0,n=e.length,r=t?t.length:0;++i<n;)for(var o=-1,a=e[i];++o<r;)t[o]===a&&(xi.call(t,o--,1),r--);return t},K.range=function(t,e,i){t=+t||0,i="number"==typeof i?i:+i||1,null==e&&(e=t,t=0);var n=-1;e=Hi(0,di((e-t)/(i||1)));for(var r=Qe(e);++n<e;)r[n]=t,t+=i;return r},K.reject=function(t,e,i){return e=K.createCallback(e,i,3),Me(t,function(t,i,n){return!e(t,i,n)})},K.remove=function(t,e,i){var n=-1,r=t?t.length:0,o=[];for(e=K.createCallback(e,i,3);++n<r;)i=t[n],e(i,n,t)&&(o.push(i),xi.call(t,n--,1),r--);return o},K.rest=Ie,K.shuffle=ze,K.sortBy=function(t,e,i){var n=-1,o=zi(e),a=t?t.length:0,u=Qe("number"==typeof a?a:0);for(o||(e=K.createCallback(e,i,3)),Ce(t,function(t,i,r){var a=u[++n]=l();o?a.m=Pe(e,function(e){return t[e]}):(a.m=s())[0]=e(t,i,r),a.n=n,a.o=t}),a=u.length,u.sort(r);a--;)t=u[a],u[a]=t.o,o||h(t.m),c(t);return u},K.tap=function(t,e){return e(t),t},K.throttle=function(t,e,i){var n=!0,r=!0;if(!xe(t))throw new ai;return!1===i?n=!1:Te(i)&&(n="leading"in i?i.leading:n,r="trailing"in i?i.trailing:r),j.leading=n,j.maxWait=e,j.trailing=r,We(t,e,j)},K.times=function(t,e,i){t=-1<(t=+t)?t:0;var n=-1,r=Qe(t);for(e=ee(e,i,1);++n<t;)r[n]=e(n);return r},K.toArray=function(t){return t&&"number"==typeof t.length?u(t):we(t)},K.transform=function(t,e,i,n){var r=zi(t);if(null==i)if(r)i=[];else{var o=t&&t.constructor;i=te(o&&o.prototype)}return e&&(e=K.createCallback(e,n,4),(r?Ce:p)(t,function(t,n,r){return e(i,t,n,r)})),i},K.union=function(){return le(re(arguments,!0,!0))},K.uniq=Ve,K.values=we,K.where=Me,K.without=function(t){return ne(t,u(arguments,1))},K.wrap=function(t,e){return ce(e,16,[t])},K.xor=function(){for(var t=-1,e=arguments.length;++t<e;){var i=arguments[t];if(zi(i)||ge(i))var n=n?le(ne(n,i).concat(ne(i,n))):i}return n||[]},K.zip=Be,K.zipObject=je,K.collect=Pe,K.drop=Ie,K.each=Ce,K.eachRight=Ae,K.extend=X,K.methods=ye,K.object=je,K.select=Me,K.tail=Ie,K.unique=Ve,K.unzip=Be,qe(K),K.clone=function(t,e,i,n){return"boolean"!=typeof e&&null!=e&&(n=i,i=e,e=!1),J(t,e,"function"==typeof i&&ee(i,n,1))},K.cloneDeep=function(t,e,i){return J(t,!0,"function"==typeof e&&ee(e,i,1))},K.contains=Re,K.escape=function(t){return null==t?"":oi(t).replace(ki,ue)},K.every=Se,K.find=He,K.findIndex=function(t,e,i){var n=-1,r=t?t.length:0;for(e=K.createCallback(e,i,3);++n<r;)if(e(t[n],n,t))return n;return-1},K.findKey=function(t,e,i){var n;return e=K.createCallback(e,i,3),p(t,function(t,i,r){return e(t,i,r)?(n=i,!1):void 0}),n},K.findLast=function(t,e,i){var n;return e=K.createCallback(e,i,3),Ae(t,function(t,i,r){return e(t,i,r)?(n=t,!1):void 0}),n},K.findLastIndex=function(t,e,i){var n=t?t.length:0;for(e=K.createCallback(e,i,3);n--;)if(e(t[n],n,t))return n;return-1},K.findLastKey=function(t,e,i){var n;return e=K.createCallback(e,i,3),ve(t,function(t,i,r){return e(t,i,r)?(n=i,!1):void 0}),n},K.has=function(t,e){return t?vi.call(t,e):!1},K.identity=Xe,K.indexOf=Ue,K.isArguments=ge,K.isArray=zi,K.isBoolean=function(t){return!0===t||!1===t||t&&"object"==typeof t&&ci.call(t)==z||!1},K.isDate=function(t){return t&&"object"==typeof t&&ci.call(t)==N||!1},K.isElement=function(t){return t&&1===t.nodeType||!1},K.isEmpty=function(t){var e=!0;if(!t)return e;var i=ci.call(t),n=t.length;return i==D||i==V||i==O||i==I&&"number"==typeof n&&xe(t.splice)?!n:(p(t,function(){return e=!1}),e)},K.isEqual=function(t,e,i,n){return oe(t,e,"function"==typeof i&&ee(i,n,2))},K.isFinite=function(t){return Ri(t)&&!Si(parseFloat(t))},K.isFunction=xe,K.isNaN=function(t){return _e(t)&&t!=+t},K.isNull=function(t){return null===t},K.isNumber=_e,K.isObject=Te,K.isPlainObject=Vi,K.isRegExp=function(t){return t&&"object"==typeof t&&ci.call(t)==k||!1},K.isString=be,K.isUndefined=function(t){return"undefined"==typeof t},K.lastIndexOf=function(t,e,i){var n=t?t.length:0;for("number"==typeof i&&(n=(0>i?Hi(0,n+i):Ci(i,n-1))+1);n--;)if(t[n]===e)return n;return-1},K.mixin=qe,K.noConflict=function(){return i._=hi,this},K.noop=Ye,K.now=Xi,K.parseInt=qi,K.random=function(t,e,i){var n=null==t,r=null==e;return null==i&&("boolean"==typeof t&&r?(i=t,t=1):r||"boolean"!=typeof e||(i=e,r=!0)),n&&r&&(e=1),t=+t||0,r?(e=t,t=0):e=+e||0,i||t%1||e%1?(i=Pi(),Ci(t+i*(e-t+parseFloat("1e-"+((i+"").length-1))),e)):se(t,e)},K.reduce=Oe,K.reduceRight=De,K.result=function(t,e){if(t){var i=t[e];return xe(i)?t[e]():i}},K.runInContext=d,K.size=function(t){var e=t?t.length:0;return"number"==typeof e?e:Ni(t).length},K.some=Ne,K.sortedIndex=ke,K.template=function(t,e,i){var n=K.templateSettings;t=oi(t||""),i=E({},i,n);var r,o=E({},i.imports,n.imports),n=Ni(o),o=we(o),s=0,l=i.interpolate||C,h="__p+='",l=ri((i.escape||C).source+"|"+l.source+"|"+(l===M?w:C).source+"|"+(i.evaluate||C).source+"|$","g");t.replace(l,function(e,i,n,o,l,c){return n||(n=o),h+=t.slice(s,c).replace(P,a),i&&(h+="'+__e("+i+")+'"),l&&(r=!0,h+="';"+l+";\n__p+='"),n&&(h+="'+((__t=("+n+"))==null?'':__t)+'"),s=c+e.length,e}),h+="';",l=i=i.variable,l||(i="obj",h="with("+i+"){"+h+"}"),h=(r?h.replace(T,""):h).replace(_,"$1").replace(b,"$1;"),h="function("+i+"){"+(l?"":i+"||("+i+"={});")+"var __t,__p='',__e=_.escape"+(r?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+h+"return __p}";try{var c=ti(n,"return "+h).apply(f,o)}catch(u){throw u.source=h,u}return e?c(e):(c.source=h,c)},K.unescape=function(t){return null==t?"":oi(t).replace(Ii,me)},K.uniqueId=function(t){var e=++g;return oi(null==t?"":t)+e},K.all=Se,K.any=Ne,K.detect=He,K.findWhere=He,K.foldl=Oe,K.foldr=De,K.include=Re,K.inject=Oe,qe(function(){var t={};return p(K,function(e,i){K.prototype[i]||(t[i]=e)}),t}(),!1),K.first=Fe,K.last=function(t,e,i){var n=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=r;for(e=K.createCallback(e,i,3);o--&&e(t[o],o,t);)n++}else if(n=e,null==n||i)return t?t[r-1]:f;return u(t,Hi(0,r-n))},K.sample=function(t,e,i){return t&&"number"!=typeof t.length&&(t=we(t)),null==e||i?t?t[se(0,t.length-1)]:f:(t=ze(t),t.length=Ci(Hi(0,e),t.length),t)},K.take=Fe,K.head=Fe,p(K,function(t,e){var i="sample"!==e;K.prototype[e]||(K.prototype[e]=function(e,n){var r=this.__chain__,o=t(this.__wrapped__,e,n);return r||null!=e&&(!n||i&&"function"==typeof e)?new $(o,r):o})}),K.VERSION="2.4.1",K.prototype.chain=function(){return this.__chain__=!0,this},K.prototype.toString=function(){return oi(this.__wrapped__)},K.prototype.value=$e,K.prototype.valueOf=$e,Ce(["join","pop","shift"],function(t){var e=si[t];K.prototype[t]=function(){var t=this.__chain__,i=e.apply(this.__wrapped__,arguments);return t?new $(i,t):i}}),Ce(["push","reverse","sort","unshift"],function(t){var e=si[t];K.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),Ce(["concat","slice","splice"],function(t){var e=si[t];K.prototype[t]=function(){return new $(e.apply(this.__wrapped__,arguments),this.__chain__)}}),K}var f,p=[],m=[],g=0,v=+new Date+"",y=75,E=40,x=" 	\f\n\r\u2028\u2029",T=/\b__p\+='';/g,_=/\b(__p\+=)''\+/g,b=/(__e\(.*?\)|\b__t\))\+'';/g,w=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,R=/\w*$/,S=/^\s*function[ \n\r\t]+\w/,M=/<%=([\s\S]+?)%>/g,H=RegExp("^["+x+"]*0+(?=.$)"),C=/($^)/,A=/\bthis\b/,P=/['\n\r\t\u2028\u2029\\]/g,L="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setTimeout".split(" "),O="[object Arguments]",D="[object Array]",z="[object Boolean]",N="[object Date]",F="[object Function]",U="[object Number]",I="[object Object]",k="[object RegExp]",V="[object String]",B={};B[F]=!1,B[O]=B[D]=B[z]=B[N]=B[U]=B[I]=B[k]=B[V]=!0;var j={leading:!1,maxWait:0,trailing:!1},G={configurable:!1,enumerable:!1,value:null,writable:!1},W={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},X={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},q=W[typeof window]&&window||this,Y=W[typeof exports]&&exports&&!exports.nodeType&&exports,K=W[typeof module]&&module&&!module.nodeType&&module,$=K&&K.exports===Y&&Y,Q=W[typeof global]&&global;!Q||Q.global!==Q&&Q.window!==Q||(q=Q);var Z=d();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(q._=Z,define("underscore",[],function(){return Z})):Y&&K?$?(K.exports=Z)._=Z:Y._=Z:q._=Z}.call(this),(window._gsQueue||(window._gsQueue=[])).push(function(){"use strict";window._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(t,e){var i,n,r,o,a=function(){t.call(this,"css"),this._overwriteProps.length=0,this.setRatio=a.prototype.setRatio},s={},l=a.prototype=new t("css");l.constructor=a,a.version="1.11.8",a.API=2,a.defaultTransformPerspective=0,a.defaultSkewType="compensated",l="px",a.suffixMap={top:l,right:l,bottom:l,left:l,width:l,height:l,fontSize:l,padding:l,margin:l,perspective:l,lineHeight:""};var h,c,u,d,f,p,m=/(?:\d|\-\d|\.\d|\-\.\d)+/g,g=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,v=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,y=/[^\d\-\.]/g,E=/(?:\d|\-|\+|=|#|\.)*/g,x=/opacity *= *([^)]*)/,T=/opacity:([^;]*)/,_=/alpha\(opacity *=.+?\)/i,b=/^(rgb|hsl)/,w=/([A-Z])/g,R=/-([a-z])/gi,S=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,M=function(t,e){return e.toUpperCase()},H=/(?:Left|Right|Width)/i,C=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,A=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,P=/,(?=[^\)]*(?:\(|$))/gi,L=Math.PI/180,O=180/Math.PI,D={},z=document,N=z.createElement("div"),F=z.createElement("img"),U=a._internals={_specialProps:s},I=navigator.userAgent,k=function(){var t,e=I.indexOf("Android"),i=z.createElement("div");return u=-1!==I.indexOf("Safari")&&-1===I.indexOf("Chrome")&&(-1===e||Number(I.substr(e+8,1))>3),f=u&&6>Number(I.substr(I.indexOf("Version/")+8,1)),d=-1!==I.indexOf("Firefox"),/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(I)&&(p=parseFloat(RegExp.$1)),i.innerHTML="<a style='top:1px;opacity:.55;'>a</a>",t=i.getElementsByTagName("a")[0],t?/^0.55/.test(t.style.opacity):!1}(),V=function(t){return x.test("string"==typeof t?t:(t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?parseFloat(RegExp.$1)/100:1},B=function(){window.console&&0},j="",G="",W=function(t,e){e=e||N;var i,n,r=e.style;if(void 0!==r[t])return t;for(t=t.charAt(0).toUpperCase()+t.substr(1),i=["O","Moz","ms","Ms","Webkit"],n=5;--n>-1&&void 0===r[i[n]+t];);return n>=0?(G=3===n?"ms":i[n],j="-"+G.toLowerCase()+"-",G+t):null},X=z.defaultView?z.defaultView.getComputedStyle:function(){},q=a.getStyle=function(t,e,i,n,r){var o;return k||"opacity"!==e?(!n&&t.style[e]?o=t.style[e]:(i=i||X(t,null))?o=i[e]||i.getPropertyValue(e)||i.getPropertyValue(e.replace(w,"-$1").toLowerCase()):t.currentStyle&&(o=t.currentStyle[e]),null==r||o&&"none"!==o&&"auto"!==o&&"auto auto"!==o?o:r):V(t)},Y=U.convertToPixels=function(t,i,n,r,o){if("px"===r||!r)return n;if("auto"===r||!n)return 0;var s,l,h,c=H.test(i),u=t,d=N.style,f=0>n;if(f&&(n=-n),"%"===r&&-1!==i.indexOf("border"))s=n/100*(c?t.clientWidth:t.clientHeight);else{if(d.cssText="border:0 solid red;position:"+q(t,"position")+";line-height:0;","%"!==r&&u.appendChild)d[c?"borderLeftWidth":"borderTopWidth"]=n+r;else{if(u=t.parentNode||z.body,l=u._gsCache,h=e.ticker.frame,l&&c&&l.time===h)return l.width*n/100;d[c?"width":"height"]=n+r}u.appendChild(N),s=parseFloat(N[c?"offsetWidth":"offsetHeight"]),u.removeChild(N),c&&"%"===r&&a.cacheWidths!==!1&&(l=u._gsCache=u._gsCache||{},l.time=h,l.width=100*(s/n)),0!==s||o||(s=Y(t,i,n,r,!0))}return f?-s:s},K=U.calculateOffset=function(t,e,i){if("absolute"!==q(t,"position",i))return 0;var n="left"===e?"Left":"Top",r=q(t,"margin"+n,i);return t["offset"+n]-(Y(t,e,parseFloat(r),r.replace(E,""))||0)},$=function(t,e){var i,n,r={};if(e=e||X(t,null))if(i=e.length)for(;--i>-1;)r[e[i].replace(R,M)]=e.getPropertyValue(e[i]);else for(i in e)r[i]=e[i];else if(e=t.currentStyle||t.style)for(i in e)"string"==typeof i&&void 0===r[i]&&(r[i.replace(R,M)]=e[i]);return k||(r.opacity=V(t)),n=we(t,e,!1),r.rotation=n.rotation,r.skewX=n.skewX,r.scaleX=n.scaleX,r.scaleY=n.scaleY,r.x=n.x,r.y=n.y,_e&&(r.z=n.z,r.rotationX=n.rotationX,r.rotationY=n.rotationY,r.scaleZ=n.scaleZ),r.filters&&delete r.filters,r},Q=function(t,e,i,n,r){var o,a,s,l={},h=t.style;for(a in i)"cssText"!==a&&"length"!==a&&isNaN(a)&&(e[a]!==(o=i[a])||r&&r[a])&&-1===a.indexOf("Origin")&&("number"==typeof o||"string"==typeof o)&&(l[a]="auto"!==o||"left"!==a&&"top"!==a?""!==o&&"auto"!==o&&"none"!==o||"string"!=typeof e[a]||""===e[a].replace(y,"")?o:0:K(t,a),void 0!==h[a]&&(s=new ue(h,a,h[a],s)));if(n)for(a in n)"className"!==a&&(l[a]=n[a]);return{difs:l,firstMPT:s}},Z={width:["Left","Right"],height:["Top","Bottom"]},J=["marginLeft","marginRight","marginTop","marginBottom"],te=function(t,e,i){var n=parseFloat("width"===e?t.offsetWidth:t.offsetHeight),r=Z[e],o=r.length;for(i=i||X(t,null);--o>-1;)n-=parseFloat(q(t,"padding"+r[o],i,!0))||0,n-=parseFloat(q(t,"border"+r[o]+"Width",i,!0))||0;return n},ee=function(t,e){(null==t||""===t||"auto"===t||"auto auto"===t)&&(t="0 0");var i=t.split(" "),n=-1!==t.indexOf("left")?"0%":-1!==t.indexOf("right")?"100%":i[0],r=-1!==t.indexOf("top")?"0%":-1!==t.indexOf("bottom")?"100%":i[1];return null==r?r="0":"center"===r&&(r="50%"),("center"===n||isNaN(parseFloat(n))&&-1===(n+"").indexOf("="))&&(n="50%"),e&&(e.oxp=-1!==n.indexOf("%"),e.oyp=-1!==r.indexOf("%"),e.oxr="="===n.charAt(1),e.oyr="="===r.charAt(1),e.ox=parseFloat(n.replace(y,"")),e.oy=parseFloat(r.replace(y,""))),n+" "+r+(i.length>2?" "+i[2]:"")},ie=function(t,e){return"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2)):parseFloat(t)-parseFloat(e)},ne=function(t,e){return null==t?e:"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*Number(t.substr(2))+e:parseFloat(t)},re=function(t,e,i,n){var r,o,a,s,l=1e-6;return null==t?s=e:"number"==typeof t?s=t:(r=360,o=t.split("_"),a=Number(o[0].replace(y,""))*(-1===t.indexOf("rad")?1:O)-("="===t.charAt(1)?0:e),o.length&&(n&&(n[i]=e+a),-1!==t.indexOf("short")&&(a%=r,a!==a%(r/2)&&(a=0>a?a+r:a-r)),-1!==t.indexOf("_cw")&&0>a?a=(a+9999999999*r)%r-(0|a/r)*r:-1!==t.indexOf("ccw")&&a>0&&(a=(a-9999999999*r)%r-(0|a/r)*r)),s=e+a),l>s&&s>-l&&(s=0),s},oe={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},ae=function(t,e,i){return t=0>t?t+1:t>1?t-1:t,0|255*(1>6*t?e+6*(i-e)*t:.5>t?i:2>3*t?e+6*(i-e)*(2/3-t):e)+.5},se=function(t){var e,i,n,r,o,a;return t&&""!==t?"number"==typeof t?[t>>16,255&t>>8,255&t]:(","===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),oe[t]?oe[t]:"#"===t.charAt(0)?(4===t.length&&(e=t.charAt(1),i=t.charAt(2),n=t.charAt(3),t="#"+e+e+i+i+n+n),t=parseInt(t.substr(1),16),[t>>16,255&t>>8,255&t]):"hsl"===t.substr(0,3)?(t=t.match(m),r=Number(t[0])%360/360,o=Number(t[1])/100,a=Number(t[2])/100,i=.5>=a?a*(o+1):a+o-a*o,e=2*a-i,t.length>3&&(t[3]=Number(t[3])),t[0]=ae(r+1/3,e,i),t[1]=ae(r,e,i),t[2]=ae(r-1/3,e,i),t):(t=t.match(m)||oe.transparent,t[0]=Number(t[0]),t[1]=Number(t[1]),t[2]=Number(t[2]),t.length>3&&(t[3]=Number(t[3])),t)):oe.black},le="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(l in oe)le+="|"+l+"\\b";le=RegExp(le+")","gi");var he=function(t,e,i,n){if(null==t)return function(t){return t};var r,o=e?(t.match(le)||[""])[0]:"",a=t.split(o).join("").match(v)||[],s=t.substr(0,t.indexOf(a[0])),l=")"===t.charAt(t.length-1)?")":"",h=-1!==t.indexOf(" ")?" ":",",c=a.length,u=c>0?a[0].replace(m,""):"";return c?r=e?function(t){var e,d,f,p;if("number"==typeof t)t+=u;else if(n&&P.test(t)){for(p=t.replace(P,"|").split("|"),f=0;p.length>f;f++)p[f]=r(p[f]);return p.join(",")}if(e=(t.match(le)||[o])[0],d=t.split(e).join("").match(v)||[],f=d.length,c>f--)for(;c>++f;)d[f]=i?d[0|(f-1)/2]:a[f];return s+d.join(h)+h+e+l+(-1!==t.indexOf("inset")?" inset":"")}:function(t){var e,o,d;if("number"==typeof t)t+=u;else if(n&&P.test(t)){for(o=t.replace(P,"|").split("|"),d=0;o.length>d;d++)o[d]=r(o[d]);return o.join(",")}if(e=t.match(v)||[],d=e.length,c>d--)for(;c>++d;)e[d]=i?e[0|(d-1)/2]:a[d];return s+e.join(h)+l}:function(t){return t}},ce=function(t){return t=t.split(","),function(e,i,n,r,o,a,s){var l,h=(i+"").split(" ");for(s={},l=0;4>l;l++)s[t[l]]=h[l]=h[l]||h[(l-1)/2>>0];return r.parse(e,s,o,a)}},ue=(U._setPluginRatio=function(t){this.plugin.setRatio(t);for(var e,i,n,r,o=this.data,a=o.proxy,s=o.firstMPT,l=1e-6;s;)e=a[s.v],s.r?e=Math.round(e):l>e&&e>-l&&(e=0),s.t[s.p]=e,s=s._next;if(o.autoRotate&&(o.autoRotate.rotation=a.rotation),1===t)for(s=o.firstMPT;s;){if(i=s.t,i.type){if(1===i.type){for(r=i.xs0+i.s+i.xs1,n=1;i.l>n;n++)r+=i["xn"+n]+i["xs"+(n+1)];i.e=r}}else i.e=i.s+i.xs0;s=s._next}},function(t,e,i,n,r){this.t=t,this.p=e,this.v=i,this.r=r,n&&(n._prev=this,this._next=n)}),de=(U._parseToProxy=function(t,e,i,n,r,o){var a,s,l,h,c,u=n,d={},f={},p=i._transform,m=D;for(i._transform=null,D=e,n=c=i.parse(t,e,n,r),D=m,o&&(i._transform=p,u&&(u._prev=null,u._prev&&(u._prev._next=null)));n&&n!==u;){if(1>=n.type&&(s=n.p,f[s]=n.s+n.c,d[s]=n.s,o||(h=new ue(n,"s",s,h,n.r),n.c=0),1===n.type))for(a=n.l;--a>0;)l="xn"+a,s=n.p+"_"+l,f[s]=n.data[l],d[s]=n[l],o||(h=new ue(n,l,s,h,n.rxp[l]));n=n._next}return{proxy:d,end:f,firstMPT:h,pt:c}},U.CSSPropTween=function(t,e,n,r,a,s,l,h,c,u,d){this.t=t,this.p=e,this.s=n,this.c=r,this.n=l||e,t instanceof de||o.push(this.n),this.r=h,this.type=s||0,c&&(this.pr=c,i=!0),this.b=void 0===u?n:u,this.e=void 0===d?n+r:d,a&&(this._next=a,a._prev=this)}),fe=a.parseComplex=function(t,e,i,n,r,o,a,s,l,c){i=i||o||"",a=new de(t,e,0,0,a,c?2:1,null,!1,s,i,n),n+="";var u,d,f,p,v,y,E,x,T,_,w,R,S=i.split(", ").join(",").split(" "),M=n.split(", ").join(",").split(" "),H=S.length,C=h!==!1;for((-1!==n.indexOf(",")||-1!==i.indexOf(","))&&(S=S.join(" ").replace(P,", ").split(" "),M=M.join(" ").replace(P,", ").split(" "),H=S.length),H!==M.length&&(S=(o||"").split(" "),H=S.length),a.plugin=l,a.setRatio=c,u=0;H>u;u++)if(p=S[u],v=M[u],x=parseFloat(p),x||0===x)a.appendXtra("",x,ie(v,x),v.replace(g,""),C&&-1!==v.indexOf("px"),!0);else if(r&&("#"===p.charAt(0)||oe[p]||b.test(p)))R=","===v.charAt(v.length-1)?"),":")",p=se(p),v=se(v),T=p.length+v.length>6,T&&!k&&0===v[3]?(a["xs"+a.l]+=a.l?" transparent":"transparent",a.e=a.e.split(M[u]).join("transparent")):(k||(T=!1),a.appendXtra(T?"rgba(":"rgb(",p[0],v[0]-p[0],",",!0,!0).appendXtra("",p[1],v[1]-p[1],",",!0).appendXtra("",p[2],v[2]-p[2],T?",":R,!0),T&&(p=4>p.length?1:p[3],a.appendXtra("",p,(4>v.length?1:v[3])-p,R,!1)));else if(y=p.match(m)){if(E=v.match(g),!E||E.length!==y.length)return a;for(f=0,d=0;y.length>d;d++)w=y[d],_=p.indexOf(w,f),a.appendXtra(p.substr(f,_-f),Number(w),ie(E[d],w),"",C&&"px"===p.substr(_+w.length,2),0===d),f=_+w.length;a["xs"+a.l]+=p.substr(f)}else a["xs"+a.l]+=a.l?" "+p:p;if(-1!==n.indexOf("=")&&a.data){for(R=a.xs0+a.data.s,u=1;a.l>u;u++)R+=a["xs"+u]+a.data["xn"+u];a.e=R+a["xs"+u]}return a.l||(a.type=-1,a.xs0=a.e),a.xfirst||a},pe=9;for(l=de.prototype,l.l=l.pr=0;--pe>0;)l["xn"+pe]=0,l["xs"+pe]="";l.xs0="",l._next=l._prev=l.xfirst=l.data=l.plugin=l.setRatio=l.rxp=null,l.appendXtra=function(t,e,i,n,r,o){var a=this,s=a.l;return a["xs"+s]+=o&&s?" "+t:t||"",i||0===s||a.plugin?(a.l++,a.type=a.setRatio?2:1,a["xs"+a.l]=n||"",s>0?(a.data["xn"+s]=e+i,a.rxp["xn"+s]=r,a["xn"+s]=e,a.plugin||(a.xfirst=new de(a,"xn"+s,e,i,a.xfirst||a,0,a.n,r,a.pr),a.xfirst.xs0=0),a):(a.data={s:e+i},a.rxp={},a.s=e,a.c=i,a.r=r,a)):(a["xs"+s]+=e+(n||""),a)};var me=function(t,e){e=e||{},this.p=e.prefix?W(t)||t:t,s[t]=s[this.p]=this,this.format=e.formatter||he(e.defaultValue,e.color,e.collapsible,e.multi),e.parser&&(this.parse=e.parser),this.clrs=e.color,this.multi=e.multi,this.keyword=e.keyword,this.dflt=e.defaultValue,this.pr=e.priority||0},ge=U._registerComplexSpecialProp=function(t,e,i){"object"!=typeof e&&(e={parser:i});var n,r,o=t.split(","),a=e.defaultValue;for(i=i||[a],n=0;o.length>n;n++)e.prefix=0===n&&e.prefix,e.defaultValue=i[n]||a,r=new me(o[n],e)},ve=function(t){if(!s[t]){var e=t.charAt(0).toUpperCase()+t.substr(1)+"Plugin";ge(t,{parser:function(t,i,n,r,o,a,l){var h=(window.GreenSockGlobals||window).com.greensock.plugins[e];return h?(h._cssRegister(),s[n].parse(t,i,n,r,o,a,l)):(B("Error: "+e+" js file not loaded."),o)}})}};l=me.prototype,l.parseComplex=function(t,e,i,n,r,o){var a,s,l,h,c,u,d=this.keyword;if(this.multi&&(P.test(i)||P.test(e)?(s=e.replace(P,"|").split("|"),l=i.replace(P,"|").split("|")):d&&(s=[e],l=[i])),l){for(h=l.length>s.length?l.length:s.length,a=0;h>a;a++)e=s[a]=s[a]||this.dflt,i=l[a]=l[a]||this.dflt,d&&(c=e.indexOf(d),u=i.indexOf(d),c!==u&&(i=-1===u?l:s,i[a]+=" "+d));e=s.join(", "),i=l.join(", ")}return fe(t,this.p,e,i,this.clrs,this.dflt,n,this.pr,r,o)},l.parse=function(t,e,i,n,o,a){return this.parseComplex(t.style,this.format(q(t,this.p,r,!1,this.dflt)),this.format(e),o,a)},a.registerSpecialProp=function(t,e,i){ge(t,{parser:function(t,n,r,o,a,s){var l=new de(t,r,0,0,a,2,r,!1,i);return l.plugin=s,l.setRatio=e(t,n,o._tween,r),l},priority:i})};var ye="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective".split(","),Ee=W("transform"),xe=j+"transform",Te=W("transformOrigin"),_e=null!==W("perspective"),be=U.Transform=function(){this.skewY=0},we=U.getTransform=function(t,e,i,n){if(t._gsTransform&&i&&!n)return t._gsTransform;
var r,o,s,l,h,c,u,d,f,p,m,g,v,y=i?t._gsTransform||new be:new be,E=0>y.scaleX,x=2e-5,T=1e5,_=179.99,b=_*L,w=_e?parseFloat(q(t,Te,e,!1,"0 0 0").split(" ")[2])||y.zOrigin||0:0;for(Ee?r=q(t,xe,e,!0):t.currentStyle&&(r=t.currentStyle.filter.match(C),r=r&&4===r.length?[r[0].substr(4),Number(r[2].substr(4)),Number(r[1].substr(4)),r[3].substr(4),y.x||0,y.y||0].join(","):""),o=(r||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],s=o.length;--s>-1;)l=Number(o[s]),o[s]=(h=l-(l|=0))?(0|h*T+(0>h?-.5:.5))/T+l:l;if(16===o.length){var R=o[8],S=o[9],M=o[10],H=o[12],A=o[13],P=o[14];if(y.zOrigin&&(P=-y.zOrigin,H=R*P-o[12],A=S*P-o[13],P=M*P+y.zOrigin-o[14]),!i||n||null==y.rotationX){var D,z,N,F,U,I,k,V=o[0],B=o[1],j=o[2],G=o[3],W=o[4],X=o[5],Y=o[6],K=o[7],$=o[11],Q=Math.atan2(Y,M),Z=-b>Q||Q>b;y.rotationX=Q*O,Q&&(F=Math.cos(-Q),U=Math.sin(-Q),D=W*F+R*U,z=X*F+S*U,N=Y*F+M*U,R=W*-U+R*F,S=X*-U+S*F,M=Y*-U+M*F,$=K*-U+$*F,W=D,X=z,Y=N),Q=Math.atan2(R,V),y.rotationY=Q*O,Q&&(I=-b>Q||Q>b,F=Math.cos(-Q),U=Math.sin(-Q),D=V*F-R*U,z=B*F-S*U,N=j*F-M*U,S=B*U+S*F,M=j*U+M*F,$=G*U+$*F,V=D,B=z,j=N),Q=Math.atan2(B,X),y.rotation=Q*O,Q&&(k=-b>Q||Q>b,F=Math.cos(-Q),U=Math.sin(-Q),V=V*F+W*U,z=B*F+X*U,X=B*-U+X*F,Y=j*-U+Y*F,B=z),k&&Z?y.rotation=y.rotationX=0:k&&I?y.rotation=y.rotationY=0:I&&Z&&(y.rotationY=y.rotationX=0),y.scaleX=(0|Math.sqrt(V*V+B*B)*T+.5)/T,y.scaleY=(0|Math.sqrt(X*X+S*S)*T+.5)/T,y.scaleZ=(0|Math.sqrt(Y*Y+M*M)*T+.5)/T,y.skewX=0,y.perspective=$?1/(0>$?-$:$):0,y.x=H,y.y=A,y.z=P}}else if(!(_e&&!n&&o.length&&y.x===o[4]&&y.y===o[5]&&(y.rotationX||y.rotationY)||void 0!==y.x&&"none"===q(t,"display",e))){var J=o.length>=6,te=J?o[0]:1,ee=o[1]||0,ie=o[2]||0,ne=J?o[3]:1;y.x=o[4]||0,y.y=o[5]||0,c=Math.sqrt(te*te+ee*ee),u=Math.sqrt(ne*ne+ie*ie),d=te||ee?Math.atan2(ee,te)*O:y.rotation||0,f=ie||ne?Math.atan2(ie,ne)*O+d:y.skewX||0,p=c-Math.abs(y.scaleX||0),m=u-Math.abs(y.scaleY||0),Math.abs(f)>90&&270>Math.abs(f)&&(E?(c*=-1,f+=0>=d?180:-180,d+=0>=d?180:-180):(u*=-1,f+=0>=f?180:-180)),g=(d-y.rotation)%180,v=(f-y.skewX)%180,(void 0===y.skewX||p>x||-x>p||m>x||-x>m||g>-_&&_>g&&!1|g*T||v>-_&&_>v&&!1|v*T)&&(y.scaleX=c,y.scaleY=u,y.rotation=d,y.skewX=f),_e&&(y.rotationX=y.rotationY=y.z=0,y.perspective=parseFloat(a.defaultTransformPerspective)||0,y.scaleZ=1)}y.zOrigin=w;for(s in y)x>y[s]&&y[s]>-x&&(y[s]=0);return i&&(t._gsTransform=y),y},Re=function(t){var e,i,n=this.data,r=-n.rotation*L,o=r+n.skewX*L,a=1e5,s=(0|Math.cos(r)*n.scaleX*a)/a,l=(0|Math.sin(r)*n.scaleX*a)/a,h=(0|Math.sin(o)*-n.scaleY*a)/a,c=(0|Math.cos(o)*n.scaleY*a)/a,u=this.t.style,d=this.t.currentStyle;if(d){i=l,l=-h,h=-i,e=d.filter,u.filter="";var f,m,g=this.t.offsetWidth,v=this.t.offsetHeight,y="absolute"!==d.position,T="progid:DXImageTransform.Microsoft.Matrix(M11="+s+", M12="+l+", M21="+h+", M22="+c,_=n.x,b=n.y;if(null!=n.ox&&(f=(n.oxp?.01*g*n.ox:n.ox)-g/2,m=(n.oyp?.01*v*n.oy:n.oy)-v/2,_+=f-(f*s+m*l),b+=m-(f*h+m*c)),y?(f=g/2,m=v/2,T+=", Dx="+(f-(f*s+m*l)+_)+", Dy="+(m-(f*h+m*c)+b)+")"):T+=", sizingMethod='auto expand')",u.filter=-1!==e.indexOf("DXImageTransform.Microsoft.Matrix(")?e.replace(A,T):T+" "+e,(0===t||1===t)&&1===s&&0===l&&0===h&&1===c&&(y&&-1===T.indexOf("Dx=0, Dy=0")||x.test(e)&&100!==parseFloat(RegExp.$1)||-1===e.indexOf(e.indexOf("Alpha"))&&u.removeAttribute("filter")),!y){var w,R,S,M=8>p?1:-1;for(f=n.ieOffsetX||0,m=n.ieOffsetY||0,n.ieOffsetX=Math.round((g-((0>s?-s:s)*g+(0>l?-l:l)*v))/2+_),n.ieOffsetY=Math.round((v-((0>c?-c:c)*v+(0>h?-h:h)*g))/2+b),pe=0;4>pe;pe++)R=J[pe],w=d[R],i=-1!==w.indexOf("px")?parseFloat(w):Y(this.t,R,parseFloat(w),w.replace(E,""))||0,S=i!==n[R]?2>pe?-n.ieOffsetX:-n.ieOffsetY:2>pe?f-n.ieOffsetX:m-n.ieOffsetY,u[R]=(n[R]=Math.round(i-S*(0===pe||2===pe?1:M)))+"px"}}},Se=U.set3DTransformRatio=function(){var t,e,i,n,r,o,a,s,l,h,c,u,f,p,m,g,v,y,E,x,T,_,b,w=this.data,R=this.t.style,S=w.rotation*L,M=w.scaleX,H=w.scaleY,C=w.scaleZ,A=w.perspective;if(d){var P=1e-4;P>M&&M>-P&&(M=C=2e-5),P>H&&H>-P&&(H=C=2e-5),!A||w.z||w.rotationX||w.rotationY||(A=0)}if(S||w.skewX)y=Math.cos(S),E=Math.sin(S),t=y,r=E,w.skewX&&(S-=w.skewX*L,y=Math.cos(S),E=Math.sin(S),"simple"===w.skewType&&(x=Math.tan(w.skewX*L),x=Math.sqrt(1+x*x),y*=x,E*=x)),e=-E,o=y;else{if(!(w.rotationY||w.rotationX||1!==C||A))return void(R[Ee]="translate3d("+w.x+"px,"+w.y+"px,"+w.z+"px)"+(1!==M||1!==H?" scale("+M+","+H+")":""));t=o=1,e=r=0}c=1,i=n=a=s=l=h=u=f=p=0,m=A?-1/A:0,g=w.zOrigin,v=1e5,S=w.rotationY*L,S&&(y=Math.cos(S),E=Math.sin(S),l=c*-E,f=m*-E,i=t*E,a=r*E,c*=y,m*=y,t*=y,r*=y),S=w.rotationX*L,S&&(y=Math.cos(S),E=Math.sin(S),x=e*y+i*E,T=o*y+a*E,_=h*y+c*E,b=p*y+m*E,i=e*-E+i*y,a=o*-E+a*y,c=h*-E+c*y,m=p*-E+m*y,e=x,o=T,h=_,p=b),1!==C&&(i*=C,a*=C,c*=C,m*=C),1!==H&&(e*=H,o*=H,h*=H,p*=H),1!==M&&(t*=M,r*=M,l*=M,f*=M),g&&(u-=g,n=i*u,s=a*u,u=c*u+g),n=(x=(n+=w.x)-(n|=0))?(0|x*v+(0>x?-.5:.5))/v+n:n,s=(x=(s+=w.y)-(s|=0))?(0|x*v+(0>x?-.5:.5))/v+s:s,u=(x=(u+=w.z)-(u|=0))?(0|x*v+(0>x?-.5:.5))/v+u:u,R[Ee]="matrix3d("+[(0|t*v)/v,(0|r*v)/v,(0|l*v)/v,(0|f*v)/v,(0|e*v)/v,(0|o*v)/v,(0|h*v)/v,(0|p*v)/v,(0|i*v)/v,(0|a*v)/v,(0|c*v)/v,(0|m*v)/v,n,s,u,A?1+-u/A:1].join(",")+")"},Me=U.set2DTransformRatio=function(t){var e,i,n,r,o,a=this.data,s=this.t,l=s.style;return a.rotationX||a.rotationY||a.z||a.force3D?(this.setRatio=Se,void Se.call(this,t)):void(a.rotation||a.skewX?(e=a.rotation*L,i=e-a.skewX*L,n=1e5,r=a.scaleX*n,o=a.scaleY*n,l[Ee]="matrix("+(0|Math.cos(e)*r)/n+","+(0|Math.sin(e)*r)/n+","+(0|Math.sin(i)*-o)/n+","+(0|Math.cos(i)*o)/n+","+a.x+","+a.y+")"):l[Ee]="matrix("+a.scaleX+",0,0,"+a.scaleY+","+a.x+","+a.y+")")};ge("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType",{parser:function(t,e,i,n,o,s,l){if(n._transform)return o;var h,c,u,d,f,p,m,g=n._transform=we(t,r,!0,l.parseTransform),v=t.style,y=1e-6,E=ye.length,x=l,T={};if("string"==typeof x.transform&&Ee)u=v.cssText,v[Ee]=x.transform,v.display="block",h=we(t,null,!1),v.cssText=u;else if("object"==typeof x){if(h={scaleX:ne(null!=x.scaleX?x.scaleX:x.scale,g.scaleX),scaleY:ne(null!=x.scaleY?x.scaleY:x.scale,g.scaleY),scaleZ:ne(x.scaleZ,g.scaleZ),x:ne(x.x,g.x),y:ne(x.y,g.y),z:ne(x.z,g.z),perspective:ne(x.transformPerspective,g.perspective)},m=x.directionalRotation,null!=m)if("object"==typeof m)for(u in m)x[u]=m[u];else x.rotation=m;h.rotation=re("rotation"in x?x.rotation:"shortRotation"in x?x.shortRotation+"_short":"rotationZ"in x?x.rotationZ:g.rotation,g.rotation,"rotation",T),_e&&(h.rotationX=re("rotationX"in x?x.rotationX:"shortRotationX"in x?x.shortRotationX+"_short":g.rotationX||0,g.rotationX,"rotationX",T),h.rotationY=re("rotationY"in x?x.rotationY:"shortRotationY"in x?x.shortRotationY+"_short":g.rotationY||0,g.rotationY,"rotationY",T)),h.skewX=null==x.skewX?g.skewX:re(x.skewX,g.skewX),h.skewY=null==x.skewY?g.skewY:re(x.skewY,g.skewY),(c=h.skewY-g.skewY)&&(h.skewX+=c,h.rotation+=c)}for(_e&&null!=x.force3D&&(g.force3D=x.force3D,p=!0),g.skewType=x.skewType||g.skewType||a.defaultSkewType,f=g.force3D||g.z||g.rotationX||g.rotationY||h.z||h.rotationX||h.rotationY||h.perspective,f||null==x.scale||(h.scaleZ=1);--E>-1;)i=ye[E],d=h[i]-g[i],(d>y||-y>d||null!=D[i])&&(p=!0,o=new de(g,i,g[i],d,o),i in T&&(o.e=T[i]),o.xs0=0,o.plugin=s,n._overwriteProps.push(o.n));return d=x.transformOrigin,(d||_e&&f&&g.zOrigin)&&(Ee?(p=!0,i=Te,d=(d||q(t,i,r,!1,"50% 50%"))+"",o=new de(v,i,0,0,o,-1,"transformOrigin"),o.b=v[i],o.plugin=s,_e?(u=g.zOrigin,d=d.split(" "),g.zOrigin=(d.length>2&&(0===u||"0px"!==d[2])?parseFloat(d[2]):u)||0,o.xs0=o.e=v[i]=d[0]+" "+(d[1]||"50%")+" 0px",o=new de(g,"zOrigin",0,0,o,-1,o.n),o.b=u,o.xs0=o.e=g.zOrigin):o.xs0=o.e=v[i]=d):ee(d+"",g)),p&&(n._transformType=f||3===this._transformType?3:2),o},prefix:!0}),ge("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),ge("borderRadius",{defaultValue:"0px",parser:function(t,e,i,o,a){e=this.format(e);var s,l,h,c,u,d,f,p,m,g,v,y,E,x,T,_,b=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],w=t.style;for(m=parseFloat(t.offsetWidth),g=parseFloat(t.offsetHeight),s=e.split(" "),l=0;b.length>l;l++)this.p.indexOf("border")&&(b[l]=W(b[l])),u=c=q(t,b[l],r,!1,"0px"),-1!==u.indexOf(" ")&&(c=u.split(" "),u=c[0],c=c[1]),d=h=s[l],f=parseFloat(u),y=u.substr((f+"").length),E="="===d.charAt(1),E?(p=parseInt(d.charAt(0)+"1",10),d=d.substr(2),p*=parseFloat(d),v=d.substr((p+"").length-(0>p?1:0))||""):(p=parseFloat(d),v=d.substr((p+"").length)),""===v&&(v=n[i]||y),v!==y&&(x=Y(t,"borderLeft",f,y),T=Y(t,"borderTop",f,y),"%"===v?(u=100*(x/m)+"%",c=100*(T/g)+"%"):"em"===v?(_=Y(t,"borderLeft",1,"em"),u=x/_+"em",c=T/_+"em"):(u=x+"px",c=T+"px"),E&&(d=parseFloat(u)+p+v,h=parseFloat(c)+p+v)),a=fe(w,b[l],u+" "+c,d+" "+h,!1,"0px",a);return a},prefix:!0,formatter:he("0px 0px 0px 0px",!1,!0)}),ge("backgroundPosition",{defaultValue:"0 0",parser:function(t,e,i,n,o,a){var s,l,h,c,u,d,f="background-position",m=r||X(t,null),g=this.format((m?p?m.getPropertyValue(f+"-x")+" "+m.getPropertyValue(f+"-y"):m.getPropertyValue(f):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),v=this.format(e);if(-1!==g.indexOf("%")!=(-1!==v.indexOf("%"))&&(d=q(t,"backgroundImage").replace(S,""),d&&"none"!==d)){for(s=g.split(" "),l=v.split(" "),F.setAttribute("src",d),h=2;--h>-1;)g=s[h],c=-1!==g.indexOf("%"),c!==(-1!==l[h].indexOf("%"))&&(u=0===h?t.offsetWidth-F.width:t.offsetHeight-F.height,s[h]=c?parseFloat(g)/100*u+"px":100*(parseFloat(g)/u)+"%");g=s.join(" ")}return this.parseComplex(t.style,g,v,o,a)},formatter:ee}),ge("backgroundSize",{defaultValue:"0 0",formatter:ee}),ge("perspective",{defaultValue:"0px",prefix:!0}),ge("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),ge("transformStyle",{prefix:!0}),ge("backfaceVisibility",{prefix:!0}),ge("userSelect",{prefix:!0}),ge("margin",{parser:ce("marginTop,marginRight,marginBottom,marginLeft")}),ge("padding",{parser:ce("paddingTop,paddingRight,paddingBottom,paddingLeft")}),ge("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(t,e,i,n,o,a){var s,l,h;return 9>p?(l=t.currentStyle,h=8>p?" ":",",s="rect("+l.clipTop+h+l.clipRight+h+l.clipBottom+h+l.clipLeft+")",e=this.format(e).split(",").join(h)):(s=this.format(q(t,this.p,r,!1,this.dflt)),e=this.format(e)),this.parseComplex(t.style,s,e,o,a)}}),ge("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),ge("autoRound,strictUnits",{parser:function(t,e,i,n,r){return r}}),ge("border",{defaultValue:"0px solid #dd3a20",parser:function(t,e,i,n,o,a){return this.parseComplex(t.style,this.format(q(t,"borderTopWidth",r,!1,"0px")+" "+q(t,"borderTopStyle",r,!1,"solid")+" "+q(t,"borderTopColor",r,!1,"#dd3a20")),this.format(e),o,a)},color:!0,formatter:function(t){var e=t.split(" ");return e[0]+" "+(e[1]||"solid")+" "+(t.match(le)||["#dd3a20"])[0]}}),ge("borderWidth",{parser:ce("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),ge("float,cssFloat,styleFloat",{parser:function(t,e,i,n,r){var o=t.style,a="cssFloat"in o?"cssFloat":"styleFloat";return new de(o,a,0,0,r,-1,i,!1,0,o[a],e)}});var He=function(t){var e,i=this.t,n=i.filter||q(this.data,"filter"),r=0|this.s+this.c*t;100===r&&(-1===n.indexOf("atrix(")&&-1===n.indexOf("radient(")&&-1===n.indexOf("oader(")?(i.removeAttribute("filter"),e=!q(this.data,"filter")):(i.filter=n.replace(_,""),e=!0)),e||(this.xn1&&(i.filter=n=n||"alpha(opacity="+r+")"),-1===n.indexOf("opacity")?0===r&&this.xn1||(i.filter=n+" alpha(opacity="+r+")"):i.filter=n.replace(x,"opacity="+r))};ge("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(t,e,i,n,o,a){var s=parseFloat(q(t,"opacity",r,!1,"1")),l=t.style,h="autoAlpha"===i;return"string"==typeof e&&"="===e.charAt(1)&&(e=("-"===e.charAt(0)?-1:1)*parseFloat(e.substr(2))+s),h&&1===s&&"hidden"===q(t,"visibility",r)&&0!==e&&(s=0),k?o=new de(l,"opacity",s,e-s,o):(o=new de(l,"opacity",100*s,100*(e-s),o),o.xn1=h?1:0,l.zoom=1,o.type=2,o.b="alpha(opacity="+o.s+")",o.e="alpha(opacity="+(o.s+o.c)+")",o.data=t,o.plugin=a,o.setRatio=He),h&&(o=new de(l,"visibility",0,0,o,-1,null,!1,0,0!==s?"inherit":"hidden",0===e?"hidden":"inherit"),o.xs0="inherit",n._overwriteProps.push(o.n),n._overwriteProps.push(i)),o}});var Ce=function(t,e){e&&(t.removeProperty?("ms"===e.substr(0,2)&&(e="M"+e.substr(1)),t.removeProperty(e.replace(w,"-$1").toLowerCase())):t.removeAttribute(e))},Ae=function(t){if(this.t._gsClassPT=this,1===t||0===t){this.t.className=0===t?this.b:this.e;for(var e=this.data,i=this.t.style;e;)e.v?i[e.p]=e.v:Ce(i,e.p),e=e._next;1===t&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.className!==this.e&&(this.t.className=this.e)};ge("className",{parser:function(t,e,n,o,a,s,l){var h,c,u,d,f,p=t.className,m=t.style.cssText;if(a=o._classNamePT=new de(t,n,0,0,a,2),a.setRatio=Ae,a.pr=-11,i=!0,a.b=p,c=$(t,r),u=t._gsClassPT){for(d={},f=u.data;f;)d[f.p]=1,f=f._next;u.setRatio(1)}return t._gsClassPT=a,a.e="="!==e.charAt(1)?e:p.replace(RegExp("\\s*\\b"+e.substr(2)+"\\b"),"")+("+"===e.charAt(0)?" "+e.substr(2):""),o._tween._duration&&(t.className=a.e,h=Q(t,c,$(t),l,d),t.className=p,a.data=h.firstMPT,t.style.cssText=m,a=a.xfirst=o.parse(t,h.difs,a,s)),a}});var Pe=function(t){if((1===t||0===t)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var e,i,n,r,o=this.t.style,a=s.transform.parse;if("all"===this.e)o.cssText="",r=!0;else for(e=this.e.split(","),n=e.length;--n>-1;)i=e[n],s[i]&&(s[i].parse===a?r=!0:i="transformOrigin"===i?Te:s[i].p),Ce(o,i);r&&(Ce(o,Ee),this.t._gsTransform&&delete this.t._gsTransform)}};for(ge("clearProps",{parser:function(t,e,n,r,o){return o=new de(t,n,0,0,o,2),o.setRatio=Pe,o.e=e,o.pr=-10,o.data=r._tween,i=!0,o}}),l="bezier,throwProps,physicsProps,physics2D".split(","),pe=l.length;pe--;)ve(l[pe]);l=a.prototype,l._firstPT=null,l._onInitTween=function(t,e,s){if(!t.nodeType)return!1;this._target=t,this._tween=s,this._vars=e,h=e.autoRound,i=!1,n=e.suffixMap||a.suffixMap,r=X(t,""),o=this._overwriteProps;var l,d,p,m,g,v,y,E,x,_=t.style;if(c&&""===_.zIndex&&(l=q(t,"zIndex",r),("auto"===l||""===l)&&(_.zIndex=0)),"string"==typeof e&&(m=_.cssText,l=$(t,r),_.cssText=m+";"+e,l=Q(t,l,$(t)).difs,!k&&T.test(e)&&(l.opacity=parseFloat(RegExp.$1)),e=l,_.cssText=m),this._firstPT=d=this.parse(t,e,null),this._transformType){for(x=3===this._transformType,Ee?u&&(c=!0,""===_.zIndex&&(y=q(t,"zIndex",r),("auto"===y||""===y)&&(_.zIndex=0)),f&&(_.WebkitBackfaceVisibility=this._vars.WebkitBackfaceVisibility||(x?"visible":"hidden"))):_.zoom=1,p=d;p&&p._next;)p=p._next;E=new de(t,"transform",0,0,null,2),this._linkCSSP(E,null,p),E.setRatio=x&&_e?Se:Ee?Me:Re,E.data=this._transform||we(t,r,!0),o.pop()}if(i){for(;d;){for(v=d._next,p=m;p&&p.pr>d.pr;)p=p._next;(d._prev=p?p._prev:g)?d._prev._next=d:m=d,(d._next=p)?p._prev=d:g=d,d=v}this._firstPT=m}return!0},l.parse=function(t,e,i,o){var a,l,c,u,d,f,p,m,g,v,y=t.style;for(a in e)f=e[a],l=s[a],l?i=l.parse(t,f,a,this,i,o,e):(d=q(t,a,r)+"",g="string"==typeof f,"color"===a||"fill"===a||"stroke"===a||-1!==a.indexOf("Color")||g&&b.test(f)?(g||(f=se(f),f=(f.length>3?"rgba(":"rgb(")+f.join(",")+")"),i=fe(y,a,d,f,!0,"transparent",i,0,o)):!g||-1===f.indexOf(" ")&&-1===f.indexOf(",")?(c=parseFloat(d),p=c||0===c?d.substr((c+"").length):"",(""===d||"auto"===d)&&("width"===a||"height"===a?(c=te(t,a,r),p="px"):"left"===a||"top"===a?(c=K(t,a,r),p="px"):(c="opacity"!==a?0:1,p="")),v=g&&"="===f.charAt(1),v?(u=parseInt(f.charAt(0)+"1",10),f=f.substr(2),u*=parseFloat(f),m=f.replace(E,"")):(u=parseFloat(f),m=g?f.substr((u+"").length)||"":""),""===m&&(m=a in n?n[a]:p),f=u||0===u?(v?u+c:u)+m:e[a],p!==m&&""!==m&&(u||0===u)&&c&&(c=Y(t,a,c,p),"%"===m?(c/=Y(t,a,100,"%")/100,e.strictUnits!==!0&&(d=c+"%")):"em"===m?c/=Y(t,a,1,"em"):"px"!==m&&(u=Y(t,a,u,m),m="px"),v&&(u||0===u)&&(f=u+c+m)),v&&(u+=c),!c&&0!==c||!u&&0!==u?void 0!==y[a]&&(f||"NaN"!=f+""&&null!=f)?(i=new de(y,a,u||c||0,0,i,-1,a,!1,0,d,f),i.xs0="none"!==f||"display"!==a&&-1===a.indexOf("Style")?f:d):B("invalid "+a+" tween value: "+e[a]):(i=new de(y,a,c,u-c,i,0,a,h!==!1&&("px"===m||"zIndex"===a),0,d,f),i.xs0=m)):i=fe(y,a,d,f,!0,null,i,0,o)),o&&i&&!i.plugin&&(i.plugin=o);return i},l.setRatio=function(t){var e,i,n,r=this._firstPT,o=1e-6;if(1!==t||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(t||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;r;){if(e=r.c*t+r.s,r.r?e=Math.round(e):o>e&&e>-o&&(e=0),r.type)if(1===r.type)if(n=r.l,2===n)r.t[r.p]=r.xs0+e+r.xs1+r.xn1+r.xs2;else if(3===n)r.t[r.p]=r.xs0+e+r.xs1+r.xn1+r.xs2+r.xn2+r.xs3;else if(4===n)r.t[r.p]=r.xs0+e+r.xs1+r.xn1+r.xs2+r.xn2+r.xs3+r.xn3+r.xs4;else if(5===n)r.t[r.p]=r.xs0+e+r.xs1+r.xn1+r.xs2+r.xn2+r.xs3+r.xn3+r.xs4+r.xn4+r.xs5;else{for(i=r.xs0+e+r.xs1,n=1;r.l>n;n++)i+=r["xn"+n]+r["xs"+(n+1)];r.t[r.p]=i}else-1===r.type?r.t[r.p]=r.xs0:r.setRatio&&r.setRatio(t);else r.t[r.p]=e+r.xs0;r=r._next}else for(;r;)2!==r.type?r.t[r.p]=r.b:r.setRatio(t),r=r._next;else for(;r;)2!==r.type?r.t[r.p]=r.e:r.setRatio(t),r=r._next},l._enableTransforms=function(t){this._transformType=t||3===this._transformType?3:2,this._transform=this._transform||we(this._target,r,!0)},l._linkCSSP=function(t,e,i,n){return t&&(e&&(e._prev=t),t._next&&(t._next._prev=t._prev),t._prev?t._prev._next=t._next:this._firstPT===t&&(this._firstPT=t._next,n=!0),i?i._next=t:n||null!==this._firstPT||(this._firstPT=t),t._next=e,t._prev=i),t},l._kill=function(e){var i,n,r,o=e;if(e.autoAlpha||e.alpha){o={};for(n in e)o[n]=e[n];o.opacity=1,o.autoAlpha&&(o.visibility=1)}return e.className&&(i=this._classNamePT)&&(r=i.xfirst,r&&r._prev?this._linkCSSP(r._prev,i._next,r._prev._prev):r===this._firstPT&&(this._firstPT=i._next),i._next&&this._linkCSSP(i._next,i._next._next,r._prev),this._classNamePT=null),t.prototype._kill.call(this,o)};var Le=function(t,e,i){var n,r,o,a;if(t.slice)for(r=t.length;--r>-1;)Le(t[r],e,i);else for(n=t.childNodes,r=n.length;--r>-1;)o=n[r],a=o.type,o.style&&(e.push($(o)),i&&i.push(o)),1!==a&&9!==a&&11!==a||!o.childNodes.length||Le(o,e,i)};return a.cascadeTo=function(t,i,n){var r,o,a,s=e.to(t,i,n),l=[s],h=[],c=[],u=[],d=e._internals.reservedProps;for(t=s._targets||s.target,Le(t,h,u),s.render(i,!0),Le(t,c),s.render(0,!0),s._enabled(!0),r=u.length;--r>-1;)if(o=Q(u[r],h[r],c[r]),o.firstMPT){o=o.difs;for(a in n)d[a]&&(o[a]=n[a]);l.push(e.to(u[r],i,o))}return l},t.activate([a]),a},!0)}),window._gsDefine&&window._gsQueue.pop()(),define("CSSPlugin",function(){}),(window._gsQueue||(window._gsQueue=[])).push(function(){"use strict";window._gsDefine("easing.Back",["easing.Ease"],function(t){var e,i,n,r=window.GreenSockGlobals||window,o=r.com.greensock,a=2*Math.PI,s=Math.PI/2,l=o._class,h=function(e,i){var n=l("easing."+e,function(){},!0),r=n.prototype=new t;return r.constructor=n,r.getRatio=i,n},c=t.register||function(){},u=function(t,e,i,n){var r=l("easing."+t,{easeOut:new e,easeIn:new i,easeInOut:new n},!0);return c(r,t),r},d=function(t,e,i){this.t=t,this.v=e,i&&(this.next=i,i.prev=this,this.c=i.v-e,this.gap=i.t-t)},f=function(e,i){var n=l("easing."+e,function(t){this._p1=t||0===t?t:1.70158,this._p2=1.525*this._p1},!0),r=n.prototype=new t;return r.constructor=n,r.getRatio=i,r.config=function(t){return new n(t)},n},p=u("Back",f("BackOut",function(t){return(t-=1)*t*((this._p1+1)*t+this._p1)+1}),f("BackIn",function(t){return t*t*((this._p1+1)*t-this._p1)}),f("BackInOut",function(t){return 1>(t*=2)?.5*t*t*((this._p2+1)*t-this._p2):.5*((t-=2)*t*((this._p2+1)*t+this._p2)+2)})),m=l("easing.SlowMo",function(t,e,i){e=e||0===e?e:.7,null==t?t=.7:t>1&&(t=1),this._p=1!==t?e:0,this._p1=(1-t)/2,this._p2=t,this._p3=this._p1+this._p2,this._calcEnd=i===!0},!0),g=m.prototype=new t;return g.constructor=m,g.getRatio=function(t){var e=t+(.5-t)*this._p;return this._p1>t?this._calcEnd?1-(t=1-t/this._p1)*t:e-(t=1-t/this._p1)*t*t*t*e:t>this._p3?this._calcEnd?1-(t=(t-this._p3)/this._p1)*t:e+(t-e)*(t=(t-this._p3)/this._p1)*t*t*t:this._calcEnd?1:e},m.ease=new m(.7,.7),g.config=m.config=function(t,e,i){return new m(t,e,i)},e=l("easing.SteppedEase",function(t){t=t||1,this._p1=1/t,this._p2=t+1},!0),g=e.prototype=new t,g.constructor=e,g.getRatio=function(t){return 0>t?t=0:t>=1&&(t=.999999999),(this._p2*t>>0)*this._p1},g.config=e.config=function(t){return new e(t)},i=l("easing.RoughEase",function(e){e=e||{};for(var i,n,r,o,a,s,l=e.taper||"none",h=[],c=0,u=0|(e.points||20),f=u,p=e.randomize!==!1,m=e.clamp===!0,g=e.template instanceof t?e.template:null,v="number"==typeof e.strength?.4*e.strength:.4;--f>-1;)i=p?Math.random():1/u*f,n=g?g.getRatio(i):i,"none"===l?r=v:"out"===l?(o=1-i,r=o*o*v):"in"===l?r=i*i*v:.5>i?(o=2*i,r=.5*o*o*v):(o=2*(1-i),r=.5*o*o*v),p?n+=Math.random()*r-.5*r:f%2?n+=.5*r:n-=.5*r,m&&(n>1?n=1:0>n&&(n=0)),h[c++]={x:i,y:n};for(h.sort(function(t,e){return t.x-e.x}),s=new d(1,1,null),f=u;--f>-1;)a=h[f],s=new d(a.x,a.y,s);this._prev=new d(0,0,0!==s.t?s:s.next)},!0),g=i.prototype=new t,g.constructor=i,g.getRatio=function(t){var e=this._prev;if(t>e.t){for(;e.next&&t>=e.t;)e=e.next;e=e.prev}else for(;e.prev&&e.t>=t;)e=e.prev;return this._prev=e,e.v+(t-e.t)/e.gap*e.c},g.config=function(t){return new i(t)},i.ease=new i,u("Bounce",h("BounceOut",function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),h("BounceIn",function(t){return 1/2.75>(t=1-t)?1-7.5625*t*t:2/2.75>t?1-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}),h("BounceInOut",function(t){var e=.5>t;return t=e?1-2*t:2*t-1,t=1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5})),u("Circ",h("CircOut",function(t){return Math.sqrt(1-(t-=1)*t)}),h("CircIn",function(t){return-(Math.sqrt(1-t*t)-1)}),h("CircInOut",function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)})),n=function(e,i,n){var r=l("easing."+e,function(t,e){this._p1=t||1,this._p2=e||n,this._p3=this._p2/a*(Math.asin(1/this._p1)||0)},!0),o=r.prototype=new t;return o.constructor=r,o.getRatio=i,o.config=function(t,e){return new r(t,e)},r},u("Elastic",n("ElasticOut",function(t){return this._p1*Math.pow(2,-10*t)*Math.sin((t-this._p3)*a/this._p2)+1},.3),n("ElasticIn",function(t){return-(this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*a/this._p2))},.3),n("ElasticInOut",function(t){return 1>(t*=2)?-.5*this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*a/this._p2):.5*this._p1*Math.pow(2,-10*(t-=1))*Math.sin((t-this._p3)*a/this._p2)+1},.45)),u("Expo",h("ExpoOut",function(t){return 1-Math.pow(2,-10*t)}),h("ExpoIn",function(t){return Math.pow(2,10*(t-1))-.001}),h("ExpoInOut",function(t){return 1>(t*=2)?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))})),u("Sine",h("SineOut",function(t){return Math.sin(t*s)}),h("SineIn",function(t){return-Math.cos(t*s)+1}),h("SineInOut",function(t){return-.5*(Math.cos(Math.PI*t)-1)})),l("easing.EaseLookup",{find:function(e){return t.map[e]}},!0),c(r.SlowMo,"SlowMo","ease,"),c(i,"RoughEase","ease,"),c(e,"SteppedEase","ease,"),p},!0)}),window._gsDefine&&window._gsQueue.pop()(),define("Ease",function(){}),(window._gsQueue||(window._gsQueue=[])).push(function(){"use strict";var t=document.documentElement,e=window,i=function(i,n){var r="x"===n?"Width":"Height",o="scroll"+r,a="client"+r,s=document.body;return i===e||i===t||i===s?Math.max(t[o],s[o])-(e["inner"+r]||Math.max(t[a],s[a])):i[o]-i["offset"+r]},n=window._gsDefine.plugin({propName:"scrollTo",API:2,version:"1.7.3",init:function(t,n,r){return this._wdw=t===e,this._target=t,this._tween=r,"object"!=typeof n&&(n={y:n}),this._autoKill=n.autoKill!==!1,this.x=this.xPrev=this.getX(),this.y=this.yPrev=this.getY(),null!=n.x?(this._addTween(this,"x",this.x,"max"===n.x?i(t,"x"):n.x,"scrollTo_x",!0),this._overwriteProps.push("scrollTo_x")):this.skipX=!0,null!=n.y?(this._addTween(this,"y",this.y,"max"===n.y?i(t,"y"):n.y,"scrollTo_y",!0),this._overwriteProps.push("scrollTo_y")):this.skipY=!0,!0},set:function(t){this._super.setRatio.call(this,t);var n=this._wdw||!this.skipX?this.getX():this.xPrev,r=this._wdw||!this.skipY?this.getY():this.yPrev,o=r-this.yPrev,a=n-this.xPrev;this._autoKill&&(!this.skipX&&(a>7||-7>a)&&i(this._target,"x")>n&&(this.skipX=!0),!this.skipY&&(o>7||-7>o)&&i(this._target,"y")>r&&(this.skipY=!0),this.skipX&&this.skipY&&this._tween.kill()),this._wdw?e.scrollTo(this.skipX?n:this.x,this.skipY?r:this.y):(this.skipY||(this._target.scrollTop=this.y),this.skipX||(this._target.scrollLeft=this.x)),this.xPrev=this.x,this.yPrev=this.y}}),r=n.prototype;n.max=i,r.getX=function(){return this._wdw?null!=e.pageXOffset?e.pageXOffset:null!=t.scrollLeft?t.scrollLeft:document.body.scrollLeft:this._target.scrollLeft},r.getY=function(){return this._wdw?null!=e.pageYOffset?e.pageYOffset:null!=t.scrollTop?t.scrollTop:document.body.scrollTop:this._target.scrollTop},r._kill=function(t){return t.scrollTo_x&&(this.skipX=!0),t.scrollTo_y&&(this.skipY=!0),this._super._kill.call(this,t)}}),window._gsDefine&&window._gsQueue.pop()(),define("ScrollToPlugin",function(){}),function(t){"use strict";var e=t.GreenSockGlobals||t;if(!e.TweenLite){var i,n,r,o,a,s=function(t){var i,n=t.split("."),r=e;for(i=0;n.length>i;i++)r[n[i]]=r=r[n[i]]||{};return r},l=s("com.greensock"),h=1e-10,c=[].slice,u=function(){},d=function(){var t=Object.prototype.toString,e=t.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&t.call(i)===e)}}(),f={},p=function(i,n,r,o){this.sc=f[i]?f[i].sc:[],f[i]=this,this.gsClass=null,this.func=r;var a=[];this.check=function(l){for(var h,c,u,d,m=n.length,g=m;--m>-1;)(h=f[n[m]]||new p(n[m],[])).gsClass?(a[m]=h.gsClass,g--):l&&h.sc.push(this);if(0===g&&r)for(c=("com.greensock."+i).split("."),u=c.pop(),d=s(c.join("."))[u]=this.gsClass=r.apply(r,a),o&&(e[u]=d,"function"==typeof define&&define.amd?define((t.GreenSockAMDPath?t.GreenSockAMDPath+"/":"")+i.split(".").join("/"),[],function(){return d}):"undefined"!=typeof module&&module.exports&&(module.exports=d)),m=0;this.sc.length>m;m++)this.sc[m].check()},this.check(!0)},m=t._gsDefine=function(t,e,i,n){return new p(t,e,i,n)},g=l._class=function(t,e,i){return e=e||function(){},m(t,[],function(){return e},i),e};m.globals=e;var v=[0,0,1,1],y=[],E=g("easing.Ease",function(t,e,i,n){this._func=t,this._type=i||0,this._power=n||0,this._params=e?v.concat(e):v},!0),x=E.map={},T=E.register=function(t,e,i,n){for(var r,o,a,s,h=e.split(","),c=h.length,u=(i||"easeIn,easeOut,easeInOut").split(",");--c>-1;)for(o=h[c],r=n?g("easing."+o,null,!0):l.easing[o]||{},a=u.length;--a>-1;)s=u[a],x[o+"."+s]=x[s+o]=r[s]=t.getRatio?t:t[s]||new t};for(r=E.prototype,r._calcEnd=!1,r.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var e=this._type,i=this._power,n=1===e?1-t:2===e?t:.5>t?2*t:2*(1-t);return 1===i?n*=n:2===i?n*=n*n:3===i?n*=n*n*n:4===i&&(n*=n*n*n*n),1===e?1-n:2===e?n:.5>t?n/2:1-n/2},i=["Linear","Quad","Cubic","Quart","Quint,Strong"],n=i.length;--n>-1;)r=i[n]+",Power"+n,T(new E(null,null,1,n),r,"easeOut",!0),T(new E(null,null,2,n),r,"easeIn"+(0===n?",easeNone":"")),T(new E(null,null,3,n),r,"easeInOut");x.linear=l.easing.Linear.easeIn,x.swing=l.easing.Quad.easeInOut;var _=g("events.EventDispatcher",function(t){this._listeners={},this._eventTarget=t||this});r=_.prototype,r.addEventListener=function(t,e,i,n,r){r=r||0;var s,l,h=this._listeners[t],c=0;for(null==h&&(this._listeners[t]=h=[]),l=h.length;--l>-1;)s=h[l],s.c===e&&s.s===i?h.splice(l,1):0===c&&r>s.pr&&(c=l+1);h.splice(c,0,{c:e,s:i,up:n,pr:r}),this!==o||a||o.wake()},r.removeEventListener=function(t,e){var i,n=this._listeners[t];if(n)for(i=n.length;--i>-1;)if(n[i].c===e)return void n.splice(i,1)},r.dispatchEvent=function(t){var e,i,n,r=this._listeners[t];if(r)for(e=r.length,i=this._eventTarget;--e>-1;)n=r[e],n.up?n.c.call(n.s||i,{type:t,target:i}):n.c.call(n.s||i)};var b=t.requestAnimationFrame,w=t.cancelAnimationFrame,R=Date.now||function(){return(new Date).getTime()},S=R();for(i=["ms","moz","webkit","o"],n=i.length;--n>-1&&!b;)b=t[i[n]+"RequestAnimationFrame"],w=t[i[n]+"CancelAnimationFrame"]||t[i[n]+"CancelRequestAnimationFrame"];g("Ticker",function(t,e){var i,n,r,s,l,h=this,c=R(),d=e!==!1&&b,f=function(t){S=R(),h.time=(S-c)/1e3;var e,o=h.time-l;(!i||o>0||t===!0)&&(h.frame++,l+=o+(o>=s?.004:s-o),e=!0),t!==!0&&(r=n(f)),e&&h.dispatchEvent("tick")};_.call(h),h.time=h.frame=0,h.tick=function(){f(!0)},h.sleep=function(){null!=r&&(d&&w?w(r):clearTimeout(r),n=u,r=null,h===o&&(a=!1))},h.wake=function(){null!==r&&h.sleep(),n=0===i?u:d&&b?b:function(t){return setTimeout(t,0|1e3*(l-h.time)+1)},h===o&&(a=!0),f(2)},h.fps=function(t){return arguments.length?(i=t,s=1/(i||60),l=this.time+s,void h.wake()):i},h.useRAF=function(t){return arguments.length?(h.sleep(),d=t,void h.fps(i)):d},h.fps(t),setTimeout(function(){d&&(!r||5>h.frame)&&h.useRAF(!1)},1500)}),r=l.Ticker.prototype=new l.events.EventDispatcher,r.constructor=l.Ticker;var M=g("core.Animation",function(t,e){if(this.vars=e=e||{},this._duration=this._totalDuration=t||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=e.immediateRender===!0,this.data=e.data,this._reversed=e.reversed===!0,k){a||o.wake();var i=this.vars.useFrames?I:k;i.add(this,i._time),this.vars.paused&&this.paused(!0)}});o=M.ticker=new l.Ticker,r=M.prototype,r._dirty=r._gc=r._initted=r._paused=!1,r._totalTime=r._time=0,r._rawPrevTime=-1,r._next=r._last=r._onUpdate=r._timeline=r.timeline=null,r._paused=!1;var H=function(){a&&R()-S>2e3&&o.wake(),setTimeout(H,2e3)};H(),r.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},r.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},r.resume=function(t,e){return null!=t&&this.seek(t,e),this.paused(!1)},r.seek=function(t,e){return this.totalTime(Number(t),e!==!1)},r.restart=function(t,e){return this.reversed(!1).paused(!1).totalTime(t?-this._delay:0,e!==!1,!0)},r.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},r.render=function(){},r.invalidate=function(){return this},r.isActive=function(){var t,e=this._timeline,i=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime())>=i&&i+this.totalDuration()/this._timeScale>t},r._enabled=function(t,e){return a||o.wake(),this._gc=!t,this._active=this.isActive(),e!==!0&&(t&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!t&&this.timeline&&this._timeline._remove(this,!0)),!1},r._kill=function(){return this._enabled(!1,!1)},r.kill=function(t,e){return this._kill(t,e),this},r._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},r._swapSelfInParams=function(t){for(var e=t.length,i=t.concat();--e>-1;)"{self}"===t[e]&&(i[e]=this);return i},r.eventCallback=function(t,e,i,n){if("on"===(t||"").substr(0,2)){var r=this.vars;if(1===arguments.length)return r[t];null==e?delete r[t]:(r[t]=e,r[t+"Params"]=d(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,r[t+"Scope"]=n),"onUpdate"===t&&(this._onUpdate=e)}return this},r.delay=function(t){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+t-this._delay),this._delay=t,this):this._delay},r.duration=function(t){return arguments.length?(this._duration=this._totalDuration=t,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==t&&this.totalTime(this._totalTime*(t/this._duration),!0),this):(this._dirty=!1,this._duration)},r.totalDuration=function(t){return this._dirty=!1,arguments.length?this.duration(t):this._totalDuration},r.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(t>this._duration?this._duration:t,e)):this._time},r.totalTime=function(t,e,i){if(a||o.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>t&&!i&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();
var n=this._totalDuration,r=this._timeline;if(t>n&&!i&&(t=n),this._startTime=(this._paused?this._pauseTime:r._time)-(this._reversed?n-t:t)/this._timeScale,r._dirty||this._uncache(!1),r._timeline)for(;r._timeline;)r._timeline._time!==(r._startTime+r._totalTime)/r._timeScale&&r.totalTime(r._totalTime,!0),r=r._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==t||0===this._duration)&&this.render(t,e,!1)}return this},r.progress=r.totalProgress=function(t,e){return arguments.length?this.totalTime(this.duration()*t,e):this._time/this.duration()},r.startTime=function(t){return arguments.length?(t!==this._startTime&&(this._startTime=t,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,t-this._delay)),this):this._startTime},r.timeScale=function(t){if(!arguments.length)return this._timeScale;if(t=t||h,this._timeline&&this._timeline.smoothChildTiming){var e=this._pauseTime,i=e||0===e?e:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/t}return this._timeScale=t,this._uncache(!1)},r.reversed=function(t){return arguments.length?(t!=this._reversed&&(this._reversed=t,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},r.paused=function(t){if(!arguments.length)return this._paused;if(t!=this._paused&&this._timeline){a||t||o.wake();var e=this._timeline,i=e.rawTime(),n=i-this._pauseTime;!t&&e.smoothChildTiming&&(this._startTime+=n,this._uncache(!1)),this._pauseTime=t?i:null,this._paused=t,this._active=this.isActive(),!t&&0!==n&&this._initted&&this.duration()&&this.render(e.smoothChildTiming?this._totalTime:(i-this._startTime)/this._timeScale,!0,!0)}return this._gc&&!t&&this._enabled(!0,!1),this};var C=g("core.SimpleTimeline",function(t){M.call(this,0,t),this.autoRemoveChildren=this.smoothChildTiming=!0});r=C.prototype=new M,r.constructor=C,r.kill()._gc=!1,r._first=r._last=null,r._sortChildren=!1,r.add=r.insert=function(t,e){var i,n;if(t._startTime=Number(e||0)+t._delay,t._paused&&this!==t._timeline&&(t._pauseTime=t._startTime+(this.rawTime()-t._startTime)/t._timeScale),t.timeline&&t.timeline._remove(t,!0),t.timeline=t._timeline=this,t._gc&&t._enabled(!0,!0),i=this._last,this._sortChildren)for(n=t._startTime;i&&i._startTime>n;)i=i._prev;return i?(t._next=i._next,i._next=t):(t._next=this._first,this._first=t),t._next?t._next._prev=t:this._last=t,t._prev=i,this._timeline&&this._uncache(!0),this},r._remove=function(t,e){return t.timeline===this&&(e||t._enabled(!1,!0),t.timeline=null,t._prev?t._prev._next=t._next:this._first===t&&(this._first=t._next),t._next?t._next._prev=t._prev:this._last===t&&(this._last=t._prev),this._timeline&&this._uncache(!0)),this},r.render=function(t,e,i){var n,r=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;r;)n=r._next,(r._active||t>=r._startTime&&!r._paused)&&(r._reversed?r.render((r._dirty?r.totalDuration():r._totalDuration)-(t-r._startTime)*r._timeScale,e,i):r.render((t-r._startTime)*r._timeScale,e,i)),r=n},r.rawTime=function(){return a||o.wake(),this._totalTime};var A=g("TweenLite",function(e,i,n){if(M.call(this,i,n),this.render=A.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:A.selector(e)||e;var r,o,a,s=e.jquery||e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType),l=this.vars.overwrite;if(this._overwrite=l=null==l?U[A.defaultOverwrite]:"number"==typeof l?l>>0:U[l],(s||e instanceof Array||e.push&&d(e))&&"number"!=typeof e[0])for(this._targets=a=c.call(e,0),this._propLookup=[],this._siblings=[],r=0;a.length>r;r++)o=a[r],o?"string"!=typeof o?o.length&&o!==t&&o[0]&&(o[0]===t||o[0].nodeType&&o[0].style&&!o.nodeType)?(a.splice(r--,1),this._targets=a=a.concat(c.call(o,0))):(this._siblings[r]=V(o,this,!1),1===l&&this._siblings[r].length>1&&B(o,this,null,1,this._siblings[r])):(o=a[r--]=A.selector(o),"string"==typeof o&&a.splice(r+1,1)):a.splice(r--,1);else this._propLookup={},this._siblings=V(e,this,!1),1===l&&this._siblings.length>1&&B(e,this,null,1,this._siblings);(this.vars.immediateRender||0===i&&0===this._delay&&this.vars.immediateRender!==!1)&&this.render(-this._delay,!1,!0)},!0),P=function(e){return e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType)},L=function(t,e){var i,n={};for(i in t)F[i]||i in e&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!D[i]||D[i]&&D[i]._autoCSS)||(n[i]=t[i],delete t[i]);t.css=n};r=A.prototype=new M,r.constructor=A,r.kill()._gc=!1,r.ratio=0,r._firstPT=r._targets=r._overwrittenProps=r._startAt=null,r._notifyPluginsOfEnabled=!1,A.version="1.11.8",A.defaultEase=r._ease=new E(null,null,1,1),A.defaultOverwrite="auto",A.ticker=o,A.autoSleep=!0,A.selector=t.$||t.jQuery||function(e){return t.$?(A.selector=t.$,t.$(e)):t.document?t.document.getElementById("#"===e.charAt(0)?e.substr(1):e):e};var O=A._internals={isArray:d,isSelector:P},D=A._plugins={},z=A._tweenLookup={},N=0,F=O.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1},U={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},I=M._rootFramesTimeline=new C,k=M._rootTimeline=new C;k._startTime=o.time,I._startTime=o.frame,k._active=I._active=!0,M._updateRoot=function(){if(k.render((o.time-k._startTime)*k._timeScale,!1,!1),I.render((o.frame-I._startTime)*I._timeScale,!1,!1),!(o.frame%120)){var t,e,i;for(i in z){for(e=z[i].tweens,t=e.length;--t>-1;)e[t]._gc&&e.splice(t,1);0===e.length&&delete z[i]}if(i=k._first,(!i||i._paused)&&A.autoSleep&&!I._first&&1===o._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||o.sleep()}}},o.addEventListener("tick",M._updateRoot);var V=function(t,e,i){var n,r,o=t._gsTweenID;if(z[o||(t._gsTweenID=o="t"+N++)]||(z[o]={target:t,tweens:[]}),e&&(n=z[o].tweens,n[r=n.length]=e,i))for(;--r>-1;)n[r]===e&&n.splice(r,1);return z[o].tweens},B=function(t,e,i,n,r){var o,a,s,l;if(1===n||n>=4){for(l=r.length,o=0;l>o;o++)if((s=r[o])!==e)s._gc||s._enabled(!1,!1)&&(a=!0);else if(5===n)break;return a}var c,u=e._startTime+h,d=[],f=0,p=0===e._duration;for(o=r.length;--o>-1;)(s=r[o])===e||s._gc||s._paused||(s._timeline!==e._timeline?(c=c||j(e,0,p),0===j(s,c,p)&&(d[f++]=s)):u>=s._startTime&&s._startTime+s.totalDuration()/s._timeScale>u&&((p||!s._initted)&&2e-10>=u-s._startTime||(d[f++]=s)));for(o=f;--o>-1;)s=d[o],2===n&&s._kill(i,t)&&(a=!0),(2!==n||!s._firstPT&&s._initted)&&s._enabled(!1,!1)&&(a=!0);return a},j=function(t,e,i){for(var n=t._timeline,r=n._timeScale,o=t._startTime;n._timeline;){if(o+=n._startTime,r*=n._timeScale,n._paused)return-100;n=n._timeline}return o/=r,o>e?o-e:i&&o===e||!t._initted&&2*h>o-e?h:(o+=t.totalDuration()/t._timeScale/r)>e+h?0:o-e-h};r._init=function(){var t,e,i,n,r=this.vars,o=this._overwrittenProps,a=this._duration,s=r.immediateRender,l=r.ease;if(r.startAt){if(this._startAt&&this._startAt.render(-1,!0),r.startAt.overwrite=0,r.startAt.immediateRender=!0,this._startAt=A.to(this.target,0,r.startAt),s)if(this._time>0)this._startAt=null;else if(0!==a)return}else if(r.runBackwards&&0!==a)if(this._startAt)this._startAt.render(-1,!0),this._startAt=null;else{i={};for(n in r)F[n]&&"autoCSS"!==n||(i[n]=r[n]);if(i.overwrite=0,i.data="isFromStart",this._startAt=A.to(this.target,0,i),r.immediateRender){if(0===this._time)return}else this._startAt.render(-1,!0)}if(this._ease=l?l instanceof E?r.easeParams instanceof Array?l.config.apply(l,r.easeParams):l:"function"==typeof l?new E(l,r.easeParams):x[l]||A.defaultEase:A.defaultEase,this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(t=this._targets.length;--t>-1;)this._initProps(this._targets[t],this._propLookup[t]={},this._siblings[t],o?o[t]:null)&&(e=!0);else e=this._initProps(this.target,this._propLookup,this._siblings,o);if(e&&A._onPluginEvent("_onInitAllProps",this),o&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),r.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=r.onUpdate,this._initted=!0},r._initProps=function(e,i,n,r){var o,a,s,l,h,c;if(null==e)return!1;this.vars.css||e.style&&e!==t&&e.nodeType&&D.css&&this.vars.autoCSS!==!1&&L(this.vars,e);for(o in this.vars){if(c=this.vars[o],F[o])c&&(c instanceof Array||c.push&&d(c))&&-1!==c.join("").indexOf("{self}")&&(this.vars[o]=c=this._swapSelfInParams(c,this));else if(D[o]&&(l=new D[o])._onInitTween(e,this.vars[o],this)){for(this._firstPT=h={_next:this._firstPT,t:l,p:"setRatio",s:0,c:1,f:!0,n:o,pg:!0,pr:l._priority},a=l._overwriteProps.length;--a>-1;)i[l._overwriteProps[a]]=this._firstPT;(l._priority||l._onInitAllProps)&&(s=!0),(l._onDisable||l._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=i[o]=h={_next:this._firstPT,t:e,p:o,f:"function"==typeof e[o],n:o,pg:!1,pr:0},h.s=h.f?e[o.indexOf("set")||"function"!=typeof e["get"+o.substr(3)]?o:"get"+o.substr(3)]():parseFloat(e[o]),h.c="string"==typeof c&&"="===c.charAt(1)?parseInt(c.charAt(0)+"1",10)*Number(c.substr(2)):Number(c)-h.s||0;h&&h._next&&(h._next._prev=h)}return r&&this._kill(r,e)?this._initProps(e,i,n,r):this._overwrite>1&&this._firstPT&&n.length>1&&B(e,this,i,this._overwrite,n)?(this._kill(i,e),this._initProps(e,i,n,r)):s},r.render=function(t,e,i){var n,r,o,a,s=this._time,l=this._duration;if(t>=l)this._totalTime=this._time=l,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(n=!0,r="onComplete"),0===l&&(a=this._rawPrevTime,this._startTime===this._timeline._duration&&(t=0),(0===t||0>a||a===h)&&a!==t&&(i=!0,a>h&&(r="onReverseComplete")),this._rawPrevTime=a=!e||t||this._rawPrevTime===t?t:h);else if(1e-7>t)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==s||0===l&&this._rawPrevTime>0&&this._rawPrevTime!==h)&&(r="onReverseComplete",n=this._reversed),0>t?(this._active=!1,0===l&&(this._rawPrevTime>=0&&(i=!0),this._rawPrevTime=a=!e||t||this._rawPrevTime===t?t:h)):this._initted||(i=!0);else if(this._totalTime=this._time=t,this._easeType){var c=t/l,u=this._easeType,d=this._easePower;(1===u||3===u&&c>=.5)&&(c=1-c),3===u&&(c*=2),1===d?c*=c:2===d?c*=c*c:3===d?c*=c*c*c:4===d&&(c*=c*c*c*c),this.ratio=1===u?1-c:2===u?c:.5>t/l?c/2:1-c/2}else this.ratio=this._ease.getRatio(t/l);if(this._time!==s||i){if(!this._initted){if(this._init(),!this._initted||this._gc)return;this._time&&!n?this.ratio=this._ease.getRatio(this._time/l):n&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._active||!this._paused&&this._time!==s&&t>=0&&(this._active=!0),0===s&&(this._startAt&&(t>=0?this._startAt.render(t,e,i):r||(r="_dummyGS")),this.vars.onStart&&(0!==this._time||0===l)&&(e||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||y))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(0>t&&this._startAt&&this._startTime&&this._startAt.render(t,e,i),e||(this._time!==s||n)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||y)),r&&(this._gc||(0>t&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(t,e,i),n&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[r]&&this.vars[r].apply(this.vars[r+"Scope"]||this,this.vars[r+"Params"]||y),0===l&&this._rawPrevTime===h&&a!==h&&(this._rawPrevTime=0)))}},r._kill=function(t,e){if("all"===t&&(t=null),null!=t||null!=e&&e!==this.target){e="string"!=typeof e?e||this._targets||this.target:A.selector(e)||e;var i,n,r,o,a,s,l,h;if((d(e)||P(e))&&"number"!=typeof e[0])for(i=e.length;--i>-1;)this._kill(t,e[i])&&(s=!0);else{if(this._targets){for(i=this._targets.length;--i>-1;)if(e===this._targets[i]){a=this._propLookup[i]||{},this._overwrittenProps=this._overwrittenProps||[],n=this._overwrittenProps[i]=t?this._overwrittenProps[i]||{}:"all";break}}else{if(e!==this.target)return!1;a=this._propLookup,n=this._overwrittenProps=t?this._overwrittenProps||{}:"all"}if(a){l=t||a,h=t!==n&&"all"!==n&&t!==a&&("object"!=typeof t||!t._tempKill);for(r in l)(o=a[r])&&(o.pg&&o.t._kill(l)&&(s=!0),o.pg&&0!==o.t._overwriteProps.length||(o._prev?o._prev._next=o._next:o===this._firstPT&&(this._firstPT=o._next),o._next&&(o._next._prev=o._prev),o._next=o._prev=null),delete a[r]),h&&(n[r]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return s}return this._enabled(!1,!1)},r.invalidate=function(){return this._notifyPluginsOfEnabled&&A._onPluginEvent("_onDisable",this),this._firstPT=null,this._overwrittenProps=null,this._onUpdate=null,this._startAt=null,this._initted=this._active=this._notifyPluginsOfEnabled=!1,this._propLookup=this._targets?{}:[],this},r._enabled=function(t,e){if(a||o.wake(),t&&this._gc){var i,n=this._targets;if(n)for(i=n.length;--i>-1;)this._siblings[i]=V(n[i],this,!0);else this._siblings=V(this.target,this,!0)}return M.prototype._enabled.call(this,t,e),this._notifyPluginsOfEnabled&&this._firstPT?A._onPluginEvent(t?"_onEnable":"_onDisable",this):!1},A.to=function(t,e,i){return new A(t,e,i)},A.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new A(t,e,i)},A.fromTo=function(t,e,i,n){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,new A(t,e,n)},A.delayedCall=function(t,e,i,n,r){return new A(e,0,{delay:t,onComplete:e,onCompleteParams:i,onCompleteScope:n,onReverseComplete:e,onReverseCompleteParams:i,onReverseCompleteScope:n,immediateRender:!1,useFrames:r,overwrite:0})},A.set=function(t,e){return new A(t,0,e)},A.getTweensOf=function(t,e){if(null==t)return[];t="string"!=typeof t?t:A.selector(t)||t;var i,n,r,o;if((d(t)||P(t))&&"number"!=typeof t[0]){for(i=t.length,n=[];--i>-1;)n=n.concat(A.getTweensOf(t[i],e));for(i=n.length;--i>-1;)for(o=n[i],r=i;--r>-1;)o===n[r]&&n.splice(i,1)}else for(n=V(t).concat(),i=n.length;--i>-1;)(n[i]._gc||e&&!n[i].isActive())&&n.splice(i,1);return n},A.killTweensOf=A.killDelayedCallsTo=function(t,e,i){"object"==typeof e&&(i=e,e=!1);for(var n=A.getTweensOf(t,e),r=n.length;--r>-1;)n[r]._kill(i,t)};var G=g("plugins.TweenPlugin",function(t,e){this._overwriteProps=(t||"").split(","),this._propName=this._overwriteProps[0],this._priority=e||0,this._super=G.prototype},!0);if(r=G.prototype,G.version="1.10.1",G.API=2,r._firstPT=null,r._addTween=function(t,e,i,n,r,o){var a,s;return null!=n&&(a="number"==typeof n||"="!==n.charAt(1)?Number(n)-i:parseInt(n.charAt(0)+"1",10)*Number(n.substr(2)))?(this._firstPT=s={_next:this._firstPT,t:t,p:e,s:i,c:a,f:"function"==typeof t[e],n:r||e,r:o},s._next&&(s._next._prev=s),s):void 0},r.setRatio=function(t){for(var e,i=this._firstPT,n=1e-6;i;)e=i.c*t+i.s,i.r?e=Math.round(e):n>e&&e>-n&&(e=0),i.f?i.t[i.p](e):i.t[i.p]=e,i=i._next},r._kill=function(t){var e,i=this._overwriteProps,n=this._firstPT;if(null!=t[this._propName])this._overwriteProps=[];else for(e=i.length;--e>-1;)null!=t[i[e]]&&i.splice(e,1);for(;n;)null!=t[n.n]&&(n._next&&(n._next._prev=n._prev),n._prev?(n._prev._next=n._next,n._prev=null):this._firstPT===n&&(this._firstPT=n._next)),n=n._next;return!1},r._roundProps=function(t,e){for(var i=this._firstPT;i;)(t[this._propName]||null!=i.n&&t[i.n.split(this._propName+"_").join("")])&&(i.r=e),i=i._next},A._onPluginEvent=function(t,e){var i,n,r,o,a,s=e._firstPT;if("_onInitAllProps"===t){for(;s;){for(a=s._next,n=r;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:o)?s._prev._next=s:r=s,(s._next=n)?n._prev=s:o=s,s=a}s=e._firstPT=r}for(;s;)s.pg&&"function"==typeof s.t[t]&&s.t[t]()&&(i=!0),s=s._next;return i},G.activate=function(t){for(var e=t.length;--e>-1;)t[e].API===G.API&&(D[(new t[e])._propName]=t[e]);return!0},m.plugin=function(t){if(!(t&&t.propName&&t.init&&t.API))throw"illegal plugin definition.";var e,i=t.propName,n=t.priority||0,r=t.overwriteProps,o={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},a=g("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",function(){G.call(this,i,n),this._overwriteProps=r||[]},t.global===!0),s=a.prototype=new G(i);s.constructor=a,a.API=t.API;for(e in o)"function"==typeof t[e]&&(s[o[e]]=t[e]);return a.version=t.version,G.activate([a]),a},i=t._gsQueue){for(n=0;i.length>n;n++)i[n]();for(r in f)f[r].func||t.console.log("GSAP encountered missing dependency: com.greensock."+r)}a=!1}}(window),define("TweenLite",["CSSPlugin","Ease","ScrollToPlugin"],function(t){return function(){var e;return e||t.TweenLite}}(this)),(window._gsQueue||(window._gsQueue=[])).push(function(){"use strict";window._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(t,e,i){var n=function(t){e.call(this,t),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var i,n,r=this.vars;for(n in r)i=r[n],a(i)&&-1!==i.join("").indexOf("{self}")&&(r[n]=this._swapSelfInParams(i));a(r.tweens)&&this.add(r.tweens,0,r.align,r.stagger)},r=1e-10,o=i._internals.isSelector,a=i._internals.isArray,s=[],l=window._gsDefine.globals,h=function(t){var e,i={};for(e in t)i[e]=t[e];return i},c=function(t,e,i,n){t._timeline.pause(t._startTime),e&&e.apply(n||t._timeline,i||s)},u=s.slice,d=n.prototype=new e;return n.version="1.11.8",d.constructor=n,d.kill()._gc=!1,d.to=function(t,e,n,r){var o=n.repeat&&l.TweenMax||i;return e?this.add(new o(t,e,n),r):this.set(t,n,r)},d.from=function(t,e,n,r){return this.add((n.repeat&&l.TweenMax||i).from(t,e,n),r)},d.fromTo=function(t,e,n,r,o){var a=r.repeat&&l.TweenMax||i;return e?this.add(a.fromTo(t,e,n,r),o):this.set(t,r,o)},d.staggerTo=function(t,e,r,a,s,l,c,d){var f,p=new n({onComplete:l,onCompleteParams:c,onCompleteScope:d,smoothChildTiming:this.smoothChildTiming});for("string"==typeof t&&(t=i.selector(t)||t),o(t)&&(t=u.call(t,0)),a=a||0,f=0;t.length>f;f++)r.startAt&&(r.startAt=h(r.startAt)),p.to(t[f],e,h(r),f*a);return this.add(p,s)},d.staggerFrom=function(t,e,i,n,r,o,a,s){return i.immediateRender=0!=i.immediateRender,i.runBackwards=!0,this.staggerTo(t,e,i,n,r,o,a,s)},d.staggerFromTo=function(t,e,i,n,r,o,a,s,l){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,this.staggerTo(t,e,n,r,o,a,s,l)},d.call=function(t,e,n,r){return this.add(i.delayedCall(0,t,e,n),r)},d.set=function(t,e,n){return n=this._parseTimeOrLabel(n,0,!0),null==e.immediateRender&&(e.immediateRender=n===this._time&&!this._paused),this.add(new i(t,0,e),n)},n.exportRoot=function(t,e){t=t||{},null==t.smoothChildTiming&&(t.smoothChildTiming=!0);var r,o,a=new n(t),s=a._timeline;for(null==e&&(e=!0),s._remove(a,!0),a._startTime=0,a._rawPrevTime=a._time=a._totalTime=s._time,r=s._first;r;)o=r._next,e&&r instanceof i&&r.target===r.vars.onComplete||a.add(r,r._startTime-r._delay),r=o;return s.add(a,0),a},d.add=function(r,o,s,l){var h,c,u,d,f,p;if("number"!=typeof o&&(o=this._parseTimeOrLabel(o,0,!0,r)),!(r instanceof t)){if(r instanceof Array||r&&r.push&&a(r)){for(s=s||"normal",l=l||0,h=o,c=r.length,u=0;c>u;u++)a(d=r[u])&&(d=new n({tweens:d})),this.add(d,h),"string"!=typeof d&&"function"!=typeof d&&("sequence"===s?h=d._startTime+d.totalDuration()/d._timeScale:"start"===s&&(d._startTime-=d.delay())),h+=l;return this._uncache(!0)}if("string"==typeof r)return this.addLabel(r,o);if("function"!=typeof r)throw"Cannot add "+r+" into the timeline; it is not a tween, timeline, function, or string.";r=i.delayedCall(0,r)}if(e.prototype.add.call(this,r,o),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(f=this,p=f.rawTime()>r._startTime;f._timeline;)p&&f._timeline.smoothChildTiming?f.totalTime(f._totalTime,!0):f._gc&&f._enabled(!0,!1),f=f._timeline;return this},d.remove=function(e){if(e instanceof t)return this._remove(e,!1);if(e instanceof Array||e&&e.push&&a(e)){for(var i=e.length;--i>-1;)this.remove(e[i]);return this}return"string"==typeof e?this.removeLabel(e):this.kill(null,e)},d._remove=function(t,i){e.prototype._remove.call(this,t,i);var n=this._last;return n?this._time>n._startTime+n._totalDuration/n._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},d.append=function(t,e){return this.add(t,this._parseTimeOrLabel(null,e,!0,t))},d.insert=d.insertMultiple=function(t,e,i,n){return this.add(t,e||0,i,n)},d.appendMultiple=function(t,e,i,n){return this.add(t,this._parseTimeOrLabel(null,e,!0,t),i,n)},d.addLabel=function(t,e){return this._labels[t]=this._parseTimeOrLabel(e),this},d.addPause=function(t,e,i,n){return this.call(c,["{self}",e,i,n],this,t)},d.removeLabel=function(t){return delete this._labels[t],this},d.getLabelTime=function(t){return null!=this._labels[t]?this._labels[t]:-1},d._parseTimeOrLabel=function(e,i,n,r){var o;if(r instanceof t&&r.timeline===this)this.remove(r);else if(r&&(r instanceof Array||r.push&&a(r)))for(o=r.length;--o>-1;)r[o]instanceof t&&r[o].timeline===this&&this.remove(r[o]);if("string"==typeof i)return this._parseTimeOrLabel(i,n&&"number"==typeof e&&null==this._labels[i]?e-this.duration():0,n);if(i=i||0,"string"!=typeof e||!isNaN(e)&&null==this._labels[e])null==e&&(e=this.duration());else{if(o=e.indexOf("="),-1===o)return null==this._labels[e]?n?this._labels[e]=this.duration()+i:i:this._labels[e]+i;i=parseInt(e.charAt(o-1)+"1",10)*Number(e.substr(o+1)),e=o>1?this._parseTimeOrLabel(e.substr(0,o-1),0,n):this.duration()}return Number(e)+i},d.seek=function(t,e){return this.totalTime("number"==typeof t?t:this._parseTimeOrLabel(t),e!==!1)},d.stop=function(){return this.paused(!0)},d.gotoAndPlay=function(t,e){return this.play(t,e)},d.gotoAndStop=function(t,e){return this.pause(t,e)},d.render=function(t,e,i){this._gc&&this._enabled(!0,!1);var n,o,a,l,h,c=this._dirty?this.totalDuration():this._totalDuration,u=this._time,d=this._startTime,f=this._timeScale,p=this._paused;if(t>=c?(this._totalTime=this._time=c,this._reversed||this._hasPausedChild()||(o=!0,l="onComplete",0===this._duration&&(0===t||0>this._rawPrevTime||this._rawPrevTime===r)&&this._rawPrevTime!==t&&this._first&&(h=!0,this._rawPrevTime>r&&(l="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,t=c+1e-4):1e-7>t?(this._totalTime=this._time=0,(0!==u||0===this._duration&&this._rawPrevTime!==r&&(this._rawPrevTime>0||0>t&&this._rawPrevTime>=0))&&(l="onReverseComplete",o=this._reversed),0>t?(this._active=!1,0===this._duration&&this._rawPrevTime>=0&&this._first&&(h=!0),this._rawPrevTime=t):(this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,t=0,this._initted||(h=!0))):this._totalTime=this._time=this._rawPrevTime=t,this._time!==u&&this._first||i||h){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==u&&t>0&&(this._active=!0),0===u&&this.vars.onStart&&0!==this._time&&(e||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||s)),this._time>=u)for(n=this._first;n&&(a=n._next,!this._paused||p);)(n._active||n._startTime<=this._time&&!n._paused&&!n._gc)&&(n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(t-n._startTime)*n._timeScale,e,i):n.render((t-n._startTime)*n._timeScale,e,i)),n=a;else for(n=this._last;n&&(a=n._prev,!this._paused||p);)(n._active||u>=n._startTime&&!n._paused&&!n._gc)&&(n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(t-n._startTime)*n._timeScale,e,i):n.render((t-n._startTime)*n._timeScale,e,i)),n=a;this._onUpdate&&(e||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||s)),l&&(this._gc||(d===this._startTime||f!==this._timeScale)&&(0===this._time||c>=this.totalDuration())&&(o&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[l]&&this.vars[l].apply(this.vars[l+"Scope"]||this,this.vars[l+"Params"]||s)))}},d._hasPausedChild=function(){for(var t=this._first;t;){if(t._paused||t instanceof n&&t._hasPausedChild())return!0;t=t._next}return!1},d.getChildren=function(t,e,n,r){r=r||-9999999999;for(var o=[],a=this._first,s=0;a;)r>a._startTime||(a instanceof i?e!==!1&&(o[s++]=a):(n!==!1&&(o[s++]=a),t!==!1&&(o=o.concat(a.getChildren(!0,e,n)),s=o.length))),a=a._next;return o},d.getTweensOf=function(t,e){for(var n=i.getTweensOf(t),r=n.length,o=[],a=0;--r>-1;)(n[r].timeline===this||e&&this._contains(n[r]))&&(o[a++]=n[r]);return o},d._contains=function(t){for(var e=t.timeline;e;){if(e===this)return!0;e=e.timeline}return!1},d.shiftChildren=function(t,e,i){i=i||0;for(var n,r=this._first,o=this._labels;r;)r._startTime>=i&&(r._startTime+=t),r=r._next;if(e)for(n in o)o[n]>=i&&(o[n]+=t);return this._uncache(!0)},d._kill=function(t,e){if(!t&&!e)return this._enabled(!1,!1);for(var i=e?this.getTweensOf(e):this.getChildren(!0,!0,!1),n=i.length,r=!1;--n>-1;)i[n]._kill(t,e)&&(r=!0);return r},d.clear=function(t){var e=this.getChildren(!1,!0,!0),i=e.length;for(this._time=this._totalTime=0;--i>-1;)e[i]._enabled(!1,!1);return t!==!1&&(this._labels={}),this._uncache(!0)},d.invalidate=function(){for(var t=this._first;t;)t.invalidate(),t=t._next;return this},d._enabled=function(t,i){if(t===this._gc)for(var n=this._first;n;)n._enabled(t,!0),n=n._next;return e.prototype._enabled.call(this,t,i)},d.duration=function(t){return arguments.length?(0!==this.duration()&&0!==t&&this.timeScale(this._duration/t),this):(this._dirty&&this.totalDuration(),this._duration)},d.totalDuration=function(t){if(!arguments.length){if(this._dirty){for(var e,i,n=0,r=this._last,o=999999999999;r;)e=r._prev,r._dirty&&r.totalDuration(),r._startTime>o&&this._sortChildren&&!r._paused?this.add(r,r._startTime-r._delay):o=r._startTime,0>r._startTime&&!r._paused&&(n-=r._startTime,this._timeline.smoothChildTiming&&(this._startTime+=r._startTime/this._timeScale),this.shiftChildren(-r._startTime,!1,-9999999999),o=0),i=r._startTime+r._totalDuration/r._timeScale,i>n&&(n=i),r=e;this._duration=this._totalDuration=n,this._dirty=!1}return this._totalDuration}return 0!==this.totalDuration()&&0!==t&&this.timeScale(this._totalDuration/t),this},d.usesFrames=function(){for(var e=this._timeline;e._timeline;)e=e._timeline;return e===t._rootFramesTimeline},d.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},n},!0)}),window._gsDefine&&window._gsQueue.pop()(),define("TimelineLite",["TweenLite"],function(t){return function(){var e;return e||t.TimelineLite}}(this)),function(t){function e(t,e,i,n,r){this._listener=e,this._isOnce=i,this.context=n,this._signal=t,this._priority=r||0}function i(t,e){if("function"!=typeof t)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function n(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){n.prototype.dispatch.apply(t,arguments)}}e.prototype={active:!0,params:null,execute:function(t){var e;return this.active&&this._listener&&(t=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,t),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},n.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,i,n,r){var o=this._indexOfListener(t,n);if(-1!==o){if(t=this._bindings[o],t.isOnce()!==i)throw Error("You cannot add"+(i?"":"Once")+"() then add"+(i?"Once":"")+"() the same listener without removing the relationship first.")}else t=new e(this,t,i,n,r),this._addBinding(t);return this.memorize&&this._prevParams&&t.execute(this._prevParams),t},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var i,n=this._bindings.length;n--;)if(i=this._bindings[n],i._listener===t&&i.context===e)return n;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,n){return i(t,"add"),this._registerListener(t,!1,e,n)},addOnce:function(t,e,n){return i(t,"addOnce"),this._registerListener(t,!0,e,n)},remove:function(t,e){i(t,"remove");var n=this._indexOfListener(t,e);return-1!==n&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var t,e=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=e),i){t=this._bindings.slice(),this._shouldPropagate=!0;do i--;while(t[i]&&this._shouldPropagate&&t[i].execute(e)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var r=n;r.Signal=n,"function"==typeof define&&define.amd?define("Signal",[],function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:t.signals=r}(this),define("ui/FadeIn",["Class","jquery","TweenLite","TimelineLite","Global"],function(t,e,i){var n=new t({selector:null,initialize:function(){for(var t=this,n=0;n<arguments.length;n++)this.selector=0==n?arguments[n]:this.selector.add(arguments[n]),arguments[n].css({opacity:"0"}),i.set(arguments[n],{y:100});e(t.selector).each(function(){e(this).each(function(){var t=e(this).offset().top+e(this).outerHeight()/5-100,n=e(window).scrollTop()+e(window).height();n>t&&i.to(e(this),1,{y:0,opacity:1,clearProps:"transform,opacity"})})});var r=function(){var n=null,r=0;e(t.selector).each(function(){if(0==e(this).css("opacity")){var t=e(this).offset().top+e(this).outerHeight()/10,o=e(window).scrollTop()+e(window).height();t!=n?(r=0,n=t):r++,o>t&&(i.to(e(this),1,{delay:.1*r,opacity:1,clearProps:"opacity"}),i.to(e(this),1,{delay:.1*r,y:0,clearProps:"transform",ease:Expo.easeOut}))}})};e(window).off("scroll",_.debounce(r,50)),e(window).on("scroll",_.debounce(r,50))}});return n}),define("Global",["Class","jquery","underscore","TweenLite","TimelineLite","Signal","ui/FadeIn"],function(t,e,i,n,r,o){var a=new t({breakPoints:{mobile:0,tabletPortrait:768,tabletLandscape:992,desktop:1280},currentWidthType:1280,width:1280,spinOpts:{lines:12,length:10,width:6,radius:13},pathArray:null,firstLevelLocation:null,secondLevelLocation:null,windowHeight:null,newHash:null,videoPlaying:!1,videoFinished:!1,videoInFullScreen:!1,onVideoInactive:null,coverAnimating:!1,menuOpen:!1,videoID:"8sdLAHzZVMc",now:0,assetsPath:"",assetsAutoGeneratedPath:"",phpUploadPath:"assetsDropboxSymLink/",assetsAutoGeneratedSubPath:"autoAssets/",textureNotFound:"",particleDBSavePath:"",particleDBLoadPath:"",aspectRatio:2,mouseStrength:1,FloatArraysSupported:!1,isLoading:!1,loadingStartedSignal:null,loadingFinishedSignal:null,noBeforeUnload:null,renderText:"HEY.",isMobile:!1,onResponsiveImgsSrcSet:null,onResize:null,initialize:function(){this.onResponsiveImgsSrcSet=new o,this.onResize=new o,this.onVideoInactive=new o,this.onVideoFullScreenChange=new o,this.onNavItemClicked=new o,this.navOpened=new o,this.navClosed=new o,this.loadingStartedSignal=new o,this.loadingFinishedSignal=new o,this.isIOS8=this.checkIOS8(),this.renderText=frontpage_quote||this.renderText,function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];
window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-t)),r=window.setTimeout(function(){e(i+n)},n);return t=i+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),console.clear||(console.clear=function(){}),console.trace||(console.trace=function(){}),console.group||(console.group=function(){}),console.groupCollapsed||(console.groupCollapsed=function(){}),console.groupEnd||(console.groupEnd=function(){}),console.timeStamp||(console.timeStamp=function(){}),console.profile||(console.profile=function(){}),console.profileEnd||(console.profileEnd=function(){}),console.count||(console.count=function(){}),jQuery.fn.center=function(t){return t=t?this.parent():window,this.css({position:"fixed",top:(e(t).height()-this.outerHeight())/2+e(t).scrollTop()+"px",left:(e(t).width()-this.outerWidth())/2+e(t).scrollLeft()+"px"}),this},this.introTextResized=new o,this.introTextAnimatedIn=new o,this.pathArray=window.location.pathname.split("/"),this.firstLevelLocation=this.pathArray[1],this.secondLevelLocation=this.pathArray[2],this.windowHeight=e(window).height(),this.getWidthType(),e(window).on("beforeunload",function(){null==this.noBeforeUnload?n.to(e("body"),.5,{opacity:0,ease:Linear.easeNone,onComplete:function(){e(window).scrollTop(0)}}):this.noBeforeUnload=null}.bind(this)),this.initResponsiveImages(),this.widthRespond=this.widthRespond.bind(this),i.delay(this.widthRespond,100,"logged later"),e(window).on("resize",this.widthRespond),this.initGifReplace()},getWidthType:function(){var t=this,i=window.innerWidth;this.width=e(window).width(),this.height=e(window).height();var n;return e.each(this.breakPoints,function(t){return parseInt(this,10)>i?!1:void(n=t)}),t.currentWidthType=n,this.isMobile="desktop"===t.currentWidthType||"tabletLandscape"===t.currentWidthType?!1:!0,n},animateHeaderTitle:function(t,i){t=t||0;var n=e(".work-title .inner-holder").width(),o=new r({paused:!0,delay:t});o.fromTo(e(".work-title-slash"),.8,{opacity:0,visibility:"visible",left:-10},{opacity:1,left:0,visibility:"visible",ease:Expo.easeOut}),o.set(e(".work-title"),{visibility:"visible"}),o.fromTo(e(".work-title .inner-holder"),.8,{left:-n,visibility:"visible"},{left:0,visibility:"visible",ease:Expo.easeOut},"-=0.4"),o.fromTo(e(".nav-back-arrow"),.8,{width:0},{width:28,ease:Expo.easeInOut},"-=0.6"),o.fromTo(e(".nav-back-arrow .icon-arrow-right"),.5,{left:25,opacity:0},{left:0,opacity:1,ease:Expo.easeOut},"-=0.4"),i?o.reverse(0):o.play()},onGifClick:function(t){var i=e(t.target);i.removeClass("responsive"),i.attr("src",i.data("src-gif"))},initGifReplace:function(){var t=this.imgRespond.bind(this);e("body").on("click","img.gif-replace",this.onGifClick);var i=e("main"),n=new Date;i.scroll(function(){var r=new Date;if(r-n>2e3){n=r;var o=i.height(),a=!1;e("img.gif-replace:not(.responsive)").each(function(){var t=e(this),i=t.offset().top;(-o>i||i>o)&&(t.addClass("responsive"),a=!0)}),a&&t()}})},imgRespond:function(){var t=this,n=i.keys(this.breakPoints),r=t.currentWidthType,o=n.length;e("img.responsive").each(function(){var t=e(this);if("mobile"!==r&&t.hasClass("gif-replace"))t.removeClass("responsive"),i=t.data("src-gif");else for(var i,a=0;o>a;a+=1){var s=n[a];s===r&&(i=t.data("src"+r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()))}for(var l=0;o>l;l+=1)t.removeClass("responsive-"+n[l]);t.addClass("responsive-"+r),t.attr("src",i)}),this.onResponsiveImgsSrcSet.dispatch()},initResponsiveImages:function(){e("img.responsive").each(function(){"undefined"==typeof e(this).data("src-mobile")&&e(this).data("src-mobile",e(this).attr("src"))}),this.onResponsiveImgsSrcSet.dispatch()},widthRespond:function(){this.getWidthType(),this.windowHeight=this.height,this.imgRespond(),this.onResize.dispatch(this.width,this.height),e(document).trigger("widthRespond")},setSize:function(t,e){this.width=void 0===t?window.innerWidth:t,this.height=void 0===e?window.innerHeight:e,this.widthHalf=.5*this.width,this.heightHalf=.5*this.height,this.aspectRatio=this.width/this.height},checkIOS8:function(){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return t&&parseInt(t[1],10)>=8}});return a.instance=new a,a.instance});var THREE=THREE||{REVISION:"60"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}},String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},THREE.extend=function(t,e){if(Object.keys)for(var i=Object.keys(e),n=0,r=i.length;r>n;n++){var o=i[n];Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}else{var a={}.hasOwnProperty;for(var o in e)a.call(e,o)&&(t[o]=e[o])}return t},function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!self.requestAnimationFrame;++i)self.requestAnimationFrame=self[e[i]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[e[i]+"CancelAnimationFrame"]||self[e[i]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(e){var i=Date.now(),n=Math.max(0,16-(i-t)),r=self.setTimeout(function(){e(i+n)},n);return t=i+n,r}),void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(t){self.clearTimeout(t)})}(),THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.Color=function(t){return void 0!==t&&this.set(t),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(t){return t instanceof THREE.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(t,e,i){if(0===e)this.r=this.g=this.b=i;else{var n=function(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+6*(e-t)*(2/3-i):t},r=.5>=i?i*(1+e):i+e-i*e,o=2*i-r;this.r=n(o,r,t+1/3),this.g=n(o,r,t),this.b=n(o,r,t-1/3)}return this},setStyle:function(t){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(t)){var e=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(t);return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(t)){var e=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(t);return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(t)){var e=/^\#([0-9a-f]{6})$/i.exec(t);return this.setHex(parseInt(e[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(t)){var e=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t);return this.setHex(parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3],16)),this}return/^(\w+)$/i.test(t)?(this.setHex(THREE.ColorKeywords[t]),this):void 0},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t){return this.r=t.r*t.r,this.g=t.g*t.g,this.b=t.b*t.b,this},copyLinearToGamma:function(t){return this.r=Math.sqrt(t.r),this.g=Math.sqrt(t.g),this.b=Math.sqrt(t.b),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var t={h:0,s:0,l:0};return function(){var e,i,n=this.r,r=this.g,o=this.b,a=Math.max(n,r,o),s=Math.min(n,r,o),l=(s+a)/2;if(s===a)e=0,i=0;else{var h=a-s;switch(i=.5>=l?h/(a+s):h/(2-a-s),a){case n:e=(r-o)/h+(o>r?6:0);break;case r:e=(o-n)/h+2;break;case o:e=(n-r)/h+4}e/=6}return t.h=e,t.s=i,t.l=l,t}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t){return this.r=t[0],this.g=t[1],this.b=t[2],this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(t){this._x=t,this._updateEuler()},get y(){return this._y},set y(t){this._y=t,this._updateEuler()},get z(){return this._z},set z(t){this._z=t,this._updateEuler()},get w(){return this._w},set w(t){this._w=t,this._updateEuler()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._updateEuler(),this},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._w=t._w,this._updateEuler(),this},setFromEuler:function(t,e){if(t instanceof THREE.Euler==0)throw new Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var i=Math.cos(t._x/2),n=Math.cos(t._y/2),r=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2);return"XYZ"===t.order?(this._x=o*n*r+i*a*s,this._y=i*a*r-o*n*s,this._z=i*n*s+o*a*r,this._w=i*n*r-o*a*s):"YXZ"===t.order?(this._x=o*n*r+i*a*s,this._y=i*a*r-o*n*s,this._z=i*n*s-o*a*r,this._w=i*n*r+o*a*s):"ZXY"===t.order?(this._x=o*n*r-i*a*s,this._y=i*a*r+o*n*s,this._z=i*n*s+o*a*r,this._w=i*n*r-o*a*s):"ZYX"===t.order?(this._x=o*n*r-i*a*s,this._y=i*a*r+o*n*s,this._z=i*n*s-o*a*r,this._w=i*n*r+o*a*s):"YZX"===t.order?(this._x=o*n*r+i*a*s,this._y=i*a*r+o*n*s,this._z=i*n*s-o*a*r,this._w=i*n*r-o*a*s):"XZY"===t.order&&(this._x=o*n*r-i*a*s,this._y=i*a*r-o*n*s,this._z=i*n*s+o*a*r,this._w=i*n*r+o*a*s),e!==!1&&this._updateEuler(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._updateEuler(),this},setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],r=i[4],o=i[8],a=i[1],s=i[5],l=i[9],h=i[2],c=i[6],u=i[10],d=n+s+u;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(c-l)*e,this._y=(o-h)*e,this._z=(a-r)*e):n>s&&n>u?(e=2*Math.sqrt(1+n-s-u),this._w=(c-l)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(o+h)/e):s>u?(e=2*Math.sqrt(1+s-n-u),this._w=(o-h)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(l+c)/e):(e=2*Math.sqrt(1+u-n-s),this._w=(a-r)/e,this._x=(o+h)/e,this._y=(l+c)/e,this._z=.25*e),this._updateEuler(),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._updateEuler(),this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this},multiply:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,r=t._z,o=t._w,a=e._x,s=e._y,l=e._z,h=e._w;return this._x=i*h+o*a+n*l-r*s,this._y=n*h+o*s+r*a-i*l,this._z=r*h+o*l+i*s-n*a,this._w=o*h-i*a-n*s-r*l,this._updateEuler(),this},multiplyVector3:function(t){return t.applyQuaternion(this)},slerp:function(t,e){var i=this._x,n=this._y,r=this._z,o=this._w,a=o*t._w+i*t._x+n*t._y+r*t._z;if(0>a?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=i,this._y=n,this._z=r,this;var s=Math.acos(a),l=Math.sqrt(1-a*a);if(Math.abs(l)<.001)return this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var h=Math.sin((1-e)*s)/l,c=Math.sin(e*s)/l;return this._w=o*h+this._w*c,this._x=i*h+this._x*c,this._y=n*h+this._y*c,this._z=r*h+this._z*c,this._updateEuler(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],this._w=t[3],this._updateEuler(),this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}},THREE.Quaternion.slerp=function(t,e,i,n){return i.copy(t).slerp(e,n)},THREE.Vector2=function(t,e){this.x=t||0,this.y=e||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e}else this.x=0,this.y=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t){return this.x=t[0],this.y=t[1],this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12],this.y=r[1]*e+r[5]*i+r[9]*n+r[13],this.z=r[2]*e+r[6]*i+r[10]*n+r[14],this},applyProjection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements,o=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*o,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*n-a*i,h=s*i+a*e-r*n,c=s*n+r*i-o*e,u=-r*e-o*i-a*n;return this.x=l*s+u*-r+h*-a-c*-o,this.y=h*s+u*-o+c*-r-l*-a,this.z=c*s+u*-a+l*-o-h*-r,this},transformDirection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e,this.z*=e}else this.x=0,this.y=0,this.z=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},cross:function(t,e){if(void 0!==e)return this.crossVectors(t,e);var i=this.x,n=this.y,r=this.z;return this.x=n*t.z-r*t.y,this.y=r*t.x-i*t.z,this.z=i*t.y-n*t.x,this},crossVectors:function(t,e){var i=t.x,n=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=n*s-r*a,this.y=r*o-i*s,this.z=i*a-n*o,this},angleTo:function(t){var e=this.dot(t)/(this.length()*t.length());return Math.acos(THREE.Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},setEulerFromRotationMatrix:function(){},setEulerFromQuaternion:function(){},getPositionFromMatrix:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},getScaleFromMatrix:function(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),i=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),n=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=e,this.y=i,this.z=n,this},getColumnFromMatrix:function(t,e){var i=4*t,n=e.elements;return this.x=n[i],this.y=n[i+1],this.z=n[i+2],this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var t=new THREE.Quaternion;return function(e){return e instanceof THREE.Euler==0&&0,this.applyQuaternion(t.setFromEuler(e)),this}}(),applyAxisAngle:function(){var t=new THREE.Quaternion;return function(e,i){return this.applyQuaternion(t.setFromAxisAngle(e,i)),this}}(),projectOnVector:function(){var t=new THREE.Vector3;return function(e){t.copy(e).normalize();var i=this.dot(t);return this.copy(t).multiplyScalar(i)}}(),projectOnPlane:function(){var t=new THREE.Vector3;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new THREE.Vector3;return function(e){return t.copy(this).projectOnVector(e).multiplyScalar(2),this.subVectors(t,this)}}()}),THREE.Vector4=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*n+o[12]*r,this.y=o[1]*e+o[5]*i+o[9]*n+o[13]*r,this.z=o[2]*e+o[6]*i+o[10]*n+o[14]*r,this.w=o[3]*e+o[7]*i+o[11]*n+o[15]*r,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e,this.z*=e,this.w*=e}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n,r,o=.01,a=.1,s=t.elements,l=s[0],h=s[4],c=s[8],u=s[1],d=s[5],f=s[9],p=s[2],m=s[6],g=s[10];if(Math.abs(h-u)<o&&Math.abs(c-p)<o&&Math.abs(f-m)<o){if(Math.abs(h+u)<a&&Math.abs(c+p)<a&&Math.abs(f+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;var v=(l+1)/2,y=(d+1)/2,E=(g+1)/2,x=(h+u)/4,T=(c+p)/4,_=(f+m)/4;return v>y&&v>E?o>v?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(v),n=x/i,r=T/i):y>E?o>y?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(y),i=x/n,r=_/n):o>E?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(E),i=T/r,n=_/r),this.set(i,n,r,e),this}var b=Math.sqrt((m-f)*(m-f)+(c-p)*(c-p)+(u-h)*(u-h));return Math.abs(b)<.001&&(b=1),this.x=(m-f)/b,this.y=(c-p)/b,this.z=(u-h)/b,this.w=Math.acos((l+d+g-1)/2),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this.w<t.w?this.w=t.w:this.w>e.w&&(this.w=e.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this.w=t[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Euler=function(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(t){this._x=t,this._updateQuaternion()},get y(){return this._y},set y(t){this._y=t,this._updateQuaternion()},get z(){return this._z},set z(t){this._z=t,this._updateQuaternion()},get order(){return this._order},set order(t){this._order=t,this._updateQuaternion()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this._updateQuaternion(),this},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._updateQuaternion(),this},setFromRotationMatrix:function(t,e){function i(t){return Math.min(Math.max(t,-1),1)}var n=t.elements,r=n[0],o=n[4],a=n[8],s=n[1],l=n[5],h=n[9],c=n[2],u=n[6],d=n[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(i(a)),Math.abs(a)<.99999?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(u,l),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(h)),Math.abs(h)<.99999?(this._y=Math.atan2(a,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-c,r),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(u)),Math.abs(u)<.99999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(s,r))):"ZYX"===e?(this._y=Math.asin(-i(c)),Math.abs(c)<.99999?(this._x=Math.atan2(u,d),this._z=Math.atan2(s,r)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===e?(this._z=Math.asin(i(s)),Math.abs(s)<.99999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-c,r)):(this._x=0,this._y=Math.atan2(a,d))):"XZY"===e?(this._z=Math.asin(-i(o)),Math.abs(o)<.99999?(this._x=Math.atan2(u,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-h,d),this._y=0)):0,this._order=e,this._updateQuaternion(),this},setFromQuaternion:function(t,e,i){function n(t){return Math.min(Math.max(t,-1),1)}var r=t.x*t.x,o=t.y*t.y,a=t.z*t.z,s=t.w*t.w;return e=e||this._order,"XYZ"===e?(this._x=Math.atan2(2*(t.x*t.w-t.y*t.z),s-r-o+a),this._y=Math.asin(n(2*(t.x*t.z+t.y*t.w))),this._z=Math.atan2(2*(t.z*t.w-t.x*t.y),s+r-o-a)):"YXZ"===e?(this._x=Math.asin(n(2*(t.x*t.w-t.y*t.z))),this._y=Math.atan2(2*(t.x*t.z+t.y*t.w),s-r-o+a),this._z=Math.atan2(2*(t.x*t.y+t.z*t.w),s-r+o-a)):"ZXY"===e?(this._x=Math.asin(n(2*(t.x*t.w+t.y*t.z))),this._y=Math.atan2(2*(t.y*t.w-t.z*t.x),s-r-o+a),this._z=Math.atan2(2*(t.z*t.w-t.x*t.y),s-r+o-a)):"ZYX"===e?(this._x=Math.atan2(2*(t.x*t.w+t.z*t.y),s-r-o+a),this._y=Math.asin(n(2*(t.y*t.w-t.x*t.z))),this._z=Math.atan2(2*(t.x*t.y+t.z*t.w),s+r-o-a)):"YZX"===e?(this._x=Math.atan2(2*(t.x*t.w-t.z*t.y),s-r+o-a),this._y=Math.atan2(2*(t.y*t.w-t.x*t.z),s+r-o-a),this._z=Math.asin(n(2*(t.x*t.y+t.z*t.w)))):"XZY"===e?(this._x=Math.atan2(2*(t.x*t.w+t.y*t.z),s-r+o-a),this._y=Math.atan2(2*(t.x*t.z+t.y*t.w),s+r-o-a),this._z=Math.asin(n(2*(t.z*t.w-t.x*t.y)))):0,this._order=e,i!==!1&&this._updateQuaternion(),this
},reorder:function(){var t=new THREE.Quaternion;return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._updateQuaternion(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}},THREE.Line3=function(t,e){this.start=void 0!==t?t:new THREE.Vector3,this.end=void 0!==e?e:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){var e=t||new THREE.Vector3;return e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){var e=t||new THREE.Vector3;return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new THREE.Vector3;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,n){t.subVectors(i,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),o=e.dot(t),a=o/r;return n&&(a=THREE.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,i){var n=this.closestPointToPointParameter(t,e),r=i||new THREE.Vector3;return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}},THREE.Box2=function(t,e){this.min=void 0!==t?t:new THREE.Vector2(1/0,1/0),this.max=void 0!==e?e:new THREE.Vector2(-1/0,-1/0)},THREE.Box2.prototype={constructor:THREE.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){if(t.length>0){var e=t[0];this.min.copy(e),this.max.copy(e);for(var i=1,n=t.length;n>i;i++)e=t[i],e.x<this.min.x?this.min.x=e.x:e.x>this.max.x&&(this.max.x=e.x),e.y<this.min.y?this.min.y=e.y:e.y>this.max.y&&(this.max.y=e.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var t=new THREE.Vector2;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){var e=t||new THREE.Vector2;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new THREE.Vector2;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y?!0:!1},getParameter:function(t){return new THREE.Vector2((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y?!1:!0},clampPoint:function(t,e){var i=e||new THREE.Vector2;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector2;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(t,e){this.min=void 0!==t?t:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new THREE.Vector3(-1/0,-1/0,-1/0)},THREE.Box3.prototype={constructor:THREE.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},addPoint:function(t){t.x<this.min.x?this.min.x=t.x:t.x>this.max.x&&(this.max.x=t.x),t.y<this.min.y?this.min.y=t.y:t.y>this.max.y&&(this.max.y=t.y),t.z<this.min.z?this.min.z=t.z:t.z>this.max.z&&(this.max.z=t.z)},setFromPoints:function(t){if(t.length>0){var e=t[0];this.min.copy(e),this.max.copy(e);for(var i=1,n=t.length;n>i;i++)this.addPoint(t[i])}else this.makeEmpty();return this},setFromCenterAndSize:function(){var t=new THREE.Vector3;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(){var t=new THREE.Vector3;return function(e){var i=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){if(void 0!==e.geometry&&void 0!==e.geometry.vertices)for(var n=e.geometry.vertices,r=0,o=n.length;o>r;r++)t.copy(n[r]),t.applyMatrix4(e.matrixWorld),i.expandByPoint(t)}),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){var e=t||new THREE.Vector3;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new THREE.Vector3;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z?!0:!1},getParameter:function(t){return new THREE.Vector3((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z?!1:!0},clampPoint:function(t,e){var i=e||new THREE.Vector3;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector3;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),getBoundingSphere:function(){var t=new THREE.Vector3;return function(e){var i=e||new THREE.Sphere;return i.center=this.center(),i.radius=.5*this.size(t).length(),i}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(e){return t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(t),this}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Matrix3=function(t,e,i,n,r,o,a,s,l){this.elements=new Float32Array(9),this.set(void 0!==t?t:1,e||0,i||0,n||0,void 0!==r?r:1,o||0,a||0,s||0,void 0!==l?l:1)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(t,e,i,n,r,o,a,s,l){var h=this.elements;return h[0]=t,h[3]=e,h[6]=i,h[1]=n,h[4]=r,h[7]=o,h[2]=a,h[5]=s,h[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},multiplyVector3:function(t){return t.applyMatrix3(this)},multiplyVector3Array:function(){var t=new THREE.Vector3;return function(e){for(var i=0,n=e.length;n>i;i+=3)t.x=e[i],t.y=e[i+1],t.z=e[i+2],t.applyMatrix3(this),e[i]=t.x,e[i+1]=t.y,e[i+2]=t.z;return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8];return e*o*h-e*a*l-i*r*h+i*a*s+n*r*l-n*o*s},getInverse:function(t,e){var i=t.elements,n=this.elements;n[0]=i[10]*i[5]-i[6]*i[9],n[1]=-i[10]*i[1]+i[2]*i[9],n[2]=i[6]*i[1]-i[2]*i[5],n[3]=-i[10]*i[4]+i[6]*i[8],n[4]=i[10]*i[0]-i[2]*i[8],n[5]=-i[6]*i[0]+i[2]*i[4],n[6]=i[9]*i[4]-i[5]*i[8],n[7]=-i[9]*i[0]+i[1]*i[8],n[8]=i[5]*i[0]-i[1]*i[4];var r=i[0]*n[0]+i[1]*n[3]+i[2]*n[6];if(0===r){var o="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(o);return this.identity(),this}return this.multiplyScalar(1/r),this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},clone:function(){var t=this.elements;return new THREE.Matrix3(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])}},THREE.Matrix4=function(t,e,i,n,r,o,a,s,l,h,c,u,d,f,p,m){this.elements=new Float32Array(16);var g=this.elements;g[0]=void 0!==t?t:1,g[4]=e||0,g[8]=i||0,g[12]=n||0,g[1]=r||0,g[5]=void 0!==o?o:1,g[9]=a||0,g[13]=s||0,g[2]=l||0,g[6]=h||0,g[10]=void 0!==c?c:1,g[14]=u||0,g[3]=d||0,g[7]=f||0,g[11]=p||0,g[15]=void 0!==m?m:1},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(t,e,i,n,r,o,a,s,l,h,c,u,d,f,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=h,g[10]=c,g[14]=u,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(t){return this.elements.set(t.elements),this},extractPosition:function(t){return this.copyPosition(t)},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractRotation:function(){var t=new THREE.Vector3;return function(e){var i=this.elements,n=e.elements,r=1/t.set(n[0],n[1],n[2]).length(),o=1/t.set(n[4],n[5],n[6]).length(),a=1/t.set(n[8],n[9],n[10]).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[4]=n[4]*o,i[5]=n[5]*o,i[6]=n[6]*o,i[8]=n[8]*a,i[9]=n[9]*a,i[10]=n[10]*a,this}}(),makeRotationFromEuler:function(t){t instanceof THREE.Euler==0&&0;var e=this.elements,i=t.x,n=t.y,r=t.z,o=Math.cos(i),a=Math.sin(i),s=Math.cos(n),l=Math.sin(n),h=Math.cos(r),c=Math.sin(r);if("XYZ"===t.order){var u=o*h,d=o*c,f=a*h,p=a*c;e[0]=s*h,e[4]=-s*c,e[8]=l,e[1]=d+f*l,e[5]=u-p*l,e[9]=-a*s,e[2]=p-u*l,e[6]=f+d*l,e[10]=o*s}else if("YXZ"===t.order){var m=s*h,g=s*c,v=l*h,y=l*c;e[0]=m+y*a,e[4]=v*a-g,e[8]=o*l,e[1]=o*c,e[5]=o*h,e[9]=-a,e[2]=g*a-v,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){var m=s*h,g=s*c,v=l*h,y=l*c;e[0]=m-y*a,e[4]=-o*c,e[8]=v+g*a,e[1]=g+v*a,e[5]=o*h,e[9]=y-m*a,e[2]=-o*l,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){var u=o*h,d=o*c,f=a*h,p=a*c;e[0]=s*h,e[4]=f*l-d,e[8]=u*l+p,e[1]=s*c,e[5]=p*l+u,e[9]=d*l-f,e[2]=-l,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var E=o*s,x=o*l,T=a*s,_=a*l;e[0]=s*h,e[4]=_-E*c,e[8]=T*c+x,e[1]=c,e[5]=o*h,e[9]=-a*h,e[2]=-l*h,e[6]=x*c+T,e[10]=E-_*c}else if("XZY"===t.order){var E=o*s,x=o*l,T=a*s,_=a*l;e[0]=s*h,e[4]=-c,e[8]=l*h,e[1]=E*c+_,e[5]=o*h,e[9]=x*c-T,e[2]=T*c-x,e[6]=a*h,e[10]=_*c+E}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},setRotationFromQuaternion:function(t){return this.makeRotationFromQuaternion(t)},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z,o=t.w,a=i+i,s=n+n,l=r+r,h=i*a,c=i*s,u=i*l,d=n*s,f=n*l,p=r*l,m=o*a,g=o*s,v=o*l;return e[0]=1-(d+p),e[4]=c-v,e[8]=u+g,e[1]=c+v,e[5]=1-(h+p),e[9]=f-m,e[2]=u-g,e[6]=f+m,e[10]=1-(h+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(n,r,o){var a=this.elements;return i.subVectors(n,r).normalize(),0===i.length()&&(i.z=1),t.crossVectors(o,i).normalize(),0===t.length()&&(i.x+=1e-4,t.crossVectors(o,i).normalize()),e.crossVectors(i,t),a[0]=t.x,a[4]=e.x,a[8]=i.x,a[1]=t.y,a[5]=e.y,a[9]=i.y,a[2]=t.z,a[6]=e.z,a[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],h=i[1],c=i[5],u=i[9],d=i[13],f=i[2],p=i[6],m=i[10],g=i[14],v=i[3],y=i[7],E=i[11],x=i[15],T=n[0],_=n[4],b=n[8],w=n[12],R=n[1],S=n[5],M=n[9],H=n[13],C=n[2],A=n[6],P=n[10],L=n[14],O=n[3],D=n[7],z=n[11],N=n[15];return r[0]=o*T+a*R+s*C+l*O,r[4]=o*_+a*S+s*A+l*D,r[8]=o*b+a*M+s*P+l*z,r[12]=o*w+a*H+s*L+l*N,r[1]=h*T+c*R+u*C+d*O,r[5]=h*_+c*S+u*A+d*D,r[9]=h*b+c*M+u*P+d*z,r[13]=h*w+c*H+u*L+d*N,r[2]=f*T+p*R+m*C+g*O,r[6]=f*_+p*S+m*A+g*D,r[10]=f*b+p*M+m*P+g*z,r[14]=f*w+p*H+m*L+g*N,r[3]=v*T+y*R+E*C+x*O,r[7]=v*_+y*S+E*A+x*D,r[11]=v*b+y*M+E*P+x*z,r[15]=v*w+y*H+E*L+x*N,this},multiplyToArray:function(t,e,i){var n=this.elements;return this.multiplyMatrices(t,e),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},multiplyVector3:function(t){return t.applyProjection(this)},multiplyVector4:function(t){return t.applyMatrix4(this)},multiplyVector3Array:function(){var t=new THREE.Vector3;return function(e){for(var i=0,n=e.length;n>i;i+=3)t.x=e[i],t.y=e[i+1],t.z=e[i+2],t.applyProjection(this),e[i]=t.x,e[i+1]=t.y,e[i+2]=t.z;return e}}(),rotateAxis:function(t){t.transformDirection(this)},crossVector:function(t){return t.applyMatrix4(this)},determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],h=t[2],c=t[6],u=t[10],d=t[14],f=t[3],p=t[7],m=t[11],g=t[15];return f*(+r*s*c-n*l*c-r*a*u+i*l*u+n*a*d-i*s*d)+p*(+e*s*d-e*l*u+r*o*u-n*o*d+n*l*h-r*s*h)+m*(+e*l*c-e*a*d-r*o*c+i*o*d+r*a*h-i*l*h)+g*(-n*a*h-e*s*c+e*a*u+n*o*c-i*o*u+i*s*h)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t},getPosition:function(){var t=new THREE.Vector3;return function(){var e=this.elements;return t.set(e[12],e[13],e[14])}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,n=t.elements,r=n[0],o=n[4],a=n[8],s=n[12],l=n[1],h=n[5],c=n[9],u=n[13],d=n[2],f=n[6],p=n[10],m=n[14],g=n[3],v=n[7],y=n[11],E=n[15];i[0]=c*m*v-u*p*v+u*f*y-h*m*y-c*f*E+h*p*E,i[4]=s*p*v-a*m*v-s*f*y+o*m*y+a*f*E-o*p*E,i[8]=a*u*v-s*c*v+s*h*y-o*u*y-a*h*E+o*c*E,i[12]=s*c*f-a*u*f-s*h*p+o*u*p+a*h*m-o*c*m,i[1]=u*p*g-c*m*g-u*d*y+l*m*y+c*d*E-l*p*E,i[5]=a*m*g-s*p*g+s*d*y-r*m*y-a*d*E+r*p*E,i[9]=s*c*g-a*u*g-s*l*y+r*u*y+a*l*E-r*c*E,i[13]=a*u*d-s*c*d+s*l*p-r*u*p-a*l*m+r*c*m,i[2]=h*m*g-u*f*g+u*d*v-l*m*v-h*d*E+l*f*E,i[6]=s*f*g-o*m*g-s*d*v+r*m*v+o*d*E-r*f*E,i[10]=o*u*g-s*h*g+s*l*v-r*u*v-o*l*E+r*h*E,i[14]=s*h*d-o*u*d-s*l*f+r*u*f+o*l*m-r*h*m,i[3]=c*f*g-h*p*g-c*d*v+l*p*v+h*d*y-l*f*y,i[7]=o*p*g-a*f*g+a*d*v-r*p*v-o*d*y+r*f*y,i[11]=a*h*g-o*c*g-a*l*v+r*c*v+o*l*y-r*h*y,i[15]=o*c*d-a*h*d+a*l*f-r*c*f-o*l*p+r*h*p;var x=r*i[0]+l*i[4]+d*i[8]+g*i[12];if(0==x){var T="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(T);return this.identity(),this}return this.multiplyScalar(1/x),this},translate:function(){},rotateX:function(){},rotateY:function(){},rotateZ:function(){},rotateByAxis:function(){},scale:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,Math.max(i,n)))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=1-i,o=t.x,a=t.y,s=t.z,l=r*o,h=r*a;return this.set(l*o+i,l*a-n*s,l*s+n*a,0,l*a+n*s,h*a+i,h*s-n*o,0,l*s-n*a,h*s+n*o,r*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(){var t=new THREE.Vector3,e=new THREE.Matrix4;return function(i,n,r){var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),l=t.set(o[8],o[9],o[10]).length();i.x=o[12],i.y=o[13],i.z=o[14],e.elements.set(this.elements);var h=1/a,c=1/s,u=1/l;return e.elements[0]*=h,e.elements[1]*=h,e.elements[2]*=h,e.elements[4]*=c,e.elements[5]*=c,e.elements[6]*=c,e.elements[8]*=u,e.elements[9]*=u,e.elements[10]*=u,n.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=l,this}}(),makeFrustum:function(t,e,i,n,r,o){var a=this.elements,s=2*r/(e-t),l=2*r/(n-i),h=(e+t)/(e-t),c=(n+i)/(n-i),u=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,i,n){var r=i*Math.tan(THREE.Math.degToRad(.5*t)),o=-r,a=o*e,s=r*e;return this.makeFrustum(a,s,o,r,i,n)},makeOrthographic:function(t,e,i,n,r,o){var a=this.elements,s=e-t,l=i-n,h=o-r,c=(e+t)/s,u=(i+n)/l,d=(o+r)/h;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2/h,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]},clone:function(){var t=this.elements;return new THREE.Matrix4(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])}},THREE.Ray=function(t,e){this.origin=void 0!==t?t:new THREE.Vector3,this.direction=void 0!==e?e:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){var i=e||new THREE.Vector3;return i.copy(this.direction).multiplyScalar(t).add(this.origin)},recast:function(){var t=new THREE.Vector3;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var i=e||new THREE.Vector3;i.subVectors(t,this.origin);var n=i.dot(this.direction);return 0>n?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(){var t=new THREE.Vector3;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return 0>i?this.origin.distanceTo(e):(t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceTo(e))}}(),distanceSqToSegment:function(t,e,i,n){var r,o,a,s,l=t.clone().add(e).multiplyScalar(.5),h=e.clone().sub(t).normalize(),c=.5*t.distanceTo(e),u=this.origin.clone().sub(l),d=-this.direction.dot(h),f=u.dot(this.direction),p=-u.dot(h),m=u.lengthSq(),g=Math.abs(1-d*d);if(g>=0)if(r=d*p-f,o=d*f-p,s=c*g,r>=0)if(o>=-s)if(s>=o){var v=1/g;r*=v,o*=v,a=r*(r+d*o+2*f)+o*(d*r+o+2*p)+m}else o=c,r=Math.max(0,-(d*o+f)),a=-r*r+o*(o+2*p)+m;else o=-c,r=Math.max(0,-(d*o+f)),a=-r*r+o*(o+2*p)+m;else-s>=o?(r=Math.max(0,-(-d*c+f)),o=r>0?-c:Math.min(Math.max(-c,-p),c),a=-r*r+o*(o+2*p)+m):s>=o?(r=0,o=Math.min(Math.max(-c,-p),c),a=o*(o+2*p)+m):(r=Math.max(0,-(d*c+f)),o=r>0?c:Math.min(Math.max(-c,-p),c),a=-r*r+o*(o+2*p)+m);else o=d>0?-c:c,r=Math.max(0,-(d*o+f)),a=-r*r+o*(o+2*p)+m;return i&&i.copy(this.direction.clone().multiplyScalar(r).add(this.origin)),n&&n.copy(h.clone().multiplyScalar(o).add(l)),a},isIntersectionSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},isIntersectionPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var i=t.normal.dot(this.direction);return 0>i*e?!0:!1},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0==e)return 0==t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},isIntersectionBox:function(){var t=new THREE.Vector3;return function(e){return null!==this.intersectBox(e,t)}}(),intersectBox:function(t,e){var i,n,r,o,a,s,l=1/this.direction.x,h=1/this.direction.y,c=1/this.direction.z,u=this.origin;return l>=0?(i=(t.min.x-u.x)*l,n=(t.max.x-u.x)*l):(i=(t.max.x-u.x)*l,n=(t.min.x-u.x)*l),h>=0?(r=(t.min.y-u.y)*h,o=(t.max.y-u.y)*h):(r=(t.max.y-u.y)*h,o=(t.min.y-u.y)*h),i>o||r>n?null:((r>i||i!==i)&&(i=r),(n>o||n!==n)&&(n=o),c>=0?(a=(t.min.z-u.z)*c,s=(t.max.z-u.z)*c):(a=(t.max.z-u.z)*c,s=(t.min.z-u.z)*c),i>s||a>n?null:((a>i||i!==i)&&(i=a),(n>s||n!==n)&&(n=s),0>n?null:this.at(i>=0?i:n,e)))},intersectTriangle:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3;return function(r,o,a,s,l){e.subVectors(o,r),i.subVectors(a,r),n.crossVectors(e,i);var h,c=this.direction.dot(n);if(c>0){if(s)return null;h=1}else{if(!(0>c))return null;h=-1,c=-c}t.subVectors(this.origin,r);var u=h*this.direction.dot(i.crossVectors(t,i));if(0>u)return null;var d=h*this.direction.dot(e.cross(t));if(0>d)return null;if(u+d>c)return null;var f=-h*t.dot(n);return 0>f?null:this.at(f/c,l)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Sphere=function(t,e){this.center=void 0!==t?t:new THREE.Vector3,this.radius=void 0!==e?e:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new THREE.Box3;return function(e,i){var n=this.center;void 0!==i?n.copy(i):t.setFromPoints(e).center(n);for(var r=0,o=0,a=e.length;a>o;o++)r=Math.max(r,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}}(),copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),n=e||new THREE.Vector3;return n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){var e=t||new THREE.Box3;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Frustum=function(t,e,i,n,r,o){this.planes=[void 0!==t?t:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==o?o:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(t,e,i,n,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this},copy:function(t){for(var e=this.planes,i=0;6>i;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],l=i[5],h=i[6],c=i[7],u=i[8],d=i[9],f=i[10],p=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(a-n,c-s,p-u,y-m).normalize(),e[1].setComponents(a+n,c+s,p+u,y+m).normalize(),e[2].setComponents(a+r,c+l,p+d,y+g).normalize(),e[3].setComponents(a-r,c-l,p-d,y-g).normalize(),e[4].setComponents(a-o,c-h,p-f,y-v).normalize(),e[5].setComponents(a+o,c+h,p+f,y+v).normalize(),this},intersectsObject:function(){var t=new THREE.Sphere;return function(e){var i=e.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),t.copy(i.boundingSphere),t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,i=t.center,n=-t.radius,r=0;6>r;r++){var o=e[r].distanceToPoint(i);if(n>o)return!1}return!0},intersectsBox:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i){for(var n=this.planes,r=0;6>r;r++){var o=n[r];t.x=o.normal.x>0?i.min.x:i.max.x,e.x=o.normal.x>0?i.max.x:i.min.x,t.y=o.normal.y>0?i.min.y:i.max.y,e.y=o.normal.y>0?i.max.y:i.min.y,t.z=o.normal.z>0?i.min.z:i.max.z,e.z=o.normal.z>0?i.max.z:i.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(e);if(0>a&&0>s)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,i=0;6>i;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Plane=function(t,e){this.normal=void 0!==t?t:new THREE.Vector3(1,0,0),this.constant=void 0!==e?e:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,n,r){var o=t.subVectors(r,n).cross(e.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,i),this}}(),copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var i=this.distanceToPoint(t),n=e||new THREE.Vector3;return n.copy(this.normal).multiplyScalar(i)},isIntersectionLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return 0>e&&i>0||0>i&&e>0},intersectLine:function(){var t=new THREE.Vector3;return function(e,i){var n=i||new THREE.Vector3,r=e.delta(t),o=this.normal.dot(r);if(0==o)return 0==this.distanceToPoint(e.start)?n.copy(e.start):void 0;var a=-(e.start.dot(this.normal)+this.constant)/o;return 0>a||a>1?void 0:n.copy(r).multiplyScalar(a).add(e.start)}}(),coplanarPoint:function(t){var e=t||new THREE.Vector3;return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,n){n=n||(new THREE.Matrix3).getNormalMatrix(i);var r=t.copy(this.normal).applyMatrix3(n),o=this.coplanarPoint(e);return o.applyMatrix4(i),this.setFromNormalAndCoplanarPoint(r,o),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Math={PI2:2*Math.PI,generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0;return function(){for(var r=0;36>r;r++)8==r||13==r||18==r||23==r?i[r]="-":14==r?i[r]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[r]=e[19==r?3&t|8:t]);return i.join("")}}(),clamp:function(t,e,i){return e>t?e:t>i?i:t},clampBottom:function(t,e){return e>t?e:t},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},smoothstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},smootherstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},sign:function(t){return 0>t?-1:t>0?1:0},degToRad:function(){var t=Math.PI/180;return function(e){return e*t}}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t}}()},THREE.Spline=function(t){function e(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e}this.points=t;var i,n,r,o,a,s,l,h,c,u=[],d={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return i=(this.points.length-1)*t,n=Math.floor(i),r=i-n,u[0]=0===n?n:n-1,u[1]=n,u[2]=n>this.points.length-2?this.points.length-1:n+1,u[3]=n>this.points.length-3?this.points.length-1:n+2,s=this.points[u[0]],l=this.points[u[1]],h=this.points[u[2]],c=this.points[u[3]],o=r*r,a=r*o,d.x=e(s.x,l.x,h.x,c.x,r,o,a),d.y=e(s.y,l.y,h.y,c.y,r,o,a),d.z=e(s.z,l.z,h.z,c.z,r,o,a),d},this.getControlPointsArray=function(){var t,e,i=this.points.length,n=[];for(t=0;i>t;t++)e=this.points[t],n[t]=[e.x,e.y,e.z];return n},this.getLength=function(t){var e,i,n,r,o=0,a=0,s=0,l=new THREE.Vector3,h=new THREE.Vector3,c=[],u=0;for(c[0]=0,t||(t=100),n=this.points.length*t,l.copy(this.points[0]),e=1;n>e;e++)i=e/n,r=this.getPoint(i),h.copy(r),u+=h.distanceTo(l),l.copy(r),o=(this.points.length-1)*i,a=Math.floor(o),a!=s&&(c[a]=u,s=a);return c[c.length]=u,{chunks:c,total:u}},this.reparametrizeByArcLength=function(t){var e,i,n,r,o,a,s,l,h=[],c=new THREE.Vector3,u=this.getLength();for(h.push(c.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(a=u.chunks[e]-u.chunks[e-1],s=Math.ceil(t*a/u.total),r=(e-1)/(this.points.length-1),o=e/(this.points.length-1),i=1;s-1>i;i++)n=r+i*(1/s)*(o-r),l=this.getPoint(n),h.push(c.copy(l).clone());
h.push(c.copy(this.points[e]).clone())}this.points=h}},THREE.Triangle=function(t,e,i){this.a=void 0!==t?t:new THREE.Vector3,this.b=void 0!==e?e:new THREE.Vector3,this.c=void 0!==i?i:new THREE.Vector3},THREE.Triangle.normal=function(){var t=new THREE.Vector3;return function(e,i,n,r){var o=r||new THREE.Vector3;o.subVectors(n,i),t.subVectors(e,i),o.cross(t);var a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(n,r,o,a,s){t.subVectors(a,r),e.subVectors(o,r),i.subVectors(n,r);var l=t.dot(t),h=t.dot(e),c=t.dot(i),u=e.dot(e),d=e.dot(i),f=l*u-h*h,p=s||new THREE.Vector3;if(0==f)return p.set(-2,-1,-1);var m=1/f,g=(u*c-h*d)*m,v=(l*d-h*c)*m;return p.set(1-g-v,v,g)}}(),THREE.Triangle.containsPoint=function(){var t=new THREE.Vector3;return function(e,i,n,r){var o=THREE.Triangle.barycoordFromPoint(e,i,n,r,t);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){var e=t||new THREE.Vector3;return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return THREE.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){var e=t||new THREE.Plane;return e.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return THREE.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return THREE.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Vertex=function(t){return t},THREE.UV=function(t,e){return new THREE.Vector2(t,e)},THREE.Clock=function(t){this.autoStart=void 0!==t?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();t=.001*(e-this.oldTime),this.oldTime=e,this.elapsedTime+=t}return t}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(t){t.addEventListener=THREE.EventDispatcher.prototype.addEventListener,t.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,t.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)?!0:!1},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners,n=i[t].indexOf(e);-1!==n&&i[t].splice(n,1)}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,i=e[t.type];if(void 0!==i){t.target=this;for(var n=0,r=i.length;r>n;n++)i[n].call(this,t)}}}},function(t){t.Raycaster=function(e,i,n,r){this.ray=new t.Ray(e,i),this.near=n||0,this.far=r||1/0};var e=new t.Sphere,i=new t.Ray,n=(new t.Plane,new t.Vector3,new t.Vector3),r=new t.Matrix4,o=function(t,e){return t.distance-e.distance},a=new t.Vector3,s=new t.Vector3,l=new t.Vector3,h=function(o,c,u){if(o instanceof t.Particle){n.getPositionFromMatrix(o.matrixWorld);var d=c.ray.distanceToPoint(n);if(d>o.scale.x)return u;u.push({distance:d,point:o.position,face:null,object:o})}else if(o instanceof t.LOD){n.getPositionFromMatrix(o.matrixWorld);var d=c.ray.origin.distanceTo(n);h(o.getObjectForDistance(d),c,u)}else if(o instanceof t.Mesh){var f=o.geometry;if(null===f.boundingSphere&&f.computeBoundingSphere(),e.copy(f.boundingSphere),e.applyMatrix4(o.matrixWorld),c.ray.isIntersectionSphere(e)===!1)return u;if(r.getInverse(o.matrixWorld),i.copy(c.ray).applyMatrix4(r),null!==f.boundingBox&&i.isIntersectionBox(f.boundingBox)===!1)return u;var p=f.vertices;if(f instanceof t.BufferGeometry){var m=o.material;if(void 0===m)return u;if(f.dynamic===!1)return u;var g,v,y,E=c.precision;if(void 0!==f.attributes.index)for(var x=f.offsets,T=f.attributes.index.array,_=f.attributes.position.array,b=f.offsets.length,w=f.attributes.index.array.length/3,R=0;b>R;++R)for(var S=x[R].start,M=x[R].count,H=x[R].index,C=S,A=S+M;A>C;C+=3){g=H+T[C],v=H+T[C+1],y=H+T[C+2],a.set(_[3*g],_[3*g+1],_[3*g+2]),s.set(_[3*v],_[3*v+1],_[3*v+2]),l.set(_[3*y],_[3*y+1],_[3*y+2]);var P=i.intersectTriangle(a,s,l,m.side!==t.DoubleSide);if(null!==P){P.applyMatrix4(o.matrixWorld);var d=c.ray.origin.distanceTo(P);E>d||d<c.near||d>c.far||u.push({distance:d,point:P,face:null,faceIndex:null,object:o})}}else for(var x=f.offsets,_=f.attributes.position.array,b=f.offsets.length,w=f.attributes.position.array.length,C=0;w>C;C+=3){g=C,v=C+1,y=C+2,a.set(_[3*g],_[3*g+1],_[3*g+2]),s.set(_[3*v],_[3*v+1],_[3*v+2]),l.set(_[3*y],_[3*y+1],_[3*y+2]);var P=i.intersectTriangle(a,s,l,m.side!==t.DoubleSide);if(null!==P){P.applyMatrix4(o.matrixWorld);var d=c.ray.origin.distanceTo(P);E>d||d<c.near||d>c.far||u.push({distance:d,point:P,face:null,faceIndex:null,object:o})}}}else if(f instanceof t.Geometry)for(var g,v,y,L=o.material instanceof t.MeshFaceMaterial,O=L===!0?o.material.materials:null,E=c.precision,D=0,w=f.faces.length;w>D;D++){var z=f.faces[D],m=L===!0?O[z.materialIndex]:o.material;if(void 0!==m){g=p[z.a],v=p[z.b],y=p[z.c];var P=i.intersectTriangle(g,v,y,m.side!==t.DoubleSide);if(null!==P){P.applyMatrix4(o.matrixWorld);var d=c.ray.origin.distanceTo(P);E>d||d<c.near||d>c.far||u.push({distance:d,point:P,face:z,faceIndex:D,object:o})}}}}else if(o instanceof t.Line){var E=c.linePrecision,N=E*E,f=o.geometry;if(null===f.boundingSphere&&f.computeBoundingSphere(),e.copy(f.boundingSphere),e.applyMatrix4(o.matrixWorld),c.ray.isIntersectionSphere(e)===!1)return u;r.getInverse(o.matrixWorld),i.copy(c.ray).applyMatrix4(r);for(var p=f.vertices,F=p.length,U=new t.Vector3,I=new t.Vector3,k=o.type===t.LineStrip?1:2,C=0;F-1>C;C+=k){var V=i.distanceSqToSegment(p[C],p[C+1],I,U);if(!(V>N)){var d=i.origin.distanceTo(I);d<c.near||d>c.far||u.push({distance:d,point:U.clone().applyMatrix4(o.matrixWorld),face:null,faceIndex:null,object:o})}}}},c=function(t,e,i){for(var n=t.getDescendants(),r=0,o=n.length;o>r;r++)h(n[r],e,i)};t.Raycaster.prototype.precision=1e-4,t.Raycaster.prototype.linePrecision=1,t.Raycaster.prototype.set=function(t,e){this.ray.set(t,e)},t.Raycaster.prototype.intersectObject=function(t,e){var i=[];return e===!0&&c(t,this,i),h(t,this,i),i.sort(o),i},t.Raycaster.prototype.intersectObjects=function(t,e){for(var i=[],n=0,r=t.length;r>n;n++)h(t[n],this,i),e===!0&&c(t[n],this,i);return i.sort(o),i}}(THREE),THREE.Object3D=function(){this.id=THREE.Object3DIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this.rotation=new THREE.Euler,this.quaternion=new THREE.Quaternion,this.scale=new THREE.Vector3(1,1,1),this.rotation._quaternion=this.quaternion,this.quaternion._euler=this.rotation,this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.userData={}},THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){return this.rotation.order},set eulerOrder(t){this.rotation.order=t},get useQuaternion(){},set useQuaternion(t){},applyMatrix:function(){var t=new THREE.Matrix4;return function(e){this.matrix.multiplyMatrices(e,this.matrix),this.position.getPositionFromMatrix(this.matrix),this.scale.getScaleFromMatrix(this.matrix),t.extractRotation(this.matrix),this.quaternion.setFromRotationMatrix(t)}}(),setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new THREE.Quaternion;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new THREE.Vector3;return function(e,i){return t.copy(e),t.applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(i)),this}}(),translate:function(t,e){return this.translateOnAxis(e,t)},translateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new THREE.Matrix4;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new THREE.Matrix4;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(t!==this&&t instanceof THREE.Object3D){void 0!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t);for(var e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof THREE.Scene&&e.__addObject(t)}},remove:function(t){var e=this.children.indexOf(t);if(-1!==e){t.parent=void 0,t.dispatchEvent({type:"removed"}),this.children.splice(e,1);for(var i=this;void 0!==i.parent;)i=i.parent;void 0!==i&&i instanceof THREE.Scene&&i.__removeObject(t)}},traverse:function(t){t(this);for(var e=0,i=this.children.length;i>e;e++)this.children[e].traverse(t)},getObjectById:function(t,e){for(var i=0,n=this.children.length;n>i;i++){var r=this.children[i];if(r.id===t)return r;if(e===!0&&(r=r.getObjectById(t,e),void 0!==r))return r}return void 0},getObjectByName:function(t,e){for(var i=0,n=this.children.length;n>i;i++){var r=this.children[i];if(r.name===t)return r;if(e===!0&&(r=r.getObjectByName(t,e),void 0!==r))return r}return void 0},getChildByName:function(t,e){return this.getObjectByName(t,e)},getDescendants:function(t){void 0===t&&(t=[]),Array.prototype.push.apply(t,this.children);for(var e=0,i=this.children.length;i>e;e++)this.children[e].getDescendants(t);return t},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||t===!0)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,i=this.children.length;i>e;e++)this.children[e].updateMatrixWorld(t)},clone:function(t,e){if(void 0===t&&(t=new THREE.Object3D),void 0===e&&(e=!0),t.name=this.name,t.up.copy(this.up),t.position.copy(this.position),t.quaternion.copy(this.quaternion),t.scale.copy(this.scale),t.renderDepth=this.renderDepth,t.rotationAutoUpdate=this.rotationAutoUpdate,t.matrix.copy(this.matrix),t.matrixWorld.copy(this.matrixWorld),t.matrixAutoUpdate=this.matrixAutoUpdate,t.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,t.visible=this.visible,t.castShadow=this.castShadow,t.receiveShadow=this.receiveShadow,t.frustumCulled=this.frustumCulled,t.userData=JSON.parse(JSON.stringify(this.userData)),e===!0)for(var i=0;i<this.children.length;i++){var n=this.children[i];t.add(n.clone())}return t}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Projector=function(){function t(){if(l===E){var t=new THREE.RenderableObject;return y.push(t),E++,l++,t}return y[l++]}function e(){if(c===T){var t=new THREE.RenderableVertex;return x.push(t),T++,c++,t}return x[c++]}function i(){if(d===b){var t=new THREE.RenderableFace3;return _.push(t),b++,d++,t}return _[d++]}function n(){if(p===R){var t=new THREE.RenderableLine;return w.push(t),R++,p++,t}return w[p++]}function r(){if(g===M){var t=new THREE.RenderableParticle;return S.push(t),M++,g++,t}return S[g++]}function o(t,e){return t.z!==e.z?e.z-t.z:t.id!==e.id?t.id-e.id:0}function a(t,e){var i=0,n=1,r=t.z+t.w,o=e.z+e.w,a=-t.z+t.w,s=-e.z+e.w;return r>=0&&o>=0&&a>=0&&s>=0?!0:0>r&&0>o||0>a&&0>s?!1:(0>r?i=Math.max(i,r/(r-o)):0>o&&(n=Math.min(n,r/(r-o))),0>a?i=Math.max(i,a/(a-s)):0>s&&(n=Math.min(n,a/(a-s))),i>n?!1:(t.lerp(e,i),e.lerp(t,1-n),!0))}var s,l,h,c,u,d,f,p,m,g,v,y=[],E=0,x=[],T=0,_=[],b=0,w=[],R=0,S=[],M=0,H={objects:[],sprites:[],lights:[],elements:[]},C=new THREE.Vector3,A=new THREE.Vector4,P=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),L=new THREE.Box3,O=new Array(3),D=(new Array(4),new THREE.Matrix4),z=new THREE.Matrix4,N=new THREE.Matrix4,F=new THREE.Matrix3,U=new THREE.Matrix3,I=new THREE.Vector3,k=new THREE.Frustum,V=new THREE.Vector4,B=new THREE.Vector4;this.projectVector=function(t,e){return e.matrixWorldInverse.getInverse(e.matrixWorld),z.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),t.applyProjection(z)},this.unprojectVector=function(t,e){return e.projectionMatrixInverse.getInverse(e.projectionMatrix),z.multiplyMatrices(e.matrixWorld,e.projectionMatrixInverse),t.applyProjection(z)},this.pickingRay=function(t,e){t.z=-1;var i=new THREE.Vector3(t.x,t.y,1);return this.unprojectVector(t,e),this.unprojectVector(i,e),i.sub(t).normalize(),new THREE.Raycaster(t,i)};var j=function(e){return s=t(),s.id=e.id,s.object=e,null!==e.renderDepth?s.z=e.renderDepth:(C.getPositionFromMatrix(e.matrixWorld),C.applyProjection(z),s.z=C.z),s},G=function(t){if(t.visible!==!1){t instanceof THREE.Light?H.lights.push(t):t instanceof THREE.Mesh||t instanceof THREE.Line?(t.frustumCulled===!1||k.intersectsObject(t)===!0)&&H.objects.push(j(t)):(t instanceof THREE.Sprite||t instanceof THREE.Particle)&&H.sprites.push(j(t));for(var e=0,i=t.children.length;i>e;e++)G(t.children[e])}},W=function(t,e){l=0,H.objects.length=0,H.sprites.length=0,H.lights.length=0,G(t),e===!0&&H.objects.sort(o)};this.projectScene=function(t,s,l,y){var E,T,_,b,w,R,S,M,C,j,G,X,q,Y,K,$,Q,Z,J,te,ee,ie,ne,re,oe,ae=!1;for(d=0,p=0,g=0,H.elements.length=0,t.autoUpdate===!0&&t.updateMatrixWorld(),void 0===s.parent&&s.updateMatrixWorld(),D.copy(s.matrixWorldInverse.getInverse(s.matrixWorld)),z.multiplyMatrices(s.projectionMatrix,D),U.getNormalMatrix(D),k.setFromMatrix(z),W(t,l),E=0,T=H.objects.length;T>E;E++)if(q=H.objects[E].object,v=q.matrixWorld,c=0,q instanceof THREE.Mesh){for(Y=q.geometry,K=Y.vertices,$=Y.faces,J=Y.faceVertexUvs,F.getNormalMatrix(v),re=q.material instanceof THREE.MeshFaceMaterial,oe=re===!0?q.material:null,_=0,b=K.length;b>_;_++){h=e(),h.positionWorld.copy(K[_]).applyMatrix4(v),h.positionScreen.copy(h.positionWorld).applyMatrix4(z);var se=1/h.positionScreen.w;h.positionScreen.x*=se,h.positionScreen.y*=se,h.positionScreen.z*=se,h.visible=!(h.positionScreen.x<-1||h.positionScreen.x>1||h.positionScreen.y<-1||h.positionScreen.y>1||h.positionScreen.z<-1||h.positionScreen.z>1)}for(w=0,R=$.length;R>w;w++){Q=$[w];var le=re===!0?oe.materials[Q.materialIndex]:q.material;if(void 0!==le){var he=le.side;if(ee=x[Q.a],ie=x[Q.b],ne=x[Q.c],O[0]=ee.positionScreen,O[1]=ie.positionScreen,O[2]=ne.positionScreen,(ee.visible===!0||ie.visible===!0||ne.visible===!0||P.isIntersectionBox(L.setFromPoints(O)))&&(ae=(ne.positionScreen.x-ee.positionScreen.x)*(ie.positionScreen.y-ee.positionScreen.y)-(ne.positionScreen.y-ee.positionScreen.y)*(ie.positionScreen.x-ee.positionScreen.x)<0,he===THREE.DoubleSide||ae===(he===THREE.FrontSide))){for(u=i(),u.id=q.id,u.v1.copy(ee),u.v2.copy(ie),u.v3.copy(ne),u.normalModel.copy(Q.normal),ae===!1&&(he===THREE.BackSide||he===THREE.DoubleSide)&&u.normalModel.negate(),u.normalModel.applyMatrix3(F).normalize(),u.normalModelView.copy(u.normalModel).applyMatrix3(U),u.centroidModel.copy(Q.centroid).applyMatrix4(v),Z=Q.vertexNormals,S=0,M=Math.min(Z.length,3);M>S;S++){var ce=u.vertexNormalsModel[S];ce.copy(Z[S]),ae===!1&&(he===THREE.BackSide||he===THREE.DoubleSide)&&ce.negate(),ce.applyMatrix3(F).normalize();var ue=u.vertexNormalsModelView[S];ue.copy(ce).applyMatrix3(U)}for(u.vertexNormalsLength=Z.length,C=0,j=Math.min(J.length,3);j>C;C++)if(te=J[C][w],void 0!==te)for(G=0,X=te.length;X>G;G++)u.uvs[C][G]=te[G];u.color=Q.color,u.material=le,I.copy(u.centroidModel).applyProjection(z),u.z=I.z,H.elements.push(u)}}}}else if(q instanceof THREE.Line){N.multiplyMatrices(z,v),K=q.geometry.vertices,ee=e(),ee.positionScreen.copy(K[0]).applyMatrix4(N);var de=q.type===THREE.LinePieces?2:1;for(_=1,b=K.length;b>_;_++)ee=e(),ee.positionScreen.copy(K[_]).applyMatrix4(N),(_+1)%de>0||(ie=x[c-2],V.copy(ee.positionScreen),B.copy(ie.positionScreen),a(V,B)===!0&&(V.multiplyScalar(1/V.w),B.multiplyScalar(1/B.w),f=n(),f.id=q.id,f.v1.positionScreen.copy(V),f.v2.positionScreen.copy(B),f.z=Math.max(V.z,B.z),f.material=q.material,q.material.vertexColors===THREE.VertexColors&&(f.vertexColors[0].copy(q.geometry.colors[_]),f.vertexColors[1].copy(q.geometry.colors[_-1])),H.elements.push(f)))}for(E=0,T=H.sprites.length;T>E;E++)if(q=H.sprites[E].object,v=q.matrixWorld,q instanceof THREE.Particle){A.set(v.elements[12],v.elements[13],v.elements[14],1),A.applyMatrix4(z);var se=1/A.w;A.z*=se,A.z>0&&A.z<1&&(m=r(),m.id=q.id,m.x=A.x*se,m.y=A.y*se,m.z=A.z,m.object=q,m.rotation=q.rotation.z,m.scale.x=q.scale.x*Math.abs(m.x-(A.x+s.projectionMatrix.elements[0])/(A.w+s.projectionMatrix.elements[12])),m.scale.y=q.scale.y*Math.abs(m.y-(A.y+s.projectionMatrix.elements[5])/(A.w+s.projectionMatrix.elements[13])),m.material=q.material,H.elements.push(m))}return y===!0&&H.elements.sort(o),H}},THREE.Face3=function(t,e,i,n,r,o){this.a=t,this.b=e,this.c=i,this.normal=n instanceof THREE.Vector3?n:new THREE.Vector3,this.vertexNormals=n instanceof Array?n:[],this.color=r instanceof THREE.Color?r:new THREE.Color,this.vertexColors=r instanceof Array?r:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var t=new THREE.Face3(this.a,this.b,this.c);t.normal.copy(this.normal),t.color.copy(this.color),t.centroid.copy(this.centroid),t.materialIndex=this.materialIndex;var e,i;for(e=0,i=this.vertexNormals.length;i>e;e++)t.vertexNormals[e]=this.vertexNormals[e].clone();for(e=0,i=this.vertexColors.length;i>e;e++)t.vertexColors[e]=this.vertexColors[e].clone();for(e=0,i=this.vertexTangents.length;i>e;e++)t.vertexTangents[e]=this.vertexTangents[e].clone();return t}},THREE.Face4=function(t,e,i,n,r,o,a){return new THREE.Face3(t,e,i,r,o,a)},THREE.Geometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.vertices=[],this.colors=[],this.normals=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.buffersNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(t){for(var e=(new THREE.Matrix3).getNormalMatrix(t),i=0,n=this.vertices.length;n>i;i++){var r=this.vertices[i];r.applyMatrix4(t)}for(var i=0,n=this.faces.length;n>i;i++){var o=this.faces[i];o.normal.applyMatrix3(e).normalize();for(var a=0,s=o.vertexNormals.length;s>a;a++)o.vertexNormals[a].applyMatrix3(e).normalize();o.centroid.applyMatrix4(t)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox(),this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var t,e,i;for(t=0,e=this.faces.length;e>t;t++)i=this.faces[t],i.centroid.set(0,0,0),i.centroid.add(this.vertices[i.a]),i.centroid.add(this.vertices[i.b]),i.centroid.add(this.vertices[i.c]),i.centroid.divideScalar(3)},computeFaceNormals:function(){for(var t=new THREE.Vector3,e=new THREE.Vector3,i=0,n=this.faces.length;n>i;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,i,n,r,o,a;if(void 0===this.__tmpVertices){for(this.__tmpVertices=new Array(this.vertices.length),a=this.__tmpVertices,e=0,i=this.vertices.length;i>e;e++)a[e]=new THREE.Vector3;for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]}else for(a=this.__tmpVertices,e=0,i=this.vertices.length;i>e;e++)a[e].set(0,0,0);if(t){{var s,l,h,c=new THREE.Vector3,u=new THREE.Vector3;new THREE.Vector3,new THREE.Vector3,new THREE.Vector3}for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],s=this.vertices[o.a],l=this.vertices[o.b],h=this.vertices[o.c],c.subVectors(h,l),u.subVectors(s,l),c.cross(u),a[o.a].add(c),a[o.b].add(c),a[o.c].add(c)}else for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,i=this.vertices.length;i>e;e++)a[e].normalize();for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o.vertexNormals[0].copy(a[o.a]),o.vertexNormals[1].copy(a[o.b]),o.vertexNormals[2].copy(a[o.c])},computeMorphNormals:function(){var t,e,i,n,r;for(i=0,n=this.faces.length;n>i;i++)for(r=this.faces[i],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;e>t;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var o=new THREE.Geometry;for(o.faces=this.faces,t=0,e=this.morphTargets.length;e>t;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a,s,l=this.morphNormals[t].faceNormals,h=this.morphNormals[t].vertexNormals;for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],a=new THREE.Vector3,s={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},l.push(a),h.push(s)}var c=this.morphNormals[t];o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals();var a,s;for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],a=c.faceNormals[i],s=c.vertexNormals[i],a.copy(r.normal),s.a.copy(r.vertexNormals[0]),s.b.copy(r.vertexNormals[1]),s.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){function t(t,e,i,n,r,o,a){h=t.vertices[e],c=t.vertices[i],u=t.vertices[n],d=l[r],f=l[o],p=l[a],m=c.x-h.x,g=u.x-h.x,v=c.y-h.y,y=u.y-h.y,E=c.z-h.z,x=u.z-h.z,T=f.x-d.x,_=p.x-d.x,b=f.y-d.y,w=p.y-d.y,R=1/(T*w-_*b),P.set((w*m-b*g)*R,(w*v-b*y)*R,(w*E-b*x)*R),L.set((T*g-_*m)*R,(T*y-_*v)*R,(T*x-_*E)*R),C[e].add(P),C[i].add(P),C[n].add(P),A[e].add(L),A[i].add(L),A[n].add(L)}var e,i,n,r,o,a,s,l,h,c,u,d,f,p,m,g,v,y,E,x,T,_,b,w,R,S,M,H,C=[],A=[],P=new THREE.Vector3,L=new THREE.Vector3,O=new THREE.Vector3,D=new THREE.Vector3,z=new THREE.Vector3;for(n=0,r=this.vertices.length;r>n;n++)C[n]=new THREE.Vector3,A[n]=new THREE.Vector3;for(e=0,i=this.faces.length;i>e;e++)s=this.faces[e],l=this.faceVertexUvs[0][e],t(this,s.a,s.b,s.c,0,1,2);var N=["a","b","c","d"];for(e=0,i=this.faces.length;i>e;e++)for(s=this.faces[e],o=0;o<Math.min(s.vertexNormals.length,3);o++)z.copy(s.vertexNormals[o]),a=s[N[o]],S=C[a],O.copy(S),O.sub(z.multiplyScalar(z.dot(S))).normalize(),D.crossVectors(s.vertexNormals[o],S),M=D.dot(A[a]),H=0>M?-1:1,s.vertexTangents[o]=new THREE.Vector4(O.x,O.y,O.z,H);this.hasTangents=!0},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,n=e.length;n>i;i++)i>0&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var t,e,i,n,r,o,a,s,l={},h=[],c=[],u=4,d=Math.pow(10,u);for(this.__tmpVertices=void 0,i=0,n=this.vertices.length;n>i;i++)t=this.vertices[i],e=Math.round(t.x*d)+"_"+Math.round(t.y*d)+"_"+Math.round(t.z*d),void 0===l[e]?(l[e]=i,h.push(this.vertices[i]),c[i]=h.length-1):c[i]=c[l[e]];var f=[];for(i=0,n=this.faces.length;n>i;i++){r=this.faces[i],r.a=c[r.a],r.b=c[r.b],r.c=c[r.c],o=[r.a,r.b,r.c];for(var p=-1,m=0;3>m;m++)if(o[m]==o[(m+1)%3]){p=m,f.push(i);break}}for(i=f.length-1;i>=0;i--)for(this.faces.splice(i,1),a=0,s=this.faceVertexUvs.length;s>a;a++)this.faceVertexUvs[a].splice(i,1);var g=this.vertices.length-h.length;return this.vertices=h,g},clone:function(){for(var t=new THREE.Geometry,e=this.vertices,i=0,n=e.length;n>i;i++)t.vertices.push(e[i].clone());for(var r=this.faces,i=0,n=r.length;n>i;i++)t.faces.push(r[i].clone());for(var o=this.faceVertexUvs[0],i=0,n=o.length;n>i;i++){for(var a=o[i],s=[],l=0,h=a.length;h>l;l++)s.push(new THREE.Vector2(a[l].x,a[l].y));t.faceVertexUvs[0].push(s)}return t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.attributes={},this.dynamic=!0,this.offsets=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.morphTargets=[]},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,applyMatrix:function(t){var e,i;if(this.attributes.position&&(e=this.attributes.position.array),this.attributes.normal&&(i=this.attributes.normal.array),void 0!==e&&(t.multiplyVector3Array(e),this.verticesNeedUpdate=!0),void 0!==i){var n=(new THREE.Matrix3).getNormalMatrix(t);n.multiplyVector3Array(i),this.normalizeNormals(),this.normalsNeedUpdate=!0}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var t=this.attributes.position.array;if(t){var e,i,n,r=this.boundingBox;t.length>=3&&(r.min.x=r.max.x=t[0],r.min.y=r.max.y=t[1],r.min.z=r.max.z=t[2]);for(var o=3,a=t.length;a>o;o+=3)e=t[o],i=t[o+1],n=t[o+2],e<r.min.x?r.min.x=e:e>r.max.x&&(r.max.x=e),i<r.min.y?r.min.y=i:i>r.max.y&&(r.max.y=i),n<r.min.z?r.min.z=n:n>r.max.z&&(r.max.z=n)}(void 0===t||0===t.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0))},computeBoundingSphere:function(){var t=new THREE.Box3,e=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var i=this.attributes.position.array;if(i){for(var n=this.boundingSphere.center,r=0,o=i.length;o>r;r+=3)e.set(i[r],i[r+1],i[r+2]),t.addPoint(e);t.center(n);for(var a=0,r=0,o=i.length;o>r;r+=3)e.set(i[r],i[r+1],i[r+2]),a=Math.max(a,n.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(a)}}}(),computeVertexNormals:function(){if(this.attributes.position){var t,e,i,n,r=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(r)};else for(t=0,e=this.attributes.normal.array.length;e>t;t++)this.attributes.normal.array[t]=0;var o,a,s,l,h,c,u=this.attributes.position.array,d=this.attributes.normal.array,f=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3,g=new THREE.Vector3,v=new THREE.Vector3;if(this.attributes.index){var y=this.attributes.index.array,E=this.offsets;for(i=0,n=E.length;n>i;++i){var x=E[i].start,T=E[i].count,_=E[i].index;for(t=x,e=x+T;e>t;t+=3)o=_+y[t],a=_+y[t+1],s=_+y[t+2],l=u[3*o],h=u[3*o+1],c=u[3*o+2],f.set(l,h,c),l=u[3*a],h=u[3*a+1],c=u[3*a+2],p.set(l,h,c),l=u[3*s],h=u[3*s+1],c=u[3*s+2],m.set(l,h,c),g.subVectors(m,p),v.subVectors(f,p),g.cross(v),d[3*o]+=g.x,d[3*o+1]+=g.y,d[3*o+2]+=g.z,d[3*a]+=g.x,d[3*a+1]+=g.y,d[3*a+2]+=g.z,d[3*s]+=g.x,d[3*s+1]+=g.y,d[3*s+2]+=g.z}}else for(t=0,e=u.length;e>t;t+=9)l=u[t],h=u[t+1],c=u[t+2],f.set(l,h,c),l=u[t+3],h=u[t+4],c=u[t+5],p.set(l,h,c),l=u[t+6],h=u[t+7],c=u[t+8],m.set(l,h,c),g.subVectors(m,p),v.subVectors(f,p),g.cross(v),d[t]=g.x,d[t+1]=g.y,d[t+2]=g.z,d[t+3]=g.x,d[t+4]=g.y,d[t+5]=g.z,d[t+6]=g.x,d[t+7]=g.y,d[t+8]=g.z;this.normalizeNormals(),this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var t,e,i,n,r=this.attributes.normal.array,o=0,a=r.length;a>o;o+=3)t=r[o],e=r[o+1],i=r[o+2],n=1/Math.sqrt(t*t+e*e+i*i),r[o]*=n,r[o+1]*=n,r[o+2]*=n},computeTangents:function(){function t(t,e,i){d=n[3*t],f=n[3*t+1],p=n[3*t+2],m=n[3*e],g=n[3*e+1],v=n[3*e+2],y=n[3*i],E=n[3*i+1],x=n[3*i+2],T=o[2*t],_=o[2*t+1],b=o[2*e],w=o[2*e+1],R=o[2*i],S=o[2*i+1],M=m-d,H=y-d,C=g-f,A=E-f,P=v-p,L=x-p,O=b-T,D=R-T,z=w-_,N=S-_,F=1/(O*N-D*z),W.set((N*M-z*H)*F,(N*C-z*A)*F,(N*P-z*L)*F),X.set((O*H-D*M)*F,(O*A-D*C)*F,(O*L-D*P)*F),h[t].add(W),h[e].add(W),h[i].add(W),c[t].add(X),c[e].add(X),c[i].add(X)}function e(t){ie.x=r[3*t],ie.y=r[3*t+1],ie.z=r[3*t+2],ne.copy(ie),Z=h[t],te.copy(Z),te.sub(ie.multiplyScalar(ie.dot(Z))).normalize(),ee.crossVectors(ne,Z),J=ee.dot(c[t]),Q=0>J?-1:1,l[4*t]=te.x,l[4*t+1]=te.y,l[4*t+2]=te.z,l[4*t+3]=Q}if(void 0!==this.attributes.index&&void 0!==this.attributes.position&&void 0!==this.attributes.normal&&void 0!==this.attributes.uv){var i=this.attributes.index.array,n=this.attributes.position.array,r=this.attributes.normal.array,o=this.attributes.uv.array,a=n.length/3;if(void 0===this.attributes.tangent){var s=4*a;this.attributes.tangent={itemSize:4,array:new Float32Array(s)}}for(var l=this.attributes.tangent.array,h=[],c=[],u=0;a>u;u++)h[u]=new THREE.Vector3,c[u]=new THREE.Vector3;var d,f,p,m,g,v,y,E,x,T,_,b,w,R,S,M,H,C,A,P,L,O,D,z,N,F,U,I,k,V,B,j,G,W=new THREE.Vector3,X=new THREE.Vector3,q=this.offsets;for(k=0,V=q.length;V>k;++k){var Y=q[k].start,K=q[k].count,$=q[k].index;for(U=Y,I=Y+K;I>U;U+=3)B=$+i[U],j=$+i[U+1],G=$+i[U+2],t(B,j,G)}var Q,Z,J,te=new THREE.Vector3,ee=new THREE.Vector3,ie=new THREE.Vector3,ne=new THREE.Vector3;for(k=0,V=q.length;V>k;++k){var Y=q[k].start,K=q[k].count,$=q[k].index;for(U=Y,I=Y+K;I>U;U+=3)B=$+i[U],j=$+i[U+1],G=$+i[U+2],e(B),e(j),e(G)}this.hasTangents=!0,this.tangentsNeedUpdate=!0}},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4,this.projectionMatrixInverse=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.lookAt=function(){var t=new THREE.Matrix4;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)
}}(),THREE.Camera.prototype.clone=function(t){return void 0===t&&(t=new THREE.Camera),THREE.Object3D.prototype.clone.call(this,t),t.matrixWorldInverse.copy(this.matrixWorldInverse),t.projectionMatrix.copy(this.projectionMatrix),t.projectionMatrixInverse.copy(this.projectionMatrixInverse),t},THREE.OrthographicCamera=function(t,e,i,n,r,o){THREE.Camera.call(this),this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.OrthographicCamera.prototype.clone=function(){var t=new THREE.OrthographicCamera;return THREE.Camera.prototype.clone.call(this,t),t.left=this.left,t.right=this.right,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t},THREE.PerspectiveCamera=function(t,e,i,n){THREE.Camera.call(this),this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*THREE.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(t,e,i,n,r,o){this.fullWidth=t,this.fullHeight=e,this.x=i,this.y=n,this.width=r,this.height=o,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var t=this.fullWidth/this.fullHeight,e=Math.tan(THREE.Math.degToRad(.5*this.fov))*this.near,i=-e,n=t*i,r=t*e,o=Math.abs(r-n),a=Math.abs(e-i);this.projectionMatrix.makeFrustum(n+this.x*o/this.fullWidth,n+(this.x+this.width)*o/this.fullWidth,e-(this.y+this.height)*a/this.fullHeight,e-this.y*a/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.PerspectiveCamera.prototype.clone=function(){var t=new THREE.PerspectiveCamera;return THREE.Camera.prototype.clone.call(this,t),t.fov=this.fov,t.aspect=this.aspect,t.near=this.near,t.far=this.far,t},THREE.Light=function(t){THREE.Object3D.call(this),this.color=new THREE.Color(t)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.clone=function(t){return void 0===t&&(t=new THREE.Light),THREE.Object3D.prototype.clone.call(this,t),t.color.copy(this.color),t},THREE.AmbientLight=function(t){THREE.Light.call(this,t)},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.clone=function(){var t=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,t),t},THREE.AreaLight=function(t,e){THREE.Light.call(this,t),this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=void 0!==e?e:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight=function(t,e){THREE.Light.call(this,t),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==e?e:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.clone=function(){var t=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,t),t.target=this.target.clone(),t.intensity=this.intensity,t.castShadow=this.castShadow,t.onlyShadow=this.onlyShadow,t},THREE.HemisphereLight=function(t,e,i){THREE.Light.call(this,t),this.position.set(0,100,0),this.groundColor=new THREE.Color(e),this.intensity=void 0!==i?i:1},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.clone=function(){var t=new THREE.HemisphereLight;return THREE.Light.prototype.clone.call(this,t),t.groundColor.copy(this.groundColor),t.intensity=this.intensity,t},THREE.PointLight=function(t,e,i){THREE.Light.call(this,t),this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.clone=function(){var t=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,t),t.intensity=this.intensity,t.distance=this.distance,t},THREE.SpotLight=function(t,e,i,n,r){THREE.Light.call(this,t),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.exponent=void 0!==r?r:10,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.clone=function(){var t=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,t),t.target=this.target.clone(),t.intensity=this.intensity,t.distance=this.distance,t.angle=this.angle,t.exponent=this.exponent,t.castShadow=this.castShadow,t.onlyShadow=this.onlyShadow,t},THREE.Loader=function(t){this.showStatus=t,this.statusDomElement=t?THREE.Loader.prototype.addStatusElement():null,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var t=document.createElement("div");return t.style.position="absolute",t.style.right="0px",t.style.top="0px",t.style.fontSize="0.8em",t.style.textAlign="left",t.style.background="rgba(0,0,0,0.25)",t.style.color="#fff",t.style.width="120px",t.style.padding="0.5em 0.5em 0.5em 0.5em",t.style.zIndex=1e3,t.innerHTML="Loading ...",t},updateProgress:function(t){var e="Loaded ";e+=t.total?(100*t.loaded/t.total).toFixed(0)+"%":(t.loaded/1e3).toFixed(2)+" KB",this.statusDomElement.innerHTML=e},extractUrlBase:function(t){var e=t.split("/");return e.pop(),(e.length<1?".":e.join("/"))+"/"},initMaterials:function(t,e){for(var i=[],n=0;n<t.length;++n)i[n]=THREE.Loader.prototype.createMaterial(t[n],e);return i},needsTangents:function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];if(n instanceof THREE.ShaderMaterial)return!0}return!1},createMaterial:function(t,e){function i(t){var e=Math.log(t)/Math.LN2;return Math.floor(e)==e}function n(t){var e=Math.log(t)/Math.LN2;return Math.pow(2,Math.round(e))}function r(t,e){var r=new Image;r.onload=function(){if(i(this.width)&&i(this.height))t.image=this;else{var e=n(this.width),r=n(this.height);t.image.width=e,t.image.height=r,t.image.getContext("2d").drawImage(this,0,0,e,r)}t.needsUpdate=!0},r.crossOrigin=s.crossOrigin,r.src=e}function o(t,i,n,o,a,s,l){var h=/\.dds$/i.test(n),c=e+"/"+n;if(h){var u=THREE.ImageUtils.loadCompressedTexture(c);t[i]=u}else{var u=document.createElement("canvas");t[i]=new THREE.Texture(u)}if(t[i].sourceFile=n,o&&(t[i].repeat.set(o[0],o[1]),1!==o[0]&&(t[i].wrapS=THREE.RepeatWrapping),1!==o[1]&&(t[i].wrapT=THREE.RepeatWrapping)),a&&t[i].offset.set(a[0],a[1]),s){var d={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};void 0!==d[s[0]]&&(t[i].wrapS=d[s[0]]),void 0!==d[s[1]]&&(t[i].wrapT=d[s[1]])}l&&(t[i].anisotropy=l),h||r(t[i],c)}function a(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]}var s=this,l="MeshLambertMaterial",h={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(t.shading){var c=t.shading.toLowerCase();"phong"===c?l="MeshPhongMaterial":"basic"===c&&(l="MeshBasicMaterial")}if(void 0!==t.blending&&void 0!==THREE[t.blending]&&(h.blending=THREE[t.blending]),(void 0!==t.transparent||t.opacity<1)&&(h.transparent=t.transparent),void 0!==t.depthTest&&(h.depthTest=t.depthTest),void 0!==t.depthWrite&&(h.depthWrite=t.depthWrite),void 0!==t.visible&&(h.visible=t.visible),void 0!==t.flipSided&&(h.side=THREE.BackSide),void 0!==t.doubleSided&&(h.side=THREE.DoubleSide),void 0!==t.wireframe&&(h.wireframe=t.wireframe),void 0!==t.vertexColors&&("face"===t.vertexColors?h.vertexColors=THREE.FaceColors:t.vertexColors&&(h.vertexColors=THREE.VertexColors)),t.colorDiffuse?h.color=a(t.colorDiffuse):t.DbgColor&&(h.color=t.DbgColor),t.colorSpecular&&(h.specular=a(t.colorSpecular)),t.colorAmbient&&(h.ambient=a(t.colorAmbient)),t.transparency&&(h.opacity=t.transparency),t.specularCoef&&(h.shininess=t.specularCoef),t.mapDiffuse&&e&&o(h,"map",t.mapDiffuse,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy),t.mapLight&&e&&o(h,"lightMap",t.mapLight,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy),t.mapBump&&e&&o(h,"bumpMap",t.mapBump,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy),t.mapNormal&&e&&o(h,"normalMap",t.mapNormal,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy),t.mapSpecular&&e&&o(h,"specularMap",t.mapSpecular,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy),t.mapBumpScale&&(h.bumpScale=t.mapBumpScale),t.mapNormal){var u=THREE.ShaderLib.normalmap,d=THREE.UniformsUtils.clone(u.uniforms);d.tNormal.value=h.normalMap,t.mapNormalFactor&&d.uNormalScale.value.set(t.mapNormalFactor,t.mapNormalFactor),h.map&&(d.tDiffuse.value=h.map,d.enableDiffuse.value=!0),h.specularMap&&(d.tSpecular.value=h.specularMap,d.enableSpecular.value=!0),h.lightMap&&(d.tAO.value=h.lightMap,d.enableAO.value=!0),d.uDiffuseColor.value.setHex(h.color),d.uSpecularColor.value.setHex(h.specular),d.uAmbientColor.value.setHex(h.ambient),d.uShininess.value=h.shininess,void 0!==h.opacity&&(d.uOpacity.value=h.opacity);var f={fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:d,lights:!0,fog:!0},p=new THREE.ShaderMaterial(f);h.transparent&&(p.transparent=!0)}else var p=new THREE[l](h);return void 0!==t.DbgName&&(p.name=t.DbgName),p}},THREE.XHRLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(t,e,i,n){var r=this,o=new XMLHttpRequest;void 0!==e&&o.addEventListener("load",function(i){e(i.target.responseText),r.manager.itemEnd(t)},!1),void 0!==i&&o.addEventListener("progress",function(t){i(t)},!1),void 0!==n&&o.addEventListener("error",function(t){n(t)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.open("GET",t,!0),o.send(null),r.manager.itemStart(t)},setCrossOrigin:function(t){this.crossOrigin=t}},THREE.ImageLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(t,e,i,n){var r=this,o=document.createElement("img");void 0!==e&&o.addEventListener("load",function(){r.manager.itemEnd(t),e(this)},!1),void 0!==i&&o.addEventListener("progress",function(t){i(t)},!1),void 0!==n&&o.addEventListener("error",function(t){n(t)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.src=t,r.manager.itemStart(t)},setCrossOrigin:function(t){this.crossOrigin=t}},THREE.JSONLoader=function(t){THREE.Loader.call(this,t),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.load=function(t,e,i){i=i&&"string"==typeof i?i:this.extractUrlBase(t),this.onLoadStart(),this.loadAjaxJSON(this,t,e,i)},THREE.JSONLoader.prototype.loadAjaxJSON=function(t,e,i,n,r){var o=new XMLHttpRequest,a=0;o.onreadystatechange=function(){if(o.readyState===o.DONE){if(200===o.status||0===o.status){if(o.responseText){var e=JSON.parse(o.responseText),s=t.parse(e,n);i(s.geometry,s.materials)}t.onLoadComplete()}}else o.readyState===o.LOADING?r&&(0===a&&(a=o.getResponseHeader("Content-Length")),r({total:a,loaded:o.responseText.length})):o.readyState===o.HEADERS_RECEIVED&&void 0!==r&&(a=o.getResponseHeader("Content-Length"))},o.open("GET",e,!0),o.withCredentials=this.withCredentials,o.send(null)},THREE.JSONLoader.prototype.parse=function(t,e){function i(e){function i(t,e){return t&1<<e}var n,r,a,s,l,h,c,u,d,f,p,m,g,v,y,E,x,T,_,b,w,R,S,M,H,C,A,P=t.faces,L=t.vertices,O=t.normals,D=t.colors,z=0;if(void 0!==t.uvs){for(n=0;n<t.uvs.length;n++)t.uvs[n].length&&z++;for(n=0;z>n;n++)o.faceVertexUvs[n]=[]}for(s=0,l=L.length;l>s;)T=new THREE.Vector3,T.x=L[s++]*e,T.y=L[s++]*e,T.z=L[s++]*e,o.vertices.push(T);for(s=0,l=P.length;l>s;)if(f=P[s++],p=i(f,0),m=i(f,1),g=i(f,3),v=i(f,4),y=i(f,5),E=i(f,6),x=i(f,7),p){if(b=new THREE.Face3,b.a=P[s],b.b=P[s+1],b.c=P[s+3],w=new THREE.Face3,w.a=P[s+1],w.b=P[s+2],w.c=P[s+3],s+=4,m&&(d=P[s++],b.materialIndex=d,w.materialIndex=d),a=o.faces.length,g)for(n=0;z>n;n++)for(M=t.uvs[n],o.faceVertexUvs[n][a]=[],o.faceVertexUvs[n][a+1]=[],r=0;4>r;r++)u=P[s++],C=M[2*u],A=M[2*u+1],H=new THREE.Vector2(C,A),2!==r&&o.faceVertexUvs[n][a].push(H),0!==r&&o.faceVertexUvs[n][a+1].push(H);if(v&&(c=3*P[s++],b.normal.set(O[c++],O[c++],O[c]),w.normal.copy(b.normal)),y)for(n=0;4>n;n++)c=3*P[s++],S=new THREE.Vector3(O[c++],O[c++],O[c]),2!==n&&b.vertexNormals.push(S),0!==n&&w.vertexNormals.push(S);if(E&&(h=P[s++],R=D[h],b.color.setHex(R),w.color.setHex(R)),x)for(n=0;4>n;n++)h=P[s++],R=D[h],2!==n&&b.vertexColors.push(new THREE.Color(R)),0!==n&&w.vertexColors.push(new THREE.Color(R));o.faces.push(b),o.faces.push(w)}else{if(_=new THREE.Face3,_.a=P[s++],_.b=P[s++],_.c=P[s++],m&&(d=P[s++],_.materialIndex=d),a=o.faces.length,g)for(n=0;z>n;n++)for(M=t.uvs[n],o.faceVertexUvs[n][a]=[],r=0;3>r;r++)u=P[s++],C=M[2*u],A=M[2*u+1],H=new THREE.Vector2(C,A),o.faceVertexUvs[n][a].push(H);if(v&&(c=3*P[s++],_.normal.set(O[c++],O[c++],O[c])),y)for(n=0;3>n;n++)c=3*P[s++],S=new THREE.Vector3(O[c++],O[c++],O[c]),_.vertexNormals.push(S);if(E&&(h=P[s++],_.color.setHex(D[h])),x)for(n=0;3>n;n++)h=P[s++],_.vertexColors.push(new THREE.Color(D[h]));o.faces.push(_)}}function n(){var e,i,n,r,a,s,l,h,c,u;if(t.skinWeights)for(e=0,i=t.skinWeights.length;i>e;e+=2)n=t.skinWeights[e],r=t.skinWeights[e+1],a=0,s=0,o.skinWeights.push(new THREE.Vector4(n,r,a,s));if(t.skinIndices)for(e=0,i=t.skinIndices.length;i>e;e+=2)l=t.skinIndices[e],h=t.skinIndices[e+1],c=0,u=0,o.skinIndices.push(new THREE.Vector4(l,h,c,u));o.bones=t.bones,o.animation=t.animation}function r(e){if(void 0!==t.morphTargets){var i,n,r,a,s,l;for(i=0,n=t.morphTargets.length;n>i;i++)for(o.morphTargets[i]={},o.morphTargets[i].name=t.morphTargets[i].name,o.morphTargets[i].vertices=[],s=o.morphTargets[i].vertices,l=t.morphTargets[i].vertices,r=0,a=l.length;a>r;r+=3){var h=new THREE.Vector3;h.x=l[r]*e,h.y=l[r+1]*e,h.z=l[r+2]*e,s.push(h)}}if(void 0!==t.morphColors){var i,n,c,u,d,f,p;for(i=0,n=t.morphColors.length;n>i;i++)for(o.morphColors[i]={},o.morphColors[i].name=t.morphColors[i].name,o.morphColors[i].colors=[],d=o.morphColors[i].colors,f=t.morphColors[i].colors,c=0,u=f.length;u>c;c+=3)p=new THREE.Color(16755200),p.setRGB(f[c],f[c+1],f[c+2]),d.push(p)}}var o=new THREE.Geometry,a=void 0!==t.scale?1/t.scale:1;if(i(a),n(),r(a),o.computeCentroids(),o.computeFaceNormals(),o.computeBoundingSphere(),void 0===t.materials)return{geometry:o};var s=this.initMaterials(t.materials,e);return this.needsTangents(s)&&o.computeTangents(),{geometry:o,materials:s}},THREE.LoadingManager=function(t,e,i){var n=this,r=0,o=0;this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(){o++},this.itemEnd=function(t){r++,void 0!==n.onProgress&&n.onProgress(t,r,o),r===o&&void 0!==n.onLoad&&n.onLoad()}},THREE.DefaultLoadingManager=new THREE.LoadingManager,THREE.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(t,e){var i=this,n=new THREE.XHRLoader;n.setCrossOrigin(this.crossOrigin),n.load(t,function(t){e(i.parse(JSON.parse(t)))})},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=new THREE.BufferGeometry,i=t.attributes,n=t.offsets,r=t.boundingSphere;for(var o in i){var a=i[o];e.attributes[o]={itemSize:a.itemSize,array:new self[a.type](a.array)}}return void 0!==n&&(e.offsets=JSON.parse(JSON.stringify(n))),void 0!==r&&(e.boundingSphere=new THREE.Sphere((new THREE.Vector3).fromArray(void 0!==r.center?r.center:[0,0,0]),r.radius)),e}},THREE.GeometryLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(t,e){var i=this,n=new THREE.XHRLoader;n.setCrossOrigin(this.crossOrigin),n.load(t,function(t){e(i.parse(JSON.parse(t)))})},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(){}},THREE.MaterialLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(t,e){var i=this,n=new THREE.XHRLoader;n.setCrossOrigin(this.crossOrigin),n.load(t,function(t){e(i.parse(JSON.parse(t)))})},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=new THREE[t.type];if(void 0!==t.color&&e.color.setHex(t.color),void 0!==t.ambient&&e.ambient.setHex(t.ambient),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.materials)for(var i=0,n=t.materials.length;n>i;i++)e.materials.push(this.parse(t.materials[i]));return e}},THREE.ObjectLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(t,e){var i=this,n=new THREE.XHRLoader(i.manager);n.setCrossOrigin(this.crossOrigin),n.load(t,function(t){e(i.parse(JSON.parse(t)))})},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=this.parseGeometries(t.geometries),i=this.parseMaterials(t.materials),n=this.parseObject(t.object,e,i);return n},parseGeometries:function(t){var e={};if(void 0!==t)for(var i=new THREE.JSONLoader,n=new THREE.BufferGeometryLoader,r=0,o=t.length;o>r;r++){var a,s=t[r];switch(s.type){case"PlaneGeometry":a=new THREE.PlaneGeometry(s.width,s.height,s.widthSegments,s.heightSegments);break;case"CubeGeometry":a=new THREE.CubeGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CylinderGeometry":a=new THREE.CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radiusSegments,s.heightSegments,s.openEnded);break;case"SphereGeometry":a=new THREE.SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"IcosahedronGeometry":a=new THREE.IcosahedronGeometry(s.radius,s.detail);break;case"TorusGeometry":a=new THREE.TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":a=new THREE.TorusKnotGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.p,s.q,s.heightScale);break;case"BufferGeometry":a=n.parse(s.data);break;case"Geometry":a=i.parse(s.data).geometry}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t){var e={};if(void 0!==t)for(var i=new THREE.MaterialLoader,n=0,r=t.length;r>n;n++){var o=t[n],a=i.parse(o);a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),e[o.uuid]=a}return e},parseObject:function(){var t=new THREE.Matrix4;return function(e,i,n){var r;switch(e.type){case"Scene":r=new THREE.Scene;break;case"PerspectiveCamera":r=new THREE.PerspectiveCamera(e.fov,e.aspect,e.near,e.far);break;case"OrthographicCamera":r=new THREE.OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":r=new THREE.AmbientLight(e.color);break;case"DirectionalLight":r=new THREE.DirectionalLight(e.color,e.intensity);break;case"PointLight":r=new THREE.PointLight(e.color,e.intensity,e.distance);break;case"SpotLight":r=new THREE.SpotLight(e.color,e.intensity,e.distance,e.angle,e.exponent);break;case"HemisphereLight":r=new THREE.HemisphereLight(e.color,e.groundColor,e.intensity);break;case"Mesh":var o=i[e.geometry],a=n[e.material];r=new THREE.Mesh(o,a);break;default:r=new THREE.Object3D}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.children)for(var s in e.children)r.add(this.parseObject(e.children[s],i,n));return r}}()},THREE.SceneLoader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){},this.callbackSync=function(){},this.callbackProgress=function(){},this.geometryHandlers={},this.hierarchyHandlers={},this.addGeometryHandler("ascii",THREE.JSONLoader)},THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(t,e){var i=this,n=new THREE.XHRLoader(i.manager);n.setCrossOrigin(this.crossOrigin),n.load(t,function(n){i.parse(JSON.parse(n),e,t)})},setCrossOrigin:function(t){this.crossOrigin=t},addGeometryHandler:function(t,e){this.geometryHandlers[t]={loaderClass:e}},addHierarchyHandler:function(t,e){this.hierarchyHandlers[t]={loaderClass:e}},parse:function(t,e,i){function n(t,e){return"relativeToHTML"==e?t:C+"/"+t}function r(){o(M.scene,P.objects)}function o(t,e){var i,r,a,s,l,c;for(var u in e){var d=M.objects[u],f=e[u];if(void 0===d){if(f.type&&f.type in H.hierarchyHandlers){if(void 0===f.loading){var v={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1},y={};for(var E in f)E in v||(y[E]=f[E]);m=M.materials[f.material],f.loading=!0;var b=H.hierarchyHandlers[f.type].loaderObject;b.options?b.load(n(f.url,P.urlBaseType),h(u,t,m,f)):b.load(n(f.url,P.urlBaseType),h(u,t,m,f),y)}}else if(void 0!==f.geometry){if(p=M.geometries[f.geometry]){var w=!1;if(m=M.materials[f.material],w=m instanceof THREE.ShaderMaterial,a=f.position,s=f.rotation,l=f.scale,i=f.matrix,c=f.quaternion,f.material||(m=new THREE.MeshFaceMaterial(M.face_materials[f.geometry])),m instanceof THREE.MeshFaceMaterial&&0===m.materials.length&&(m=new THREE.MeshFaceMaterial(M.face_materials[f.geometry])),m instanceof THREE.MeshFaceMaterial)for(var R=0;R<m.materials.length;R++)w=w||m.materials[R]instanceof THREE.ShaderMaterial;w&&p.computeTangents(),f.skin?d=new THREE.SkinnedMesh(p,m):f.morph?(d=new THREE.MorphAnimMesh(p,m),void 0!==f.duration&&(d.duration=f.duration),void 0!==f.time&&(d.time=f.time),void 0!==f.mirroredLoop&&(d.mirroredLoop=f.mirroredLoop),m.morphNormals&&p.computeMorphNormals()):d=new THREE.Mesh(p,m),d.name=u,i?(d.matrixAutoUpdate=!1,d.matrix.set(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])):(d.position.fromArray(a),c?d.quaternion.fromArray(c):d.rotation.fromArray(s),d.scale.fromArray(l)),d.visible=f.visible,d.castShadow=f.castShadow,d.receiveShadow=f.receiveShadow,t.add(d),M.objects[u]=d}}else"DirectionalLight"===f.type||"PointLight"===f.type||"AmbientLight"===f.type?(T=void 0!==f.color?f.color:16777215,_=void 0!==f.intensity?f.intensity:1,"DirectionalLight"===f.type?(a=f.direction,x=new THREE.DirectionalLight(T,_),x.position.fromArray(a),f.target&&(A.push({object:x,targetName:f.target}),x.target=null)):"PointLight"===f.type?(a=f.position,r=f.distance,x=new THREE.PointLight(T,_,r),x.position.fromArray(a)):"AmbientLight"===f.type&&(x=new THREE.AmbientLight(T)),t.add(x),x.name=u,M.lights[u]=x,M.objects[u]=x):"PerspectiveCamera"===f.type||"OrthographicCamera"===f.type?(a=f.position,s=f.rotation,c=f.quaternion,"PerspectiveCamera"===f.type?g=new THREE.PerspectiveCamera(f.fov,f.aspect,f.near,f.far):"OrthographicCamera"===f.type&&(g=new THREE.OrthographicCamera(f.left,f.right,f.top,f.bottom,f.near,f.far)),g.name=u,g.position.fromArray(a),void 0!==c?g.quaternion.fromArray(c):void 0!==s&&g.rotation.fromArray(s),t.add(g),M.cameras[u]=g,M.objects[u]=g):(a=f.position,s=f.rotation,l=f.scale,c=f.quaternion,d=new THREE.Object3D,d.name=u,d.position.fromArray(a),c?d.quaternion.fromArray(c):d.rotation.fromArray(s),d.scale.fromArray(l),d.visible=void 0!==f.visible?f.visible:!1,t.add(d),M.objects[u]=d,M.empties[u]=d);if(d){if(void 0!==f.userData)for(var S in f.userData){var C=f.userData[S];d.userData[S]=C}if(void 0!==f.groups)for(var R=0;R<f.groups.length;R++){var L=f.groups[R];void 0===M.groups[L]&&(M.groups[L]=[]),M.groups[L].push(u)}}}void 0!==d&&void 0!==f.children&&o(d,f.children)}}function a(t,e,i){M.geometries[i]=t,M.face_materials[i]=e,r()}function s(t,e,i,n,o){var a=o.position,s=o.rotation,l=o.quaternion,h=o.scale;t.position.fromArray(a),l?t.quaternion.fromArray(l):t.rotation.fromArray(s),t.scale.fromArray(h),n&&t.traverse(function(t){t.material=n});var c=void 0!==o.visible?o.visible:!0;t.traverse(function(t){t.visible=c}),i.add(t),t.name=e,M.objects[e]=t,r()}function l(t){return function(e,i){e.name=t,a(e,i,t),b-=1,H.onLoadComplete(),u()}}function h(t,e,i,n){return function(r){var o;o=r.content?r.content:r.dae?r.scene:r,s(o,t,e,i,n),b-=1,H.onLoadComplete(),u()}}function c(t){return function(e,i){e.name=t,M.geometries[t]=e,M.face_materials[t]=i}}function u(){var t={totalModels:R,totalTextures:S,loadedModels:R-b,loadedTextures:S-w};H.callbackProgress(t,M),H.onLoadProgress(),0===b&&0===w&&(d(),e(M))}function d(){for(var t=0;t<A.length;t++){var e=A[t],i=M.objects[e.targetName];i?e.object.target=i:(e.object.target=new THREE.Object3D,M.scene.add(e.object.target)),e.object.target.userData.targetInverse=e.object}}function f(t,e){if(e(t),void 0!==t.children)for(var i in t.children)f(t.children[i],e)}var p,m,g,v,y,E,x,T,_,b,w,R,S,M,H=this,C=THREE.Loader.prototype.extractUrlBase(i),A=[],P=t;for(var L in this.geometryHandlers){var O=this.geometryHandlers[L].loaderClass;this.geometryHandlers[L].loaderObject=new O}for(var L in this.hierarchyHandlers){var O=this.hierarchyHandlers[L].loaderClass;this.hierarchyHandlers[L].loaderObject=new O}if(b=0,w=0,M={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}},P.transform){var D=P.transform.position,z=P.transform.rotation,N=P.transform.scale;D&&M.scene.position.fromArray(D),z&&M.scene.rotation.fromArray(z),N&&M.scene.scale.fromArray(N),(D||z||N)&&(M.scene.updateMatrix(),M.scene.updateMatrixWorld())}var F,U,I=function(t){w-=t,u(),H.onLoadComplete()},k=function(t){return function(){I(t)}};for(F in P.fogs)U=P.fogs[F],"linear"===U.type?v=new THREE.Fog(0,U.near,U.far):"exp2"===U.type&&(v=new THREE.FogExp2(0,U.density)),E=U.color,v.color.setRGB(E[0],E[1],E[2]),M.fogs[F]=v;var V,B;for(V in P.geometries)B=P.geometries[V],B.type in this.geometryHandlers&&(b+=1,H.onLoadStart());for(var j in P.objects)f(P.objects[j],function(t){t.type&&t.type in H.hierarchyHandlers&&(b+=1,H.onLoadStart())});R=b;for(V in P.geometries)if(B=P.geometries[V],"cube"===B.type)p=new THREE.CubeGeometry(B.width,B.height,B.depth,B.widthSegments,B.heightSegments,B.depthSegments),p.name=V,M.geometries[V]=p;else if("plane"===B.type)p=new THREE.PlaneGeometry(B.width,B.height,B.widthSegments,B.heightSegments),p.name=V,M.geometries[V]=p;else if("sphere"===B.type)p=new THREE.SphereGeometry(B.radius,B.widthSegments,B.heightSegments),p.name=V,M.geometries[V]=p;else if("cylinder"===B.type)p=new THREE.CylinderGeometry(B.topRad,B.botRad,B.height,B.radSegs,B.heightSegs),p.name=V,M.geometries[V]=p;else if("torus"===B.type)p=new THREE.TorusGeometry(B.radius,B.tube,B.segmentsR,B.segmentsT),p.name=V,M.geometries[V]=p;else if("icosahedron"===B.type)p=new THREE.IcosahedronGeometry(B.radius,B.subdivisions),p.name=V,M.geometries[V]=p;else if(B.type in this.geometryHandlers){var G={};for(var W in B)"type"!==W&&"url"!==W&&(G[W]=B[W]);var X=this.geometryHandlers[B.type].loaderObject;X.load(n(B.url,P.urlBaseType),l(V),G)}else if("embedded"===B.type){var q=P.embeds[B.id],Y="";if(q.metadata=P.metadata,q){var K=this.geometryHandlers.ascii.loaderObject,$=K.parse(q,Y);c(V)($.geometry,$.materials)}}var Q,Z;for(Q in P.textures)if(Z=P.textures[Q],Z.url instanceof Array){w+=Z.url.length;for(var J=0;J<Z.url.length;J++)H.onLoadStart()}else w+=1,H.onLoadStart();S=w;for(Q in P.textures){if(Z=P.textures[Q],void 0!==Z.mapping&&void 0!==THREE[Z.mapping]&&(Z.mapping=new THREE[Z.mapping]),Z.url instanceof Array){for(var te=Z.url.length,ee=[],ie=0;te>ie;ie++)ee[ie]=n(Z.url[ie],P.urlBaseType);var ne=/\.dds$/i.test(ee[0]);y=ne?THREE.ImageUtils.loadCompressedTextureCube(ee,Z.mapping,k(te)):THREE.ImageUtils.loadTextureCube(ee,Z.mapping,k(te))}else{var ne=/\.dds$/i.test(Z.url),re=n(Z.url,P.urlBaseType),oe=k(1);if(y=ne?THREE.ImageUtils.loadCompressedTexture(re,Z.mapping,oe):THREE.ImageUtils.loadTexture(re,Z.mapping,oe),void 0!==THREE[Z.minFilter]&&(y.minFilter=THREE[Z.minFilter]),void 0!==THREE[Z.magFilter]&&(y.magFilter=THREE[Z.magFilter]),Z.anisotropy&&(y.anisotropy=Z.anisotropy),Z.repeat&&(y.repeat.set(Z.repeat[0],Z.repeat[1]),1!==Z.repeat[0]&&(y.wrapS=THREE.RepeatWrapping),1!==Z.repeat[1]&&(y.wrapT=THREE.RepeatWrapping)),Z.offset&&y.offset.set(Z.offset[0],Z.offset[1]),Z.wrap){var ae={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};void 0!==ae[Z.wrap[0]]&&(y.wrapS=ae[Z.wrap[0]]),void 0!==ae[Z.wrap[1]]&&(y.wrapT=ae[Z.wrap[1]])}}M.textures[Q]=y}var se,le,he;for(se in P.materials){le=P.materials[se];for(he in le.parameters)if("envMap"===he||"map"===he||"lightMap"===he||"bumpMap"===he)le.parameters[he]=M.textures[le.parameters[he]];else if("shading"===he)le.parameters[he]="flat"===le.parameters[he]?THREE.FlatShading:THREE.SmoothShading;else if("side"===he)le.parameters[he]="double"==le.parameters[he]?THREE.DoubleSide:"back"==le.parameters[he]?THREE.BackSide:THREE.FrontSide;else if("blending"===he)le.parameters[he]=le.parameters[he]in THREE?THREE[le.parameters[he]]:THREE.NormalBlending;else if("combine"===he)le.parameters[he]=le.parameters[he]in THREE?THREE[le.parameters[he]]:THREE.MultiplyOperation;else if("vertexColors"===he)"face"==le.parameters[he]?le.parameters[he]=THREE.FaceColors:le.parameters[he]&&(le.parameters[he]=THREE.VertexColors);else if("wrapRGB"===he){var ce=le.parameters[he];le.parameters[he]=new THREE.Vector3(ce[0],ce[1],ce[2])}if(void 0!==le.parameters.opacity&&le.parameters.opacity<1&&(le.parameters.transparent=!0),le.parameters.normalMap){var ue=THREE.ShaderLib.normalmap,de=THREE.UniformsUtils.clone(ue.uniforms),fe=le.parameters.color,pe=le.parameters.specular,me=le.parameters.ambient,ge=le.parameters.shininess;de.tNormal.value=M.textures[le.parameters.normalMap],le.parameters.normalScale&&de.uNormalScale.value.set(le.parameters.normalScale[0],le.parameters.normalScale[1]),le.parameters.map&&(de.tDiffuse.value=le.parameters.map,de.enableDiffuse.value=!0),le.parameters.envMap&&(de.tCube.value=le.parameters.envMap,de.enableReflection.value=!0,de.uReflectivity.value=le.parameters.reflectivity),le.parameters.lightMap&&(de.tAO.value=le.parameters.lightMap,de.enableAO.value=!0),le.parameters.specularMap&&(de.tSpecular.value=M.textures[le.parameters.specularMap],de.enableSpecular.value=!0),le.parameters.displacementMap&&(de.tDisplacement.value=M.textures[le.parameters.displacementMap],de.enableDisplacement.value=!0,de.uDisplacementBias.value=le.parameters.displacementBias,de.uDisplacementScale.value=le.parameters.displacementScale),de.uDiffuseColor.value.setHex(fe),de.uSpecularColor.value.setHex(pe),de.uAmbientColor.value.setHex(me),de.uShininess.value=ge,le.parameters.opacity&&(de.uOpacity.value=le.parameters.opacity);
var ve={fragmentShader:ue.fragmentShader,vertexShader:ue.vertexShader,uniforms:de,lights:!0,fog:!0};m=new THREE.ShaderMaterial(ve)}else m=new THREE[le.type](le.parameters);m.name=se,M.materials[se]=m}for(se in P.materials)if(le=P.materials[se],le.parameters.materials){for(var ye=[],ie=0;ie<le.parameters.materials.length;ie++){var Ee=le.parameters.materials[ie];ye.push(M.materials[Ee])}M.materials[se].materials=ye}r(),M.cameras&&P.defaults.camera&&(M.currentCamera=M.cameras[P.defaults.camera]),M.fogs&&P.defaults.fog&&(M.scene.fog=M.fogs[P.defaults.fog]),H.callbackSync(M),u()}},THREE.TextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(t,e){var i=this,n=new THREE.ImageLoader(i.manager);n.setCrossOrigin(this.crossOrigin),n.load(t,function(t){var i=new THREE.Texture(t);i.needsUpdate=!0,void 0!==e&&e(i)})},setCrossOrigin:function(t){this.crossOrigin=t}},THREE.Material=function(){this.id=THREE.MaterialIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this.needsUpdate=!0},THREE.Material.prototype={constructor:THREE.Material,setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i&&e in this){var n=this[e];n instanceof THREE.Color?n.set(i):n instanceof THREE.Vector3&&i instanceof THREE.Vector3?n.copy(i):this[e]="overdraw"==e?Number(i):i}}},clone:function(t){return void 0===t&&(t=new THREE.Material),t.name=this.name,t.side=this.side,t.opacity=this.opacity,t.transparent=this.transparent,t.blending=this.blending,t.blendSrc=this.blendSrc,t.blendDst=this.blendDst,t.blendEquation=this.blendEquation,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.polygonOffset=this.polygonOffset,t.polygonOffsetFactor=this.polygonOffsetFactor,t.polygonOffsetUnits=this.polygonOffsetUnits,t.alphaTest=this.alphaTest,t.overdraw=this.overdraw,t.visible=this.visible,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.setValues(t)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.clone=function(){var t=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.linewidth=this.linewidth,t.linecap=this.linecap,t.linejoin=this.linejoin,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.LineDashedMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(t)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.clone=function(){var t=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.linewidth=this.linewidth,t.scale=this.scale,t.dashSize=this.dashSize,t.gapSize=this.gapSize,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.MeshBasicMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(t)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.clone=function(){var t=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t},THREE.MeshLambertMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.clone=function(){var t=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.ambient.copy(this.ambient),t.emissive.copy(this.emissive),t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.MeshPhongMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!0,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.clone=function(){var t=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.ambient.copy(this.ambient),t.emissive.copy(this.emissive),t.specular.copy(this.specular),t.shininess=this.shininess,t.metal=this.metal,t.perPixel=this.perPixel,t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.bumpMap=this.bumpMap,t.bumpScale=this.bumpScale,t.normalMap=this.normalMap,t.normalScale.copy(this.normalScale),t.specularMap=this.specularMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.MeshDepthMaterial=function(t){THREE.Material.call(this),this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.clone=function(){var t=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,t),t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t},THREE.MeshNormalMaterial=function(t){THREE.Material.call(this,t),this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.clone=function(){var t=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,t),t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t},THREE.MeshFaceMaterial=function(t){this.materials=t instanceof Array?t:[]},THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))},THREE.ParticleBasicMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=!1,this.fog=!0,this.setValues(t)},THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleBasicMaterial.prototype.clone=function(){var t=new THREE.ParticleBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.size=this.size,t.sizeAttenuation=this.sizeAttenuation,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.ParticleCanvasMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.program=function(){},this.setValues(t)},THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleCanvasMaterial.prototype.clone=function(){var t=new THREE.ParticleCanvasMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.program=this.program,t},THREE.ShaderMaterial=function(t){THREE.Material.call(this),this.fragmentShader="void main() {}",this.vertexShader="void main() {}",this.uniforms={},this.defines={},this.attributes=null,this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName="position",this.setValues(t)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.clone=function(){var t=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,t),t.fragmentShader=this.fragmentShader,t.vertexShader=this.vertexShader,t.uniforms=THREE.UniformsUtils.clone(this.uniforms),t.attributes=this.attributes,t.defines=this.defines,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.fog=this.fog,t.lights=this.lights,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.SpriteMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=new THREE.Texture,this.useScreenCoordinates=!0,this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.scaleByViewport=!this.sizeAttenuation,this.alignment=THREE.SpriteAlignment.center.clone(),this.fog=!1,this.uvOffset=new THREE.Vector2(0,0),this.uvScale=new THREE.Vector2(1,1),this.setValues(t),t=t||{},void 0===t.depthTest&&(this.depthTest=!this.useScreenCoordinates),void 0===t.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates),void 0===t.scaleByViewport&&(this.scaleByViewport=!this.sizeAttenuation)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.clone=function(){var t=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.useScreenCoordinates=this.useScreenCoordinates,t.sizeAttenuation=this.sizeAttenuation,t.scaleByViewport=this.scaleByViewport,t.alignment.copy(this.alignment),t.uvOffset.copy(this.uvOffset),t.uvScale.copy(this.uvScale),t.fog=this.fog,t},THREE.SpriteAlignment={},THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1),THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1),THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1),THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0),THREE.SpriteAlignment.center=new THREE.Vector2(0,0),THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0),THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1),THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1),THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1),THREE.Texture=function(t,e,i,n,r,o,a,s,l){this.id=THREE.TextureIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.image=t,this.mipmaps=[],this.mapping=void 0!==e?e:new THREE.UVMapping,this.wrapS=void 0!==i?i:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==n?n:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:THREE.LinearFilter,this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==s?s:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.needsUpdate=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,clone:function(t){return void 0===t&&(t=new THREE.Texture),t.image=this.image,t.mipmaps=this.mipmaps.slice(0),t.mapping=this.mapping,t.wrapS=this.wrapS,t.wrapT=this.wrapT,t.magFilter=this.magFilter,t.minFilter=this.minFilter,t.anisotropy=this.anisotropy,t.format=this.format,t.type=this.type,t.offset.copy(this.offset),t.repeat.copy(this.repeat),t.generateMipmaps=this.generateMipmaps,t.premultiplyAlpha=this.premultiplyAlpha,t.flipY=this.flipY,t.unpackAlignment=this.unpackAlignment,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.CompressedTexture=function(t,e,i,n,r,o,a,s,l,h,c){THREE.Texture.call(this,null,o,a,s,l,h,n,r,c),this.image={width:e,height:i},this.mipmaps=t,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.clone=function(){var t=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,t),t},THREE.DataTexture=function(t,e,i,n,r,o,a,s,l,h,c){THREE.Texture.call(this,null,o,a,s,l,h,n,r,c),this.image={data:t,width:e,height:i}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.clone=function(){var t=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,t),t},THREE.Particle=function(t){THREE.Object3D.call(this),this.material=t},THREE.Particle.prototype=Object.create(THREE.Object3D.prototype),THREE.Particle.prototype.clone=function(t){return void 0===t&&(t=new THREE.Particle(this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.ParticleSystem=function(t,e){THREE.Object3D.call(this),this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.ParticleBasicMaterial({color:16777215*Math.random()}),this.sortParticles=!1,this.frustumCulled=!1},THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype),THREE.ParticleSystem.prototype.clone=function(t){return void 0===t&&(t=new THREE.ParticleSystem(this.geometry,this.material)),t.sortParticles=this.sortParticles,THREE.Object3D.prototype.clone.call(this,t),t},THREE.Line=function(t,e,i){THREE.Object3D.call(this),this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==i?i:THREE.LineStrip},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.clone=function(t){return void 0===t&&(t=new THREE.Line(this.geometry,this.material,this.type)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Mesh=function(t,e){THREE.Object3D.call(this),this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.updateMorphTargets=function(){if(this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;e>t;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:0},THREE.Mesh.prototype.clone=function(t){return void 0===t&&(t=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Bone=function(t){THREE.Object3D.call(this),this.skin=t,this.skinMatrix=new THREE.Matrix4},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.update=function(t,e){this.matrixAutoUpdate&&(e|=this.updateMatrix()),(e||this.matrixWorldNeedsUpdate)&&(t?this.skinMatrix.multiplyMatrices(t,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);var i,n=this.children.length;for(i=0;n>i;i++)this.children[i].update(this.skinMatrix,e)},THREE.SkinnedMesh=function(t,e,i){THREE.Mesh.call(this,t,e),this.useVertexTexture=void 0!==i?i:!0,this.identityMatrix=new THREE.Matrix4,this.bones=[],this.boneMatrices=[];var n,r,o,a,s,l;if(this.geometry&&void 0!==this.geometry.bones){for(n=0;n<this.geometry.bones.length;n++)o=this.geometry.bones[n],a=o.pos,s=o.rotq,l=o.scl,r=this.addBone(),r.name=o.name,r.position.set(a[0],a[1],a[2]),r.quaternion.set(s[0],s[1],s[2],s[3]),void 0!==l?r.scale.set(l[0],l[1],l[2]):r.scale.set(1,1,1);for(n=0;n<this.bones.length;n++)o=this.geometry.bones[n],r=this.bones[n],-1===o.parent?this.add(r):this.bones[o.parent].add(r);var h=this.bones.length;if(this.useVertexTexture){var c;c=h>256?64:h>64?32:h>16?16:8,this.boneTextureWidth=c,this.boneTextureHeight=c,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1}else this.boneMatrices=new Float32Array(16*h);this.pose()}},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.addBone=function(t){return void 0===t&&(t=new THREE.Bone(this)),this.bones.push(t),t},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){var t=new THREE.Matrix4;return function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var i=0,n=this.children.length;n>i;i++){var r=this.children[i];r instanceof THREE.Bone?r.update(this.identityMatrix,!1):r.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[];for(var o=0,a=this.bones.length;a>o;o++){var s=new THREE.Matrix4;s.getInverse(this.bones[o].skinMatrix),this.boneInverses.push(s)}}for(var o=0,a=this.bones.length;a>o;o++)t.multiplyMatrices(this.bones[o].skinMatrix,this.boneInverses[o]),t.flattenToArrayOffset(this.boneMatrices,16*o);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0),this.normalizeSkinWeights()},THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var t=0;t<this.geometry.skinIndices.length;t++){var e=this.geometry.skinWeights[t],i=1/e.lengthManhattan();1/0!==i?e.multiplyScalar(i):e.set(1)}},THREE.SkinnedMesh.prototype.clone=function(t){return void 0===t&&(t=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,t),t},THREE.MorphAnimMesh=function(t,e){THREE.Mesh.call(this,t,e),this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.setFrameRange=function(t,e){this.startKeyframe=t,this.endKeyframe=e,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){var t=this.geometry;t.animations||(t.animations={});for(var e,i=t.animations,n=/([a-z]+)(\d+)/,r=0,o=t.morphTargets.length;o>r;r++){var a=t.morphTargets[r],s=a.name.match(n);if(s&&s.length>1){{var l=s[1];s[2]}i[l]||(i[l]={start:1/0,end:-1/0});var h=i[l];r<h.start&&(h.start=r),r>h.end&&(h.end=r),e||(e=l)}}t.firstAnimation=e},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(t,e,i){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[t]={start:e,end:i}},THREE.MorphAnimMesh.prototype.playAnimation=function(t,e){var i=this.geometry.animations[t];i?(this.setFrameRange(i.start,i.end),this.duration=1e3*((i.end-i.start)/e),this.time=0):0},THREE.MorphAnimMesh.prototype.updateAnimation=function(t){var e=this.duration/this.length;this.time+=this.direction*t,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var i=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/e),0,this.length-1);i!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[i]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=i);var n=this.time%e/e;this.directionBackwards&&(n=1-n),this.morphTargetInfluences[this.currentKeyframe]=n,this.morphTargetInfluences[this.lastKeyframe]=1-n},THREE.MorphAnimMesh.prototype.clone=function(t){return void 0===t&&(t=new THREE.MorphAnimMesh(this.geometry,this.material)),t.duration=this.duration,t.mirroredLoop=this.mirroredLoop,t.time=this.time,t.lastKeyframe=this.lastKeyframe,t.currentKeyframe=this.currentKeyframe,t.direction=this.direction,t.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,t),t},THREE.Ribbon=function(t,e){THREE.Object3D.call(this),this.geometry=t,this.material=e},THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype),THREE.Ribbon.prototype.clone=function(t){return void 0===t&&(t=new THREE.Ribbon(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=0;i<this.objects.length&&!(e<this.objects[i].distance);i++);this.objects.splice(i,0,{distance:e,object:t}),this.add(t)},THREE.LOD.prototype.getObjectForDistance=function(t){for(var e=1,i=this.objects.length;i>e&&!(t<this.objects[e].distance);e++);return this.objects[e-1].object},THREE.LOD.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i){if(this.objects.length>1){t.getPositionFromMatrix(i.matrixWorld),e.getPositionFromMatrix(this.matrixWorld);var n=t.distanceTo(e);this.objects[0].object.visible=!0;for(var r=1,o=this.objects.length;o>r&&n>=this.objects[r].distance;r++)this.objects[r-1].object.visible=!1,this.objects[r].object.visible=!0;for(;o>r;r++)this.objects[r].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(){},THREE.Sprite=function(t){THREE.Object3D.call(this),this.material=void 0!==t?t:new THREE.SpriteMaterial,this.rotation3d=this.rotation,this.rotation=0},THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation,this.rotation3d.order),this.quaternion.setFromEuler(this.rotation3d),this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},THREE.Sprite.prototype.clone=function(t){return void 0===t&&(t=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Scene=function(){THREE.Object3D.call(this),this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.__addObject=function(t){if(t instanceof THREE.Light)-1===this.__lights.indexOf(t)&&this.__lights.push(t),t.target&&void 0===t.target.parent&&this.add(t.target);else if(!(t instanceof THREE.Camera||t instanceof THREE.Bone)&&-1===this.__objects.indexOf(t)){this.__objects.push(t),this.__objectsAdded.push(t);var e=this.__objectsRemoved.indexOf(t);-1!==e&&this.__objectsRemoved.splice(e,1)}for(var i=0;i<t.children.length;i++)this.__addObject(t.children[i])},THREE.Scene.prototype.__removeObject=function(t){if(t instanceof THREE.Light){var e=this.__lights.indexOf(t);-1!==e&&this.__lights.splice(e,1)}else if(!(t instanceof THREE.Camera)){var e=this.__objects.indexOf(t);if(-1!==e){this.__objects.splice(e,1),this.__objectsRemoved.push(t);var i=this.__objectsAdded.indexOf(t);-1!==i&&this.__objectsAdded.splice(i,1)}}for(var n=0;n<t.children.length;n++)this.__removeObject(t.children[n])},THREE.Scene.prototype.clone=function(t){return void 0===t&&(t=new THREE.Scene),THREE.Object3D.prototype.clone.call(this,t),null!==this.fog&&(t.fog=this.fog.clone()),null!==this.overrideMaterial&&(t.overrideMaterial=this.overrideMaterial.clone()),t.autoUpdate=this.autoUpdate,t.matrixAutoUpdate=this.matrixAutoUpdate,t},THREE.Fog=function(t,e,i){this.name="",this.color=new THREE.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(t,e){this.name="",this.color=new THREE.Color(t),this.density=void 0!==e?e:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.CanvasRenderer=function(t){function e(){Ce.setRGB(0,0,0),Ae.setRGB(0,0,0),Pe.setRGB(0,0,0);for(var t=0,e=w.length;e>t;t++){var i=w[t],n=i.color;i instanceof THREE.AmbientLight?Ce.add(n):i instanceof THREE.DirectionalLight?Ae.add(n):i instanceof THREE.PointLight&&Pe.add(n)}}function i(t,e,i){for(var n=0,r=w.length;r>n;n++){var o=w[n];if(be.copy(o.color),o instanceof THREE.DirectionalLight){var a=Le.getPositionFromMatrix(o.matrixWorld).normalize(),s=e.dot(a);if(0>=s)continue;s*=o.intensity,i.add(be.multiplyScalar(s))}else if(o instanceof THREE.PointLight){var a=Le.getPositionFromMatrix(o.matrixWorld),s=e.dot(Le.subVectors(a,t).normalize());if(0>=s)continue;if(s*=0==o.distance?1:1-Math.min(t.distanceTo(a)/o.distance,1),0==s)continue;s*=o.intensity,i.add(be.multiplyScalar(s))}}}function n(t,e,i){f(i.opacity),p(i.blending);var n,r,o,a,s,l,h;if(i instanceof THREE.ParticleBasicMaterial)if(null===i.map){if(o=e.object.scale.x,a=e.object.scale.y,o*=e.scale.x*M,a*=e.scale.y*H,He.min.set(t.x-o,t.y-a),He.max.set(t.x+o,t.y+a),Se.isIntersectionBox(He)===!1)return void He.makeEmpty();E(i.color.getStyle()),re.save(),re.translate(t.x,t.y),re.rotate(-e.rotation),re.scale(o,a),re.fillRect(-1,-1,2,2),re.restore()}else{if(s=i.map.image,l=s.width>>1,h=s.height>>1,o=e.scale.x*M,a=e.scale.y*H,n=o*l,r=a*h,He.min.set(t.x-n,t.y-r),He.max.set(t.x+n,t.y+r),Se.isIntersectionBox(He)===!1)return void He.makeEmpty();re.save(),re.translate(t.x,t.y),re.rotate(-e.rotation),re.scale(o,-a),re.translate(-l,-h),re.drawImage(s,0,0),re.restore()}else if(i instanceof THREE.ParticleCanvasMaterial){if(n=e.scale.x*M,r=e.scale.y*H,He.min.set(t.x-n,t.y-r),He.max.set(t.x+n,t.y+r),Se.isIntersectionBox(He)===!1)return void He.makeEmpty();y(i.color.getStyle()),E(i.color.getStyle()),re.save(),re.translate(t.x,t.y),re.rotate(-e.rotation),re.scale(n,r),i.program(re),re.restore()}}function r(t,e,i,n){if(f(n.opacity),p(n.blending),re.beginPath(),re.moveTo(t.positionScreen.x,t.positionScreen.y),re.lineTo(e.positionScreen.x,e.positionScreen.y),n instanceof THREE.LineBasicMaterial){if(m(n.linewidth),g(n.linecap),v(n.linejoin),n.vertexColors!==THREE.VertexColors)y(n.color.getStyle());else{var r=i.vertexColors[0].getStyle(),o=i.vertexColors[1].getStyle();if(r===o)y(r);else{try{var a=re.createLinearGradient(t.positionScreen.x,t.positionScreen.y,e.positionScreen.x,e.positionScreen.y);a.addColorStop(0,r),a.addColorStop(1,o)}catch(s){a=r}y(a)}}re.stroke(),He.expandByScalar(2*n.linewidth)}else n instanceof THREE.LineDashedMaterial&&(m(n.linewidth),g(n.linecap),v(n.linejoin),y(n.color.getStyle()),x(n.dashSize,n.gapSize),re.stroke(),He.expandByScalar(2*n.linewidth),x(null,null))}function o(t,e,n,r,o,d,m,g){if(ee.info.render.vertices+=3,ee.info.render.faces++,f(g.opacity),p(g.blending),O=t.positionScreen.x,D=t.positionScreen.y,z=e.positionScreen.x,N=e.positionScreen.y,F=n.positionScreen.x,U=n.positionScreen.y,a(O,D,z,N,F,U),(g instanceof THREE.MeshLambertMaterial||g instanceof THREE.MeshPhongMaterial)&&null===g.map)Te.copy(g.color),_e.copy(g.emissive),g.vertexColors===THREE.FaceColors&&Te.multiply(m.color),g.wireframe===!1&&g.shading==THREE.SmoothShading&&3==m.vertexNormalsLength?(ve.copy(Ce),ye.copy(Ce),Ee.copy(Ce),i(m.v1.positionWorld,m.vertexNormalsModel[0],ve),i(m.v2.positionWorld,m.vertexNormalsModel[1],ye),i(m.v3.positionWorld,m.vertexNormalsModel[2],Ee),ve.multiply(Te).add(_e),ye.multiply(Te).add(_e),Ee.multiply(Te).add(_e),xe.addColors(ye,Ee).multiplyScalar(.5),V=u(ve,ye,Ee,xe),c(O,D,z,N,F,U,0,0,1,0,0,1,V)):(ge.copy(Ce),i(m.centroidModel,m.normalModel,ge),ge.multiply(Te).add(_e),g.wireframe===!0?s(ge,g.wireframeLinewidth,g.wireframeLinecap,g.wireframeLinejoin):l(ge));else if(g instanceof THREE.MeshBasicMaterial||g instanceof THREE.MeshLambertMaterial||g instanceof THREE.MeshPhongMaterial)null!==g.map?g.map.mapping instanceof THREE.UVMapping&&(B=m.uvs[0],h(O,D,z,N,F,U,B[r].x,B[r].y,B[o].x,B[o].y,B[d].x,B[d].y,g.map)):null!==g.envMap?g.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(Le.copy(m.vertexNormalsModelView[r]),j=.5*Le.x+.5,G=.5*Le.y+.5,Le.copy(m.vertexNormalsModelView[o]),W=.5*Le.x+.5,X=.5*Le.y+.5,Le.copy(m.vertexNormalsModelView[d]),q=.5*Le.x+.5,Y=.5*Le.y+.5,h(O,D,z,N,F,U,j,G,W,X,q,Y,g.envMap)):(ge.copy(g.color),g.vertexColors===THREE.FaceColors&&ge.multiply(m.color),g.wireframe===!0?s(ge,g.wireframeLinewidth,g.wireframeLinecap,g.wireframeLinejoin):l(ge));else if(g instanceof THREE.MeshDepthMaterial)I=C.near,k=C.far,ve.r=ve.g=ve.b=1-T(t.positionScreen.z*t.positionScreen.w,I,k),ye.r=ye.g=ye.b=1-T(e.positionScreen.z*e.positionScreen.w,I,k),Ee.r=Ee.g=Ee.b=1-T(n.positionScreen.z*n.positionScreen.w,I,k),xe.addColors(ye,Ee).multiplyScalar(.5),V=u(ve,ye,Ee,xe),c(O,D,z,N,F,U,0,0,1,0,0,1,V);else if(g instanceof THREE.MeshNormalMaterial){var v;g.shading==THREE.FlatShading?(v=m.normalModelView,ge.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5),g.wireframe===!0?s(ge,g.wireframeLinewidth,g.wireframeLinecap,g.wireframeLinejoin):l(ge)):g.shading==THREE.SmoothShading&&(v=m.vertexNormalsModelView[r],ve.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5),v=m.vertexNormalsModelView[o],ye.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5),v=m.vertexNormalsModelView[d],Ee.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5),xe.addColors(ye,Ee).multiplyScalar(.5),V=u(ve,ye,Ee,xe),c(O,D,z,N,F,U,0,0,1,0,0,1,V))
}}function a(t,e,i,n,r,o){re.beginPath(),re.moveTo(t,e),re.lineTo(i,n),re.lineTo(r,o),re.closePath()}function s(t,e,i,n){m(e),g(i),v(n),y(t.getStyle()),re.stroke(),He.expandByScalar(2*e)}function l(t){E(t.getStyle()),re.fill()}function h(t,e,i,n,r,o,a,s,h,c,u,d,f){if(!(f instanceof THREE.DataTexture||void 0===f.image||0==f.image.width)){if(f.needsUpdate===!0){var p=f.wrapS==THREE.RepeatWrapping,m=f.wrapT==THREE.RepeatWrapping;we[f.id]=re.createPattern(f.image,p===!0&&m===!0?"repeat":p===!0&&m===!1?"repeat-x":p===!1&&m===!0?"repeat-y":"no-repeat"),f.needsUpdate=!1}E(void 0===we[f.id]?"rgba(10,0,0,1)":we[f.id]);var g,v,y,x,T,_,b,w,R=f.offset.x/f.repeat.x,S=f.offset.y/f.repeat.y,M=f.image.width*f.repeat.x,H=f.image.height*f.repeat.y;if(a=(a+R)*M,s=(1-s+S)*H,h=(h+R)*M,c=(1-c+S)*H,u=(u+R)*M,d=(1-d+S)*H,i-=t,n-=e,r-=t,o-=e,h-=a,c-=s,u-=a,d-=s,b=h*d-u*c,0===b){if(void 0===Re[f.id]){var C=document.createElement("canvas");C.width=f.image.width,C.height=f.image.height;var A=C.getContext("2d");A.drawImage(f.image,0,0),Re[f.id]=A.getImageData(0,0,f.image.width,f.image.height).data}var P=Re[f.id],L=4*(Math.floor(a)+Math.floor(s)*f.image.width);return ge.setRGB(P[L]/255,P[L+1]/255,P[L+2]/255),void l(ge)}w=1/b,g=(d*i-c*r)*w,v=(d*n-c*o)*w,y=(h*r-u*i)*w,x=(h*o-u*n)*w,T=t-g*a-y*s,_=e-v*a-x*s,re.save(),re.transform(g,v,y,x,T,_),re.fill(),re.restore()}}function c(t,e,i,n,r,o,a,s,l,h,c,u,d){var f,p,m,g,v,y,E,x,T=d.width-1,_=d.height-1;a*=T,s*=_,l*=T,h*=_,c*=T,u*=_,i-=t,n-=e,r-=t,o-=e,l-=a,h-=s,c-=a,u-=s,E=l*u-c*h,x=1/E,f=(u*i-h*r)*x,p=(u*n-h*o)*x,m=(l*r-c*i)*x,g=(l*o-c*n)*x,v=t-f*a-m*s,y=e-p*a-g*s,re.save(),re.transform(f,p,m,g,v,y),re.clip(),re.drawImage(d,0,0),re.restore()}function u(t,e,i,n){return Z[0]=255*t.r|0,Z[1]=255*t.g|0,Z[2]=255*t.b|0,Z[4]=255*e.r|0,Z[5]=255*e.g|0,Z[6]=255*e.b|0,Z[8]=255*i.r|0,Z[9]=255*i.g|0,Z[10]=255*i.b|0,Z[12]=255*n.r|0,Z[13]=255*n.g|0,Z[14]=255*n.b|0,$.putImageData(Q,0,0),te.drawImage(K,0,0),J}function d(t,e,i){var n,r=e.x-t.x,o=e.y-t.y,a=r*r+o*o;0!==a&&(n=i/Math.sqrt(a),r*=n,o*=n,e.x+=r,e.y+=o,t.x-=r,t.y-=o)}function f(t){se!==t&&(re.globalAlpha=t,se=t)}function p(t){le!==t&&(t===THREE.NormalBlending?re.globalCompositeOperation="source-over":t===THREE.AdditiveBlending?re.globalCompositeOperation="lighter":t===THREE.SubtractiveBlending&&(re.globalCompositeOperation="darker"),le=t)}function m(t){ue!==t&&(re.lineWidth=t,ue=t)}function g(t){de!==t&&(re.lineCap=t,de=t)}function v(t){fe!==t&&(re.lineJoin=t,fe=t)}function y(t){he!==t&&(re.strokeStyle=t,he=t)}function E(t){ce!==t&&(re.fillStyle=t,ce=t)}function x(t,e){(pe!==t||me!==e)&&(re.setLineDash([t,e]),pe=t,me=e)}var T=THREE.Math.smoothstep;t=t||{};var _,b,w,R,S,M,H,C,A,P,L,O,D,z,N,F,U,I,k,V,B,j,G,W,X,q,Y,K,$,Q,Z,J,te,ee=this,ie=new THREE.Projector,ne=void 0!==t.canvas?t.canvas:document.createElement("canvas"),re=ne.getContext("2d"),oe=new THREE.Color(0),ae=0,se=1,le=0,he=null,ce=null,ue=null,de=null,fe=null,pe=null,me=0,ge=(new THREE.RenderableVertex,new THREE.RenderableVertex,new THREE.Color),ve=new THREE.Color,ye=new THREE.Color,Ee=new THREE.Color,xe=new THREE.Color,Te=new THREE.Color,_e=new THREE.Color,be=new THREE.Color,we={},Re={},Se=new THREE.Box2,Me=new THREE.Box2,He=new THREE.Box2,Ce=new THREE.Color,Ae=new THREE.Color,Pe=new THREE.Color,Le=new THREE.Vector3,Oe=16;K=document.createElement("canvas"),K.width=K.height=2,$=K.getContext("2d"),$.fillStyle="rgba(10,0,0,1)",$.fillRect(0,0,2,2),Q=$.getImageData(0,0,2,2),Z=Q.data,J=document.createElement("canvas"),J.width=J.height=Oe,te=J.getContext("2d"),te.translate(-Oe/2,-Oe/2),te.scale(Oe,Oe),Oe--,void 0===re.setLineDash&&(re.setLineDash=void 0!==re.mozDash?function(t){re.mozDash=null!==t[0]?t:null}:function(){}),this.domElement=ne,this.devicePixelRatio=void 0!==t.devicePixelRatio?t.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setSize=function(t,e,i){R=t*this.devicePixelRatio,S=e*this.devicePixelRatio,M=Math.floor(R/2),H=Math.floor(S/2),ne.width=R,ne.height=S,1!==this.devicePixelRatio&&i!==!1&&(ne.style.width=t+"px",ne.style.height=e+"px"),Se.set(new THREE.Vector2(-M,-H),new THREE.Vector2(M,H)),Me.set(new THREE.Vector2(-M,-H),new THREE.Vector2(M,H)),se=1,le=0,he=null,ce=null,ue=null,de=null,fe=null},this.setClearColor=function(t,e){oe.set(t),ae=void 0!==e?e:1,Me.set(new THREE.Vector2(-M,-H),new THREE.Vector2(M,H))},this.setClearColorHex=function(t,e){this.setClearColor(t,e)},this.getMaxAnisotropy=function(){return 0},this.clear=function(){re.setTransform(1,0,0,-1,M,H),Me.empty()===!1&&(Me.intersect(Se),Me.expandByScalar(2),1>ae&&re.clearRect(0|Me.min.x,0|Me.min.y,Me.max.x-Me.min.x|0,Me.max.y-Me.min.y|0),ae>0&&(p(THREE.NormalBlending),f(1),E("rgba("+Math.floor(255*oe.r)+","+Math.floor(255*oe.g)+","+Math.floor(255*oe.b)+","+ae+")"),re.fillRect(0|Me.min.x,0|Me.min.y,Me.max.x-Me.min.x|0,Me.max.y-Me.min.y|0)),Me.makeEmpty())},this.render=function(t,i){if(i instanceof THREE.Camera!=0){this.autoClear===!0&&this.clear(),re.setTransform(1,0,0,-1,M,H),ee.info.render.vertices=0,ee.info.render.faces=0,_=ie.projectScene(t,i,this.sortObjects,this.sortElements),b=_.elements,w=_.lights,C=i,e();for(var a=0,s=b.length;s>a;a++){var l=b[a],h=l.material;if(void 0!==h&&h.visible!==!1){if(He.makeEmpty(),l instanceof THREE.RenderableParticle)A=l,A.x*=M,A.y*=H,n(A,l,h);else if(l instanceof THREE.RenderableLine)A=l.v1,P=l.v2,A.positionScreen.x*=M,A.positionScreen.y*=H,P.positionScreen.x*=M,P.positionScreen.y*=H,He.setFromPoints([A.positionScreen,P.positionScreen]),Se.isIntersectionBox(He)===!0&&r(A,P,l,h);else if(l instanceof THREE.RenderableFace3){if(A=l.v1,P=l.v2,L=l.v3,A.positionScreen.z<-1||A.positionScreen.z>1)continue;if(P.positionScreen.z<-1||P.positionScreen.z>1)continue;if(L.positionScreen.z<-1||L.positionScreen.z>1)continue;A.positionScreen.x*=M,A.positionScreen.y*=H,P.positionScreen.x*=M,P.positionScreen.y*=H,L.positionScreen.x*=M,L.positionScreen.y*=H,h.overdraw>0&&(d(A.positionScreen,P.positionScreen,h.overdraw),d(P.positionScreen,L.positionScreen,h.overdraw),d(L.positionScreen,A.positionScreen,h.overdraw)),He.setFromPoints([A.positionScreen,P.positionScreen,L.positionScreen]),Se.isIntersectionBox(He)===!0&&o(A,P,L,0,1,2,l,h)}Me.union(He)}}re.setTransform(1,0,0,1,0,0)}}},THREE.ShaderChunk={fog_pars_fragment:["#ifdef USE_FOG","uniform vec3 fogColor;","#ifdef FOG_EXP2","uniform float fogDensity;","#else","uniform float fogNear;","uniform float fogFar;","#endif","#endif"].join("\n"),fog_fragment:["#ifdef USE_FOG","float depth = gl_FragCoord.z / gl_FragCoord.w;","#ifdef FOG_EXP2","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","#else","float fogFactor = smoothstep( fogNear, fogFar, depth );","#endif","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","#endif"].join("\n"),envmap_pars_fragment:["#ifdef USE_ENVMAP","uniform float reflectivity;","uniform samplerCube envMap;","uniform float flipEnvMap;","uniform int combine;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","uniform bool useRefract;","uniform float refractionRatio;","#else","varying vec3 vReflect;","#endif","#endif"].join("\n"),envmap_fragment:["#ifdef USE_ENVMAP","vec3 reflectVec;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","reflectVec = refract( cameraToVertex, normal, refractionRatio );","} else { ","reflectVec = reflect( cameraToVertex, normal );","}","#else","reflectVec = vReflect;","#endif","#ifdef DOUBLE_SIDED","float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );","vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#else","vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#endif","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","if ( combine == 1 ) {","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );","} else if ( combine == 2 ) {","gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;","} else {","gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );","}","#endif"].join("\n"),envmap_pars_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","varying vec3 vReflect;","uniform float refractionRatio;","uniform bool useRefract;","#endif"].join("\n"),worldpos_vertex:["#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )","#ifdef USE_SKINNING","vec4 worldPosition = modelMatrix * skinned;","#endif","#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );","#endif","#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","#endif","#endif"].join("\n"),envmap_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;","worldNormal = normalize( worldNormal );","vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, worldNormal, refractionRatio );","} else {","vReflect = reflect( cameraToVertex, worldNormal );","}","#endif"].join("\n"),map_particle_pars_fragment:["#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_particle_fragment:["#ifdef USE_MAP","gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );","#endif"].join("\n"),map_pars_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","uniform vec4 offsetRepeat;","#endif"].join("\n"),map_pars_fragment:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","#endif","#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","#endif"].join("\n"),map_fragment:["#ifdef USE_MAP","vec4 texelColor = texture2D( map, vUv );","#ifdef GAMMA_INPUT","texelColor.xyz *= texelColor.xyz;","#endif","gl_FragColor = gl_FragColor * texelColor;","#endif"].join("\n"),lightmap_pars_fragment:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","uniform sampler2D lightMap;","#endif"].join("\n"),lightmap_pars_vertex:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","#endif"].join("\n"),lightmap_fragment:["#ifdef USE_LIGHTMAP","gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );","#endif"].join("\n"),lightmap_vertex:["#ifdef USE_LIGHTMAP","vUv2 = uv2;","#endif"].join("\n"),bumpmap_pars_fragment:["#ifdef USE_BUMPMAP","uniform sampler2D bumpMap;","uniform float bumpScale;","vec2 dHdxy_fwd() {","vec2 dSTdx = dFdx( vUv );","vec2 dSTdy = dFdy( vUv );","float Hll = bumpScale * texture2D( bumpMap, vUv ).x;","float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","return vec2( dBx, dBy );","}","vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","vec3 vSigmaX = dFdx( surf_pos );","vec3 vSigmaY = dFdy( surf_pos );","vec3 vN = surf_norm;","vec3 R1 = cross( vSigmaY, vN );","vec3 R2 = cross( vN, vSigmaX );","float fDet = dot( vSigmaX, R1 );","vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","return normalize( abs( fDet ) * surf_norm - vGrad );","}","#endif"].join("\n"),normalmap_pars_fragment:["#ifdef USE_NORMALMAP","uniform sampler2D normalMap;","uniform vec2 normalScale;","vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {","vec3 q0 = dFdx( eye_pos.xyz );","vec3 q1 = dFdy( eye_pos.xyz );","vec2 st0 = dFdx( vUv.st );","vec2 st1 = dFdy( vUv.st );","vec3 S = normalize(  q0 * st1.t - q1 * st0.t );","vec3 T = normalize( -q0 * st1.s + q1 * st0.s );","vec3 N = normalize( surf_norm );","vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;","mapN.xy = normalScale * mapN.xy;","mat3 tsn = mat3( S, T, N );","return normalize( tsn * mapN );","}","#endif"].join("\n"),specularmap_pars_fragment:["#ifdef USE_SPECULARMAP","uniform sampler2D specularMap;","#endif"].join("\n"),specularmap_fragment:["float specularStrength;","#ifdef USE_SPECULARMAP","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","#else","specularStrength = 1.0;","#endif"].join("\n"),lights_lambert_pars_vertex:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif"].join("\n"),lights_lambert_vertex:["vLightFront = vec3( 0.0 );","#ifdef DOUBLE_SIDED","vLightBack = vec3( 0.0 );","#endif","transformedNormal = normalize( transformedNormal );","#if MAX_DIR_LIGHTS > 0","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, dirVector );","vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += directionalLightColor[ i ] * directionalLightWeighting;","#ifdef DOUBLE_SIDED","vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;","#endif","}","#endif","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;","#ifdef DOUBLE_SIDED","vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;","#ifdef DOUBLE_SIDED","vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_HEMI_LIGHTS > 0","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;","vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","#ifdef DOUBLE_SIDED","vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );","#endif","}","#endif","vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;","#ifdef DOUBLE_SIDED","vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;","#endif"].join("\n"),lights_phong_pars_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif"].join("\n"),lights_phong_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","vPointLight[ i ] = vec4( lVector, lDistance );","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","vSpotLight[ i ] = vec4( lVector, lDistance );","}","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","vWorldPosition = worldPosition.xyz;","#endif"].join("\n"),lights_phong_pars_fragment:["uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#else","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#else","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vViewPosition;","varying vec3 vNormal;"].join("\n"),lights_phong_fragment:["vec3 normal = normalize( vNormal );","vec3 viewPosition = normalize( vViewPosition );","#ifdef DOUBLE_SIDED","normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );","#endif","#ifdef USE_NORMALMAP","normal = perturbNormal2Arb( -vViewPosition, normal );","#elif defined( USE_BUMPMAP )","normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse  = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vPointLight[ i ].xyz );","float lDistance = vPointLight[ i ].w;","#endif","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dotProduct, 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dotProduct, 0.0 );","#endif","pointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;","#else","pointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse  = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vSpotLight[ i ].xyz );","float lDistance = vSpotLight[ i ].w;","#endif","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dotProduct, 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dotProduct, 0.0 );","#endif","spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;","vec3 spotHalfVector = normalize( lVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;","#else","spotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse  = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, dirVector );","#ifdef WRAP_AROUND","float dirDiffuseWeightFull = max( dotProduct, 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dotProduct, 0.0 );","#endif","dirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += diffuse * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;","#endif"].join("\n"),color_pars_fragment:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_fragment:["#ifdef USE_COLOR","gl_FragColor = gl_FragColor * vec4( vColor, opacity );","#endif"].join("\n"),color_pars_vertex:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_vertex:["#ifdef USE_COLOR","#ifdef GAMMA_INPUT","vColor = color * color;","#else","vColor = color;","#endif","#endif"].join("\n"),skinning_pars_vertex:["#ifdef USE_SKINNING","#ifdef BONE_TEXTURE","uniform sampler2D boneTexture;","mat4 getBoneMatrix( const in float i ) {","float j = i * 4.0;","float x = mod( j, N_BONE_PIXEL_X );","float y = floor( j / N_BONE_PIXEL_X );","const float dx = 1.0 / N_BONE_PIXEL_X;","const float dy = 1.0 / N_BONE_PIXEL_Y;","y = dy * ( y + 0.5 );","vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );","vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );","vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );","vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );","mat4 bone = mat4( v1, v2, v3, v4 );","return bone;","}","#else","uniform mat4 boneGlobalMatrices[ MAX_BONES ];","mat4 getBoneMatrix( const in float i ) {","mat4 bone = boneGlobalMatrices[ int(i) ];","return bone;","}","#endif","#endif"].join("\n"),skinbase_vertex:["#ifdef USE_SKINNING","mat4 boneMatX = getBoneMatrix( skinIndex.x );","mat4 boneMatY = getBoneMatrix( skinIndex.y );","#endif"].join("\n"),skinning_vertex:["#ifdef USE_SKINNING","#ifdef USE_MORPHTARGETS","vec4 skinVertex = vec4( morphed, 1.0 );","#else","vec4 skinVertex = vec4( position, 1.0 );","#endif","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","#endif"].join("\n"),morphtarget_pars_vertex:["#ifdef USE_MORPHTARGETS","#ifndef USE_MORPHNORMALS","uniform float morphTargetInfluences[ 8 ];","#else","uniform float morphTargetInfluences[ 4 ];","#endif","#endif"].join("\n"),morphtarget_vertex:["#ifdef USE_MORPHTARGETS","vec3 morphed = vec3( 0.0 );","morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];","morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];","morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];","morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];","#ifndef USE_MORPHNORMALS","morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];","morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];","morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];","morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];","#endif","morphed += position;","#endif"].join("\n"),default_vertex:["vec4 mvPosition;","#ifdef USE_SKINNING","mvPosition = modelViewMatrix * skinned;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( morphed, 1.0 );","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;"].join("\n"),morphnormal_vertex:["#ifdef USE_MORPHNORMALS","vec3 morphedNormal = vec3( 0.0 );","morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];","morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];","morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];","morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];","morphedNormal += normal;","#endif"].join("\n"),skinnormal_vertex:["#ifdef USE_SKINNING","mat4 skinMatrix = skinWeight.x * boneMatX;","skinMatrix 	+= skinWeight.y * boneMatY;","#ifdef USE_MORPHNORMALS","vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );","#else","vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );","#endif","#endif"].join("\n"),defaultnormal_vertex:["vec3 objectNormal;","#ifdef USE_SKINNING","objectNormal = skinnedNormal.xyz;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )","objectNormal = morphedNormal;","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )","objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;"].join("\n"),shadowmap_pars_fragment:["#ifdef USE_SHADOWMAP","uniform sampler2D shadowMap[ MAX_SHADOWS ];","uniform vec2 shadowMapSize[ MAX_SHADOWS ];","uniform float shadowDarkness[ MAX_SHADOWS ];","uniform float shadowBias[ MAX_SHADOWS ];","varying vec4 vShadowCoord[ MAX_SHADOWS ];","float unpackDepth( const in vec4 rgba_depth ) {","const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );","float depth = dot( rgba_depth, bit_shift );","return depth;","}","#endif"].join("\n"),shadowmap_fragment:["#ifdef USE_SHADOWMAP","#ifdef SHADOWMAP_DEBUG","vec3 frustumColors[3];","frustumColors[0] = vec3( 1.0, 0.5, 0.0 );","frustumColors[1] = vec3( 0.0, 1.0, 0.8 );","frustumColors[2] = vec3( 0.0, 0.5, 1.0 );","#endif","#ifdef SHADOWMAP_CASCADE","int inFrustumCount = 0;","#endif","float fDepth;","vec3 shadowColor = vec3( 1.0 );","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;","bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );","bool inFrustum = all( inFrustumVec );","#ifdef SHADOWMAP_CASCADE","inFrustumCount += int( inFrustum );","bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );","#else","bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );","#endif","bool frustumTest = all( frustumTestVec );","if ( frustumTest ) {","shadowCoord.z += shadowBias[ i ];","#if defined( SHADOWMAP_TYPE_PCF )","float shadow = 0.0;","const float shadowDelta = 1.0 / 9.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.25 * xPixelOffset;","float dy0 = -1.25 * yPixelOffset;","float dx1 = 1.25 * xPixelOffset;","float dy1 = 1.25 * yPixelOffset;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#elif defined( SHADOWMAP_TYPE_PCF_SOFT )","float shadow = 0.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.0 * xPixelOffset;","float dy0 = -1.0 * yPixelOffset;","float dx1 = 1.0 * xPixelOffset;","float dy1 = 1.0 * yPixelOffset;","mat3 shadowKernel;","mat3 depthKernel;","depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","vec3 shadowZ = vec3( shadowCoord.z );","shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));","shadowKernel[0] *= vec3(0.25);","shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));","shadowKernel[1] *= vec3(0.25);","shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));","shadowKernel[2] *= vec3(0.25);","vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );","shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );","shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );","vec4 shadowValues;","shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );","shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );","shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );","shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );","shadow = dot( shadowValues, vec4( 1.0 ) );","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#else","vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );","float fDepth = unpackDepth( rgbaDepth );","if ( fDepth < shadowCoord.z )","shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );","#endif","}","#ifdef SHADOWMAP_DEBUG","#ifdef SHADOWMAP_CASCADE","if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];","#else","if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];","#endif","#endif","}","#ifdef GAMMA_OUTPUT","shadowColor *= shadowColor;","#endif","gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;","#endif"].join("\n"),shadowmap_pars_vertex:["#ifdef USE_SHADOWMAP","varying vec4 vShadowCoord[ MAX_SHADOWS ];","uniform mat4 shadowMatrix[ MAX_SHADOWS ];","#endif"].join("\n"),shadowmap_vertex:["#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif"].join("\n"),alphatest_fragment:["#ifdef ALPHATEST","if ( gl_FragColor.a < ALPHATEST ) discard;","#endif"].join("\n"),linear_to_gamma_fragment:["#ifdef GAMMA_OUTPUT","gl_FragColor.xyz = sqrt( gl_FragColor.xyz );","#endif"].join("\n")},THREE.UniformsUtils={merge:function(t){var e,i,n,r={};
for(e=0;e<t.length;e++){n=this.clone(t[e]);for(i in n)r[i]=n[i]}return r},clone:function(t){var e,i,n,r={};for(e in t){r[e]={};for(i in t[e])n=t[e][i],r[e][i]=n instanceof THREE.Color||n instanceof THREE.Vector2||n instanceof THREE.Vector3||n instanceof THREE.Vector4||n instanceof THREE.Matrix4||n instanceof THREE.Texture?n.clone():n instanceof Array?n.slice():n}return r}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED","if ( gl_FrontFacing )","gl_FragColor.xyz *= vLightFront;","else","gl_FragColor.xyz *= vLightBack;","#else","gl_FragColor.xyz *= vLightFront;","#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#ifdef USE_SIZEATTENUATION","gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","#else","gl_PointSize = size;","#endif","gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {","gl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","if ( mod( vLineDistance, totalSize ) > dashSize ) {","discard;","}","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;","void main() {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float color = 1.0 - smoothstep( mNear, mFar, depth );","gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {","vNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;","void main() {","gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );","}"].join("\n")},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:.98},uReflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;","uniform vec3 uDiffuseColor;","uniform vec3 uSpecularColor;","uniform float uShininess;","uniform float uOpacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float uRefractionRatio;","uniform float uReflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","gl_FragColor = vec4( vec3( 1.0 ), uOpacity );","vec3 specularTex = vec3( 1.0 );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse ) {","#ifdef GAMMA_INPUT","vec4 texelColor = texture2D( tDiffuse, vUv );","texelColor.xyz *= texelColor.xyz;","gl_FragColor = gl_FragColor * texelColor;","#else","gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","#endif","}","if( enableAO ) {","#ifdef GAMMA_INPUT","vec4 aoColor = texture2D( tAO, vUv );","aoColor.xyz *= aoColor.xyz;","gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","#else","gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","#endif","}","if( enableSpecular )","specularTex = texture2D( tSpecular, vUv ).xyz;","mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","vec3 finalNormal = tsb * normalTex;","#ifdef FLIP_SIDED","finalNormal = -finalNormal;","#endif","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","float pointDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","pointVector = normalize( pointVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","#endif","pointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;","vec3 pointHalfVector = normalize( pointVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","#else","pointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","float spotDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","spotVector = normalize( spotVector );","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","#endif","spotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;","vec3 spotHalfVector = normalize( spotVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","#else","spotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","#ifdef WRAP_AROUND","float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","#endif","dirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += uDiffuseColor * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;","#endif","if ( enableReflection ) {","vec3 vReflect;","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, normal, uRefractionRatio );","} else {","vReflect = reflect( cameraToVertex, normal );","}","vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );","}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING","vNormal = normalize( normalMatrix * skinnedNormal.xyz );","vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","vTangent = normalize( normalMatrix * skinnedTangent.xyz );","#else","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","#endif","vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","vUv = uv * uRepeat + uOffset;","vec3 displacedPosition;","#ifdef VERTEX_TEXTURES","if ( enableDisplacement ) {","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","displacedPosition = position + normalize( normal ) * df;","} else {","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","}","#else","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","#endif","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","gl_Position = projectionMatrix * mvPosition;","vWorldPosition = worldPosition.xyz;","vViewPosition = -mvPosition.xyz;","#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;","void main() {","gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );","}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["vec4 pack_depth( const in float depth ) {","const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","const vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","vec4 res = fract( depth * bit_shift );","res -= res.xxyz * bit_mask;","return res;","}","void main() {","gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","}"].join("\n")}},THREE.WebGLRenderer=function(t){function e(t){t.__webglVertexBuffer=Ne.createBuffer(),t.__webglColorBuffer=Ne.createBuffer(),Be.info.memory.geometries++}function i(t){t.__webglVertexBuffer=Ne.createBuffer(),t.__webglColorBuffer=Ne.createBuffer(),t.__webglLineDistanceBuffer=Ne.createBuffer(),Be.info.memory.geometries++}function n(t){t.__webglVertexBuffer=Ne.createBuffer(),t.__webglColorBuffer=Ne.createBuffer(),t.__webglNormalBuffer=Ne.createBuffer(),Be.info.memory.geometries++}function r(t){t.__webglVertexBuffer=Ne.createBuffer(),t.__webglNormalBuffer=Ne.createBuffer(),t.__webglTangentBuffer=Ne.createBuffer(),t.__webglColorBuffer=Ne.createBuffer(),t.__webglUVBuffer=Ne.createBuffer(),t.__webglUV2Buffer=Ne.createBuffer(),t.__webglSkinIndicesBuffer=Ne.createBuffer(),t.__webglSkinWeightsBuffer=Ne.createBuffer(),t.__webglFaceBuffer=Ne.createBuffer(),t.__webglLineBuffer=Ne.createBuffer();var e,i;if(t.numMorphTargets)for(t.__webglMorphTargetsBuffers=[],e=0,i=t.numMorphTargets;i>e;e++)t.__webglMorphTargetsBuffers.push(Ne.createBuffer());if(t.numMorphNormals)for(t.__webglMorphNormalsBuffers=[],e=0,i=t.numMorphNormals;i>e;e++)t.__webglMorphNormalsBuffers.push(Ne.createBuffer());Be.info.memory.geometries++}function o(t,e){var i=t.vertices.length,n=e.material;if(n.attributes){void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]);for(var r in n.attributes){var o=n.attributes[r];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;"v2"===o.type?a=2:"v3"===o.type?a=3:"v4"===o.type?a=4:"c"===o.type&&(a=3),o.size=a,o.array=new Float32Array(i*a),o.buffer=Ne.createBuffer(),o.buffer.belongsToAttribute=r,o.needsUpdate=!0}t.__webglCustomAttributesList.push(o)}}}function a(t,e){var i=t.vertices.length;t.__vertexArray=new Float32Array(3*i),t.__colorArray=new Float32Array(3*i),t.__sortArray=[],t.__webglParticleCount=i,o(t,e)}function s(t,e){var i=t.vertices.length;t.__vertexArray=new Float32Array(3*i),t.__colorArray=new Float32Array(3*i),t.__lineDistanceArray=new Float32Array(1*i),t.__webglLineCount=i,o(t,e)}function l(t,e){var i=t.vertices.length;t.__vertexArray=new Float32Array(3*i),t.__colorArray=new Float32Array(3*i),t.__normalArray=new Float32Array(3*i),t.__webglVertexCount=i,o(t,e)}function h(t,e){var i=e.geometry,n=t.faces3,r=3*n.length,o=1*n.length,a=3*n.length,s=c(e,t),l=p(s),h=d(s),u=f(s);t.__vertexArray=new Float32Array(3*r),h&&(t.__normalArray=new Float32Array(3*r)),i.hasTangents&&(t.__tangentArray=new Float32Array(4*r)),u&&(t.__colorArray=new Float32Array(3*r)),l&&(i.faceVertexUvs.length>0&&(t.__uvArray=new Float32Array(2*r)),i.faceVertexUvs.length>1&&(t.__uv2Array=new Float32Array(2*r))),e.geometry.skinWeights.length&&e.geometry.skinIndices.length&&(t.__skinIndexArray=new Float32Array(4*r),t.__skinWeightArray=new Float32Array(4*r)),t.__faceArray=new Uint16Array(3*o),t.__lineArray=new Uint16Array(2*a);var m,g;if(t.numMorphTargets)for(t.__morphTargetsArrays=[],m=0,g=t.numMorphTargets;g>m;m++)t.__morphTargetsArrays.push(new Float32Array(3*r));if(t.numMorphNormals)for(t.__morphNormalsArrays=[],m=0,g=t.numMorphNormals;g>m;m++)t.__morphNormalsArrays.push(new Float32Array(3*r));if(t.__webglFaceCount=3*o,t.__webglLineCount=2*a,s.attributes){void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]);for(var v in s.attributes){var y=s.attributes[v],E={};for(var x in y)E[x]=y[x];if(!E.__webglInitialized||E.createUniqueBuffers){E.__webglInitialized=!0;var T=1;"v2"===E.type?T=2:"v3"===E.type?T=3:"v4"===E.type?T=4:"c"===E.type&&(T=3),E.size=T,E.array=new Float32Array(r*T),E.buffer=Ne.createBuffer(),E.buffer.belongsToAttribute=v,y.needsUpdate=!0,E.__original=y}t.__webglCustomAttributesList.push(E)}}t.__inittedArrays=!0}function c(t,e){return t.material instanceof THREE.MeshFaceMaterial?t.material.materials[e.materialIndex]:t.material}function u(t){return t&&void 0!==t.shading&&t.shading===THREE.SmoothShading}function d(t){return t instanceof THREE.MeshBasicMaterial&&!t.envMap||t instanceof THREE.MeshDepthMaterial?!1:u(t)?THREE.SmoothShading:THREE.FlatShading}function f(t){return t.vertexColors?t.vertexColors:!1}function p(t){return t.map||t.lightMap||t.bumpMap||t.normalMap||t.specularMap||t instanceof THREE.ShaderMaterial?!0:!1}function m(t){var e,i,n;for(e in t.attributes)n="index"===e?Ne.ELEMENT_ARRAY_BUFFER:Ne.ARRAY_BUFFER,i=t.attributes[e],void 0===i.numItems&&(i.numItems=i.array.length),i.buffer=Ne.createBuffer(),Ne.bindBuffer(n,i.buffer),Ne.bufferData(n,i.array,Ne.STATIC_DRAW)}function g(t,e,i){var n,r,o,a,s,l,h,c,u,d,f,p,m=t.vertices,g=m.length,v=t.colors,y=v.length,E=t.__vertexArray,x=t.__colorArray,T=t.__sortArray,_=t.verticesNeedUpdate,b=(t.elementsNeedUpdate,t.colorsNeedUpdate),w=t.__webglCustomAttributesList;if(i.sortParticles){for(Ei.copy(yi),Ei.multiply(i.matrixWorld),n=0;g>n;n++)o=m[n],xi.copy(o),xi.applyProjection(Ei),T[n]=[xi.z,n];
for(T.sort(R),n=0;g>n;n++)o=m[T[n][1]],a=3*n,E[a]=o.x,E[a+1]=o.y,E[a+2]=o.z;for(r=0;y>r;r++)a=3*r,l=v[T[r][1]],x[a]=l.r,x[a+1]=l.g,x[a+2]=l.b;if(w)for(h=0,c=w.length;c>h;h++)if(p=w[h],void 0===p.boundTo||"vertices"===p.boundTo)if(a=0,d=p.value.length,1===p.size)for(u=0;d>u;u++)s=T[u][1],p.array[u]=p.value[s];else if(2===p.size)for(u=0;d>u;u++)s=T[u][1],f=p.value[s],p.array[a]=f.x,p.array[a+1]=f.y,a+=2;else if(3===p.size)if("c"===p.type)for(u=0;d>u;u++)s=T[u][1],f=p.value[s],p.array[a]=f.r,p.array[a+1]=f.g,p.array[a+2]=f.b,a+=3;else for(u=0;d>u;u++)s=T[u][1],f=p.value[s],p.array[a]=f.x,p.array[a+1]=f.y,p.array[a+2]=f.z,a+=3;else if(4===p.size)for(u=0;d>u;u++)s=T[u][1],f=p.value[s],p.array[a]=f.x,p.array[a+1]=f.y,p.array[a+2]=f.z,p.array[a+3]=f.w,a+=4}else{if(_)for(n=0;g>n;n++)o=m[n],a=3*n,E[a]=o.x,E[a+1]=o.y,E[a+2]=o.z;if(b)for(r=0;y>r;r++)l=v[r],a=3*r,x[a]=l.r,x[a+1]=l.g,x[a+2]=l.b;if(w)for(h=0,c=w.length;c>h;h++)if(p=w[h],p.needsUpdate&&(void 0===p.boundTo||"vertices"===p.boundTo))if(d=p.value.length,a=0,1===p.size)for(u=0;d>u;u++)p.array[u]=p.value[u];else if(2===p.size)for(u=0;d>u;u++)f=p.value[u],p.array[a]=f.x,p.array[a+1]=f.y,a+=2;else if(3===p.size)if("c"===p.type)for(u=0;d>u;u++)f=p.value[u],p.array[a]=f.r,p.array[a+1]=f.g,p.array[a+2]=f.b,a+=3;else for(u=0;d>u;u++)f=p.value[u],p.array[a]=f.x,p.array[a+1]=f.y,p.array[a+2]=f.z,a+=3;else if(4===p.size)for(u=0;d>u;u++)f=p.value[u],p.array[a]=f.x,p.array[a+1]=f.y,p.array[a+2]=f.z,p.array[a+3]=f.w,a+=4}if((_||i.sortParticles)&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglVertexBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,E,e)),(b||i.sortParticles)&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglColorBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,x,e)),w)for(h=0,c=w.length;c>h;h++)p=w[h],(p.needsUpdate||i.sortParticles)&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,p.buffer),Ne.bufferData(Ne.ARRAY_BUFFER,p.array,e))}function v(t,e){var i,n,r,o,a,s,l,h,c,u,d,f,p=t.vertices,m=t.colors,g=t.lineDistances,v=p.length,y=m.length,E=g.length,x=t.__vertexArray,T=t.__colorArray,_=t.__lineDistanceArray,b=t.verticesNeedUpdate,w=t.colorsNeedUpdate,R=t.lineDistancesNeedUpdate,S=t.__webglCustomAttributesList;if(b){for(i=0;v>i;i++)o=p[i],a=3*i,x[a]=o.x,x[a+1]=o.y,x[a+2]=o.z;Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglVertexBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,x,e)}if(w){for(n=0;y>n;n++)s=m[n],a=3*n,T[a]=s.r,T[a+1]=s.g,T[a+2]=s.b;Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglColorBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,T,e)}if(R){for(r=0;E>r;r++)_[r]=g[r];Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglLineDistanceBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,_,e)}if(S)for(l=0,h=S.length;h>l;l++)if(f=S[l],f.needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo)){if(a=0,u=f.value.length,1===f.size)for(c=0;u>c;c++)f.array[c]=f.value[c];else if(2===f.size)for(c=0;u>c;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,a+=2;else if(3===f.size)if("c"===f.type)for(c=0;u>c;c++)d=f.value[c],f.array[a]=d.r,f.array[a+1]=d.g,f.array[a+2]=d.b,a+=3;else for(c=0;u>c;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,a+=3;else if(4===f.size)for(c=0;u>c;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,f.array[a+3]=d.w,a+=4;Ne.bindBuffer(Ne.ARRAY_BUFFER,f.buffer),Ne.bufferData(Ne.ARRAY_BUFFER,f.array,e)}}function y(t,e){var i,n,r,o,a,s,l,h,c,u,d,f,p,m=t.vertices,g=t.colors,v=t.normals,y=m.length,E=g.length,x=v.length,T=t.__vertexArray,_=t.__colorArray,b=t.__normalArray,w=t.verticesNeedUpdate,R=t.colorsNeedUpdate,S=t.normalsNeedUpdate,M=t.__webglCustomAttributesList;if(w){for(i=0;y>i;i++)o=m[i],a=3*i,T[a]=o.x,T[a+1]=o.y,T[a+2]=o.z;Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglVertexBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,T,e)}if(R){for(n=0;E>n;n++)s=g[n],a=3*n,_[a]=s.r,_[a+1]=s.g,_[a+2]=s.b;Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglColorBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,_,e)}if(S){for(r=0;x>r;r++)l=v[r],a=3*r,b[a]=l.x,b[a+1]=l.y,b[a+2]=l.z;Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglNormalBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,b,e)}if(M)for(h=0,c=M.length;c>h;h++)if(f=M[h],f.needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo)){if(a=0,d=f.value.length,1===f.size)for(u=0;d>u;u++)f.array[u]=f.value[u];else if(2===f.size)for(u=0;d>u;u++)p=f.value[u],f.array[a]=p.x,f.array[a+1]=p.y,a+=2;else if(3===f.size)if("c"===f.type)for(u=0;d>u;u++)p=f.value[u],f.array[a]=p.r,f.array[a+1]=p.g,f.array[a+2]=p.b,a+=3;else for(u=0;d>u;u++)p=f.value[u],f.array[a]=p.x,f.array[a+1]=p.y,f.array[a+2]=p.z,a+=3;else if(4===f.size)for(u=0;d>u;u++)p=f.value[u],f.array[a]=p.x,f.array[a+1]=p.y,f.array[a+2]=p.z,f.array[a+3]=p.w,a+=4;Ne.bindBuffer(Ne.ARRAY_BUFFER,f.buffer),Ne.bufferData(Ne.ARRAY_BUFFER,f.array,e)}}function E(t,e,i,n,r){if(t.__inittedArrays){var o,a,s,l,h,c,u,m,g,v,y,E,x,T,_,b,w,R,S,M,H,C,A,P,L,O,D,z,N,F,U,I,k,V,B,j,G,W,X,q,Y,K,$=d(r),Q=f(r),Z=p(r),J=$===THREE.SmoothShading,te=0,ee=0,ie=0,ne=0,re=0,oe=0,ae=0,se=0,le=0,he=0,ce=0,ue=0,de=0,fe=t.__vertexArray,pe=t.__uvArray,me=t.__uv2Array,ge=t.__normalArray,ve=t.__tangentArray,ye=t.__colorArray,Ee=t.__skinIndexArray,xe=t.__skinWeightArray,Te=t.__morphTargetsArrays,_e=t.__morphNormalsArrays,be=t.__webglCustomAttributesList,we=t.__faceArray,Re=t.__lineArray,Se=e.geometry,Me=Se.verticesNeedUpdate,He=Se.elementsNeedUpdate,Ce=Se.uvsNeedUpdate,Ae=Se.normalsNeedUpdate,Pe=Se.tangentsNeedUpdate,Le=Se.colorsNeedUpdate,Oe=Se.morphTargetsNeedUpdate,De=Se.vertices,ze=t.faces3,Fe=Se.faces,Ue=Se.faceVertexUvs[0],Ie=Se.faceVertexUvs[1],ke=(Se.colors,Se.skinIndices),Ve=Se.skinWeights,Be=Se.morphTargets,je=Se.morphNormals;if(Me){for(o=0,a=ze.length;a>o;o++)l=Fe[ze[o]],E=De[l.a],x=De[l.b],T=De[l.c],fe[ee]=E.x,fe[ee+1]=E.y,fe[ee+2]=E.z,fe[ee+3]=x.x,fe[ee+4]=x.y,fe[ee+5]=x.z,fe[ee+6]=T.x,fe[ee+7]=T.y,fe[ee+8]=T.z,ee+=9;Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglVertexBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,fe,i)}if(Oe)for(B=0,j=Be.length;j>B;B++){for(ce=0,o=0,a=ze.length;a>o;o++)X=ze[o],l=Fe[X],E=Be[B].vertices[l.a],x=Be[B].vertices[l.b],T=Be[B].vertices[l.c],G=Te[B],G[ce]=E.x,G[ce+1]=E.y,G[ce+2]=E.z,G[ce+3]=x.x,G[ce+4]=x.y,G[ce+5]=x.z,G[ce+6]=T.x,G[ce+7]=T.y,G[ce+8]=T.z,r.morphNormals&&(J?(q=je[B].vertexNormals[X],R=q.a,S=q.b,M=q.c):(R=je[B].faceNormals[X],S=R,M=R),W=_e[B],W[ce]=R.x,W[ce+1]=R.y,W[ce+2]=R.z,W[ce+3]=S.x,W[ce+4]=S.y,W[ce+5]=S.z,W[ce+6]=M.x,W[ce+7]=M.y,W[ce+8]=M.z),ce+=9;Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[B]),Ne.bufferData(Ne.ARRAY_BUFFER,Te[B],i),r.morphNormals&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[B]),Ne.bufferData(Ne.ARRAY_BUFFER,_e[B],i))}if(Ve.length){for(o=0,a=ze.length;a>o;o++)l=Fe[ze[o]],P=Ve[l.a],L=Ve[l.b],O=Ve[l.c],xe[he]=P.x,xe[he+1]=P.y,xe[he+2]=P.z,xe[he+3]=P.w,xe[he+4]=L.x,xe[he+5]=L.y,xe[he+6]=L.z,xe[he+7]=L.w,xe[he+8]=O.x,xe[he+9]=O.y,xe[he+10]=O.z,xe[he+11]=O.w,D=ke[l.a],z=ke[l.b],N=ke[l.c],Ee[he]=D.x,Ee[he+1]=D.y,Ee[he+2]=D.z,Ee[he+3]=D.w,Ee[he+4]=z.x,Ee[he+5]=z.y,Ee[he+6]=z.z,Ee[he+7]=z.w,Ee[he+8]=N.x,Ee[he+9]=N.y,Ee[he+10]=N.z,Ee[he+11]=N.w,he+=12;he>0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglSkinIndicesBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,Ee,i),Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglSkinWeightsBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,xe,i))}if(Le&&Q){for(o=0,a=ze.length;a>o;o++)l=Fe[ze[o]],u=l.vertexColors,m=l.color,3===u.length&&Q===THREE.VertexColors?(H=u[0],C=u[1],A=u[2]):(H=m,C=m,A=m),ye[le]=H.r,ye[le+1]=H.g,ye[le+2]=H.b,ye[le+3]=C.r,ye[le+4]=C.g,ye[le+5]=C.b,ye[le+6]=A.r,ye[le+7]=A.g,ye[le+8]=A.b,le+=9;le>0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglColorBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,ye,i))}if(Pe&&Se.hasTangents){for(o=0,a=ze.length;a>o;o++)l=Fe[ze[o]],g=l.vertexTangents,_=g[0],b=g[1],w=g[2],ve[ae]=_.x,ve[ae+1]=_.y,ve[ae+2]=_.z,ve[ae+3]=_.w,ve[ae+4]=b.x,ve[ae+5]=b.y,ve[ae+6]=b.z,ve[ae+7]=b.w,ve[ae+8]=w.x,ve[ae+9]=w.y,ve[ae+10]=w.z,ve[ae+11]=w.w,ae+=12;Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglTangentBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,ve,i)}if(Ae&&$){for(o=0,a=ze.length;a>o;o++)if(l=Fe[ze[o]],h=l.vertexNormals,c=l.normal,3===h.length&&J)for(F=0;3>F;F++)I=h[F],ge[oe]=I.x,ge[oe+1]=I.y,ge[oe+2]=I.z,oe+=3;else for(F=0;3>F;F++)ge[oe]=c.x,ge[oe+1]=c.y,ge[oe+2]=c.z,oe+=3;Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglNormalBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,ge,i)}if(Ce&&Ue&&Z){for(o=0,a=ze.length;a>o;o++)if(s=ze[o],v=Ue[s],void 0!==v)for(F=0;3>F;F++)k=v[F],pe[ie]=k.x,pe[ie+1]=k.y,ie+=2;ie>0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglUVBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,pe,i))}if(Ce&&Ie&&Z){for(o=0,a=ze.length;a>o;o++)if(s=ze[o],y=Ie[s],void 0!==y)for(F=0;3>F;F++)V=y[F],me[ne]=V.x,me[ne+1]=V.y,ne+=2;ne>0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglUV2Buffer),Ne.bufferData(Ne.ARRAY_BUFFER,me,i))}if(He){for(o=0,a=ze.length;a>o;o++)we[re]=te,we[re+1]=te+1,we[re+2]=te+2,re+=3,Re[se]=te,Re[se+1]=te+1,Re[se+2]=te,Re[se+3]=te+2,Re[se+4]=te+1,Re[se+5]=te+2,se+=6,te+=3;Ne.bindBuffer(Ne.ELEMENT_ARRAY_BUFFER,t.__webglFaceBuffer),Ne.bufferData(Ne.ELEMENT_ARRAY_BUFFER,we,i),Ne.bindBuffer(Ne.ELEMENT_ARRAY_BUFFER,t.__webglLineBuffer),Ne.bufferData(Ne.ELEMENT_ARRAY_BUFFER,Re,i)}if(be)for(F=0,U=be.length;U>F;F++)if(K=be[F],K.__original.needsUpdate){if(ue=0,de=0,1===K.size){if(void 0===K.boundTo||"vertices"===K.boundTo)for(o=0,a=ze.length;a>o;o++)l=Fe[ze[o]],K.array[ue]=K.value[l.a],K.array[ue+1]=K.value[l.b],K.array[ue+2]=K.value[l.c],ue+=3;else if("faces"===K.boundTo)for(o=0,a=ze.length;a>o;o++)Y=K.value[ze[o]],K.array[ue]=Y,K.array[ue+1]=Y,K.array[ue+2]=Y,ue+=3}else if(2===K.size){if(void 0===K.boundTo||"vertices"===K.boundTo)for(o=0,a=ze.length;a>o;o++)l=Fe[ze[o]],E=K.value[l.a],x=K.value[l.b],T=K.value[l.c],K.array[ue]=E.x,K.array[ue+1]=E.y,K.array[ue+2]=x.x,K.array[ue+3]=x.y,K.array[ue+4]=T.x,K.array[ue+5]=T.y,ue+=6;else if("faces"===K.boundTo)for(o=0,a=ze.length;a>o;o++)Y=K.value[ze[o]],E=Y,x=Y,T=Y,K.array[ue]=E.x,K.array[ue+1]=E.y,K.array[ue+2]=x.x,K.array[ue+3]=x.y,K.array[ue+4]=T.x,K.array[ue+5]=T.y,ue+=6}else if(3===K.size){var Ge;if(Ge="c"===K.type?["r","g","b"]:["x","y","z"],void 0===K.boundTo||"vertices"===K.boundTo)for(o=0,a=ze.length;a>o;o++)l=Fe[ze[o]],E=K.value[l.a],x=K.value[l.b],T=K.value[l.c],K.array[ue]=E[Ge[0]],K.array[ue+1]=E[Ge[1]],K.array[ue+2]=E[Ge[2]],K.array[ue+3]=x[Ge[0]],K.array[ue+4]=x[Ge[1]],K.array[ue+5]=x[Ge[2]],K.array[ue+6]=T[Ge[0]],K.array[ue+7]=T[Ge[1]],K.array[ue+8]=T[Ge[2]],ue+=9;else if("faces"===K.boundTo)for(o=0,a=ze.length;a>o;o++)Y=K.value[ze[o]],E=Y,x=Y,T=Y,K.array[ue]=E[Ge[0]],K.array[ue+1]=E[Ge[1]],K.array[ue+2]=E[Ge[2]],K.array[ue+3]=x[Ge[0]],K.array[ue+4]=x[Ge[1]],K.array[ue+5]=x[Ge[2]],K.array[ue+6]=T[Ge[0]],K.array[ue+7]=T[Ge[1]],K.array[ue+8]=T[Ge[2]],ue+=9;else if("faceVertices"===K.boundTo)for(o=0,a=ze.length;a>o;o++)Y=K.value[ze[o]],E=Y[0],x=Y[1],T=Y[2],K.array[ue]=E[Ge[0]],K.array[ue+1]=E[Ge[1]],K.array[ue+2]=E[Ge[2]],K.array[ue+3]=x[Ge[0]],K.array[ue+4]=x[Ge[1]],K.array[ue+5]=x[Ge[2]],K.array[ue+6]=T[Ge[0]],K.array[ue+7]=T[Ge[1]],K.array[ue+8]=T[Ge[2]],ue+=9}else if(4===K.size)if(void 0===K.boundTo||"vertices"===K.boundTo)for(o=0,a=ze.length;a>o;o++)l=Fe[ze[o]],E=K.value[l.a],x=K.value[l.b],T=K.value[l.c],K.array[ue]=E.x,K.array[ue+1]=E.y,K.array[ue+2]=E.z,K.array[ue+3]=E.w,K.array[ue+4]=x.x,K.array[ue+5]=x.y,K.array[ue+6]=x.z,K.array[ue+7]=x.w,K.array[ue+8]=T.x,K.array[ue+9]=T.y,K.array[ue+10]=T.z,K.array[ue+11]=T.w,ue+=12;else if("faces"===K.boundTo)for(o=0,a=ze.length;a>o;o++)Y=K.value[ze[o]],E=Y,x=Y,T=Y,K.array[ue]=E.x,K.array[ue+1]=E.y,K.array[ue+2]=E.z,K.array[ue+3]=E.w,K.array[ue+4]=x.x,K.array[ue+5]=x.y,K.array[ue+6]=x.z,K.array[ue+7]=x.w,K.array[ue+8]=T.x,K.array[ue+9]=T.y,K.array[ue+10]=T.z,K.array[ue+11]=T.w,ue+=12;else if("faceVertices"===K.boundTo)for(o=0,a=ze.length;a>o;o++)Y=K.value[ze[o]],E=Y[0],x=Y[1],T=Y[2],K.array[ue]=E.x,K.array[ue+1]=E.y,K.array[ue+2]=E.z,K.array[ue+3]=E.w,K.array[ue+4]=x.x,K.array[ue+5]=x.y,K.array[ue+6]=x.z,K.array[ue+7]=x.w,K.array[ue+8]=T.x,K.array[ue+9]=T.y,K.array[ue+10]=T.z,K.array[ue+11]=T.w,ue+=12;Ne.bindBuffer(Ne.ARRAY_BUFFER,K.buffer),Ne.bufferData(Ne.ARRAY_BUFFER,K.array,i)}n&&(delete t.__inittedArrays,delete t.__colorArray,delete t.__normalArray,delete t.__tangentArray,delete t.__uvArray,delete t.__uv2Array,delete t.__faceArray,delete t.__vertexArray,delete t.__lineArray,delete t.__skinIndexArray,delete t.__skinWeightArray)}}function x(t,e,i){var n,r,o=t.attributes;for(n in o)r=o[n],r.needsUpdate&&("index"===n?(Ne.bindBuffer(Ne.ELEMENT_ARRAY_BUFFER,r.buffer),Ne.bufferData(Ne.ELEMENT_ARRAY_BUFFER,r.array,e)):(Ne.bindBuffer(Ne.ARRAY_BUFFER,r.buffer),Ne.bufferData(Ne.ARRAY_BUFFER,r.array,e)),r.needsUpdate=!1),i&&!r.dynamic&&(r.array=null)}function T(t){gi[t]||(Ne.enableVertexAttribArray(t),gi[t]=!0)}function _(){for(var t in gi)gi[t]&&(Ne.disableVertexAttribArray(t),gi[t]=!1)}function b(t,e,i){var n=t.program.attributes;if(-1!==i.morphTargetBase&&n.position>=0?(Ne.bindBuffer(Ne.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[i.morphTargetBase]),T(n.position),Ne.vertexAttribPointer(n.position,3,Ne.FLOAT,!1,0,0)):n.position>=0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,e.__webglVertexBuffer),T(n.position),Ne.vertexAttribPointer(n.position,3,Ne.FLOAT,!1,0,0)),i.morphTargetForcedOrder.length)for(var r=0,o=i.morphTargetForcedOrder,a=i.morphTargetInfluences;r<t.numSupportedMorphTargets&&r<o.length;)n["morphTarget"+r]>=0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[o[r]]),T(n["morphTarget"+r]),Ne.vertexAttribPointer(n["morphTarget"+r],3,Ne.FLOAT,!1,0,0)),n["morphNormal"+r]>=0&&t.morphNormals&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[o[r]]),T(n["morphNormal"+r]),Ne.vertexAttribPointer(n["morphNormal"+r],3,Ne.FLOAT,!1,0,0)),i.__webglMorphTargetInfluences[r]=a[o[r]],r++;else{var s,l,h=[],a=i.morphTargetInfluences,c=a.length;for(l=0;c>l;l++)s=a[l],s>0&&h.push([s,l]);h.length>t.numSupportedMorphTargets?(h.sort(R),h.length=t.numSupportedMorphTargets):h.length>t.numSupportedMorphNormals?h.sort(R):0===h.length&&h.push([0,0]);for(var u,r=0;r<t.numSupportedMorphTargets;)h[r]?(u=h[r][1],n["morphTarget"+r]>=0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[u]),T(n["morphTarget"+r]),Ne.vertexAttribPointer(n["morphTarget"+r],3,Ne.FLOAT,!1,0,0)),n["morphNormal"+r]>=0&&t.morphNormals&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[u]),T(n["morphNormal"+r]),Ne.vertexAttribPointer(n["morphNormal"+r],3,Ne.FLOAT,!1,0,0)),i.__webglMorphTargetInfluences[r]=a[u]):i.__webglMorphTargetInfluences[r]=0,r++}null!==t.program.uniforms.morphTargetInfluences&&Ne.uniform1fv(t.program.uniforms.morphTargetInfluences,i.__webglMorphTargetInfluences)}function w(t,e){return t.z!==e.z?e.z-t.z:t.id-e.id}function R(t,e){return e[0]-t[0]}function S(t,e,i){if(t.length)for(var n=0,r=t.length;r>n;n++)We=null,Ke=null,ti=-1,ri=-1,oi=-1,Ze=-1,Je=-1,Ye=-1,qe=-1,_i=!0,t[n].render(e,i,pi,mi),We=null,Ke=null,ti=-1,ri=-1,oi=-1,Ze=-1,Je=-1,Ye=-1,qe=-1,_i=!0}function M(t,e,i,n,r,o,a,s){var l,h,c,u,d,f,p;e?(d=t.length-1,f=-1,p=-1):(d=0,f=t.length,p=1);for(var m=d;m!==f;m+=p)if(l=t[m],l.render){if(h=l.object,c=l.buffer,s)u=s;else{if(u=l[i],!u)continue;a&&Be.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),Be.setDepthTest(u.depthTest),Be.setDepthWrite(u.depthWrite),ae(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits)}Be.setMaterialFaces(u),c instanceof THREE.BufferGeometry?Be.renderBufferDirect(n,r,o,u,c,h):Be.renderBuffer(n,r,o,u,c,h)}}function H(t,e,i,n,r,o,a){for(var s,l,h,c=0,u=t.length;u>c;c++)if(s=t[c],l=s.object,l.visible){if(a)h=a;else{if(h=s[e],!h)continue;o&&Be.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst),Be.setDepthTest(h.depthTest),Be.setDepthWrite(h.depthWrite),ae(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}Be.renderImmediateObject(i,n,r,h,l)}}function C(t){var e=t.object,i=e.material;i.transparent?(t.transparent=i,t.opaque=null):(t.opaque=i,t.transparent=null)}function A(t){var e,i,n,r=t.object,o=t.buffer;n=r.material,n instanceof THREE.MeshFaceMaterial?(i=o.materialIndex,e=n.materials[i],e.transparent?(t.transparent=e,t.opaque=null):(t.opaque=e,t.transparent=null)):(e=n,e&&(e.transparent?(t.transparent=e,t.opaque=null):(t.opaque=e,t.transparent=null)))}function P(t,e){var i,n,r,o,a,s,l={},h=t.morphTargets.length,c=t.morphNormals.length,u=e instanceof THREE.MeshFaceMaterial;for(t.geometryGroups={},i=0,n=t.faces.length;n>i;i++)r=t.faces[i],o=u?r.materialIndex:0,void 0===l[o]&&(l[o]={hash:o,counter:0}),s=l[o].hash+"_"+l[o].counter,void 0===t.geometryGroups[s]&&(t.geometryGroups[s]={faces3:[],materialIndex:o,vertices:0,numMorphTargets:h,numMorphNormals:c}),a=3,t.geometryGroups[s].vertices+a>65535&&(l[o].counter+=1,s=l[o].hash+"_"+l[o].counter,void 0===t.geometryGroups[s]&&(t.geometryGroups[s]={faces3:[],materialIndex:o,vertices:0,numMorphTargets:h,numMorphNormals:c})),t.geometryGroups[s].faces3.push(i),t.geometryGroups[s].vertices+=a;t.geometryGroupsList=[];for(var d in t.geometryGroups)t.geometryGroups[d].id=$e++,t.geometryGroupsList.push(t.geometryGroups[d])}function L(t,o){var c,u,d,f;if(void 0===t.__webglInit&&(t.__webglInit=!0,t._modelViewMatrix=new THREE.Matrix4,t._normalMatrix=new THREE.Matrix3,void 0!==t.geometry&&void 0===t.geometry.__webglInit&&(t.geometry.__webglInit=!0,t.geometry.addEventListener("dispose",zi)),u=t.geometry,void 0!==u))if(u instanceof THREE.BufferGeometry)m(u);else if(t instanceof THREE.Mesh){d=t.material,void 0===u.geometryGroups&&P(u,d);for(c in u.geometryGroups)f=u.geometryGroups[c],f.__webglVertexBuffer||(r(f),h(f,t),u.verticesNeedUpdate=!0,u.morphTargetsNeedUpdate=!0,u.elementsNeedUpdate=!0,u.uvsNeedUpdate=!0,u.normalsNeedUpdate=!0,u.tangentsNeedUpdate=!0,u.colorsNeedUpdate=!0)}else t instanceof THREE.Ribbon?u.__webglVertexBuffer||(n(u),l(u,t),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0,u.normalsNeedUpdate=!0):t instanceof THREE.Line?u.__webglVertexBuffer||(i(u),s(u,t),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0,u.lineDistancesNeedUpdate=!0):t instanceof THREE.ParticleSystem&&(u.__webglVertexBuffer||(e(u),a(u,t),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0));if(void 0===t.__webglActive){if(t instanceof THREE.Mesh){if(u=t.geometry,u instanceof THREE.BufferGeometry)O(o.__webglObjects,u,t);else if(u instanceof THREE.Geometry)for(c in u.geometryGroups)f=u.geometryGroups[c],O(o.__webglObjects,f,t)}else t instanceof THREE.Ribbon||t instanceof THREE.Line||t instanceof THREE.ParticleSystem?(u=t.geometry,O(o.__webglObjects,u,t)):t instanceof THREE.ImmediateRenderObject||t.immediateRenderCallback?D(o.__webglObjectsImmediate,t):t instanceof THREE.Sprite?o.__webglSprites.push(t):t instanceof THREE.LensFlare&&o.__webglFlares.push(t);t.__webglActive=!0}}function O(t,e,i){t.push({id:null,buffer:e,object:i,opaque:null,transparent:null,z:0})}function D(t,e){t.push({id:null,object:e,opaque:null,transparent:null,z:0})}function z(t){var e,i,n,r=t.geometry;if(r instanceof THREE.BufferGeometry)x(r,Ne.DYNAMIC_DRAW,!r.dynamic);else if(t instanceof THREE.Mesh){for(var o=0,a=r.geometryGroupsList.length;a>o;o++)e=r.geometryGroupsList[o],n=c(t,e),r.buffersNeedUpdate&&h(e,t),i=n.attributes&&N(n),(r.verticesNeedUpdate||r.morphTargetsNeedUpdate||r.elementsNeedUpdate||r.uvsNeedUpdate||r.normalsNeedUpdate||r.colorsNeedUpdate||r.tangentsNeedUpdate||i)&&E(e,t,Ne.DYNAMIC_DRAW,!r.dynamic,n);r.verticesNeedUpdate=!1,r.morphTargetsNeedUpdate=!1,r.elementsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.tangentsNeedUpdate=!1,r.buffersNeedUpdate=!1,n.attributes&&F(n)}else t instanceof THREE.Ribbon?(n=c(t,r),i=n.attributes&&N(n),(r.verticesNeedUpdate||r.colorsNeedUpdate||r.normalsNeedUpdate||i)&&y(r,Ne.DYNAMIC_DRAW),r.verticesNeedUpdate=!1,r.colorsNeedUpdate=!1,r.normalsNeedUpdate=!1,n.attributes&&F(n)):t instanceof THREE.Line?(n=c(t,r),i=n.attributes&&N(n),(r.verticesNeedUpdate||r.colorsNeedUpdate||r.lineDistancesNeedUpdate||i)&&v(r,Ne.DYNAMIC_DRAW),r.verticesNeedUpdate=!1,r.colorsNeedUpdate=!1,r.lineDistancesNeedUpdate=!1,n.attributes&&F(n)):t instanceof THREE.ParticleSystem&&(n=c(t,r),i=n.attributes&&N(n),(r.verticesNeedUpdate||r.colorsNeedUpdate||t.sortParticles||i)&&g(r,Ne.DYNAMIC_DRAW,t),r.verticesNeedUpdate=!1,r.colorsNeedUpdate=!1,n.attributes&&F(n))}function N(t){for(var e in t.attributes)if(t.attributes[e].needsUpdate)return!0;return!1}function F(t){for(var e in t.attributes)t.attributes[e].needsUpdate=!1}function U(t,e){t instanceof THREE.Mesh||t instanceof THREE.ParticleSystem||t instanceof THREE.Ribbon||t instanceof THREE.Line?I(e.__webglObjects,t):t instanceof THREE.Sprite?k(e.__webglSprites,t):t instanceof THREE.LensFlare?k(e.__webglFlares,t):(t instanceof THREE.ImmediateRenderObject||t.immediateRenderCallback)&&I(e.__webglObjectsImmediate,t),delete t.__webglActive}function I(t,e){for(var i=t.length-1;i>=0;i--)t[i].object===e&&t.splice(i,1)}function k(t,e){for(var i=t.length-1;i>=0;i--)t[i]===e&&t.splice(i,1)}function V(t,e){t.uniforms=THREE.UniformsUtils.clone(e.uniforms),t.vertexShader=e.vertexShader,t.fragmentShader=e.fragmentShader}function B(t,e,i,n,r){Qe=0,n.needsUpdate&&(n.program&&ji(n),Be.initMaterial(n,e,i,r),n.needsUpdate=!1),n.morphTargets&&(r.__webglMorphTargetInfluences||(r.__webglMorphTargetInfluences=new Float32Array(Be.maxMorphTargets)));var o=!1,a=n.program,s=a.uniforms,l=n.uniforms;if(a!==We&&(Ne.useProgram(a),We=a,o=!0),n.id!==qe&&(qe=n.id,o=!0),(o||t!==Ke)&&(Ne.uniformMatrix4fv(s.projectionMatrix,!1,t.projectionMatrix.elements),t!==Ke&&(Ke=t)),n.skinning)if(Hi&&r.useVertexTexture){if(null!==s.boneTexture){var h=J();Ne.uniform1i(s.boneTexture,h),Be.setTexture(r.boneTexture,h)}}else null!==s.boneGlobalMatrices&&Ne.uniformMatrix4fv(s.boneGlobalMatrices,!1,r.boneMatrices);return o&&(i&&n.fog&&q(l,i),(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n.lights)&&(_i&&(re(a,e),_i=!1),$(l,bi)),(n instanceof THREE.MeshBasicMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.MeshPhongMaterial)&&j(l,n),n instanceof THREE.LineBasicMaterial?G(l,n):n instanceof THREE.LineDashedMaterial?(G(l,n),W(l,n)):n instanceof THREE.ParticleBasicMaterial?X(l,n):n instanceof THREE.MeshPhongMaterial?Y(l,n):n instanceof THREE.MeshLambertMaterial?K(l,n):n instanceof THREE.MeshDepthMaterial?(l.mNear.value=t.near,l.mFar.value=t.far,l.opacity.value=n.opacity):n instanceof THREE.MeshNormalMaterial&&(l.opacity.value=n.opacity),r.receiveShadow&&!n._shadowPass&&Q(l,e),te(a,n.uniformsList),(n instanceof THREE.ShaderMaterial||n instanceof THREE.MeshPhongMaterial||n.envMap)&&null!==s.cameraPosition&&(xi.getPositionFromMatrix(t.matrixWorld),Ne.uniform3f(s.cameraPosition,xi.x,xi.y,xi.z)),(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.ShaderMaterial||n.skinning)&&null!==s.viewMatrix&&Ne.uniformMatrix4fv(s.viewMatrix,!1,t.matrixWorldInverse.elements)),Z(s,r),null!==s.modelMatrix&&Ne.uniformMatrix4fv(s.modelMatrix,!1,r.matrixWorld.elements),a}function j(t,e){t.opacity.value=e.opacity,Be.gammaInput?t.diffuse.value.copyGammaToLinear(e.color):t.diffuse.value=e.color,t.map.value=e.map,t.lightMap.value=e.lightMap,t.specularMap.value=e.specularMap,e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale));var i;if(e.map?i=e.map:e.specularMap?i=e.specularMap:e.normalMap?i=e.normalMap:e.bumpMap&&(i=e.bumpMap),void 0!==i){var n=i.offset,r=i.repeat;t.offsetRepeat.value.set(n.x,n.y,r.x,r.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,t.reflectivity.value=Be.gammaInput?e.reflectivity:e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.combine.value=e.combine,t.useRefract.value=e.envMap&&e.envMap.mapping instanceof THREE.CubeRefractionMapping}function G(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function W(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function X(t,e){t.psColor.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size,t.scale.value=Me.height/2,t.map.value=e.map}function q(t,e){t.fogColor.value=e.color,e instanceof THREE.Fog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e instanceof THREE.FogExp2&&(t.fogDensity.value=e.density)}function Y(t,e){t.shininess.value=e.shininess,Be.gammaInput?(t.ambient.value.copyGammaToLinear(e.ambient),t.emissive.value.copyGammaToLinear(e.emissive),t.specular.value.copyGammaToLinear(e.specular)):(t.ambient.value=e.ambient,t.emissive.value=e.emissive,t.specular.value=e.specular),e.wrapAround&&t.wrapRGB.value.copy(e.wrapRGB)}function K(t,e){Be.gammaInput?(t.ambient.value.copyGammaToLinear(e.ambient),t.emissive.value.copyGammaToLinear(e.emissive)):(t.ambient.value=e.ambient,t.emissive.value=e.emissive),e.wrapAround&&t.wrapRGB.value.copy(e.wrapRGB)}function $(t,e){t.ambientLightColor.value=e.ambient,t.directionalLightColor.value=e.directional.colors,t.directionalLightDirection.value=e.directional.positions,t.pointLightColor.value=e.point.colors,t.pointLightPosition.value=e.point.positions,t.pointLightDistance.value=e.point.distances,t.spotLightColor.value=e.spot.colors,t.spotLightPosition.value=e.spot.positions,t.spotLightDistance.value=e.spot.distances,t.spotLightDirection.value=e.spot.directions,t.spotLightAngleCos.value=e.spot.anglesCos,t.spotLightExponent.value=e.spot.exponents,t.hemisphereLightSkyColor.value=e.hemi.skyColors,t.hemisphereLightGroundColor.value=e.hemi.groundColors,t.hemisphereLightDirection.value=e.hemi.positions}function Q(t,e){if(t.shadowMatrix)for(var i=0,n=0,r=e.length;r>n;n++){var o=e[n];o.castShadow&&(o instanceof THREE.SpotLight||o instanceof THREE.DirectionalLight&&!o.shadowCascade)&&(t.shadowMap.value[i]=o.shadowMap,t.shadowMapSize.value[i]=o.shadowMapSize,t.shadowMatrix.value[i]=o.shadowMatrix,t.shadowDarkness.value[i]=o.shadowDarkness,t.shadowBias.value[i]=o.shadowBias,i++)}}function Z(t,e){Ne.uniformMatrix4fv(t.modelViewMatrix,!1,e._modelViewMatrix.elements),t.normalMatrix&&Ne.uniformMatrix3fv(t.normalMatrix,!1,e._normalMatrix.elements)}function J(){var t=Qe;return Qe+=1,t}function te(t,e){var i,n,r,o,a,s,l,h,c,u,d;for(c=0,u=e.length;u>c;c++)if(o=t.uniforms[e[c][1]])if(i=e[c][0],r=i.type,n=i.value,"i"===r)Ne.uniform1i(o,n);else if("f"===r)Ne.uniform1f(o,n);else if("v2"===r)Ne.uniform2f(o,n.x,n.y);else if("v3"===r)Ne.uniform3f(o,n.x,n.y,n.z);else if("v4"===r)Ne.uniform4f(o,n.x,n.y,n.z,n.w);else if("c"===r)Ne.uniform3f(o,n.r,n.g,n.b);else if("iv1"===r)Ne.uniform1iv(o,n);else if("iv"===r)Ne.uniform3iv(o,n);else if("fv1"===r)Ne.uniform1fv(o,n);else if("fv"===r)Ne.uniform3fv(o,n);else if("v2v"===r){for(void 0===i._array&&(i._array=new Float32Array(2*n.length)),l=0,h=n.length;h>l;l++)d=2*l,i._array[d]=n[l].x,i._array[d+1]=n[l].y;Ne.uniform2fv(o,i._array)}else if("v3v"===r){for(void 0===i._array&&(i._array=new Float32Array(3*n.length)),l=0,h=n.length;h>l;l++)d=3*l,i._array[d]=n[l].x,i._array[d+1]=n[l].y,i._array[d+2]=n[l].z;Ne.uniform3fv(o,i._array)}else if("v4v"===r){for(void 0===i._array&&(i._array=new Float32Array(4*n.length)),l=0,h=n.length;h>l;l++)d=4*l,i._array[d]=n[l].x,i._array[d+1]=n[l].y,i._array[d+2]=n[l].z,i._array[d+3]=n[l].w;Ne.uniform4fv(o,i._array)}else if("m4"===r)void 0===i._array&&(i._array=new Float32Array(16)),n.flattenToArray(i._array),Ne.uniformMatrix4fv(o,!1,i._array);else if("m4v"===r){for(void 0===i._array&&(i._array=new Float32Array(16*n.length)),l=0,h=n.length;h>l;l++)n[l].flattenToArrayOffset(i._array,16*l);Ne.uniformMatrix4fv(o,!1,i._array)}else if("t"===r){if(a=n,s=J(),Ne.uniform1i(o,s),!a)continue;a.image instanceof Array&&6===a.image.length?me(a,s):a instanceof THREE.WebGLRenderTargetCube?ge(a,s):Be.setTexture(a,s)}else if("tv"===r){for(void 0===i._array&&(i._array=[]),l=0,h=i.value.length;h>l;l++)i._array[l]=J();for(Ne.uniform1iv(o,i._array),l=0,h=i.value.length;h>l;l++)a=i.value[l],s=i._array[l],a&&Be.setTexture(a,s)}}function ee(t,e){t._modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,t.matrixWorld),t._normalMatrix.getNormalMatrix(t._modelViewMatrix)}function ie(t,e,i,n){t[e]=i.r*i.r*n,t[e+1]=i.g*i.g*n,t[e+2]=i.b*i.b*n}function ne(t,e,i,n){t[e]=i.r*n,t[e+1]=i.g*n,t[e+2]=i.b*n}function re(t,e){var i,n,r,o,a,s,l,h,c,u=0,d=0,f=0,p=bi,m=p.directional.colors,g=p.directional.positions,v=p.point.colors,y=p.point.positions,E=p.point.distances,x=p.spot.colors,T=p.spot.positions,_=p.spot.distances,b=p.spot.directions,w=p.spot.anglesCos,R=p.spot.exponents,S=p.hemi.skyColors,M=p.hemi.groundColors,H=p.hemi.positions,C=0,A=0,P=0,L=0,O=0,D=0,z=0,N=0,F=0,U=0,I=0,k=0;for(i=0,n=e.length;n>i;i++)if(r=e[i],!r.onlyShadow)if(o=r.color,l=r.intensity,c=r.distance,r instanceof THREE.AmbientLight){if(!r.visible)continue;Be.gammaInput?(u+=o.r*o.r,d+=o.g*o.g,f+=o.b*o.b):(u+=o.r,d+=o.g,f+=o.b)}else if(r instanceof THREE.DirectionalLight){if(O+=1,!r.visible)continue;if(Ti.getPositionFromMatrix(r.matrixWorld),xi.getPositionFromMatrix(r.target.matrixWorld),Ti.sub(xi),Ti.normalize(),0===Ti.x&&0===Ti.y&&0===Ti.z)continue;F=3*C,g[F]=Ti.x,g[F+1]=Ti.y,g[F+2]=Ti.z,Be.gammaInput?ie(m,F,o,l*l):ne(m,F,o,l),C+=1}else if(r instanceof THREE.PointLight){if(D+=1,!r.visible)continue;U=3*A,Be.gammaInput?ie(v,U,o,l*l):ne(v,U,o,l),xi.getPositionFromMatrix(r.matrixWorld),y[U]=xi.x,y[U+1]=xi.y,y[U+2]=xi.z,E[A]=c,A+=1}else if(r instanceof THREE.SpotLight){if(z+=1,!r.visible)continue;I=3*P,Be.gammaInput?ie(x,I,o,l*l):ne(x,I,o,l),xi.getPositionFromMatrix(r.matrixWorld),T[I]=xi.x,T[I+1]=xi.y,T[I+2]=xi.z,_[P]=c,Ti.copy(xi),xi.getPositionFromMatrix(r.target.matrixWorld),Ti.sub(xi),Ti.normalize(),b[I]=Ti.x,b[I+1]=Ti.y,b[I+2]=Ti.z,w[P]=Math.cos(r.angle),R[P]=r.exponent,P+=1}else if(r instanceof THREE.HemisphereLight){if(N+=1,!r.visible)continue;if(Ti.getPositionFromMatrix(r.matrixWorld),Ti.normalize(),0===Ti.x&&0===Ti.y&&0===Ti.z)continue;k=3*L,H[k]=Ti.x,H[k+1]=Ti.y,H[k+2]=Ti.z,a=r.color,s=r.groundColor,Be.gammaInput?(h=l*l,ie(S,k,a,h),ie(M,k,s,h)):(ne(S,k,a,l),ne(M,k,s,l)),L+=1}for(i=3*C,n=Math.max(m.length,3*O);n>i;i++)m[i]=0;for(i=3*A,n=Math.max(v.length,3*D);n>i;i++)v[i]=0;for(i=3*P,n=Math.max(x.length,3*z);n>i;i++)x[i]=0;for(i=3*L,n=Math.max(S.length,3*N);n>i;i++)S[i]=0;for(i=3*L,n=Math.max(M.length,3*N);n>i;i++)M[i]=0;p.directional.length=C,p.point.length=A,p.spot.length=P,p.hemi.length=L,p.ambient[0]=u,p.ambient[1]=d,p.ambient[2]=f}function oe(t){t!==hi&&(Ne.lineWidth(t),hi=t)}function ae(t,e,i){ai!==t&&(t?Ne.enable(Ne.POLYGON_OFFSET_FILL):Ne.disable(Ne.POLYGON_OFFSET_FILL),ai=t),t&&(si!==e||li!==i)&&(Ne.polygonOffset(e,i),si=e,li=i)}function se(t){var e,i,n=[];for(var r in t)e=t[r],e!==!1&&(i="#define "+r+" "+e,n.push(i));return n.join("\n")}function le(t,e,i,n,r,o,a,s){var l,h,c,u,d,f=[];t?f.push(t):(f.push(e),f.push(i));for(c in o)f.push(c),f.push(o[c]);for(l in a)f.push(l),f.push(a[l]);for(d=f.join(),l=0,h=je.length;h>l;l++){var p=je[l];if(p.code===d)return p.usedTimes++,p.program}var m="SHADOWMAP_TYPE_BASIC";a.shadowMapType===THREE.PCFShadowMap?m="SHADOWMAP_TYPE_PCF":a.shadowMapType===THREE.PCFSoftShadowMap&&(m="SHADOWMAP_TYPE_PCF_SOFT");var g=se(o);u=Ne.createProgram();var v=["precision "+He+" float;","precision "+He+" int;",g,Mi?"#define VERTEX_TEXTURES":"",Be.gammaInput?"#define GAMMA_INPUT":"",Be.gammaOutput?"#define GAMMA_OUTPUT":"",Be.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,"#define MAX_BONES "+a.maxBones,a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.boneTextureWidth?"#define N_BONE_PIXEL_X "+a.boneTextureWidth.toFixed(1):"",a.boneTextureHeight?"#define N_BONE_PIXEL_Y "+a.boneTextureHeight.toFixed(1):"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals?"#define USE_MORPHNORMALS":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+m:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","attribute vec3 morphTarget0;","attribute vec3 morphTarget1;","attribute vec3 morphTarget2;","attribute vec3 morphTarget3;","#ifdef USE_MORPHNORMALS","attribute vec3 morphNormal0;","attribute vec3 morphNormal1;","attribute vec3 morphNormal2;","attribute vec3 morphNormal3;","#else","attribute vec3 morphTarget4;","attribute vec3 morphTarget5;","attribute vec3 morphTarget6;","attribute vec3 morphTarget7;","#endif","#endif","#ifdef USE_SKINNING","attribute vec4 skinIndex;","attribute vec4 skinWeight;","#endif",""].join("\n"),y=["precision "+He+" float;","precision "+He+" int;",a.bumpMap||a.normalMap?"#extension GL_OES_standard_derivatives : enable":"",g,"#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"",Be.gammaInput?"#define GAMMA_INPUT":"",Be.gammaOutput?"#define GAMMA_OUTPUT":"",Be.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.metal?"#define METAL":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+m:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"),E=ue("vertex",v+i),x=ue("fragment",y+e);
Ne.attachShader(u,E),Ne.attachShader(u,x),s&&Ne.bindAttribLocation(u,0,s),Ne.linkProgram(u),Ne.getProgramParameter(u,Ne.LINK_STATUS)||0,Ne.deleteShader(x),Ne.deleteShader(E),u.uniforms={},u.attributes={};var T,_,b,w;T=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences"],T.push(a.useVertexTexture?"boneTexture":"boneGlobalMatrices");for(_ in n)T.push(_);for(he(u,T),T=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"],w=0;w<a.maxMorphTargets;w++)T.push("morphTarget"+w);for(w=0;w<a.maxMorphNormals;w++)T.push("morphNormal"+w);for(b in r)T.push(b);return ce(u,T),u.id=Ge++,je.push({program:u,code:d,usedTimes:1}),Be.info.memory.programs=je.length,u}function he(t,e){var i,n,r;for(i=0,n=e.length;n>i;i++)r=e[i],t.uniforms[r]=Ne.getUniformLocation(t,r)}function ce(t,e){var i,n,r;for(i=0,n=e.length;n>i;i++)r=e[i],t.attributes[r]=Ne.getAttribLocation(t,r)}function ue(t,e){var i;return"fragment"===t?i=Ne.createShader(Ne.FRAGMENT_SHADER):"vertex"===t&&(i=Ne.createShader(Ne.VERTEX_SHADER)),Ne.shaderSource(i,e),Ne.compileShader(i),Ne.getShaderParameter(i,Ne.COMPILE_STATUS)?i:null}function de(t){return 0===(t&t-1)}function fe(t,e,i){i?(Ne.texParameteri(t,Ne.TEXTURE_WRAP_S,Te(e.wrapS)),Ne.texParameteri(t,Ne.TEXTURE_WRAP_T,Te(e.wrapT)),Ne.texParameteri(t,Ne.TEXTURE_MAG_FILTER,Te(e.magFilter)),Ne.texParameteri(t,Ne.TEXTURE_MIN_FILTER,Te(e.minFilter))):(Ne.texParameteri(t,Ne.TEXTURE_WRAP_S,Ne.CLAMP_TO_EDGE),Ne.texParameteri(t,Ne.TEXTURE_WRAP_T,Ne.CLAMP_TO_EDGE),Ne.texParameteri(t,Ne.TEXTURE_MAG_FILTER,xe(e.magFilter)),Ne.texParameteri(t,Ne.TEXTURE_MIN_FILTER,xe(e.minFilter))),ke&&e.type!==THREE.FloatType&&(e.anisotropy>1||e.__oldAnisotropy)&&(Ne.texParameterf(t,ke.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,Si)),e.__oldAnisotropy=e.anisotropy)}function pe(t,e){if(t.width<=e&&t.height<=e)return t;var i=Math.max(t.width,t.height),n=Math.floor(t.width*e/i),r=Math.floor(t.height*e/i),o=document.createElement("canvas");o.width=n,o.height=r;var a=o.getContext("2d");return a.drawImage(t,0,0,t.width,t.height,0,0,n,r),o}function me(t,e){if(6===t.image.length)if(t.needsUpdate){t.image.__webglTextureCube||(t.addEventListener("dispose",Ni),t.image.__webglTextureCube=Ne.createTexture(),Be.info.memory.textures++),Ne.activeTexture(Ne.TEXTURE0+e),Ne.bindTexture(Ne.TEXTURE_CUBE_MAP,t.image.__webglTextureCube),Ne.pixelStorei(Ne.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var i=t instanceof THREE.CompressedTexture,n=[],r=0;6>r;r++)n[r]=Be.autoScaleCubemaps&&!i?pe(t.image[r],Ri):t.image[r];var o=n[0],a=de(o.width)&&de(o.height),s=Te(t.format),l=Te(t.type);fe(Ne.TEXTURE_CUBE_MAP,t,a);for(var r=0;6>r;r++)if(i)for(var h,c=n[r].mipmaps,u=0,d=c.length;d>u;u++)h=c[u],Ne.compressedTexImage2D(Ne.TEXTURE_CUBE_MAP_POSITIVE_X+r,u,s,h.width,h.height,0,h.data);else Ne.texImage2D(Ne.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,s,s,l,n[r]);t.generateMipmaps&&a&&Ne.generateMipmap(Ne.TEXTURE_CUBE_MAP),t.needsUpdate=!1,t.onUpdate&&t.onUpdate()}else Ne.activeTexture(Ne.TEXTURE0+e),Ne.bindTexture(Ne.TEXTURE_CUBE_MAP,t.image.__webglTextureCube)}function ge(t,e){Ne.activeTexture(Ne.TEXTURE0+e),Ne.bindTexture(Ne.TEXTURE_CUBE_MAP,t.__webglTexture)}function ve(t,e,i){Ne.bindFramebuffer(Ne.FRAMEBUFFER,t),Ne.framebufferTexture2D(Ne.FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,i,e.__webglTexture,0)}function ye(t,e){Ne.bindRenderbuffer(Ne.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(Ne.renderbufferStorage(Ne.RENDERBUFFER,Ne.DEPTH_COMPONENT16,e.width,e.height),Ne.framebufferRenderbuffer(Ne.FRAMEBUFFER,Ne.DEPTH_ATTACHMENT,Ne.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(Ne.renderbufferStorage(Ne.RENDERBUFFER,Ne.DEPTH_STENCIL,e.width,e.height),Ne.framebufferRenderbuffer(Ne.FRAMEBUFFER,Ne.DEPTH_STENCIL_ATTACHMENT,Ne.RENDERBUFFER,t)):Ne.renderbufferStorage(Ne.RENDERBUFFER,Ne.RGBA4,e.width,e.height)}function Ee(t){t instanceof THREE.WebGLRenderTargetCube?(Ne.bindTexture(Ne.TEXTURE_CUBE_MAP,t.__webglTexture),Ne.generateMipmap(Ne.TEXTURE_CUBE_MAP),Ne.bindTexture(Ne.TEXTURE_CUBE_MAP,null)):(Ne.bindTexture(Ne.TEXTURE_2D,t.__webglTexture),Ne.generateMipmap(Ne.TEXTURE_2D),Ne.bindTexture(Ne.TEXTURE_2D,null))}function xe(t){return t===THREE.NearestFilter||t===THREE.NearestMipMapNearestFilter||t===THREE.NearestMipMapLinearFilter?Ne.NEAREST:Ne.LINEAR}function Te(t){if(t===THREE.RepeatWrapping)return Ne.REPEAT;if(t===THREE.ClampToEdgeWrapping)return Ne.CLAMP_TO_EDGE;if(t===THREE.MirroredRepeatWrapping)return Ne.MIRRORED_REPEAT;if(t===THREE.NearestFilter)return Ne.NEAREST;if(t===THREE.NearestMipMapNearestFilter)return Ne.NEAREST_MIPMAP_NEAREST;if(t===THREE.NearestMipMapLinearFilter)return Ne.NEAREST_MIPMAP_LINEAR;if(t===THREE.LinearFilter)return Ne.LINEAR;if(t===THREE.LinearMipMapNearestFilter)return Ne.LINEAR_MIPMAP_NEAREST;if(t===THREE.LinearMipMapLinearFilter)return Ne.LINEAR_MIPMAP_LINEAR;if(t===THREE.UnsignedByteType)return Ne.UNSIGNED_BYTE;if(t===THREE.UnsignedShort4444Type)return Ne.UNSIGNED_SHORT_4_4_4_4;if(t===THREE.UnsignedShort5551Type)return Ne.UNSIGNED_SHORT_5_5_5_1;if(t===THREE.UnsignedShort565Type)return Ne.UNSIGNED_SHORT_5_6_5;if(t===THREE.ByteType)return Ne.BYTE;if(t===THREE.ShortType)return Ne.SHORT;if(t===THREE.UnsignedShortType)return Ne.UNSIGNED_SHORT;if(t===THREE.IntType)return Ne.INT;if(t===THREE.UnsignedIntType)return Ne.UNSIGNED_INT;if(t===THREE.FloatType)return Ne.FLOAT;if(t===THREE.AlphaFormat)return Ne.ALPHA;if(t===THREE.RGBFormat)return Ne.RGB;if(t===THREE.RGBAFormat)return Ne.RGBA;if(t===THREE.LuminanceFormat)return Ne.LUMINANCE;if(t===THREE.LuminanceAlphaFormat)return Ne.LUMINANCE_ALPHA;if(t===THREE.AddEquation)return Ne.FUNC_ADD;if(t===THREE.SubtractEquation)return Ne.FUNC_SUBTRACT;if(t===THREE.ReverseSubtractEquation)return Ne.FUNC_REVERSE_SUBTRACT;if(t===THREE.ZeroFactor)return Ne.ZERO;if(t===THREE.OneFactor)return Ne.ONE;if(t===THREE.SrcColorFactor)return Ne.SRC_COLOR;if(t===THREE.OneMinusSrcColorFactor)return Ne.ONE_MINUS_SRC_COLOR;if(t===THREE.SrcAlphaFactor)return Ne.SRC_ALPHA;if(t===THREE.OneMinusSrcAlphaFactor)return Ne.ONE_MINUS_SRC_ALPHA;if(t===THREE.DstAlphaFactor)return Ne.DST_ALPHA;if(t===THREE.OneMinusDstAlphaFactor)return Ne.ONE_MINUS_DST_ALPHA;if(t===THREE.DstColorFactor)return Ne.DST_COLOR;if(t===THREE.OneMinusDstColorFactor)return Ne.ONE_MINUS_DST_COLOR;if(t===THREE.SrcAlphaSaturateFactor)return Ne.SRC_ALPHA_SATURATE;if(void 0!==Ve){if(t===THREE.RGB_S3TC_DXT1_Format)return Ve.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT1_Format)return Ve.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT3_Format)return Ve.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===THREE.RGBA_S3TC_DXT5_Format)return Ve.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}function _e(t){if(Hi&&t&&t.useVertexTexture)return 1024;var e=Ne.getParameter(Ne.MAX_VERTEX_UNIFORM_VECTORS),i=Math.floor((e-20)/4),n=i;return void 0!==t&&t instanceof THREE.SkinnedMesh&&(n=Math.min(t.bones.length,n),n<t.bones.length&&0),n}function be(t){for(var e=0,i=0,n=0,r=0,o=0,a=t.length;a>o;o++){var s=t[o];s.onlyShadow||(s instanceof THREE.DirectionalLight&&e++,s instanceof THREE.PointLight&&i++,s instanceof THREE.SpotLight&&n++,s instanceof THREE.HemisphereLight&&r++)}return{directional:e,point:i,spot:n,hemi:r}}function we(t){for(var e=0,i=0,n=t.length;n>i;i++){var r=t[i];r.castShadow&&(r instanceof THREE.SpotLight&&e++,r instanceof THREE.DirectionalLight&&!r.shadowCascade&&e++)}return e}function Re(t){setTimeout(function(){jQuery(window).trigger("mousemove")},1e3);try{var e={alpha:void 0===t?Ce:t,premultipliedAlpha:Ae,antialias:Pe,stencil:Le,preserveDrawingBuffer:Oe};if(Ne=Me.getContext("webgl",e)||Me.getContext("experimental-webgl",e),null===Ne)throw"Error creating WebGL context."}catch(i){}Fe=Ne.getExtension("OES_texture_float"),Ue=Ne.getExtension("OES_texture_float_linear"),Ie=Ne.getExtension("OES_standard_derivatives"),ke=Ne.getExtension("EXT_texture_filter_anisotropic")||Ne.getExtension("MOZ_EXT_texture_filter_anisotropic")||Ne.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),Ve=Ne.getExtension("WEBGL_compressed_texture_s3tc")||Ne.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||Ne.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),void 0===Ne.getShaderPrecisionFormat&&(Ne.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}function Se(){Ne.clearColor(0,0,0,1),Ne.clearDepth(1),Ne.clearStencil(0),Ne.enable(Ne.DEPTH_TEST),Ne.depthFunc(Ne.LEQUAL),Ne.frontFace(Ne.CCW),Ne.cullFace(Ne.BACK),Ne.enable(Ne.CULL_FACE),Ne.enable(Ne.BLEND),Ne.blendEquation(Ne.FUNC_ADD),Ne.blendFunc(Ne.SRC_ALPHA,Ne.ONE_MINUS_SRC_ALPHA),Ne.clearColor(De.r,De.g,De.b,ze)}t=t||{};var Me=void 0!==t.canvas?t.canvas:document.createElement("canvas"),He=void 0!==t.precision?t.precision:"highp",Ce=void 0!==t.alpha?t.alpha:!0,Ae=void 0!==t.premultipliedAlpha?t.premultipliedAlpha:!0,Pe=void 0!==t.antialias?t.antialias:!1,Le=void 0!==t.stencil?t.stencil:!0,Oe=void 0!==t.preserveDrawingBuffer?t.preserveDrawingBuffer:!1,De=new THREE.Color(0),ze=0;void 0!==t.clearColor&&De.setHex(t.clearColor),void 0!==t.clearAlpha&&(ze=t.clearAlpha),this.domElement=Me,this.context=null,this.devicePixelRatio=void 0!==t.devicePixelRatio?t.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.autoUpdateObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyBasedShading=!1,this.shadowMapEnabled=!1,this.shadowMapAutoUpdate=!0,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var Ne,Fe,Ue,Ie,ke,Ve,Be=this,je=[],Ge=0,We=null,Xe=null,qe=-1,Ye=null,Ke=null,$e=0,Qe=0,Ze=-1,Je=-1,ti=-1,ei=-1,ii=-1,ni=-1,ri=-1,oi=-1,ai=null,si=null,li=null,hi=null,ci=0,ui=0,di=0,fi=0,pi=0,mi=0,gi={},vi=new THREE.Frustum,yi=new THREE.Matrix4,Ei=new THREE.Matrix4,xi=new THREE.Vector3,Ti=new THREE.Vector3,_i=!0,bi={ambient:[0,0,0],directional:{length:0,colors:new Array,positions:new Array},point:{length:0,colors:new Array,positions:new Array,distances:new Array},spot:{length:0,colors:new Array,positions:new Array,distances:new Array,directions:new Array,anglesCos:new Array,exponents:new Array},hemi:{length:0,skyColors:new Array,groundColors:new Array,positions:new Array}};Re(),this.initGL=Re,Se(),this.setDefaultGLState=Se,this.context=Ne;var wi=(Ne.getParameter(Ne.MAX_TEXTURE_IMAGE_UNITS),Ne.getParameter(Ne.MAX_VERTEX_TEXTURE_IMAGE_UNITS)),Ri=(Ne.getParameter(Ne.MAX_TEXTURE_SIZE),Ne.getParameter(Ne.MAX_CUBE_MAP_TEXTURE_SIZE)),Si=ke?Ne.getParameter(ke.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,Mi=wi>0,Hi=Mi&&Fe,Ci=(Ve?Ne.getParameter(Ne.COMPRESSED_TEXTURE_FORMATS):[],Ne.getShaderPrecisionFormat(Ne.VERTEX_SHADER,Ne.HIGH_FLOAT)),Ai=Ne.getShaderPrecisionFormat(Ne.VERTEX_SHADER,Ne.MEDIUM_FLOAT),Pi=(Ne.getShaderPrecisionFormat(Ne.VERTEX_SHADER,Ne.LOW_FLOAT),Ne.getShaderPrecisionFormat(Ne.FRAGMENT_SHADER,Ne.HIGH_FLOAT)),Li=Ne.getShaderPrecisionFormat(Ne.FRAGMENT_SHADER,Ne.MEDIUM_FLOAT),Oi=(Ne.getShaderPrecisionFormat(Ne.FRAGMENT_SHADER,Ne.LOW_FLOAT),Ne.getShaderPrecisionFormat(Ne.VERTEX_SHADER,Ne.HIGH_INT),Ne.getShaderPrecisionFormat(Ne.VERTEX_SHADER,Ne.MEDIUM_INT),Ne.getShaderPrecisionFormat(Ne.VERTEX_SHADER,Ne.LOW_INT),Ne.getShaderPrecisionFormat(Ne.FRAGMENT_SHADER,Ne.HIGH_INT),Ne.getShaderPrecisionFormat(Ne.FRAGMENT_SHADER,Ne.MEDIUM_INT),Ne.getShaderPrecisionFormat(Ne.FRAGMENT_SHADER,Ne.LOW_INT),Ci.precision>0&&Pi.precision>0),Di=Ai.precision>0&&Li.precision>0;"highp"===He&&!Oi&&(Di?(He="mediump",0):(He="lowp",0)),"mediump"===He&&!Di&&(He="lowp",0),this.getContext=function(){return Ne},this.supportsVertexTextures=function(){return Mi},this.supportsFloatTextures=function(){return Fe},this.supportsStandardDerivatives=function(){return Ie},this.supportsCompressedTextureS3TC=function(){return Ve},this.getMaxAnisotropy=function(){return Si},this.getPrecision=function(){return He},this.setSize=function(t,e,i){Me.width=t*this.devicePixelRatio,Me.height=e*this.devicePixelRatio,1!==this.devicePixelRatio&&i!==!1&&(Me.style.width=t+"px",Me.style.height=e+"px"),this.setViewport(0,0,Me.width,Me.height)},this.setViewport=function(t,e,i,n){ci=void 0!==t?t:0,ui=void 0!==e?e:0,di=void 0!==i?i:Me.width,fi=void 0!==n?n:Me.height,Ne.viewport(ci,ui,di,fi)},this.setScissor=function(t,e,i,n){Ne.scissor(t,e,i,n)},this.enableScissorTest=function(t){t?Ne.enable(Ne.SCISSOR_TEST):Ne.disable(Ne.SCISSOR_TEST)},this.setClearColor=function(t,e){De.set(t),ze=void 0!==e?e:1,Ne.clearColor(De.r,De.g,De.b,ze)},this.setClearColorHex=function(t,e){this.setClearColor(t,e)},this.getClearColor=function(){return De},this.getClearAlpha=function(){return ze},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=Ne.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=Ne.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=Ne.STENCIL_BUFFER_BIT),Ne.clear(n)},this.clearTarget=function(t,e,i,n){this.setRenderTarget(t),this.clear(e,i,n)},this.addPostPlugin=function(t){t.init(this),this.renderPluginsPost.push(t)},this.addPrePlugin=function(t){t.init(this),this.renderPluginsPre.push(t)},this.updateShadowMap=function(t,e){We=null,ti=-1,ri=-1,oi=-1,Ye=-1,qe=-1,_i=!0,Ze=-1,Je=-1,this.shadowMapPlugin.update(t,e)};var zi=function(t){var e=t.target;e.removeEventListener("dispose",zi),ki(e)},Ni=function(t){var e=t.target;e.removeEventListener("dispose",Ni),Vi(e),Be.info.memory.textures--},Fi=function(t){var e=t.target;e.removeEventListener("dispose",Fi),Bi(e),Be.info.memory.textures--},Ui=function(t){var e=t.target;e.removeEventListener("dispose",Ui),ji(e)},Ii=function(t){if(void 0!==t.__webglVertexBuffer&&Ne.deleteBuffer(t.__webglVertexBuffer),void 0!==t.__webglNormalBuffer&&Ne.deleteBuffer(t.__webglNormalBuffer),void 0!==t.__webglTangentBuffer&&Ne.deleteBuffer(t.__webglTangentBuffer),void 0!==t.__webglColorBuffer&&Ne.deleteBuffer(t.__webglColorBuffer),void 0!==t.__webglUVBuffer&&Ne.deleteBuffer(t.__webglUVBuffer),void 0!==t.__webglUV2Buffer&&Ne.deleteBuffer(t.__webglUV2Buffer),void 0!==t.__webglSkinIndicesBuffer&&Ne.deleteBuffer(t.__webglSkinIndicesBuffer),void 0!==t.__webglSkinWeightsBuffer&&Ne.deleteBuffer(t.__webglSkinWeightsBuffer),void 0!==t.__webglFaceBuffer&&Ne.deleteBuffer(t.__webglFaceBuffer),void 0!==t.__webglLineBuffer&&Ne.deleteBuffer(t.__webglLineBuffer),void 0!==t.__webglLineDistanceBuffer&&Ne.deleteBuffer(t.__webglLineDistanceBuffer),void 0!==t.__webglCustomAttributesList)for(var e in t.__webglCustomAttributesList)Ne.deleteBuffer(t.__webglCustomAttributesList[e].buffer);Be.info.memory.geometries--},ki=function(t){if(t.__webglInit=void 0,t instanceof THREE.BufferGeometry){var e=t.attributes;for(var i in e)void 0!==e[i].buffer&&Ne.deleteBuffer(e[i].buffer);Be.info.memory.geometries--}else if(void 0!==t.geometryGroups)for(var n in t.geometryGroups){var r=t.geometryGroups[n];if(void 0!==r.numMorphTargets)for(var o=0,a=r.numMorphTargets;a>o;o++)Ne.deleteBuffer(r.__webglMorphTargetsBuffers[o]);if(void 0!==r.numMorphNormals)for(var o=0,a=r.numMorphNormals;a>o;o++)Ne.deleteBuffer(r.__webglMorphNormalsBuffers[o]);Ii(r)}else Ii(t)},Vi=function(t){if(t.image&&t.image.__webglTextureCube)Ne.deleteTexture(t.image.__webglTextureCube);else{if(!t.__webglInit)return;t.__webglInit=!1,Ne.deleteTexture(t.__webglTexture)}},Bi=function(t){if(t&&t.__webglTexture)if(Ne.deleteTexture(t.__webglTexture),t instanceof THREE.WebGLRenderTargetCube)for(var e=0;6>e;e++)Ne.deleteFramebuffer(t.__webglFramebuffer[e]),Ne.deleteRenderbuffer(t.__webglRenderbuffer[e]);else Ne.deleteFramebuffer(t.__webglFramebuffer),Ne.deleteRenderbuffer(t.__webglRenderbuffer)},ji=function(t){var e=t.program;if(void 0!==e){t.program=void 0;var i,n,r,o=!1;for(i=0,n=je.length;n>i;i++)if(r=je[i],r.program===e){r.usedTimes--,0===r.usedTimes&&(o=!0);break}if(o===!0){var a=[];for(i=0,n=je.length;n>i;i++)r=je[i],r.program!==e&&a.push(r);je=a,Ne.deleteProgram(e),Be.info.memory.programs--}}};this.renderBufferImmediate=function(t,e,i){if(t.hasPositions&&!t.__webglVertexBuffer&&(t.__webglVertexBuffer=Ne.createBuffer()),t.hasNormals&&!t.__webglNormalBuffer&&(t.__webglNormalBuffer=Ne.createBuffer()),t.hasUvs&&!t.__webglUvBuffer&&(t.__webglUvBuffer=Ne.createBuffer()),t.hasColors&&!t.__webglColorBuffer&&(t.__webglColorBuffer=Ne.createBuffer()),t.hasPositions&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglVertexBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,t.positionArray,Ne.DYNAMIC_DRAW),Ne.enableVertexAttribArray(e.attributes.position),Ne.vertexAttribPointer(e.attributes.position,3,Ne.FLOAT,!1,0,0)),t.hasNormals){if(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglNormalBuffer),i.shading===THREE.FlatShading){var n,r,o,a,s,l,h,c,u,d,f,p,m,g,v=3*t.count;for(g=0;v>g;g+=9)m=t.normalArray,a=m[g],h=m[g+1],d=m[g+2],s=m[g+3],c=m[g+4],f=m[g+5],l=m[g+6],u=m[g+7],p=m[g+8],n=(a+s+l)/3,r=(h+c+u)/3,o=(d+f+p)/3,m[g]=n,m[g+1]=r,m[g+2]=o,m[g+3]=n,m[g+4]=r,m[g+5]=o,m[g+6]=n,m[g+7]=r,m[g+8]=o}Ne.bufferData(Ne.ARRAY_BUFFER,t.normalArray,Ne.DYNAMIC_DRAW),Ne.enableVertexAttribArray(e.attributes.normal),Ne.vertexAttribPointer(e.attributes.normal,3,Ne.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglUvBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,t.uvArray,Ne.DYNAMIC_DRAW),Ne.enableVertexAttribArray(e.attributes.uv),Ne.vertexAttribPointer(e.attributes.uv,2,Ne.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==THREE.NoColors&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,t.__webglColorBuffer),Ne.bufferData(Ne.ARRAY_BUFFER,t.colorArray,Ne.DYNAMIC_DRAW),Ne.enableVertexAttribArray(e.attributes.color),Ne.vertexAttribPointer(e.attributes.color,3,Ne.FLOAT,!1,0,0)),Ne.drawArrays(Ne.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,r,o){if(n.visible!==!1){var a,s,l,h,c=B(t,e,i,n,o),u=c.attributes,d=r.attributes,f=!1,p=n.wireframe?1:0,m=16777215*r.id+2*c.id+p;if(m!==Ye&&(Ye=m,f=!0),f&&_(),o instanceof THREE.Mesh){var g=d.index;if(g){var v=r.offsets;v.length>1&&(f=!0);for(var y=0,E=v.length;E>y;y++){var x=v[y].index;if(f){for(s in u)l=u[s],a=d[s],l>=0&&(a?(h=a.itemSize,Ne.bindBuffer(Ne.ARRAY_BUFFER,a.buffer),T(l),Ne.vertexAttribPointer(l,h,Ne.FLOAT,!1,0,x*h*4)):n.defaultAttributeValues&&(2===n.defaultAttributeValues[s].length?Ne.vertexAttrib2fv(l,n.defaultAttributeValues[s]):3===n.defaultAttributeValues[s].length&&Ne.vertexAttrib3fv(l,n.defaultAttributeValues[s])));Ne.bindBuffer(Ne.ELEMENT_ARRAY_BUFFER,g.buffer)}Ne.drawElements(Ne.TRIANGLES,v[y].count,Ne.UNSIGNED_SHORT,2*v[y].start),Be.info.render.calls++,Be.info.render.vertices+=v[y].count,Be.info.render.faces+=v[y].count/3}}else{if(f)for(s in u)"index"!==s&&(l=u[s],a=d[s],l>=0&&(a?(h=a.itemSize,Ne.bindBuffer(Ne.ARRAY_BUFFER,a.buffer),T(l),Ne.vertexAttribPointer(l,h,Ne.FLOAT,!1,0,0)):n.defaultAttributeValues&&n.defaultAttributeValues[s]&&(2===n.defaultAttributeValues[s].length?Ne.vertexAttrib2fv(l,n.defaultAttributeValues[s]):3===n.defaultAttributeValues[s].length&&Ne.vertexAttrib3fv(l,n.defaultAttributeValues[s]))));var b=r.attributes.position;Ne.drawArrays(Ne.TRIANGLES,0,b.numItems/3),Be.info.render.calls++,Be.info.render.vertices+=b.numItems/3,Be.info.render.faces+=b.numItems/3/3}}else if(o instanceof THREE.ParticleSystem){if(f){for(s in u)l=u[s],a=d[s],l>=0&&(a?(h=a.itemSize,Ne.bindBuffer(Ne.ARRAY_BUFFER,a.buffer),T(l),Ne.vertexAttribPointer(l,h,Ne.FLOAT,!1,0,0)):n.defaultAttributeValues&&n.defaultAttributeValues[s]&&(2===n.defaultAttributeValues[s].length?Ne.vertexAttrib2fv(l,n.defaultAttributeValues[s]):3===n.defaultAttributeValues[s].length&&Ne.vertexAttrib3fv(l,n.defaultAttributeValues[s])));var b=d.position;Ne.drawArrays(Ne.POINTS,0,b.numItems/3),Be.info.render.calls++,Be.info.render.points+=b.numItems/3}}else if(o instanceof THREE.Line&&f){for(s in u)l=u[s],a=d[s],l>=0&&(a?(h=a.itemSize,Ne.bindBuffer(Ne.ARRAY_BUFFER,a.buffer),T(l),Ne.vertexAttribPointer(l,h,Ne.FLOAT,!1,0,0)):n.defaultAttributeValues&&n.defaultAttributeValues[s]&&(2===n.defaultAttributeValues[s].length?Ne.vertexAttrib2fv(l,n.defaultAttributeValues[s]):3===n.defaultAttributeValues[s].length&&Ne.vertexAttrib3fv(l,n.defaultAttributeValues[s])));var w=o.type===THREE.LineStrip?Ne.LINE_STRIP:Ne.LINES;oe(n.linewidth);var b=d.position;Ne.drawArrays(w,0,b.numItems/3),Be.info.render.calls++,Be.info.render.points+=b.numItems}}},this.renderBuffer=function(t,e,i,n,r,o){if(n.visible!==!1){var a,s,l,h=B(t,e,i,n,o),c=h.attributes,u=!1,d=n.wireframe?1:0,f=16777215*r.id+2*h.id+d;if(f!==Ye&&(Ye=f,u=!0),u&&_(),!n.morphTargets&&c.position>=0?u&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,r.__webglVertexBuffer),T(c.position),Ne.vertexAttribPointer(c.position,3,Ne.FLOAT,!1,0,0)):o.morphTargetBase&&b(n,r,o),u){if(r.__webglCustomAttributesList)for(s=0,l=r.__webglCustomAttributesList.length;l>s;s++)a=r.__webglCustomAttributesList[s],c[a.buffer.belongsToAttribute]>=0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,a.buffer),T(c[a.buffer.belongsToAttribute]),Ne.vertexAttribPointer(c[a.buffer.belongsToAttribute],a.size,Ne.FLOAT,!1,0,0));c.color>=0&&(o.geometry.colors.length>0||o.geometry.faces.length>0?(Ne.bindBuffer(Ne.ARRAY_BUFFER,r.__webglColorBuffer),T(c.color),Ne.vertexAttribPointer(c.color,3,Ne.FLOAT,!1,0,0)):n.defaultAttributeValues&&Ne.vertexAttrib3fv(c.color,n.defaultAttributeValues.color)),c.normal>=0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,r.__webglNormalBuffer),T(c.normal),Ne.vertexAttribPointer(c.normal,3,Ne.FLOAT,!1,0,0)),c.tangent>=0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,r.__webglTangentBuffer),T(c.tangent),Ne.vertexAttribPointer(c.tangent,4,Ne.FLOAT,!1,0,0)),c.uv>=0&&(o.geometry.faceVertexUvs[0]?(Ne.bindBuffer(Ne.ARRAY_BUFFER,r.__webglUVBuffer),T(c.uv),Ne.vertexAttribPointer(c.uv,2,Ne.FLOAT,!1,0,0)):n.defaultAttributeValues&&Ne.vertexAttrib2fv(c.uv,n.defaultAttributeValues.uv)),c.uv2>=0&&(o.geometry.faceVertexUvs[1]?(Ne.bindBuffer(Ne.ARRAY_BUFFER,r.__webglUV2Buffer),T(c.uv2),Ne.vertexAttribPointer(c.uv2,2,Ne.FLOAT,!1,0,0)):n.defaultAttributeValues&&Ne.vertexAttrib2fv(c.uv2,n.defaultAttributeValues.uv2)),n.skinning&&c.skinIndex>=0&&c.skinWeight>=0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,r.__webglSkinIndicesBuffer),T(c.skinIndex),Ne.vertexAttribPointer(c.skinIndex,4,Ne.FLOAT,!1,0,0),Ne.bindBuffer(Ne.ARRAY_BUFFER,r.__webglSkinWeightsBuffer),T(c.skinWeight),Ne.vertexAttribPointer(c.skinWeight,4,Ne.FLOAT,!1,0,0)),c.lineDistance>=0&&(Ne.bindBuffer(Ne.ARRAY_BUFFER,r.__webglLineDistanceBuffer),T(c.lineDistance),Ne.vertexAttribPointer(c.lineDistance,1,Ne.FLOAT,!1,0,0))}if(o instanceof THREE.Mesh)n.wireframe?(oe(n.wireframeLinewidth),u&&Ne.bindBuffer(Ne.ELEMENT_ARRAY_BUFFER,r.__webglLineBuffer),Ne.drawElements(Ne.LINES,r.__webglLineCount,Ne.UNSIGNED_SHORT,0)):(u&&Ne.bindBuffer(Ne.ELEMENT_ARRAY_BUFFER,r.__webglFaceBuffer),Ne.drawElements(Ne.TRIANGLES,r.__webglFaceCount,Ne.UNSIGNED_SHORT,0)),Be.info.render.calls++,Be.info.render.vertices+=r.__webglFaceCount,Be.info.render.faces+=r.__webglFaceCount/3;else if(o instanceof THREE.Line){var p=o.type===THREE.LineStrip?Ne.LINE_STRIP:Ne.LINES;oe(n.linewidth),Ne.drawArrays(p,0,r.__webglLineCount),Be.info.render.calls++}else o instanceof THREE.ParticleSystem?(Ne.drawArrays(Ne.POINTS,0,r.__webglParticleCount),Be.info.render.calls++,Be.info.render.points+=r.__webglParticleCount):o instanceof THREE.Ribbon&&(Ne.drawArrays(Ne.TRIANGLE_STRIP,0,r.__webglVertexCount),Be.info.render.calls++)}},this.render=function(t,e,i,n){if(e instanceof THREE.Camera!=0){var r,o,a,s,l,h=t.__lights,c=t.fog;for(qe=-1,_i=!0,t.autoUpdate===!0&&t.updateMatrixWorld(),void 0===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),yi.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),vi.setFromMatrix(yi),this.autoUpdateObjects&&this.initWebGLObjects(t),S(this.renderPluginsPre,t,e),Be.info.render.calls=0,Be.info.render.vertices=0,Be.info.render.faces=0,Be.info.render.points=0,this.setRenderTarget(i),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),l=t.__webglObjects,r=0,o=l.length;o>r;r++)a=l[r],s=a.object,a.id=r,a.render=!1,s.visible&&(!(s instanceof THREE.Mesh||s instanceof THREE.ParticleSystem)||!s.frustumCulled||vi.intersectsObject(s))&&(ee(s,e),A(a),a.render=!0,this.sortObjects===!0&&(null!==s.renderDepth?a.z=s.renderDepth:(xi.getPositionFromMatrix(s.matrixWorld),xi.applyProjection(yi),a.z=xi.z)));for(this.sortObjects&&l.sort(w),l=t.__webglObjectsImmediate,r=0,o=l.length;o>r;r++)a=l[r],s=a.object,s.visible&&(ee(s,e),C(a));if(t.overrideMaterial){var u=t.overrideMaterial;this.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),this.setDepthTest(u.depthTest),this.setDepthWrite(u.depthWrite),ae(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits),M(t.__webglObjects,!1,"",e,h,c,!0,u),H(t.__webglObjectsImmediate,"",e,h,c,!1,u)}else{var u=null;this.setBlending(THREE.NoBlending),M(t.__webglObjects,!0,"opaque",e,h,c,!1,u),H(t.__webglObjectsImmediate,"opaque",e,h,c,!1,u),M(t.__webglObjects,!1,"transparent",e,h,c,!0,u),H(t.__webglObjectsImmediate,"transparent",e,h,c,!0,u)}S(this.renderPluginsPost,t,e),i&&i.generateMipmaps&&i.minFilter!==THREE.NearestFilter&&i.minFilter!==THREE.LinearFilter&&Ee(i),this.setDepthTest(!0),this.setDepthWrite(!0)}},this.renderImmediateObject=function(t,e,i,n,r){var o=B(t,e,i,n,r);Ye=-1,Be.setMaterialFaces(n),r.immediateRenderCallback?r.immediateRenderCallback(o,Ne,vi):r.render(function(t){Be.renderBufferImmediate(t,o,n)})},this.initWebGLObjects=function(t){for(t.__webglObjects||(t.__webglObjects=[],t.__webglObjectsImmediate=[],t.__webglSprites=[],t.__webglFlares=[]);t.__objectsAdded.length;)L(t.__objectsAdded[0],t),t.__objectsAdded.splice(0,1);for(;t.__objectsRemoved.length;)U(t.__objectsRemoved[0],t),t.__objectsRemoved.splice(0,1);for(var e=0,i=t.__webglObjects.length;i>e;e++){var n=t.__webglObjects[e].object;void 0===n.__webglInit&&(void 0!==n.__webglActive&&U(n,t),L(n,t)),z(n)}},this.initMaterial=function(t,e,i,n){t.addEventListener("dispose",Ui);var r,o,a,s,l,h,c;t instanceof THREE.MeshDepthMaterial?c="depth":t instanceof THREE.MeshNormalMaterial?c="normal":t instanceof THREE.MeshBasicMaterial?c="basic":t instanceof THREE.MeshLambertMaterial?c="lambert":t instanceof THREE.MeshPhongMaterial?c="phong":t instanceof THREE.LineBasicMaterial?c="basic":t instanceof THREE.LineDashedMaterial?c="dashed":t instanceof THREE.ParticleBasicMaterial&&(c="particle_basic"),c&&V(t,THREE.ShaderLib[c]),s=be(e),h=we(e),l=_e(n),a={map:!!t.map,envMap:!!t.envMap,lightMap:!!t.lightMap,bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,specularMap:!!t.specularMap,vertexColors:t.vertexColors,fog:i,useFog:t.fog,fogExp:i instanceof THREE.FogExp2,sizeAttenuation:t.sizeAttenuation,skinning:t.skinning,maxBones:l,useVertexTexture:Hi&&n&&n.useVertexTexture,boneTextureWidth:n&&n.boneTextureWidth,boneTextureHeight:n&&n.boneTextureHeight,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:s.directional,maxPointLights:s.point,maxSpotLights:s.spot,maxHemiLights:s.hemi,maxShadows:h,shadowMapEnabled:this.shadowMapEnabled&&n.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:t.alphaTest,metal:t.metal,perPixel:t.perPixel,wrapAround:t.wrapAround,doubleSided:t.side===THREE.DoubleSide,flipSided:t.side===THREE.BackSide},t.program=le(c,t.fragmentShader,t.vertexShader,t.uniforms,t.attributes,t.defines,a,t.index0AttributeName);var u=t.program.attributes;if(t.morphTargets){t.numSupportedMorphTargets=0;var d,f="morphTarget";for(o=0;o<this.maxMorphTargets;o++)d=f+o,u[d]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;var d,f="morphNormal";for(o=0;o<this.maxMorphNormals;o++)d=f+o,u[d]>=0&&t.numSupportedMorphNormals++}t.uniformsList=[];for(r in t.uniforms)t.uniformsList.push([t.uniforms[r],r])},this.setFaceCulling=function(t,e){t===THREE.CullFaceNone?Ne.disable(Ne.CULL_FACE):(Ne.frontFace(e===THREE.FrontFaceDirectionCW?Ne.CW:Ne.CCW),Ne.cullFace(t===THREE.CullFaceBack?Ne.BACK:t===THREE.CullFaceFront?Ne.FRONT:Ne.FRONT_AND_BACK),Ne.enable(Ne.CULL_FACE))},this.setMaterialFaces=function(t){var e=t.side===THREE.DoubleSide,i=t.side===THREE.BackSide;Ze!==e&&(e?Ne.disable(Ne.CULL_FACE):Ne.enable(Ne.CULL_FACE),Ze=e),Je!==i&&(Ne.frontFace(i?Ne.CW:Ne.CCW),Je=i)},this.setDepthTest=function(t){ri!==t&&(t?Ne.enable(Ne.DEPTH_TEST):Ne.disable(Ne.DEPTH_TEST),ri=t)},this.setDepthWrite=function(t){oi!==t&&(Ne.depthMask(t),oi=t)},this.setBlending=function(t,e,i,n){t!==ti&&(t===THREE.NoBlending?Ne.disable(Ne.BLEND):t===THREE.AdditiveBlending?(Ne.enable(Ne.BLEND),Ne.blendEquation(Ne.FUNC_ADD),Ne.blendFunc(Ne.SRC_ALPHA,Ne.ONE)):t===THREE.SubtractiveBlending?(Ne.enable(Ne.BLEND),Ne.blendEquation(Ne.FUNC_ADD),Ne.blendFunc(Ne.ZERO,Ne.ONE_MINUS_SRC_COLOR)):t===THREE.MultiplyBlending?(Ne.enable(Ne.BLEND),Ne.blendEquation(Ne.FUNC_ADD),Ne.blendFunc(Ne.ZERO,Ne.SRC_COLOR)):t===THREE.CustomBlending?Ne.enable(Ne.BLEND):(Ne.enable(Ne.BLEND),Ne.blendEquationSeparate(Ne.FUNC_ADD,Ne.FUNC_ADD),Ne.blendFuncSeparate(Ne.SRC_ALPHA,Ne.ONE_MINUS_SRC_ALPHA,Ne.ONE,Ne.ONE_MINUS_SRC_ALPHA)),ti=t),t===THREE.CustomBlending?(e!==ei&&(Ne.blendEquation(Te(e)),ei=e),(i!==ii||n!==ni)&&(Ne.blendFunc(Te(i),Te(n)),ii=i,ni=n)):(ei=null,ii=null,ni=null)},this.setTexture=function(t,e){if(t.needsUpdate){t.__webglInit||(t.__webglInit=!0,t.addEventListener("dispose",Ni),t.__webglTexture=Ne.createTexture(),Be.info.memory.textures++),Ne.activeTexture(Ne.TEXTURE0+e),Ne.bindTexture(Ne.TEXTURE_2D,t.__webglTexture),Ne.pixelStorei(Ne.UNPACK_FLIP_Y_WEBGL,t.flipY),Ne.pixelStorei(Ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ne.pixelStorei(Ne.UNPACK_ALIGNMENT,t.unpackAlignment);var i=t.image,n=de(i.width)&&de(i.height),r=Te(t.format),o=Te(t.type);fe(Ne.TEXTURE_2D,t,n);var a,s=t.mipmaps;if(t instanceof THREE.DataTexture)if(s.length>0&&n){for(var l=0,h=s.length;h>l;l++)a=s[l],Ne.texImage2D(Ne.TEXTURE_2D,l,r,a.width,a.height,0,r,o,a.data);t.generateMipmaps=!1}else Ne.texImage2D(Ne.TEXTURE_2D,0,r,i.width,i.height,0,r,o,i.data);else if(t instanceof THREE.CompressedTexture)for(var l=0,h=s.length;h>l;l++)a=s[l],Ne.compressedTexImage2D(Ne.TEXTURE_2D,l,r,a.width,a.height,0,a.data);else if(s.length>0&&n){for(var l=0,h=s.length;h>l;l++)a=s[l],Ne.texImage2D(Ne.TEXTURE_2D,l,r,r,o,a);t.generateMipmaps=!1}else Ne.texImage2D(Ne.TEXTURE_2D,0,r,r,o,t.image);t.generateMipmaps&&n&&Ne.generateMipmap(Ne.TEXTURE_2D),t.needsUpdate=!1,t.onUpdate&&t.onUpdate()}else Ne.activeTexture(Ne.TEXTURE0+e),Ne.bindTexture(Ne.TEXTURE_2D,t.__webglTexture)},this.setRenderTarget=function(t){var e=t instanceof THREE.WebGLRenderTargetCube;if(t&&!t.__webglFramebuffer){void 0===t.depthBuffer&&(t.depthBuffer=!0),void 0===t.stencilBuffer&&(t.stencilBuffer=!0),t.addEventListener("dispose",Fi),t.__webglTexture=Ne.createTexture(),Be.info.memory.textures++;var i=de(t.width)&&de(t.height),n=Te(t.format),r=Te(t.type);if(e){t.__webglFramebuffer=[],t.__webglRenderbuffer=[],Ne.bindTexture(Ne.TEXTURE_CUBE_MAP,t.__webglTexture),fe(Ne.TEXTURE_CUBE_MAP,t,i);for(var o=0;6>o;o++)t.__webglFramebuffer[o]=Ne.createFramebuffer(),t.__webglRenderbuffer[o]=Ne.createRenderbuffer(),Ne.texImage2D(Ne.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,n,t.width,t.height,0,n,r,null),ve(t.__webglFramebuffer[o],t,Ne.TEXTURE_CUBE_MAP_POSITIVE_X+o),ye(t.__webglRenderbuffer[o],t);i&&Ne.generateMipmap(Ne.TEXTURE_CUBE_MAP)}else t.__webglFramebuffer=Ne.createFramebuffer(),t.__webglRenderbuffer=t.shareDepthFrom?t.shareDepthFrom.__webglRenderbuffer:Ne.createRenderbuffer(),Ne.bindTexture(Ne.TEXTURE_2D,t.__webglTexture),fe(Ne.TEXTURE_2D,t,i),Ne.texImage2D(Ne.TEXTURE_2D,0,n,t.width,t.height,0,n,r,null),ve(t.__webglFramebuffer,t,Ne.TEXTURE_2D),t.shareDepthFrom?t.depthBuffer&&!t.stencilBuffer?Ne.framebufferRenderbuffer(Ne.FRAMEBUFFER,Ne.DEPTH_ATTACHMENT,Ne.RENDERBUFFER,t.__webglRenderbuffer):t.depthBuffer&&t.stencilBuffer&&Ne.framebufferRenderbuffer(Ne.FRAMEBUFFER,Ne.DEPTH_STENCIL_ATTACHMENT,Ne.RENDERBUFFER,t.__webglRenderbuffer):ye(t.__webglRenderbuffer,t),i&&Ne.generateMipmap(Ne.TEXTURE_2D);
e?Ne.bindTexture(Ne.TEXTURE_CUBE_MAP,null):Ne.bindTexture(Ne.TEXTURE_2D,null),Ne.bindRenderbuffer(Ne.RENDERBUFFER,null),Ne.bindFramebuffer(Ne.FRAMEBUFFER,null)}var a,s,l,h,c;t?(a=e?t.__webglFramebuffer[t.activeCubeFace]:t.__webglFramebuffer,s=t.width,l=t.height,h=0,c=0):(a=null,s=di,l=fi,h=ci,c=ui),a!==Xe&&(Ne.bindFramebuffer(Ne.FRAMEBUFFER,a),Ne.viewport(h,c,s,l),Xe=a),pi=s,mi=l},this.shadowMapPlugin=new THREE.ShadowMapPlugin,this.addPrePlugin(this.shadowMapPlugin),this.addPostPlugin(new THREE.SpritePlugin),this.addPostPlugin(new THREE.LensFlarePlugin)},THREE.WebGLRenderTarget=function(t,e,i){this.width=t,this.height=e,i=i||{},this.wrapS=void 0!==i.wrapS?i.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==i.wrapT?i.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==i.magFilter?i.magFilter:THREE.LinearFilter,this.minFilter=void 0!==i.minFilter?i.minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==i.format?i.format:THREE.RGBAFormat,this.type=void 0!==i.type?i.type:THREE.UnsignedByteType,this.depthBuffer=void 0!==i.depthBuffer?i.depthBuffer:!0,this.stencilBuffer=void 0!==i.stencilBuffer?i.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var t=new THREE.WebGLRenderTarget(this.width,this.height);return t.wrapS=this.wrapS,t.wrapT=this.wrapT,t.magFilter=this.magFilter,t.minFilter=this.minFilter,t.anisotropy=this.anisotropy,t.offset.copy(this.offset),t.repeat.copy(this.repeat),t.format=this.format,t.type=this.type,t.depthBuffer=this.depthBuffer,t.stencilBuffer=this.stencilBuffer,t.generateMipmaps=this.generateMipmaps,t.shareDepthFrom=this.shareDepthFrom,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(t,e,i){THREE.WebGLRenderTarget.call(this,t,e,i),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(t){this.positionWorld.copy(t.positionWorld),this.positionScreen.copy(t.positionScreen)},THREE.RenderableFace3=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.color=null,this.material=null,this.uvs=[[]],this.z=0},THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0},THREE.RenderableParticle=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=null,this.scale=new THREE.Vector2,this.material=null},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0},THREE.GeometryUtils={merge:function(t,e,i){var n,r,o=t.vertices.length,a=(t.faceVertexUvs[0].length,e instanceof THREE.Mesh?e.geometry:e),s=t.vertices,l=a.vertices,h=t.faces,c=a.faces,u=t.faceVertexUvs[0],d=a.faceVertexUvs[0];void 0===i&&(i=0),e instanceof THREE.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,r=(new THREE.Matrix3).getNormalMatrix(n));for(var f=0,p=l.length;p>f;f++){var m=l[f],g=m.clone();n&&g.applyMatrix4(n),s.push(g)}for(f=0,p=c.length;p>f;f++){var v,y,E,x=c[f],T=x.vertexNormals,_=x.vertexColors;v=new THREE.Face3(x.a+o,x.b+o,x.c+o),v.normal.copy(x.normal),r&&v.normal.applyMatrix3(r).normalize();for(var b=0,w=T.length;w>b;b++)y=T[b].clone(),r&&y.applyMatrix3(r).normalize(),v.vertexNormals.push(y);v.color.copy(x.color);for(var b=0,w=_.length;w>b;b++)E=_[b],v.vertexColors.push(E.clone());v.materialIndex=x.materialIndex+i,v.centroid.copy(x.centroid),n&&v.centroid.applyMatrix4(n),h.push(v)}for(f=0,p=d.length;p>f;f++){for(var R=d[f],S=[],b=0,w=R.length;w>b;b++)S.push(new THREE.Vector2(R[b].x,R[b].y));u.push(S)}},randomPointInTriangle:function(){var t=new THREE.Vector3;return function(e,i,n){var r=new THREE.Vector3,o=THREE.Math.random16(),a=THREE.Math.random16();o+a>1&&(o=1-o,a=1-a);var s=1-o-a;return r.copy(e),r.multiplyScalar(o),t.copy(i),t.multiplyScalar(a),r.add(t),t.copy(n),t.multiplyScalar(s),r.add(t),r}}(),randomPointInFace:function(t,e){var i,n,r;return i=e.vertices[t.a],n=e.vertices[t.b],r=e.vertices[t.c],THREE.GeometryUtils.randomPointInTriangle(i,n,r)},randomPointsInGeometry:function(t,e){function i(t){function e(i,n){if(i>n)return i;var r=i+Math.floor((n-i)/2);return d[r]>t?e(i,r-1):d[r]<t?e(r+1,n):r}var i=e(0,d.length-1);return i}var n,r,o,a,s,l=t.faces,h=t.vertices,c=l.length,u=0,d=[];for(r=0;c>r;r++)n=l[r],o=h[n.a],a=h[n.b],s=h[n.c],n._area=THREE.GeometryUtils.triangleArea(o,a,s),u+=n._area,d[r]=u;var f,p,m=[],g={};for(r=0;e>r;r++)f=THREE.Math.random16()*u,p=i(f),m[r]=THREE.GeometryUtils.randomPointInFace(l[p],t,!0),g[p]?g[p]+=1:g[p]=1;return m},triangleArea:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,n,r){return t.subVectors(n,i),e.subVectors(r,i),t.cross(e),.5*t.length()}}(),center:function(t){t.computeBoundingBox();var e=t.boundingBox,i=new THREE.Vector3;return i.addVectors(e.min,e.max),i.multiplyScalar(-.5),t.applyMatrix((new THREE.Matrix4).makeTranslation(i.x,i.y,i.z)),t.computeBoundingBox(),i},triangulateQuads:function(t){var e,i,n,r,o=[],a=[];for(e=0,i=t.faceVertexUvs.length;i>e;e++)a[e]=[];for(e=0,i=t.faces.length;i>e;e++){var s=t.faces[e];for(o.push(s),n=0,r=t.faceVertexUvs.length;r>n;n++)a[n].push(t.faceVertexUvs[n][e])}t.faces=o,t.faceVertexUvs=a,t.computeCentroids(),t.computeFaceNormals(),t.computeVertexNormals(),t.hasTangents&&t.computeTangents()}},THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(t,e,i){var n=new Image,r=new THREE.Texture(n,e),o=new THREE.ImageLoader;return o.crossOrigin=this.crossOrigin,o.load(t,function(t){r.image=t,r.needsUpdate=!0,i&&i(r)}),r.sourceFile=t,r},loadCompressedTexture:function(t,e,i,n){var r=new THREE.CompressedTexture;r.mapping=e;var o=new XMLHttpRequest;return o.onload=function(){var t=o.response,e=THREE.ImageUtils.parseDDS(t,!0);r.format=e.format,r.mipmaps=e.mipmaps,r.image.width=e.width,r.image.height=e.height,r.generateMipmaps=!1,r.needsUpdate=!0,i&&i(r)},o.onerror=n,o.open("GET",t,!0),o.responseType="arraybuffer",o.send(null),r},loadTextureCube:function(t,e,i,n){var r=[];r.loadCount=0;var o=new THREE.Texture;o.image=r,void 0!==e&&(o.mapping=e),o.flipY=!1;for(var a=0,s=t.length;s>a;++a){var l=new Image;r[a]=l,l.onload=function(){r.loadCount+=1,6===r.loadCount&&(o.needsUpdate=!0,i&&i(o))},l.onerror=n,l.crossOrigin=this.crossOrigin,l.src=t[a]}return o},loadCompressedTextureCube:function(t,e,i,n){var r=[];r.loadCount=0;var o=new THREE.CompressedTexture;o.image=r,void 0!==e&&(o.mapping=e),o.flipY=!1,o.generateMipmaps=!1;var a=function(t,e){return function(){var n=t.response,a=THREE.ImageUtils.parseDDS(n,!0);e.format=a.format,e.mipmaps=a.mipmaps,e.width=a.width,e.height=a.height,r.loadCount+=1,6===r.loadCount&&(o.format=a.format,o.needsUpdate=!0,i&&i(o))}};if(t instanceof Array)for(var s=0,l=t.length;l>s;++s){var h={};r[s]=h;var c=new XMLHttpRequest;c.onload=a(c,h),c.onerror=n;var u=t[s];c.open("GET",u,!0),c.responseType="arraybuffer",c.send(null)}else{var u=t,c=new XMLHttpRequest;c.onload=function(){var t=c.response,e=THREE.ImageUtils.parseDDS(t,!0);if(e.isCubemap){for(var n=e.mipmaps.length/e.mipmapCount,a=0;n>a;a++){r[a]={mipmaps:[]};for(var s=0;s<e.mipmapCount;s++)r[a].mipmaps.push(e.mipmaps[a*e.mipmapCount+s]),r[a].format=e.format,r[a].width=e.width,r[a].height=e.height}o.format=e.format,o.needsUpdate=!0,i&&i(o)}},c.onerror=n,c.open("GET",u,!0),c.responseType="arraybuffer",c.send(null)}return o},parseDDS:function(t,e){function i(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}var n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},r=542327876,o=131072,a=512,s=4,l=i("DXT1"),h=i("DXT3"),c=i("DXT5"),u=31,d=0,f=1,p=2,m=3,g=4,v=7,y=20,E=21,x=28,T=new Int32Array(t,0,u);if(T[d]!==r)return n;if(!T[y]&s)return n;var _,b=T[E];switch(b){case l:_=8,n.format=THREE.RGB_S3TC_DXT1_Format;break;case h:_=16,n.format=THREE.RGBA_S3TC_DXT3_Format;break;case c:_=16,n.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return n}n.mipmapCount=1,T[p]&o&&e!==!1&&(n.mipmapCount=Math.max(1,T[v])),n.isCubemap=T[x]&a?!0:!1,n.width=T[g],n.height=T[m];for(var w=T[f]+4,R=n.width,S=n.height,M=n.isCubemap?6:1,H=0;M>H;H++){for(var C=0;C<n.mipmapCount;C++){var A=Math.max(4,R)/4*Math.max(4,S)/4*_,P=new Uint8Array(t,w,A),L={data:P,width:R,height:S};n.mipmaps.push(L),w+=A,R=Math.max(.5*R,1),S=Math.max(.5*S,1)}R=n.width,S=n.height}return n},getNormalMap:function(t,e){var i=function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},n=function(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]},r=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return[t[0]/e,t[1]/e,t[2]/e]};e|=1;var o=t.width,a=t.height,s=document.createElement("canvas");s.width=o,s.height=a;var l=s.getContext("2d");l.drawImage(t,0,0);for(var h=l.getImageData(0,0,o,a).data,c=l.createImageData(o,a),u=c.data,d=0;o>d;d++)for(var f=0;a>f;f++){var p=0>f-1?0:f-1,m=f+1>a-1?a-1:f+1,g=0>d-1?0:d-1,v=d+1>o-1?o-1:d+1,y=[],E=[0,0,h[4*(f*o+d)]/255*e];y.push([-1,0,h[4*(f*o+g)]/255*e]),y.push([-1,-1,h[4*(p*o+g)]/255*e]),y.push([0,-1,h[4*(p*o+d)]/255*e]),y.push([1,-1,h[4*(p*o+v)]/255*e]),y.push([1,0,h[4*(f*o+v)]/255*e]),y.push([1,1,h[4*(m*o+v)]/255*e]),y.push([0,1,h[4*(m*o+d)]/255*e]),y.push([-1,1,h[4*(m*o+g)]/255*e]);for(var x=[],T=y.length,_=0;T>_;_++){var b=y[_],w=y[(_+1)%T];b=n(b,E),w=n(w,E),x.push(r(i(b,w)))}for(var R=[0,0,0],_=0;_<x.length;_++)R[0]+=x[_][0],R[1]+=x[_][1],R[2]+=x[_][2];R[0]/=x.length,R[1]/=x.length,R[2]/=x.length;var S=4*(f*o+d);u[S]=(R[0]+1)/2*255|0,u[S+1]=(R[1]+1)/2*255|0,u[S+2]=255*R[2]|0,u[S+3]=255}return l.putImageData(c,0,0),s},generateDataTexture:function(t,e,i){for(var n=t*e,r=new Uint8Array(3*n),o=Math.floor(255*i.r),a=Math.floor(255*i.g),s=Math.floor(255*i.b),l=0;n>l;l++)r[3*l]=o,r[3*l+1]=a,r[3*l+2]=s;var h=new THREE.DataTexture(r,t,e,THREE.RGBFormat);return h.needsUpdate=!0,h}},THREE.SceneUtils={createMultiMaterialObject:function(t,e){for(var i=new THREE.Object3D,n=0,r=e.length;r>n;n++)i.add(new THREE.Mesh(t,e[n]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){var n=new THREE.Matrix4;n.getInverse(i.matrixWorld),t.applyMatrix(n),e.remove(t),i.add(t)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(t){var e=t.familyName.toLowerCase(),i=this;i.faces[e]=i.faces[e]||{},i.faces[e][t.cssFontWeight]=i.faces[e][t.cssFontWeight]||{},i.faces[e][t.cssFontWeight][t.cssFontStyle]=t;i.faces[e][t.cssFontWeight][t.cssFontStyle]=t;return t},drawText:function(t){var e,i=this.getFace(),n=this.size/i.resolution,r=0,o=String(t).split(""),a=o.length,s=[];for(e=0;a>e;e++){var l=new THREE.Path,h=this.extractGlyphPoints(o[e],i,n,r,l);r+=h.offset,s.push(h.path)}var c=r/2;return{paths:s,offset:c}},extractGlyphPoints:function(t,e,i,n,r){var o,a,s,l,h,c,u,d,f,p,m,g,v,y,E,x,T,_,b,w=[],R=e.glyphs[t]||e.glyphs["?"];if(R){if(R.o)for(l=R._cachedOutline||(R._cachedOutline=R.o.split(" ")),c=l.length,u=i,d=i,o=0;c>o;)switch(h=l[o++]){case"m":f=l[o++]*u+n,p=l[o++]*d,r.moveTo(f,p);break;case"l":f=l[o++]*u+n,p=l[o++]*d,r.lineTo(f,p);break;case"q":if(m=l[o++]*u+n,g=l[o++]*d,E=l[o++]*u+n,x=l[o++]*d,r.quadraticCurveTo(E,x,m,g),b=w[w.length-1],b)for(v=b.x,y=b.y,a=1,s=this.divisions;s>=a;a++){var S=a/s;THREE.Shape.Utils.b2(S,v,E,m),THREE.Shape.Utils.b2(S,y,x,g)}break;case"b":if(m=l[o++]*u+n,g=l[o++]*d,E=l[o++]*u+n,x=l[o++]*-d,T=l[o++]*u+n,_=l[o++]*-d,r.bezierCurveTo(m,g,E,x,T,_),b=w[w.length-1],b)for(v=b.x,y=b.y,a=1,s=this.divisions;s>=a;a++){var S=a/s;THREE.Shape.Utils.b3(S,v,E,T,m),THREE.Shape.Utils.b3(S,y,x,_,g)}}return{offset:R.ha*i,path:r}}}},THREE.FontUtils.generateShapes=function(t,e){e=e||{};var i=void 0!==e.size?e.size:100,n=void 0!==e.curveSegments?e.curveSegments:4,r=void 0!==e.font?e.font:"helvetiker",o=void 0!==e.weight?e.weight:"normal",a=void 0!==e.style?e.style:"normal";THREE.FontUtils.size=i,THREE.FontUtils.divisions=n,THREE.FontUtils.face=r,THREE.FontUtils.weight=o,THREE.FontUtils.style=a;for(var s=THREE.FontUtils.drawText(t),l=s.paths,h=[],c=0,u=l.length;u>c;c++)Array.prototype.push.apply(h,l[c].toShapes());return h},function(t){var e=1e-10,i=function(t,e){var i=t.length;if(3>i)return null;var o,a,s,l=[],h=[],c=[];if(n(t)>0)for(a=0;i>a;a++)h[a]=a;else for(a=0;i>a;a++)h[a]=i-1-a;var u=i,d=2*u;for(a=u-1;u>2;){if(d--<=0)return e?c:l;if(o=a,o>=u&&(o=0),a=o+1,a>=u&&(a=0),s=a+1,s>=u&&(s=0),r(t,o,a,s,u,h)){var f,p,m,g,v;for(f=h[o],p=h[a],m=h[s],l.push([t[f],t[p],t[m]]),c.push([h[o],h[a],h[s]]),g=a,v=a+1;u>v;g++,v++)h[g]=h[v];u--,d=2*u}}return e?c:l},n=function(t){for(var e=t.length,i=0,n=e-1,r=0;e>r;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},r=function(t,i,n,r,o,a){var s,l,h,c,u,d,f,p,m;if(l=t[a[i]].x,h=t[a[i]].y,c=t[a[n]].x,u=t[a[n]].y,d=t[a[r]].x,f=t[a[r]].y,e>(c-l)*(f-h)-(u-h)*(d-l))return!1;var g,v,y,E,x,T,_,b,w,R,S,M,H,C,A;for(g=d-c,v=f-u,y=l-d,E=h-f,x=c-l,T=u-h,s=0;o>s;s++)if(s!==i&&s!==n&&s!==r&&(p=t[a[s]].x,m=t[a[s]].y,_=p-l,b=m-h,w=p-c,R=m-u,S=p-d,M=m-f,A=g*R-v*w,H=x*b-T*_,C=y*M-E*S,A>=-e&&C>=-e&&H>=-e))return!1;return!0};return t.Triangulate=i,t.Triangulate.area=n,t}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Curve=function(){},THREE.Curve.prototype.getPoint=function(){return null},THREE.Curve.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},THREE.Curve.prototype.getPoints=function(t){t||(t=5);var e,i=[];for(e=0;t>=e;e++)i.push(this.getPoint(e/t));return i},THREE.Curve.prototype.getSpacedPoints=function(t){t||(t=5);var e,i=[];for(e=0;t>=e;e++)i.push(this.getPointAt(e/t));return i},THREE.Curve.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},THREE.Curve.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],r=this.getPoint(0),o=0;for(n.push(0),i=1;t>=i;i++)e=this.getPoint(i/t),o+=e.distanceTo(r),n.push(o),r=e;return this.cacheArcLengths=n,n},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(t,e){var i,n=this.getLengths(),r=0,o=n.length;i=e?e:t*n[o-1];for(var a,s=0,l=o-1;l>=s;)if(r=Math.floor(s+(l-s)/2),a=n[r]-i,0>a)s=r+1;else{if(!(a>0)){l=r;break}l=r-1}if(r=l,n[r]==i){var h=r/(o-1);return h}var c=n[r],u=n[r+1],d=u-c,f=(i-c)/d,h=(r+f)/(o-1);return h},THREE.Curve.prototype.getTangent=function(t){var e=1e-4,i=t-e,n=t+e;0>i&&(i=0),n>1&&(n=1);var r=this.getPoint(i),o=this.getPoint(n),a=o.clone().sub(r);return a.normalize()},THREE.Curve.prototype.getTangentAt=function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},THREE.Curve.Utils={tangentQuadraticBezier:function(t,e,i,n){return 2*(1-t)*(i-e)+2*t*(n-i)},tangentCubicBezier:function(t,e,i,n,r){return-3*e*(1-t)*(1-t)+3*i*(1-t)*(1-t)-6*t*i*(1-t)+6*t*n*(1-t)-3*t*t*n+3*t*t*r},tangentSpline:function(t){var e=6*t*t-6*t,i=3*t*t-4*t+1,n=-6*t*t+6*t,r=3*t*t-2*t;return e+i+n+r},interpolate:function(t,e,i,n,r){var o=.5*(i-t),a=.5*(n-e),s=r*r,l=r*s;return(2*e-2*i+o+a)*l+(-3*e+3*i-2*o-a)*s+o*r+e}},THREE.Curve.create=function(t,e){return t.prototype=Object.create(THREE.Curve.prototype),t.prototype.getPoint=e,t},THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.add=function(t){this.curves.push(t)},THREE.CurvePath.prototype.checkConnection=function(){},THREE.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new THREE.LineCurve(e,t))},THREE.CurvePath.prototype.getPoint=function(t){for(var e,i,n=t*this.getLength(),r=this.getCurveLengths(),o=0;o<r.length;){if(r[o]>=n){e=r[o]-n,i=this.curves[o];var a=1-e/i.getLength();return i.getPointAt(a)}o++}return null},THREE.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var t,e=[],i=0,n=this.curves.length;for(t=0;n>t;t++)i+=this.curves[t].getLength(),e.push(i);return this.cacheLengths=e,e},THREE.CurvePath.prototype.getBoundingBox=function(){var t,e,i,n,r,o,a=this.getPoints();t=e=Number.NEGATIVE_INFINITY,n=r=Number.POSITIVE_INFINITY;var s,l,h,c,u=a[0]instanceof THREE.Vector3;for(c=u?new THREE.Vector3:new THREE.Vector2,l=0,h=a.length;h>l;l++)s=a[l],s.x>t?t=s.x:s.x<n&&(n=s.x),s.y>e?e=s.y:s.y<r&&(r=s.y),u&&(s.z>i?i=s.z:s.z<o&&(o=s.z)),c.add(s);var d={minX:n,minY:r,maxX:t,maxY:e,centroid:c.divideScalar(h)};return u&&(d.maxZ=i,d.minZ=o),d},THREE.CurvePath.prototype.createPointsGeometry=function(t){var e=this.getPoints(t,!0);return this.createGeometry(e)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(t){var e=this.getSpacedPoints(t,!0);return this.createGeometry(e)},THREE.CurvePath.prototype.createGeometry=function(t){for(var e=new THREE.Geometry,i=0;i<t.length;i++)e.vertices.push(new THREE.Vector3(t[i].x,t[i].y,t[i].z||0));return e},THREE.CurvePath.prototype.addWrapPath=function(t){this.bends.push(t)},THREE.CurvePath.prototype.getTransformedPoints=function(t,e){var i,n,r=this.getPoints(t);for(e||(e=this.bends),i=0,n=e.length;n>i;i++)r=this.getWrapPoints(r,e[i]);return r},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(t,e){var i,n,r=this.getSpacedPoints(t);for(e||(e=this.bends),i=0,n=e.length;n>i;i++)r=this.getWrapPoints(r,e[i]);return r},THREE.CurvePath.prototype.getWrapPoints=function(t,e){var i,n,r,o,a,s,l=this.getBoundingBox();for(i=0,n=t.length;n>i;i++){r=t[i],o=r.x,a=r.y,s=o/l.maxX,s=e.getUtoTmapping(s,o);var h=e.getPoint(s),c=e.getNormalVector(s).multiplyScalar(a);r.x=h.x+c.x,r.y=h.y+c.y}return t},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.updateMatrixWorld=function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,i=this.children.length;i>e;e++)this.children[e].updateMatrixWorld(t)},THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3,THREE.Gyroscope.prototype.translationObject=new THREE.Vector3,THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion,THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion,THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3,THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3,THREE.Path=function(t){THREE.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},THREE.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;i>e;e++)this.lineTo(t[e].x,t[e].y)},THREE.Path.prototype.moveTo=function(){var t=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:t})},THREE.Path.prototype.lineTo=function(t,e){var i=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,r=n[n.length-2],o=n[n.length-1],a=new THREE.LineCurve(new THREE.Vector2(r,o),new THREE.Vector2(t,e));this.curves.push(a),this.actions.push({action:THREE.PathActions.LINE_TO,args:i})},THREE.Path.prototype.quadraticCurveTo=function(t,e,i,n){var r=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,a=o[o.length-2],s=o[o.length-1],l=new THREE.QuadraticBezierCurve(new THREE.Vector2(a,s),new THREE.Vector2(t,e),new THREE.Vector2(i,n));this.curves.push(l),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:r})},THREE.Path.prototype.bezierCurveTo=function(t,e,i,n,r,o){var a=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,l=s[s.length-2],h=s[s.length-1],c=new THREE.CubicBezierCurve(new THREE.Vector2(l,h),new THREE.Vector2(t,e),new THREE.Vector2(i,n),new THREE.Vector2(r,o));this.curves.push(c),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:a})},THREE.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,n=i[i.length-2],r=i[i.length-1],o=[new THREE.Vector2(n,r)];Array.prototype.push.apply(o,t);var a=new THREE.SplineCurve(o);this.curves.push(a),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:e})},THREE.Path.prototype.arc=function(t,e,i,n,r,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1];this.absarc(t+s,e+l,i,n,r,o)},THREE.Path.prototype.absarc=function(t,e,i,n,r,o){this.absellipse(t,e,i,i,n,r,o)},THREE.Path.prototype.ellipse=function(t,e,i,n,r,o,a){var s=this.actions[this.actions.length-1].args,l=s[s.length-2],h=s[s.length-1];this.absellipse(t+l,e+h,i,n,r,o,a)},THREE.Path.prototype.absellipse=function(t,e,i,n,r,o,a){var s=Array.prototype.slice.call(arguments),l=new THREE.EllipseCurve(t,e,i,n,r,o,a);this.curves.push(l);var h=l.getPoint(a?1:0);s.push(h.x),s.push(h.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:s})},THREE.Path.prototype.getSpacedPoints=function(t){t||(t=40);for(var e=[],i=0;t>i;i++)e.push(this.getPoint(i/t));return e},THREE.Path.prototype.getPoints=function(t,e){if(this.useSpacedPoints)return this.getSpacedPoints(t,e);t=t||12;var i,n,r,o,a,s,l,h,c,u,d,f,p,m,g,v,y,E,x=[];for(i=0,n=this.actions.length;n>i;i++)switch(r=this.actions[i],o=r.action,a=r.args,o){case THREE.PathActions.MOVE_TO:x.push(new THREE.Vector2(a[0],a[1]));break;case THREE.PathActions.LINE_TO:x.push(new THREE.Vector2(a[0],a[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:for(s=a[2],l=a[3],u=a[0],d=a[1],x.length>0?(m=x[x.length-1],f=m.x,p=m.y):(m=this.actions[i-1].args,f=m[m.length-2],p=m[m.length-1]),g=1;t>=g;g++)v=g/t,y=THREE.Shape.Utils.b2(v,f,u,s),E=THREE.Shape.Utils.b2(v,p,d,l),x.push(new THREE.Vector2(y,E));break;case THREE.PathActions.BEZIER_CURVE_TO:for(s=a[4],l=a[5],u=a[0],d=a[1],h=a[2],c=a[3],x.length>0?(m=x[x.length-1],f=m.x,p=m.y):(m=this.actions[i-1].args,f=m[m.length-2],p=m[m.length-1]),g=1;t>=g;g++)v=g/t,y=THREE.Shape.Utils.b3(v,f,u,h,s),E=THREE.Shape.Utils.b3(v,p,d,c,l),x.push(new THREE.Vector2(y,E));break;case THREE.PathActions.CSPLINE_THRU:m=this.actions[i-1].args;var T=new THREE.Vector2(m[m.length-2],m[m.length-1]),_=[T],b=t*a[0].length;_=_.concat(a[0]);var w=new THREE.SplineCurve(_);for(g=1;b>=g;g++)x.push(w.getPointAt(g/b));break;case THREE.PathActions.ARC:var R,S=a[0],M=a[1],H=a[2],C=a[3],A=a[4],P=!!a[5],L=A-C,O=2*t;for(g=1;O>=g;g++)v=g/O,P||(v=1-v),R=C+v*L,y=S+H*Math.cos(R),E=M+H*Math.sin(R),x.push(new THREE.Vector2(y,E));break;case THREE.PathActions.ELLIPSE:var R,S=a[0],M=a[1],D=a[2],z=a[3],C=a[4],A=a[5],P=!!a[6],L=A-C,O=2*t;for(g=1;O>=g;g++)v=g/O,P||(v=1-v),R=C+v*L,y=S+D*Math.cos(R),E=M+z*Math.sin(R),x.push(new THREE.Vector2(y,E))}var N=x[x.length-1],F=1e-10;return Math.abs(N.x-x[0].x)<F&&Math.abs(N.y-x[0].y)<F&&x.splice(x.length-1,1),e&&x.push(x[0]),x},THREE.Path.prototype.toShapes=function(t){var e,i,n,r,o,a=[],s=new THREE.Path;for(e=0,i=this.actions.length;i>e;e++)n=this.actions[e],o=n.args,r=n.action,r==THREE.PathActions.MOVE_TO&&0!=s.actions.length&&(a.push(s),s=new THREE.Path),s[r].apply(s,o);if(0!=s.actions.length&&a.push(s),0==a.length)return[];var l,h,c,u=[];if(1==a.length)return h=a[0],c=new THREE.Shape,c.actions=h.actions,c.curves=h.curves,u.push(c),u;var d=!THREE.Shape.Utils.isClockWise(a[0].getPoints());if(d=t?!d:d)for(c=new THREE.Shape,e=0,i=a.length;i>e;e++)h=a[e],l=THREE.Shape.Utils.isClockWise(h.getPoints()),l=t?!l:l,l?(c.actions=h.actions,c.curves=h.curves,u.push(c),c=new THREE.Shape):c.holes.push(h);else{for(c=void 0,e=0,i=a.length;i>e;e++)h=a[e],l=THREE.Shape.Utils.isClockWise(h.getPoints()),l=t?!l:l,l?(c&&u.push(c),c=new THREE.Shape,c.actions=h.actions,c.curves=h.curves):c.holes.push(h);u.push(c)}return u},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.extrude=function(t){var e=new THREE.ExtrudeGeometry(this,t);return e},THREE.Shape.prototype.makeGeometry=function(t){var e=new THREE.ShapeGeometry(this,t);return e},THREE.Shape.prototype.getPointsHoles=function(t){var e,i=this.holes.length,n=[];for(e=0;i>e;e++)n[e]=this.holes[e].getTransformedPoints(t,this.bends);return n},THREE.Shape.prototype.getSpacedPointsHoles=function(t){var e,i=this.holes.length,n=[];for(e=0;i>e;e++)n[e]=this.holes[e].getTransformedSpacedPoints(t,this.bends);return n},THREE.Shape.prototype.extractAllPoints=function(t){return{shape:this.getTransformedPoints(t),holes:this.getPointsHoles(t)}},THREE.Shape.prototype.extractPoints=function(t){return this.useSpacedPoints?this.extractAllSpacedPoints(t):this.extractAllPoints(t)},THREE.Shape.prototype.extractAllSpacedPoints=function(t){return{shape:this.getTransformedSpacedPoints(t),holes:this.getSpacedPointsHoles(t)}},THREE.Shape.Utils={removeHoles:function(t,e){var i,n,r,o,a,s,l,h,c,u,d,f,p,m,g,v,y=t.concat(),E=y.concat(),x=[];for(a=0;a<e.length;a++){for(l=e[a],Array.prototype.push.apply(E,l),h=Number.POSITIVE_INFINITY,s=0;s<l.length;s++){d=l[s];var T=[];for(u=0;u<y.length;u++)f=y[u],c=d.distanceToSquared(f),T.push(c),h>c&&(h=c,r=s,o=u)}i=o-1>=0?o-1:y.length-1,n=r-1>=0?r-1:l.length-1;var _=[l[r],y[o],y[i]],b=THREE.FontUtils.Triangulate.area(_),w=[l[r],l[n],y[o]],R=THREE.FontUtils.Triangulate.area(w),S=1,M=-1,H=o,C=r;o+=S,r+=M,0>o&&(o+=y.length),o%=y.length,0>r&&(r+=l.length),r%=l.length,i=o-1>=0?o-1:y.length-1,n=r-1>=0?r-1:l.length-1,_=[l[r],y[o],y[i]];var A=THREE.FontUtils.Triangulate.area(_);w=[l[r],l[n],y[o]];var P=THREE.FontUtils.Triangulate.area(w);b+R>A+P&&(o=H,r=C,0>o&&(o+=y.length),o%=y.length,0>r&&(r+=l.length),r%=l.length,i=o-1>=0?o-1:y.length-1,n=r-1>=0?r-1:l.length-1),p=y.slice(0,o),m=y.slice(o),g=l.slice(r),v=l.slice(0,r);var L=[l[r],y[o],y[i]],O=[l[r],l[n],y[o]];x.push(L),x.push(O),y=p.concat(g).concat(v).concat(m)}return{shape:y,isolatedPts:x,allpoints:E}},triangulateShape:function(t,e){var i,n,r,o,a,s,l=THREE.Shape.Utils.removeHoles(t,e),h=l.shape,c=l.allpoints,u=l.isolatedPts,d=THREE.FontUtils.Triangulate(h,!1),f={};for(i=0,n=c.length;n>i;i++)a=c[i].x+":"+c[i].y,void 0!==f[a]&&0,f[a]=i;for(i=0,n=d.length;n>i;i++)for(o=d[i],r=0;3>r;r++)a=o[r].x+":"+o[r].y,s=f[a],void 0!==s&&(o[r]=s);for(i=0,n=u.length;n>i;i++)for(o=u[i],r=0;3>r;r++)a=o[r].x+":"+o[r].y,s=f[a],void 0!==s&&(o[r]=s);return d.concat(u)},isClockWise:function(t){return THREE.FontUtils.Triangulate.area(t)<0},b2p0:function(t,e){var i=1-t;return i*i*e},b2p1:function(t,e){return 2*(1-t)*t*e},b2p2:function(t,e){return t*t*e},b2:function(t,e,i,n){return this.b2p0(t,e)+this.b2p1(t,i)+this.b2p2(t,n)},b3p0:function(t,e){var i=1-t;return i*i*i*e},b3p1:function(t,e){var i=1-t;return 3*i*i*t*e},b3p2:function(t,e){var i=1-t;return 3*i*t*t*e},b3p3:function(t,e){return t*t*t*e},b3:function(t,e,i,n,r){return this.b3p0(t,e)+this.b3p1(t,i)+this.b3p2(t,n)+this.b3p3(t,r)}},THREE.LineCurve=function(t,e){this.v1=t,this.v2=e},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},THREE.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},THREE.LineCurve.prototype.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()},THREE.QuadraticBezierCurve=function(t,e,i){this.v0=t,this.v1=e,this.v2=i},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.getPoint=function(t){var e,i;return e=THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),i=THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),new THREE.Vector2(e,i)},THREE.QuadraticBezierCurve.prototype.getTangent=function(t){var e,i;e=THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.x,this.v1.x,this.v2.x),i=THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.y,this.v1.y,this.v2.y);var n=new THREE.Vector2(e,i);return n.normalize(),n},THREE.CubicBezierCurve=function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.getPoint=function(t){var e,i;return e=THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(e,i)},THREE.CubicBezierCurve.prototype.getTangent=function(t){var e,i;e=THREE.Curve.Utils.tangentCubicBezier(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Curve.Utils.tangentCubicBezier(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var n=new THREE.Vector2(e,i);return n.normalize(),n},THREE.SplineCurve=function(t){this.points=void 0==t?[]:t},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.getPoint=function(t){var e,i,n,r=new THREE.Vector2,o=[],a=this.points;return e=(a.length-1)*t,i=Math.floor(e),n=e-i,o[0]=0==i?i:i-1,o[1]=i,o[2]=i>a.length-2?a.length-1:i+1,o[3]=i>a.length-3?a.length-1:i+2,r.x=THREE.Curve.Utils.interpolate(a[o[0]].x,a[o[1]].x,a[o[2]].x,a[o[3]].x,n),r.y=THREE.Curve.Utils.interpolate(a[o[0]].y,a[o[1]].y,a[o[2]].y,a[o[3]].y,n),r},THREE.EllipseCurve=function(t,e,i,n,r,o,a){this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.getPoint=function(t){var e=this.aEndAngle-this.aStartAngle;this.aClockwise||(t=1-t);var i=this.aStartAngle+t*e,n=this.aX+this.xRadius*Math.cos(i),r=this.aY+this.yRadius*Math.sin(i);return new THREE.Vector2(n,r)},THREE.ArcCurve=function(t,e,i,n,r,o){THREE.EllipseCurve.call(this,t,e,i,i,n,r,o)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.LineCurve3=THREE.Curve.create(function(t,e){this.v1=t,this.v2=e},function(t){var e=new THREE.Vector3;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(t,e,i){this.v0=t,this.v1=e,this.v2=i},function(t){var e,i,n;return e=THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),i=THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),n=THREE.Shape.Utils.b2(t,this.v0.z,this.v1.z,this.v2.z),new THREE.Vector3(e,i,n)}),THREE.CubicBezierCurve3=THREE.Curve.create(function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},function(t){var e,i,n;return e=THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),n=THREE.Shape.Utils.b3(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new THREE.Vector3(e,i,n)
}),THREE.SplineCurve3=THREE.Curve.create(function(t){this.points=void 0==t?[]:t},function(t){var e,i,n,r=new THREE.Vector3,o=[],a=this.points;e=(a.length-1)*t,i=Math.floor(e),n=e-i,o[0]=0==i?i:i-1,o[1]=i,o[2]=i>a.length-2?a.length-1:i+1,o[3]=i>a.length-3?a.length-1:i+2;var s=a[o[0]],l=a[o[1]],h=a[o[2]],c=a[o[3]];return r.x=THREE.Curve.Utils.interpolate(s.x,l.x,h.x,c.x,n),r.y=THREE.Curve.Utils.interpolate(s.y,l.y,h.y,c.y,n),r.z=THREE.Curve.Utils.interpolate(s.z,l.z,h.z,c.z,n),r}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(t){this.points=void 0==t?[]:t},function(t){var e,i,n,r=new THREE.Vector3,o=[],a=this.points;return e=(a.length-0)*t,i=Math.floor(e),n=e-i,i+=i>0?0:(Math.floor(Math.abs(i)/a.length)+1)*a.length,o[0]=(i-1)%a.length,o[1]=i%a.length,o[2]=(i+1)%a.length,o[3]=(i+2)%a.length,r.x=THREE.Curve.Utils.interpolate(a[o[0]].x,a[o[1]].x,a[o[2]].x,a[o[3]].x,n),r.y=THREE.Curve.Utils.interpolate(a[o[0]].y,a[o[1]].y,a[o[2]].y,a[o[3]].y,n),r.z=THREE.Curve.Utils.interpolate(a[o[0]].z,a[o[1]].z,a[o[2]].z,a[o[3]].z,n),r}),THREE.AnimationHandler=function(){var t=[],e={},i={};i.update=function(e){for(var i=0;i<t.length;i++)t[i].update(e)},i.addToUpdate=function(e){-1===t.indexOf(e)&&t.push(e)},i.removeFromUpdate=function(e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},i.add=function(t){void 0!==e[t.name]&&0,e[t.name]=t,r(t)},i.get=function(t){return"string"==typeof t?e[t]?e[t]:null:void 0},i.parse=function(t){var e=[];if(t instanceof THREE.SkinnedMesh)for(var i=0;i<t.bones.length;i++)e.push(t.bones[i]);else n(t,e);return e};var n=function(t,e){e.push(t);for(var i=0;i<t.children.length;i++)n(t.children[i],e)},r=function(t){if(t.initialized!==!0){for(var e=0;e<t.hierarchy.length;e++){for(var i=0;i<t.hierarchy[e].keys.length;i++)if(t.hierarchy[e].keys[i].time<0&&(t.hierarchy[e].keys[i].time=0),void 0!==t.hierarchy[e].keys[i].rot&&!(t.hierarchy[e].keys[i].rot instanceof THREE.Quaternion)){var n=t.hierarchy[e].keys[i].rot;t.hierarchy[e].keys[i].rot=new THREE.Quaternion(n[0],n[1],n[2],n[3])}if(t.hierarchy[e].keys.length&&void 0!==t.hierarchy[e].keys[0].morphTargets){for(var r={},i=0;i<t.hierarchy[e].keys.length;i++)for(var o=0;o<t.hierarchy[e].keys[i].morphTargets.length;o++){var a=t.hierarchy[e].keys[i].morphTargets[o];r[a]=-1}t.hierarchy[e].usedMorphTargets=r;for(var i=0;i<t.hierarchy[e].keys.length;i++){var s={};for(var a in r){for(var o=0;o<t.hierarchy[e].keys[i].morphTargets.length;o++)if(t.hierarchy[e].keys[i].morphTargets[o]===a){s[a]=t.hierarchy[e].keys[i].morphTargetsInfluences[o];break}o===t.hierarchy[e].keys[i].morphTargets.length&&(s[a]=0)}t.hierarchy[e].keys[i].morphTargetsInfluences=s}}for(var i=1;i<t.hierarchy[e].keys.length;i++)t.hierarchy[e].keys[i].time===t.hierarchy[e].keys[i-1].time&&(t.hierarchy[e].keys.splice(i,1),i--);for(var i=0;i<t.hierarchy[e].keys.length;i++)t.hierarchy[e].keys[i].index=i}var l=parseInt(t.length*t.fps,10);t.JIT={},t.JIT.hierarchy=[];for(var e=0;e<t.hierarchy.length;e++)t.JIT.hierarchy.push(new Array(l));t.initialized=!0}};return i.LINEAR=0,i.CATMULLROM=1,i.CATMULLROM_FORWARD=2,i}(),THREE.Animation=function(t,e,i){this.root=t,this.data=THREE.AnimationHandler.get(e),this.hierarchy=THREE.AnimationHandler.parse(t),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.interpolationType=void 0!==i?i:THREE.AnimationHandler.LINEAR,this.points=[],this.target=new THREE.Vector3},THREE.Animation.prototype.play=function(t,e){if(this.isPlaying===!1){this.isPlaying=!0,this.loop=void 0!==t?t:!0,this.currentTime=void 0!==e?e:0;var i,n,r=this.hierarchy.length;for(i=0;r>i;i++){n=this.hierarchy[i],n.matrixAutoUpdate=!0,void 0===n.animationCache&&(n.animationCache={},n.animationCache.prevKey={pos:0,rot:0,scl:0},n.animationCache.nextKey={pos:0,rot:0,scl:0},n.animationCache.originalMatrix=n instanceof THREE.Bone?n.skinMatrix:n.matrix);var o=n.animationCache.prevKey,a=n.animationCache.nextKey;o.pos=this.data.hierarchy[i].keys[0],o.rot=this.data.hierarchy[i].keys[0],o.scl=this.data.hierarchy[i].keys[0],a.pos=this.getNextKeyWith("pos",i,1),a.rot=this.getNextKeyWith("rot",i,1),a.scl=this.getNextKeyWith("scl",i,1)}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.Animation.prototype.pause=function(){this.isPaused===!0?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.Animation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this)},THREE.Animation.prototype.update=function(t){if(this.isPlaying!==!1){{var e,i,n,r,o,a,s,l,h,c,u,d,f,p,m,g=["pos","rot","scl"];this.data.JIT.hierarchy}this.currentTime+=t*this.timeScale,d=this.currentTime,u=this.currentTime=this.currentTime%this.data.length,c=parseInt(Math.min(u*this.data.fps,this.data.length*this.data.fps),10);for(var v=0,y=this.hierarchy.length;y>v;v++){l=this.hierarchy[v],h=l.animationCache;for(var E=0;3>E;E++){if(e=g[E],a=h.prevKey[e],s=h.nextKey[e],s.time<=d){if(d>u){if(!this.loop)return void this.stop();for(a=this.data.hierarchy[v].keys[0],s=this.getNextKeyWith(e,v,1);s.time<u;)a=s,s=this.getNextKeyWith(e,v,s.index+1)}else do a=s,s=this.getNextKeyWith(e,v,s.index+1);while(s.time<u);h.prevKey[e]=a,h.nextKey[e]=s}l.matrixAutoUpdate=!0,l.matrixWorldNeedsUpdate=!0,i=(u-a.time)/(s.time-a.time),r=a[e],o=s[e],(0>i||i>1)&&(i=0>i?0:1),"pos"===e?(n=l.position,this.interpolationType===THREE.AnimationHandler.LINEAR?(n.x=r[0]+(o[0]-r[0])*i,n.y=r[1]+(o[1]-r[1])*i,n.z=r[2]+(o[2]-r[2])*i):(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)&&(this.points[0]=this.getPrevKeyWith("pos",v,a.index-1).pos,this.points[1]=r,this.points[2]=o,this.points[3]=this.getNextKeyWith("pos",v,s.index+1).pos,i=.33*i+.33,f=this.interpolateCatmullRom(this.points,i),n.x=f[0],n.y=f[1],n.z=f[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(p=this.interpolateCatmullRom(this.points,1.01*i),this.target.set(p[0],p[1],p[2]),this.target.sub(n),this.target.y=0,this.target.normalize(),m=Math.atan2(this.target.x,this.target.z),l.rotation.set(0,m,0)))):"rot"===e?THREE.Quaternion.slerp(r,o,l.quaternion,i):"scl"===e&&(n=l.scale,n.x=r[0]+(o[0]-r[0])*i,n.y=r[1]+(o[1]-r[1])*i,n.z=r[2]+(o[2]-r[2])*i)}}}},THREE.Animation.prototype.interpolateCatmullRom=function(t,e){var i,n,r,o,a,s,l,h,c,u=[],d=[];return i=(t.length-1)*e,n=Math.floor(i),r=i-n,u[0]=0===n?n:n-1,u[1]=n,u[2]=n>t.length-2?n:n+1,u[3]=n>t.length-3?n:n+2,s=t[u[0]],l=t[u[1]],h=t[u[2]],c=t[u[3]],o=r*r,a=r*o,d[0]=this.interpolate(s[0],l[0],h[0],c[0],r,o,a),d[1]=this.interpolate(s[1],l[1],h[1],c[1],r,o,a),d[2]=this.interpolate(s[2],l[2],h[2],c[2],r,o,a),d},THREE.Animation.prototype.interpolate=function(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e},THREE.Animation.prototype.getNextKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i=i<n.length-1?i:n.length-1:i%=n.length;i<n.length;i++)if(void 0!==n[i][t])return n[i];return this.data.hierarchy[e].keys[0]},THREE.Animation.prototype.getPrevKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(i=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i>0?i:0:i>=0?i:i+n.length;i>=0;i--)if(void 0!==n[i][t])return n[i];return this.data.hierarchy[e].keys[n.length-1]},THREE.KeyFrameAnimation=function(t,e,i){this.root=t,this.data=THREE.AnimationHandler.get(e),this.hierarchy=THREE.AnimationHandler.parse(t),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.JITCompile=void 0!==i?i:!0;for(var n=0,r=this.hierarchy.length;r>n;n++){var o=this.data.hierarchy[n].keys,a=this.data.hierarchy[n].sids,s=this.hierarchy[n];if(o.length&&a){for(var l=0;l<a.length;l++){var h=a[l],c=this.getNextKeyWith(h,n,0);c&&c.apply(h)}s.matrixAutoUpdate=!1,this.data.hierarchy[n].node.updateMatrix(),s.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype.play=function(t,e){if(!this.isPlaying){this.isPlaying=!0,this.loop=void 0!==t?t:!0,this.currentTime=void 0!==e?e:0,this.startTimeMs=e,this.startTime=1e7,this.endTime=-this.startTime;var i,n,r,o=this.hierarchy.length;for(i=0;o>i;i++){n=this.hierarchy[i],r=this.data.hierarchy[i],void 0===r.animationCache&&(r.animationCache={},r.animationCache.prevKey=null,r.animationCache.nextKey=null,r.animationCache.originalMatrix=n instanceof THREE.Bone?n.skinMatrix:n.matrix);var a=this.data.hierarchy[i].keys;a.length&&(r.animationCache.prevKey=a[0],r.animationCache.nextKey=a[1],this.startTime=Math.min(a[0].time,this.startTime),this.endTime=Math.max(a[a.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this);for(var t=0;t<this.data.hierarchy.length;t++){var e=this.hierarchy[t],i=this.data.hierarchy[t];if(void 0!==i.animationCache){var n=i.animationCache.originalMatrix;e instanceof THREE.Bone?(n.copy(e.skinMatrix),e.skinMatrix=n):(n.copy(e.matrix),e.matrix=n),delete i.animationCache}}},THREE.KeyFrameAnimation.prototype.update=function(t){if(this.isPlaying){var e,i,n,r,o,a,s,l,h=this.data.JIT.hierarchy;if(this.currentTime+=t*this.timeScale,s=this.currentTime,a=this.currentTime=this.currentTime%this.data.length,a<this.startTimeMs&&(a=this.currentTime=this.startTimeMs+a),o=parseInt(Math.min(a*this.data.fps,this.data.length*this.data.fps),10),l=s>a,l&&!this.loop){for(var c=0,u=this.hierarchy.length;u>c;c++){var d=this.data.hierarchy[c].keys,f=this.data.hierarchy[c].sids,p=d.length-1,m=this.hierarchy[c];if(d.length){for(var g=0;g<f.length;g++){var v=f[g],y=this.getPrevKeyWith(v,c,p);y&&y.apply(v)}this.data.hierarchy[c].node.updateMatrix(),m.matrixWorldNeedsUpdate=!0}}return void this.stop()}if(!(a<this.startTime)){for(var c=0,u=this.hierarchy.length;u>c;c++){n=this.hierarchy[c],r=this.data.hierarchy[c];var d=r.keys,E=r.animationCache;if(this.JITCompile&&void 0!==h[c][o])n instanceof THREE.Bone?(n.skinMatrix=h[c][o],n.matrixWorldNeedsUpdate=!1):(n.matrix=h[c][o],n.matrixWorldNeedsUpdate=!0);else if(d.length){if(this.JITCompile&&E&&(n instanceof THREE.Bone?n.skinMatrix=E.originalMatrix:n.matrix=E.originalMatrix),e=E.prevKey,i=E.nextKey,e&&i){if(i.time<=s){if(l&&this.loop)for(e=d[0],i=d[1];i.time<a;)e=i,i=d[e.index+1];else if(!l)for(var x=d.length-1;i.time<a&&i.index!==x;)e=i,i=d[e.index+1];E.prevKey=e,E.nextKey=i}i.time>=a?e.interpolate(i,a):e.interpolate(i,i.time)}this.data.hierarchy[c].node.updateMatrix(),n.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===h[0][o]){this.hierarchy[0].updateMatrixWorld(!0);for(var c=0;c<this.hierarchy.length;c++)h[c][o]=this.hierarchy[c]instanceof THREE.Bone?this.hierarchy[c].skinMatrix.clone():this.hierarchy[c].matrix.clone()}}}},THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(i%=n.length;i<n.length;i++)if(n[i].hasTarget(t))return n[i];return n[0]},THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(i=i>=0?i:i+n.length;i>=0;i--)if(n[i].hasTarget(t))return n[i];return n[n.length-1]},THREE.CubeCamera=function(t,e,i){THREE.Object3D.call(this);var n=90,r=1,o=new THREE.PerspectiveCamera(n,r,t,e);o.up.set(0,-1,0),o.lookAt(new THREE.Vector3(1,0,0)),this.add(o);var a=new THREE.PerspectiveCamera(n,r,t,e);a.up.set(0,-1,0),a.lookAt(new THREE.Vector3(-1,0,0)),this.add(a);var s=new THREE.PerspectiveCamera(n,r,t,e);s.up.set(0,0,1),s.lookAt(new THREE.Vector3(0,1,0)),this.add(s);var l=new THREE.PerspectiveCamera(n,r,t,e);l.up.set(0,0,-1),l.lookAt(new THREE.Vector3(0,-1,0)),this.add(l);var h=new THREE.PerspectiveCamera(n,r,t,e);h.up.set(0,-1,0),h.lookAt(new THREE.Vector3(0,0,1)),this.add(h);var c=new THREE.PerspectiveCamera(n,r,t,e);c.up.set(0,-1,0),c.lookAt(new THREE.Vector3(0,0,-1)),this.add(c),this.renderTarget=new THREE.WebGLRenderTargetCube(i,i,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(t,e){var i=this.renderTarget,n=i.generateMipmaps;i.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,o,i),i.activeCubeFace=1,t.render(e,a,i),i.activeCubeFace=2,t.render(e,s,i),i.activeCubeFace=3,t.render(e,l,i),i.activeCubeFace=4,t.render(e,h,i),i.generateMipmaps=n,i.activeCubeFace=5,t.render(e,c,i)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CombinedCamera=function(t,e,i,n,r,o,a){THREE.Camera.call(this),this.fov=i,this.left=-t/2,this.right=t/2,this.top=e/2,this.bottom=-e/2,this.cameraO=new THREE.OrthographicCamera(t/-2,t/2,e/2,e/-2,o,a),this.cameraP=new THREE.PerspectiveCamera(i,t/e,n,r),this.zoom=1,this.toPerspective()},THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype),THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near,this.far=this.cameraP.far,this.cameraP.fov=this.fov/this.zoom,this.cameraP.updateProjectionMatrix(),this.projectionMatrix=this.cameraP.projectionMatrix,this.inPerspectiveMode=!0,this.inOrthographicMode=!1},THREE.CombinedCamera.prototype.toOrthographic=function(){var t=this.fov,e=this.cameraP.aspect,i=this.cameraP.near,n=this.cameraP.far,r=(i+n)/2,o=Math.tan(t/2)*r,a=2*o,s=a*e,l=s/2;o/=this.zoom,l/=this.zoom,this.cameraO.left=-l,this.cameraO.right=l,this.cameraO.top=o,this.cameraO.bottom=-o,this.cameraO.updateProjectionMatrix(),this.near=this.cameraO.near,this.far=this.cameraO.far,this.projectionMatrix=this.cameraO.projectionMatrix,this.inPerspectiveMode=!1,this.inOrthographicMode=!0},THREE.CombinedCamera.prototype.setSize=function(t,e){this.cameraP.aspect=t/e,this.left=-t/2,this.right=t/2,this.top=e/2,this.bottom=-e/2},THREE.CombinedCamera.prototype.setFov=function(t){this.fov=t,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())},THREE.CombinedCamera.prototype.setLens=function(t,e){void 0===e&&(e=24);var i=2*THREE.Math.radToDeg(Math.atan(e/(2*t)));return this.setFov(i),i},THREE.CombinedCamera.prototype.setZoom=function(t){this.zoom=t,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0,this.rotation.y=Math.PI,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0,this.rotation.y=-Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0,this.rotation.y=Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CircleGeometry=function(t,e,i,n){THREE.Geometry.call(this),t=t||50,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI,e=void 0!==e?Math.max(3,e):8;var r,o=[],a=new THREE.Vector3,s=new THREE.Vector2(.5,.5);for(this.vertices.push(a),o.push(s),r=0;e>=r;r++){var l=new THREE.Vector3,h=i+r/e*n;l.x=t*Math.cos(h),l.y=t*Math.sin(h),this.vertices.push(l),o.push(new THREE.Vector2((l.x/t+1)/2,(l.y/t+1)/2))}var c=new THREE.Vector3(0,0,1);for(r=1;e>=r;r++){var u=r,d=r+1,f=0;this.faces.push(new THREE.Face3(u,d,f,[c,c,c])),this.faceVertexUvs[0].push([o[r],o[r+1],s])}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,t)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CubeGeometry=function(t,e,i,n,r,o){function a(t,e,i,n,r,o,a,l){var h,c,u,d=s.widthSegments,f=s.heightSegments,p=r/2,m=o/2,g=s.vertices.length;"x"===t&&"y"===e||"y"===t&&"x"===e?h="z":"x"===t&&"z"===e||"z"===t&&"x"===e?(h="y",f=s.depthSegments):("z"===t&&"y"===e||"y"===t&&"z"===e)&&(h="x",d=s.depthSegments);var v=d+1,y=f+1,E=r/d,x=o/f,T=new THREE.Vector3;for(T[h]=a>0?1:-1,u=0;y>u;u++)for(c=0;v>c;c++){var _=new THREE.Vector3;_[t]=(c*E-p)*i,_[e]=(u*x-m)*n,_[h]=a,s.vertices.push(_)}for(u=0;f>u;u++)for(c=0;d>c;c++){var b=c+v*u,w=c+v*(u+1),R=c+1+v*(u+1),S=c+1+v*u,M=new THREE.Vector2(c/d,1-u/f),H=new THREE.Vector2(c/d,1-(u+1)/f),C=new THREE.Vector2((c+1)/d,1-(u+1)/f),A=new THREE.Vector2((c+1)/d,1-u/f),P=new THREE.Face3(b+g,w+g,S+g);P.normal.copy(T),P.vertexNormals.push(T.clone(),T.clone(),T.clone()),P.materialIndex=l,s.faces.push(P),s.faceVertexUvs[0].push([M,H,A]),P=new THREE.Face3(w+g,R+g,S+g),P.normal.copy(T),P.vertexNormals.push(T.clone(),T.clone(),T.clone()),P.materialIndex=l,s.faces.push(P),s.faceVertexUvs[0].push([H.clone(),C,A.clone()])}}THREE.Geometry.call(this);var s=this;this.width=t,this.height=e,this.depth=i,this.widthSegments=n||1,this.heightSegments=r||1,this.depthSegments=o||1;var l=this.width/2,h=this.height/2,c=this.depth/2;a("z","y",-1,-1,this.depth,this.height,l,0),a("z","y",1,-1,this.depth,this.height,-l,1),a("x","z",1,1,this.width,this.depth,h,2),a("x","z",1,-1,this.width,this.depth,-h,3),a("x","y",1,-1,this.width,this.height,c,4),a("x","y",-1,-1,this.width,this.height,-c,5),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry=function(t,e,i,n,r,o){THREE.Geometry.call(this),this.radiusTop=t=void 0!==t?t:20,this.radiusBottom=e=void 0!==e?e:20,this.height=i=void 0!==i?i:100,this.radialSegments=n=n||8,this.heightSegments=r=r||1,this.openEnded=o=void 0!==o?o:!1;var a,s,l=i/2,h=[],c=[];for(s=0;r>=s;s++){var u=[],d=[],f=s/r,p=f*(e-t)+t;for(a=0;n>=a;a++){var m=a/n,g=new THREE.Vector3;g.x=p*Math.sin(m*Math.PI*2),g.y=-f*i+l,g.z=p*Math.cos(m*Math.PI*2),this.vertices.push(g),u.push(this.vertices.length-1),d.push(new THREE.Vector2(m,1-f))}h.push(u),c.push(d)}var v,y,E=(e-t)/i;for(a=0;n>a;a++)for(0!==t?(v=this.vertices[h[0][a]].clone(),y=this.vertices[h[0][a+1]].clone()):(v=this.vertices[h[1][a]].clone(),y=this.vertices[h[1][a+1]].clone()),v.setY(Math.sqrt(v.x*v.x+v.z*v.z)*E).normalize(),y.setY(Math.sqrt(y.x*y.x+y.z*y.z)*E).normalize(),s=0;r>s;s++){var x=h[s][a],T=h[s+1][a],_=h[s+1][a+1],b=h[s][a+1],w=v.clone(),R=v.clone(),S=y.clone(),M=y.clone(),H=c[s][a].clone(),C=c[s+1][a].clone(),A=c[s+1][a+1].clone(),P=c[s][a+1].clone();this.faces.push(new THREE.Face3(x,T,b,[w,R,M])),this.faceVertexUvs[0].push([H,C,P]),this.faces.push(new THREE.Face3(T,_,b,[R,S,M])),this.faceVertexUvs[0].push([C,A,P])}if(o===!1&&t>0)for(this.vertices.push(new THREE.Vector3(0,l,0)),a=0;n>a;a++){var x=h[0][a],T=h[0][a+1],_=this.vertices.length-1,w=new THREE.Vector3(0,1,0),R=new THREE.Vector3(0,1,0),S=new THREE.Vector3(0,1,0),H=c[0][a].clone(),C=c[0][a+1].clone(),A=new THREE.Vector2(C.u,0);this.faces.push(new THREE.Face3(x,T,_,[w,R,S])),this.faceVertexUvs[0].push([H,C,A])}if(o===!1&&e>0)for(this.vertices.push(new THREE.Vector3(0,-l,0)),a=0;n>a;a++){var x=h[s][a+1],T=h[s][a],_=this.vertices.length-1,w=new THREE.Vector3(0,-1,0),R=new THREE.Vector3(0,-1,0),S=new THREE.Vector3(0,-1,0),H=c[s][a+1].clone(),C=c[s][a].clone(),A=new THREE.Vector2(C.u,1);this.faces.push(new THREE.Face3(x,T,_,[w,R,S])),this.faceVertexUvs[0].push([H,C,A])}this.computeCentroids(),this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry=function(t,e){return"undefined"==typeof t?void(t=[]):(THREE.Geometry.call(this),t=t instanceof Array?t:[t],this.shapebb=t[t.length-1].getBoundingBox(),this.addShapeList(t,e),this.computeCentroids(),this.computeFaceNormals(),void 0)},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var i=t.length,n=0;i>n;n++){var r=t[n];this.addShape(r,e)}},THREE.ExtrudeGeometry.prototype.addShape=function(t,e){function i(t,e,i){return e.clone().multiplyScalar(i).add(t)}function n(t,e,i){return o(t,e,i)}function r(t,e,i){var n=Math.atan2(e.y-t.y,e.x-t.x),r=Math.atan2(i.y-t.y,i.x-t.x);n>r&&(r+=2*Math.PI);var o=(n+r)/2,a=-Math.cos(o),s=-Math.sin(o),l=new THREE.Vector2(a,s);return l}function o(t,e,i){var n,o,a,s,l,h,c=THREE.ExtrudeGeometry.__v1,u=THREE.ExtrudeGeometry.__v2,d=THREE.ExtrudeGeometry.__v3,f=THREE.ExtrudeGeometry.__v4,p=THREE.ExtrudeGeometry.__v5,m=THREE.ExtrudeGeometry.__v6;return c.set(t.x-e.x,t.y-e.y),u.set(t.x-i.x,t.y-i.y),n=c.normalize(),o=u.normalize(),d.set(-n.y,n.x),f.set(o.y,-o.x),p.copy(t).add(d),m.copy(t).add(f),p.equals(m)?f.clone():(p.copy(e).add(d),m.copy(i).add(f),a=n.dot(f),s=m.sub(p).dot(f),l=s/a,0>l?r(t,e,i):(h=n.multiplyScalar(l).add(p),h.sub(t).clone()))}function a(){if(T){var t=0,e=X*t;for(K=0;q>K;K++)W=U[K],c(W[2]+e,W[1]+e,W[0]+e,!0);for(t=b+2*x,e=X*t,K=0;q>K;K++)W=U[K],c(W[0]+e,W[1]+e,W[2]+e,!1)}else{for(K=0;q>K;K++)W=U[K],c(W[2],W[1],W[0],!0);for(K=0;q>K;K++)W=U[K],c(W[0]+X*b,W[1]+X*b,W[2]+X*b,!1)}}function s(){var t=0;for(l(I,t),t+=I.length,A=0,P=N.length;P>A;A++)C=N[A],l(C,t),t+=C.length}function l(t,e){var i,n;for(K=t.length;--K>=0;){i=K,n=K-1,0>n&&(n=t.length-1);var r=0,o=b+2*x;for(r=0;o>r;r++){var a=X*r,s=X*(r+1),l=e+i+a,h=e+n+a,c=e+n+s,d=e+i+s;u(l,h,c,d,t,r,o,i,n)}}}function h(t,e,i){L.vertices.push(new THREE.Vector3(t,e,i))}function c(i,n,r,o){i+=O,n+=O,r+=O,L.faces.push(new THREE.Face3(i,n,r,null,null,S));var a=o?H.generateBottomUV(L,t,e,i,n,r):H.generateTopUV(L,t,e,i,n,r);L.faceVertexUvs[0].push(a)}function u(i,n,r,o,a,s,l,h,c){i+=O,n+=O,r+=O,o+=O,L.faces.push(new THREE.Face3(i,n,o,null,null,M)),L.faces.push(new THREE.Face3(n,r,o,null,null,M));var u=H.generateSideWallUV(L,t,a,e,i,n,r,o,s,l,h,c);L.faceVertexUvs[0].push([u[0],u[1],u[3]]),L.faceVertexUvs[0].push([u[1],u[2],u[3]])}{var d,f,p,m,g,v=void 0!==e.amount?e.amount:100,y=void 0!==e.bevelThickness?e.bevelThickness:6,E=void 0!==e.bevelSize?e.bevelSize:y-2,x=void 0!==e.bevelSegments?e.bevelSegments:3,T=void 0!==e.bevelEnabled?e.bevelEnabled:!0,_=void 0!==e.curveSegments?e.curveSegments:12,b=void 0!==e.steps?e.steps:1,w=e.extrudePath,R=!1,S=e.material,M=e.extrudeMaterial,H=void 0!==e.UVGenerator?e.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;this.shapebb}w&&(d=w.getSpacedPoints(b),R=!0,T=!1,f=void 0!==e.frames?e.frames:new THREE.TubeGeometry.FrenetFrames(w,b,!1),p=new THREE.Vector3,m=new THREE.Vector3,g=new THREE.Vector3),T||(x=0,y=0,E=0);var C,A,P,L=this,O=this.vertices.length,D=t.extractPoints(_),z=D.shape,N=D.holes,F=!THREE.Shape.Utils.isClockWise(z);if(F){for(z=z.reverse(),A=0,P=N.length;P>A;A++)C=N[A],THREE.Shape.Utils.isClockWise(C)&&(N[A]=C.reverse());F=!1}var U=THREE.Shape.Utils.triangulateShape(z,N),I=z;for(A=0,P=N.length;P>A;A++)C=N[A],z=z.concat(C);for(var k,V,B,j,G,W,X=z.length,q=U.length,Y=(I.length,180/Math.PI,[]),K=0,$=I.length,Q=$-1,Z=K+1;$>K;K++,Q++,Z++){Q===$&&(Q=0),Z===$&&(Z=0);{I[K],I[Q],I[Z]}Y[K]=n(I[K],I[Q],I[Z])}var J,te=[],ee=Y.concat();for(A=0,P=N.length;P>A;A++){for(C=N[A],J=[],K=0,$=C.length,Q=$-1,Z=K+1;$>K;K++,Q++,Z++)Q===$&&(Q=0),Z===$&&(Z=0),J[K]=n(C[K],C[Q],C[Z]);te.push(J),ee=ee.concat(J)}for(k=0;x>k;k++){for(B=k/x,j=y*(1-B),V=E*Math.sin(B*Math.PI/2),K=0,$=I.length;$>K;K++)G=i(I[K],Y[K],V),h(G.x,G.y,-j);for(A=0,P=N.length;P>A;A++)for(C=N[A],J=te[A],K=0,$=C.length;$>K;K++)G=i(C[K],J[K],V),h(G.x,G.y,-j)}for(V=E,K=0;X>K;K++)G=T?i(z[K],ee[K],V):z[K],R?(m.copy(f.normals[0]).multiplyScalar(G.x),p.copy(f.binormals[0]).multiplyScalar(G.y),g.copy(d[0]).add(m).add(p),h(g.x,g.y,g.z)):h(G.x,G.y,0);var ie;for(ie=1;b>=ie;ie++)for(K=0;X>K;K++)G=T?i(z[K],ee[K],V):z[K],R?(m.copy(f.normals[ie]).multiplyScalar(G.x),p.copy(f.binormals[ie]).multiplyScalar(G.y),g.copy(d[ie]).add(m).add(p),h(g.x,g.y,g.z)):h(G.x,G.y,v/b*ie);for(k=x-1;k>=0;k--){for(B=k/x,j=y*(1-B),V=E*Math.sin(B*Math.PI/2),K=0,$=I.length;$>K;K++)G=i(I[K],Y[K],V),h(G.x,G.y,v+j);for(A=0,P=N.length;P>A;A++)for(C=N[A],J=te[A],K=0,$=C.length;$>K;K++)G=i(C[K],J[K],V),R?h(G.x,G.y+d[b-1].y,d[b-1].x+j):h(G.x,G.y,v+j)}a(),s()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,e,i,n,r,o){var a=t.vertices[n].x,s=t.vertices[n].y,l=t.vertices[r].x,h=t.vertices[r].y,c=t.vertices[o].x,u=t.vertices[o].y;return[new THREE.Vector2(a,s),new THREE.Vector2(l,h),new THREE.Vector2(c,u)]},generateBottomUV:function(t,e,i,n,r,o){return this.generateTopUV(t,e,i,n,r,o)},generateSideWallUV:function(t,e,i,n,r,o,a,s){var l=t.vertices[r].x,h=t.vertices[r].y,c=t.vertices[r].z,u=t.vertices[o].x,d=t.vertices[o].y,f=t.vertices[o].z,p=t.vertices[a].x,m=t.vertices[a].y,g=t.vertices[a].z,v=t.vertices[s].x,y=t.vertices[s].y,E=t.vertices[s].z;return Math.abs(h-d)<.01?[new THREE.Vector2(l,1-c),new THREE.Vector2(u,1-f),new THREE.Vector2(p,1-g),new THREE.Vector2(v,1-E)]:[new THREE.Vector2(h,1-c),new THREE.Vector2(d,1-f),new THREE.Vector2(m,1-g),new THREE.Vector2(y,1-E)]}},THREE.ExtrudeGeometry.__v1=new THREE.Vector2,THREE.ExtrudeGeometry.__v2=new THREE.Vector2,THREE.ExtrudeGeometry.__v3=new THREE.Vector2,THREE.ExtrudeGeometry.__v4=new THREE.Vector2,THREE.ExtrudeGeometry.__v5=new THREE.Vector2,THREE.ExtrudeGeometry.__v6=new THREE.Vector2,THREE.ShapeGeometry=function(t,e){THREE.Geometry.call(this),t instanceof Array==0&&(t=[t]),this.shapebb=t[t.length-1].getBoundingBox(),this.addShapeList(t,e),this.computeCentroids(),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.addShapeList=function(t,e){for(var i=0,n=t.length;n>i;i++)this.addShape(t[i],e);return this},THREE.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var i,n,r,o=void 0!==e.curveSegments?e.curveSegments:12,a=e.material,s=void 0===e.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,l=(this.shapebb,this.vertices.length),h=t.extractPoints(o),c=h.shape,u=h.holes,d=!THREE.Shape.Utils.isClockWise(c);if(d){for(c=c.reverse(),i=0,n=u.length;n>i;i++)r=u[i],THREE.Shape.Utils.isClockWise(r)&&(u[i]=r.reverse());d=!1}var f=THREE.Shape.Utils.triangulateShape(c,u),p=c;for(i=0,n=u.length;n>i;i++)r=u[i],c=c.concat(r);{var m,g,v=c.length,y=f.length;p.length}for(i=0;v>i;i++)m=c[i],this.vertices.push(new THREE.Vector3(m.x,m.y,0));for(i=0;y>i;i++){g=f[i];var E=g[0]+l,x=g[1]+l,T=g[2]+l;this.faces.push(new THREE.Face3(E,x,T,null,null,a)),this.faceVertexUvs[0].push(s.generateBottomUV(this,t,e,E,x,T))}},THREE.LatheGeometry=function(t,e,i,n){THREE.Geometry.call(this),e=e||12,i=i||0,n=n||2*Math.PI;for(var r=1/(t.length-1),o=1/e,a=0,s=e;s>=a;a++)for(var l=i+a*o*n,h=Math.cos(l),c=Math.sin(l),u=0,d=t.length;d>u;u++){var f=t[u],p=new THREE.Vector3;p.x=h*f.x-c*f.y,p.y=c*f.x+h*f.y,p.z=f.z,this.vertices.push(p)}for(var m=t.length,a=0,s=e;s>a;a++)for(var u=0,d=t.length-1;d>u;u++){var g=u+m*a,v=g,y=g+m,h=g+1+m,E=g+1,x=a*o,T=u*r,_=x+o,b=T+r;this.faces.push(new THREE.Face3(v,y,E)),this.faceVertexUvs[0].push([new THREE.Vector2(x,T),new THREE.Vector2(_,T),new THREE.Vector2(x,b)]),this.faces.push(new THREE.Face3(y,h,E)),this.faceVertexUvs[0].push([new THREE.Vector2(_,T),new THREE.Vector2(_,b),new THREE.Vector2(x,b)])}this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry=function(t,e,i,n){THREE.Geometry.call(this),this.width=t,this.height=e,this.widthSegments=i||1,this.heightSegments=n||1;var r,o,a=t/2,s=e/2,l=this.widthSegments,h=this.heightSegments,c=l+1,u=h+1,d=this.width/l,f=this.height/h,p=new THREE.Vector3(0,0,1);for(o=0;u>o;o++)for(r=0;c>r;r++){var m=r*d-a,g=o*f-s;this.vertices.push(new THREE.Vector3(m,-g,0))}for(o=0;h>o;o++)for(r=0;l>r;r++){var v=r+c*o,y=r+c*(o+1),E=r+1+c*(o+1),x=r+1+c*o,T=new THREE.Vector2(r/l,1-o/h),_=new THREE.Vector2(r/l,1-(o+1)/h),b=new THREE.Vector2((r+1)/l,1-(o+1)/h),w=new THREE.Vector2((r+1)/l,1-o/h),R=new THREE.Face3(v,y,x);R.normal.copy(p),R.vertexNormals.push(p.clone(),p.clone(),p.clone()),this.faces.push(R),this.faceVertexUvs[0].push([T,_,w]),R=new THREE.Face3(y,E,x),R.normal.copy(p),R.vertexNormals.push(p.clone(),p.clone(),p.clone()),this.faces.push(R),this.faceVertexUvs[0].push([_.clone(),b,w.clone()])}this.computeCentroids()},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry=function(t,e,i,n,r,o){THREE.Geometry.call(this),t=t||0,e=e||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8,n=void 0!==n?Math.max(3,n):8;var a,s,l=[],h=t,c=(e-t)/n;for(a=0;n>=a;a++){for(s=0;i>=s;s++){var u=new THREE.Vector3,d=r+s/i*o;u.x=h*Math.cos(d),u.y=h*Math.sin(d),this.vertices.push(u),l.push(new THREE.Vector2((u.x/h+1)/2,-(u.y/h+1)/2+1))}h+=c}var f=new THREE.Vector3(0,0,1);for(a=0;n>a;a++){var p=a*i;for(s=0;i>=s;s++){var d=s+p,m=d+a,g=d+i+a,v=d+i+1+a;this.faces.push(new THREE.Face3(m,g,v,[f,f,f])),this.faceVertexUvs[0].push([l[m],l[g],l[v]]),m=d+a,g=d+i+1+a,v=d+1+a,this.faces.push(new THREE.Face3(m,g,v,[f,f,f])),this.faceVertexUvs[0].push([l[m],l[g],l[v]])}}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,h)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry=function(t,e,i,n,r,o,a){THREE.Geometry.call(this),this.radius=t=t||50,this.widthSegments=e=Math.max(3,Math.floor(e)||8),this.heightSegments=i=Math.max(2,Math.floor(i)||6),this.phiStart=n=void 0!==n?n:0,this.phiLength=r=void 0!==r?r:2*Math.PI,this.thetaStart=o=void 0!==o?o:0,this.thetaLength=a=void 0!==a?a:Math.PI;var s,l,h=[],c=[];for(l=0;i>=l;l++){var u=[],d=[];for(s=0;e>=s;s++){var f=s/e,p=l/i,m=new THREE.Vector3;m.x=-t*Math.cos(n+f*r)*Math.sin(o+p*a),m.y=t*Math.cos(o+p*a),m.z=t*Math.sin(n+f*r)*Math.sin(o+p*a),this.vertices.push(m),u.push(this.vertices.length-1),d.push(new THREE.Vector2(f,1-p))}h.push(u),c.push(d)}for(l=0;l<this.heightSegments;l++)for(s=0;s<this.widthSegments;s++){var g=h[l][s+1],v=h[l][s],y=h[l+1][s],E=h[l+1][s+1],x=this.vertices[g].clone().normalize(),T=this.vertices[v].clone().normalize(),_=this.vertices[y].clone().normalize(),b=this.vertices[E].clone().normalize(),w=c[l][s+1].clone(),R=c[l][s].clone(),S=c[l+1][s].clone(),M=c[l+1][s+1].clone();Math.abs(this.vertices[g].y)===this.radius?(this.faces.push(new THREE.Face3(g,y,E,[x,_,b])),this.faceVertexUvs[0].push([w,S,M])):Math.abs(this.vertices[y].y)===this.radius?(this.faces.push(new THREE.Face3(g,v,y,[x,T,_])),this.faceVertexUvs[0].push([w,R,S])):(this.faces.push(new THREE.Face3(g,v,E,[x,T,b])),this.faceVertexUvs[0].push([w,R,M]),this.faces.push(new THREE.Face3(v,y,E,[T,_,b])),this.faceVertexUvs[0].push([R.clone(),S,M.clone()]))}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,t)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TextGeometry=function(t,e){e=e||{};var i=THREE.FontUtils.generateShapes(t,e);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,i,e)},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TorusGeometry=function(t,e,i,n,r){THREE.Geometry.call(this);this.radius=t||100,this.tube=e||40,this.radialSegments=i||8,this.tubularSegments=n||6,this.arc=r||2*Math.PI;for(var o=new THREE.Vector3,a=[],s=[],l=0;l<=this.radialSegments;l++)for(var h=0;h<=this.tubularSegments;h++){var c=h/this.tubularSegments*this.arc,u=l/this.radialSegments*Math.PI*2;o.x=this.radius*Math.cos(c),o.y=this.radius*Math.sin(c);
var d=new THREE.Vector3;d.x=(this.radius+this.tube*Math.cos(u))*Math.cos(c),d.y=(this.radius+this.tube*Math.cos(u))*Math.sin(c),d.z=this.tube*Math.sin(u),this.vertices.push(d),a.push(new THREE.Vector2(h/this.tubularSegments,l/this.radialSegments)),s.push(d.clone().sub(o).normalize())}for(var l=1;l<=this.radialSegments;l++)for(var h=1;h<=this.tubularSegments;h++){var f=(this.tubularSegments+1)*l+h-1,p=(this.tubularSegments+1)*(l-1)+h-1,m=(this.tubularSegments+1)*(l-1)+h,g=(this.tubularSegments+1)*l+h,v=new THREE.Face3(f,p,g,[s[f],s[p],s[g]]);v.normal.add(s[f]),v.normal.add(s[p]),v.normal.add(s[g]),v.normal.normalize(),this.faces.push(v),this.faceVertexUvs[0].push([a[f].clone(),a[p].clone(),a[g].clone()]),v=new THREE.Face3(p,m,g,[s[p],s[m],s[g]]),v.normal.add(s[p]),v.normal.add(s[m]),v.normal.add(s[g]),v.normal.normalize(),this.faces.push(v),this.faceVertexUvs[0].push([a[p].clone(),a[m].clone(),a[g].clone()])}this.computeCentroids()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry=function(t,e,i,n,r,o,a){function s(t,e,i,n,r){var o=Math.cos(t),a=Math.sin(t),s=e/i*t,l=Math.cos(s),h=n*(2+l)*.5*o,c=n*(2+l)*a*.5,u=r*n*Math.sin(s)*.5;return new THREE.Vector3(h,c,u)}THREE.Geometry.call(this);var l=this;this.radius=t||100,this.tube=e||40,this.radialSegments=i||64,this.tubularSegments=n||8,this.p=r||2,this.q=o||3,this.heightScale=a||1,this.grid=new Array(this.radialSegments);for(var h=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3,d=0;d<this.radialSegments;++d){this.grid[d]=new Array(this.tubularSegments);var f=d/this.radialSegments*2*this.p*Math.PI,p=s(f,this.q,this.p,this.radius,this.heightScale),m=s(f+.01,this.q,this.p,this.radius,this.heightScale);h.subVectors(m,p),c.addVectors(m,p),u.crossVectors(h,c),c.crossVectors(u,h),u.normalize(),c.normalize();for(var g=0;g<this.tubularSegments;++g){var v=g/this.tubularSegments*2*Math.PI,y=-this.tube*Math.cos(v),E=this.tube*Math.sin(v),x=new THREE.Vector3;x.x=p.x+y*c.x+E*u.x,x.y=p.y+y*c.y+E*u.y,x.z=p.z+y*c.z+E*u.z,this.grid[d][g]=l.vertices.push(x)-1}}for(var d=0;d<this.radialSegments;++d)for(var g=0;g<this.tubularSegments;++g){var T=(d+1)%this.radialSegments,_=(g+1)%this.tubularSegments,b=this.grid[d][g],w=this.grid[T][g],R=this.grid[T][_],S=this.grid[d][_],M=new THREE.Vector2(d/this.radialSegments,g/this.tubularSegments),H=new THREE.Vector2((d+1)/this.radialSegments,g/this.tubularSegments),C=new THREE.Vector2((d+1)/this.radialSegments,(g+1)/this.tubularSegments),A=new THREE.Vector2(d/this.radialSegments,(g+1)/this.tubularSegments);this.faces.push(new THREE.Face3(b,w,S)),this.faceVertexUvs[0].push([M,H,A]),this.faces.push(new THREE.Face3(w,R,S)),this.faceVertexUvs[0].push([H.clone(),C,A.clone()])}this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry=function(t,e,i,n,r){function o(t,e,i){return S.vertices.push(new THREE.Vector3(t,e,i))-1}THREE.Geometry.call(this),this.path=t,this.segments=e||64,this.radius=i||1,this.radialSegments=n||8,this.closed=r||!1,this.grid=[];var a,s,l,h,c,u,d,f,p,m,g,v,y,E,x,T,_,b,w,R,S=this,M=this.segments+1,H=new THREE.Vector3,C=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed),A=C.tangents,P=C.normals,L=C.binormals;for(this.tangents=A,this.normals=P,this.binormals=L,p=0;M>p;p++)for(this.grid[p]=[],h=p/(M-1),f=t.getPointAt(h),a=A[p],s=P[p],l=L[p],m=0;m<this.radialSegments;m++)c=m/this.radialSegments*2*Math.PI,u=-this.radius*Math.cos(c),d=this.radius*Math.sin(c),H.copy(f),H.x+=u*s.x+d*l.x,H.y+=u*s.y+d*l.y,H.z+=u*s.z+d*l.z,this.grid[p][m]=o(H.x,H.y,H.z);for(p=0;p<this.segments;p++)for(m=0;m<this.radialSegments;m++)g=this.closed?(p+1)%this.segments:p+1,v=(m+1)%this.radialSegments,y=this.grid[p][m],E=this.grid[g][m],x=this.grid[g][v],T=this.grid[p][v],_=new THREE.Vector2(p/this.segments,m/this.radialSegments),b=new THREE.Vector2((p+1)/this.segments,m/this.radialSegments),w=new THREE.Vector2((p+1)/this.segments,(m+1)/this.radialSegments),R=new THREE.Vector2(p/this.segments,(m+1)/this.radialSegments),this.faces.push(new THREE.Face3(y,E,T)),this.faceVertexUvs[0].push([_,b,R]),this.faces.push(new THREE.Face3(E,x,T)),this.faceVertexUvs[0].push([b.clone(),w,R.clone()]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.FrenetFrames=function(t,e,i){function n(){f[0]=new THREE.Vector3,p[0]=new THREE.Vector3,o=Number.MAX_VALUE,a=Math.abs(d[0].x),s=Math.abs(d[0].y),l=Math.abs(d[0].z),o>=a&&(o=a,u.set(1,0,0)),o>=s&&(o=s,u.set(0,1,0)),o>=l&&u.set(0,0,1),m.crossVectors(d[0],u).normalize(),f[0].crossVectors(d[0],m),p[0].crossVectors(d[0],f[0])}var r,o,a,s,l,h,c,u=(new THREE.Vector3,new THREE.Vector3),d=(new THREE.Vector3,[]),f=[],p=[],m=new THREE.Vector3,g=new THREE.Matrix4,v=e+1,y=1e-4;for(this.tangents=d,this.normals=f,this.binormals=p,h=0;v>h;h++)c=h/(v-1),d[h]=t.getTangentAt(c),d[h].normalize();for(n(),h=1;v>h;h++)f[h]=f[h-1].clone(),p[h]=p[h-1].clone(),m.crossVectors(d[h-1],d[h]),m.length()>y&&(m.normalize(),r=Math.acos(THREE.Math.clamp(d[h-1].dot(d[h]),-1,1)),f[h].applyMatrix4(g.makeRotationAxis(m,r))),p[h].crossVectors(d[h],f[h]);if(i)for(r=Math.acos(THREE.Math.clamp(f[0].dot(f[v-1]),-1,1)),r/=v-1,d[0].dot(m.crossVectors(f[0],f[v-1]))>0&&(r=-r),h=1;v>h;h++)f[h].applyMatrix4(g.makeRotationAxis(d[h],r*h)),p[h].crossVectors(d[h],f[h])},THREE.PolyhedronGeometry=function(t,e,i,n){function r(t){var e=t.normalize().clone();e.index=c.vertices.push(e)-1;var i=s(t)/2/Math.PI+.5,n=l(t)/Math.PI+.5;return e.uv=new THREE.Vector2(i,1-n),e}function o(t,e,i){var n=new THREE.Face3(t.index,e.index,i.index,[t.clone(),e.clone(),i.clone()]);n.centroid.add(t).add(e).add(i).divideScalar(3),c.faces.push(n);var r=s(n.centroid);c.faceVertexUvs[0].push([h(t.uv,t,r),h(e.uv,e,r),h(i.uv,i,r)])}function a(t,e){for(var i=Math.pow(2,e),n=(Math.pow(4,e),r(c.vertices[t.a])),a=r(c.vertices[t.b]),s=r(c.vertices[t.c]),l=[],h=0;i>=h;h++){l[h]=[];for(var u=r(n.clone().lerp(s,h/i)),d=r(a.clone().lerp(s,h/i)),f=i-h,p=0;f>=p;p++)l[h][p]=0==p&&h==i?u:r(u.clone().lerp(d,p/f))}for(var h=0;i>h;h++)for(var p=0;2*(i-h)-1>p;p++){var m=Math.floor(p/2);p%2==0?o(l[h][m+1],l[h+1][m],l[h][m]):o(l[h][m+1],l[h+1][m+1],l[h+1][m])}}function s(t){return Math.atan2(t.z,-t.x)}function l(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}function h(t,e,i){return 0>i&&1===t.x&&(t=new THREE.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new THREE.Vector2(i/2/Math.PI+.5,t.y)),t.clone()}THREE.Geometry.call(this),i=i||1,n=n||0;for(var c=this,u=0,d=t.length;d>u;u++)r(new THREE.Vector3(t[u][0],t[u][1],t[u][2]));for(var f=this.vertices,p=[],u=0,d=e.length;d>u;u++){var m=f[e[u][0]],g=f[e[u][1]],v=f[e[u][2]];p[u]=new THREE.Face3(m.index,g.index,v.index,[m.clone(),g.clone(),v.clone()])}for(var u=0,d=p.length;d>u;u++)a(p[u],n);for(var u=0,d=this.faceVertexUvs[0].length;d>u;u++){var y=this.faceVertexUvs[0][u],E=y[0].x,x=y[1].x,T=y[2].x,_=Math.max(E,Math.max(x,T)),b=Math.min(E,Math.min(x,T));_>.9&&.1>b&&(.2>E&&(y[0].x+=1),.2>x&&(y[1].x+=1),.2>T&&(y[2].x+=1))}for(var u=0,d=this.vertices.length;d>u;u++)this.vertices[u].multiplyScalar(i);this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,i)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry=function(t,e){this.radius=t,this.detail=e;var i=(1+Math.sqrt(5))/2,n=[[-1,i,0],[1,i,0],[-1,-i,0],[1,-i,0],[0,-1,i],[0,1,i],[0,-1,-i],[0,1,-i],[i,0,-1],[i,0,1],[-i,0,-1],[-i,0,1]],r=[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]];THREE.PolyhedronGeometry.call(this,n,r,t,e)},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry=function(t,e){var i=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],n=[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]];THREE.PolyhedronGeometry.call(this,i,n,t,e)},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry=function(t,e){var i=[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],n=[[2,1,0],[0,3,2],[1,3,0],[2,3,1]];THREE.PolyhedronGeometry.call(this,i,n,t,e)},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry=function(t,e,i){THREE.Geometry.call(this);var n,r,o,a,s,l=this.vertices,h=this.faces,c=this.faceVertexUvs[0],u=e+1;for(n=0;i>=n;n++)for(s=n/i,r=0;e>=r;r++)a=r/e,o=t(a,s),l.push(o);var d,f,p,m,g,v,y,E;for(n=0;i>n;n++)for(r=0;e>r;r++)d=n*u+r,f=n*u+r+1,p=(n+1)*u+r+1,m=(n+1)*u+r,g=new THREE.Vector2(r/e,n/i),v=new THREE.Vector2((r+1)/e,n/i),y=new THREE.Vector2((r+1)/e,(n+1)/i),E=new THREE.Vector2(r/e,(n+1)/i),h.push(new THREE.Face3(d,f,m)),c.push([g,v,E]),h.push(new THREE.Face3(f,p,m)),c.push([v.clone(),y,E.clone()]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.AxisHelper=function(t){t=t||1;var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3,new THREE.Vector3(t,0,0),new THREE.Vector3,new THREE.Vector3(0,t,0),new THREE.Vector3,new THREE.Vector3(0,0,t)),e.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));var i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,e,i,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),THREE.ArrowHelper=function(t,e,i,n){THREE.Object3D.call(this),void 0===n&&(n=16776960),void 0===i&&(i=1),this.position=e;var r=new THREE.Geometry;r.vertices.push(new THREE.Vector3(0,0,0)),r.vertices.push(new THREE.Vector3(0,1,0)),this.line=new THREE.Line(r,new THREE.LineBasicMaterial({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line);var o=new THREE.CylinderGeometry(0,.05,.25,5,1);o.applyMatrix((new THREE.Matrix4).makeTranslation(0,.875,0)),this.cone=new THREE.Mesh(o,new THREE.MeshBasicMaterial({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i)},THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.setDirection=function(){var t,e=new THREE.Vector3;return function(i){i.y>.99999?this.quaternion.set(0,0,0,1):i.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),THREE.ArrowHelper.prototype.setLength=function(t){this.scale.set(t,t,t)},THREE.ArrowHelper.prototype.setColor=function(t){this.line.material.color.setHex(t),this.cone.material.color.setHex(t)},THREE.BoxHelper=function(t){var e=[new THREE.Vector3(1,1,1),new THREE.Vector3(-1,1,1),new THREE.Vector3(-1,-1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,-1,-1)];this.vertices=e;var i=new THREE.Geometry;i.vertices.push(e[0],e[1],e[1],e[2],e[2],e[3],e[3],e[0],e[4],e[5],e[5],e[6],e[6],e[7],e[7],e[4],e[0],e[4],e[1],e[5],e[2],e[6],e[3],e[7]),THREE.Line.call(this,i,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces),void 0!==t&&this.update(t)},THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype),THREE.BoxHelper.prototype.update=function(t){var e=t.geometry;null===e.boundingBox&&e.computeBoundingBox();var i=e.boundingBox.min,n=e.boundingBox.max,r=this.vertices;r[0].set(n.x,n.y,n.z),r[1].set(i.x,n.y,n.z),r[2].set(i.x,i.y,n.z),r[3].set(n.x,i.y,n.z),r[4].set(n.x,n.y,i.z),r[5].set(i.x,n.y,i.z),r[6].set(i.x,i.y,i.z),r[7].set(n.x,i.y,i.z),this.geometry.computeBoundingSphere(),this.geometry.verticesNeedUpdate=!0,this.matrixAutoUpdate=!1,this.matrixWorld=t.matrixWorld},THREE.BoundingBoxHelper=function(t,e){var i=e||8947848;this.object=t,this.box=new THREE.Box3,THREE.Mesh.call(this,new THREE.CubeGeometry(1,1,1),new THREE.MeshBasicMaterial({color:i,wireframe:!0}))},THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},THREE.CameraHelper=function(t){function e(t,e,n){i(t,n),i(e,n)}function i(t,e){n.vertices.push(new THREE.Vector3),n.colors.push(new THREE.Color(e)),void 0===o[t]&&(o[t]=[]),o[t].push(n.vertices.length-1)}var n=new THREE.Geometry,r=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),o={},a=16755200,s=16711680,l=43775,h=16777215,c=3355443;e("n1","n2",a),e("n2","n4",a),e("n4","n3",a),e("n3","n1",a),e("f1","f2",a),e("f2","f4",a),e("f4","f3",a),e("f3","f1",a),e("n1","f1",a),e("n2","f2",a),e("n3","f3",a),e("n4","f4",a),e("p","n1",s),e("p","n2",s),e("p","n3",s),e("p","n4",s),e("u1","u2",l),e("u2","u3",l),e("u3","u1",l),e("c","t",h),e("p","c",c),e("cn1","cn2",c),e("cn3","cn4",c),e("cf1","cf2",c),e("cf3","cf4",c),THREE.Line.call(this,n,r,THREE.LinePieces),this.camera=t,this.matrixWorld=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype),THREE.CameraHelper.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Camera,i=new THREE.Projector;return function(){function n(n,o,a,s){t.set(o,a,s),i.unprojectVector(t,e);var l=r.pointMap[n];if(void 0!==l)for(var h=0,c=l.length;c>h;h++)r.geometry.vertices[l[h]].copy(t)}var r=this,o=1,a=1;e.projectionMatrix.copy(this.camera.projectionMatrix),n("c",0,0,-1),n("t",0,0,1),n("n1",-o,-a,-1),n("n2",o,-a,-1),n("n3",-o,a,-1),n("n4",o,a,-1),n("f1",-o,-a,1),n("f2",o,-a,1),n("f3",-o,a,1),n("f4",o,a,1),n("u1",.7*o,1.1*a,-1),n("u2",.7*-o,1.1*a,-1),n("u3",0,2*a,-1),n("cf1",-o,0,1),n("cf2",o,0,1),n("cf3",0,-a,1),n("cf4",0,a,1),n("cn1",-o,0,-1),n("cn2",o,0,-1),n("cn3",0,-a,-1),n("cn4",0,a,-1),this.geometry.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(t,e){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrixWorld=t.matrixWorld,this.matrixAutoUpdate=!1;var i=new THREE.PlaneGeometry(e,e),n=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new THREE.Mesh(i,n),this.add(this.lightPlane),i=new THREE.Geometry,i.vertices.push(new THREE.Vector3),i.vertices.push(new THREE.Vector3),i.computeLineDistances(),n=new THREE.LineBasicMaterial({fog:!1}),n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(i,n),this.add(this.targetLine),this.update()},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.update=function(){var t=new THREE.Vector3;return function(){t.getPositionFromMatrix(this.light.matrixWorld).negate(),this.lightPlane.lookAt(t),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(t),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),THREE.FaceNormalsHelper=function(t,e,i,n){this.object=t,this.size=e||1;for(var r=i||16776960,o=n||1,a=new THREE.Geometry,s=this.object.geometry.faces,l=0,h=s.length;h>l;l++)a.vertices.push(new THREE.Vector3),a.vertices.push(new THREE.Vector3);THREE.Line.call(this,a,new THREE.LineBasicMaterial({color:r,linewidth:o}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.FaceNormalsHelper.prototype.update=function(){var t=new THREE.Vector3;return function(){this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var e=this.geometry.vertices,i=this.object.geometry.faces,n=this.object.matrixWorld,r=0,o=i.length;o>r;r++){var a=i[r];t.copy(a.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);var s=2*r;e[s].copy(a.centroid).applyMatrix4(n),e[s+1].addVectors(e[s],t)}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.GridHelper=function(t,e){var i=new THREE.Geometry,n=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924),this.color2=new THREE.Color(8947848);for(var r=-t;t>=r;r+=e){i.vertices.push(new THREE.Vector3(-t,0,r),new THREE.Vector3(t,0,r),new THREE.Vector3(r,0,-t),new THREE.Vector3(r,0,t));var o=0===r?this.color1:this.color2;i.colors.push(o,o,o,o)}THREE.Line.call(this,i,n,THREE.LinePieces)},THREE.GridHelper.prototype=Object.create(THREE.Line.prototype),THREE.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0},THREE.HemisphereLightHelper=function(t,e){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrixWorld=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new THREE.Color,new THREE.Color];var i=new THREE.SphereGeometry(e,4,2);i.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var n=0,r=8;r>n;n++)i.faces[n].color=this.colors[4>n?0:1];var o=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(i,o),this.add(this.lightSphere),this.update()},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.update=function(){var t=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.getPositionFromMatrix(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),THREE.PointLightHelper=function(t,e){this.light=t,this.light.updateMatrixWorld();var i=new THREE.SphereGeometry(e,4,2),n=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),THREE.Mesh.call(this,i,n),this.matrixWorld=this.light.matrixWorld,this.matrixAutoUpdate=!1},THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SpotLightHelper=function(t){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrixWorld=t.matrixWorld,this.matrixAutoUpdate=!1;var e=new THREE.CylinderGeometry(0,1,1,8,1,!0);e.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),e.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var i=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(e,i),this.add(this.cone),this.update()},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(){var i=this.light.distance?this.light.distance:1e4,n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i),t.getPositionFromMatrix(this.light.matrixWorld),e.getPositionFromMatrix(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),THREE.VertexNormalsHelper=function(t,e,i,n){this.object=t,this.size=e||1;for(var r=i||16711680,o=n||1,a=new THREE.Geometry,s=(t.geometry.vertices,t.geometry.faces),l=0,h=s.length;h>l;l++)for(var c=s[l],u=0,d=c.vertexNormals.length;d>u;u++)a.vertices.push(new THREE.Vector3),a.vertices.push(new THREE.Vector3);THREE.Line.call(this,a,new THREE.LineBasicMaterial({color:r,linewidth:o}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexNormalsHelper.prototype.update=function(){var t=new THREE.Vector3;return function(){var e=["a","b","c","d"];this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var i=this.geometry.vertices,n=this.object.geometry.vertices,r=this.object.geometry.faces,o=this.object.matrixWorld,a=0,s=0,l=r.length;l>s;s++)for(var h=r[s],c=0,u=h.vertexNormals.length;u>c;c++){var d=h[e[c]],f=n[d],p=h.vertexNormals[c];i[a].copy(f).applyMatrix4(o),t.copy(p).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),t.add(i[a]),a+=1,i[a].copy(t),a+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.VertexTangentsHelper=function(t,e,i,n){this.object=t,this.size=e||1;for(var r=i||255,o=n||1,a=new THREE.Geometry,s=(t.geometry.vertices,t.geometry.faces),l=0,h=s.length;h>l;l++)for(var c=s[l],u=0,d=c.vertexTangents.length;d>u;u++)a.vertices.push(new THREE.Vector3),a.vertices.push(new THREE.Vector3);THREE.Line.call(this,a,new THREE.LineBasicMaterial({color:r,linewidth:o}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.update()},THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexTangentsHelper.prototype.update=function(){var t=new THREE.Vector3;return function(){var e=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var i=this.geometry.vertices,n=this.object.geometry.vertices,r=this.object.geometry.faces,o=this.object.matrixWorld,a=0,s=0,l=r.length;l>s;s++)for(var h=r[s],c=0,u=h.vertexTangents.length;u>c;c++){var d=h[e[c]],f=n[d],p=h.vertexTangents[c];i[a].copy(f).applyMatrix4(o),t.copy(p).transformDirection(o).multiplyScalar(this.size),t.add(i[a]),a+=1,i[a].copy(t),a+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.WireframeHelper=function(t){for(var e=[0,0],i={},n=function(t,e){return t-e},r=["a","b","c","d"],o=new THREE.Geometry,a=t.geometry.vertices,s=t.geometry.faces,l=0,h=s.length;h>l;l++)for(var c=s[l],u=0;3>u;u++){e[0]=c[r[u]],e[1]=c[r[(u+1)%3]],e.sort(n);var d=e.toString();void 0===i[d]&&(o.vertices.push(a[e[0]]),o.vertices.push(a[e[1]]),i[d]=!0)}THREE.Line.call(this,o,new THREE.LineBasicMaterial({color:16777215}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.matrixWorld=t.matrixWorld},THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype),THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare=function(t,e,i,n,r){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,i,n,r)},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.add=function(t,e,i,n,r,o){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===o&&(o=1),void 0===r&&(r=new THREE.Color(16777215)),void 0===n&&(n=THREE.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:r,blending:n})},THREE.LensFlare.prototype.updateLensFlares=function(){var t,e,i=this.lensFlares.length,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;i>t;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+n*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},THREE.MorphBlendMesh=function(t,e){THREE.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n="__default",r=0,o=i-1,a=i/1;this.createAnimation(n,r,o,a),this.setAnimationWeight(n,1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.createAnimation=function(t,e,i,n){var r={startFrame:e,endFrame:i,length:i-e+1,fps:n,duration:(i-e)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=r,this.animationsList.push(r)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,i=/([a-z]+)(\d+)/,n={},r=this.geometry,o=0,a=r.morphTargets.length;a>o;o++){var s=r.morphTargets[o],l=s.name.match(i);if(l&&l.length>1){{var h=l[1];l[2]}n[h]||(n[h]={start:1/0,end:-1/0});var c=n[h];o<c.start&&(c.start=o),o>c.end&&(c.end=o),e||(e=h)}}for(var h in n){var c=n[h];this.createAnimation(h,c.start,c.end,t)}this.firstAnimation=e},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var i=this.animationsMap[t];i&&(i.fps=e,i.duration=(i.end-i.start)/i.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var i=this.animationsMap[t];i&&(i.duration=e,i.fps=(i.end-i.start)/i.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var i=this.animationsMap[t];i&&(i.weight=e)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var i=this.animationsMap[t];i&&(i.time=e)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0,i=this.animationsMap[t];return i&&(e=i.time),e},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1,i=this.animationsMap[t];return i&&(e=i.duration),e},THREE.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):0},THREE.MorphBlendMesh.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},THREE.MorphBlendMesh.prototype.update=function(t){for(var e=0,i=this.animationsList.length;i>e;e++){var n=this.animationsList[e];if(n.active){var r=n.duration/n.length;n.time+=n.direction*t,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var o=n.startFrame+THREE.Math.clamp(Math.floor(n.time/r),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);var s=n.time%r/r;n.directionBackwards&&(s=1-s),this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a}}},THREE.LensFlarePlugin=function(){function t(t,i){var n=e.createProgram(),r=e.createShader(e.FRAGMENT_SHADER),o=e.createShader(e.VERTEX_SHADER),a="precision "+i+" float;\n";return e.shaderSource(r,a+t.fragmentShader),e.shaderSource(o,a+t.vertexShader),e.compileShader(r),e.compileShader(o),e.attachShader(n,r),e.attachShader(n,o),e.linkProgram(n),n}var e,i,n,r={};this.init=function(o){e=o.context,i=o,n=o.getPrecision(),r.vertices=new Float32Array(16),r.faces=new Uint16Array(6);var a=0;r.vertices[a++]=-1,r.vertices[a++]=-1,r.vertices[a++]=0,r.vertices[a++]=0,r.vertices[a++]=1,r.vertices[a++]=-1,r.vertices[a++]=1,r.vertices[a++]=0,r.vertices[a++]=1,r.vertices[a++]=1,r.vertices[a++]=1,r.vertices[a++]=1,r.vertices[a++]=-1,r.vertices[a++]=1,r.vertices[a++]=0,r.vertices[a++]=1,a=0,r.faces[a++]=0,r.faces[a++]=1,r.faces[a++]=2,r.faces[a++]=0,r.faces[a++]=2,r.faces[a++]=3,r.vertexBuffer=e.createBuffer(),r.elementBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,r.vertices,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.elementBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r.faces,e.STATIC_DRAW),r.tempTexture=e.createTexture(),r.occlusionTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,r.tempTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGB,16,16,0,e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.bindTexture(e.TEXTURE_2D,r.occlusionTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,16,16,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<=0?(r.hasVertexTexture=!1,r.program=t(THREE.ShaderFlares.lensFlare,n)):(r.hasVertexTexture=!0,r.program=t(THREE.ShaderFlares.lensFlareVertexTexture,n)),r.attributes={},r.uniforms={},r.attributes.vertex=e.getAttribLocation(r.program,"position"),r.attributes.uv=e.getAttribLocation(r.program,"uv"),r.uniforms.renderType=e.getUniformLocation(r.program,"renderType"),r.uniforms.map=e.getUniformLocation(r.program,"map"),r.uniforms.occlusionMap=e.getUniformLocation(r.program,"occlusionMap"),r.uniforms.opacity=e.getUniformLocation(r.program,"opacity"),r.uniforms.color=e.getUniformLocation(r.program,"color"),r.uniforms.scale=e.getUniformLocation(r.program,"scale"),r.uniforms.rotation=e.getUniformLocation(r.program,"rotation"),r.uniforms.screenPosition=e.getUniformLocation(r.program,"screenPosition")},this.render=function(t,n,o,a){var s=t.__webglFlares,l=s.length;if(l){var h=new THREE.Vector3,c=a/o,u=.5*o,d=.5*a,f=16/a,p=new THREE.Vector2(f*c,f),m=new THREE.Vector3(1,1,0),g=new THREE.Vector2(1,1),v=r.uniforms,y=r.attributes;e.useProgram(r.program),e.enableVertexAttribArray(r.attributes.vertex),e.enableVertexAttribArray(r.attributes.uv),e.uniform1i(v.occlusionMap,0),e.uniform1i(v.map,1),e.bindBuffer(e.ARRAY_BUFFER,r.vertexBuffer),e.vertexAttribPointer(y.vertex,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(y.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.elementBuffer),e.disable(e.CULL_FACE),e.depthMask(!1);var E,x,T,_,b;for(E=0;l>E;E++)if(f=16/a,p.set(f*c,f),_=s[E],h.set(_.matrixWorld.elements[12],_.matrixWorld.elements[13],_.matrixWorld.elements[14]),h.applyMatrix4(n.matrixWorldInverse),h.applyProjection(n.projectionMatrix),m.copy(h),g.x=m.x*u+u,g.y=m.y*d+d,r.hasVertexTexture||g.x>0&&g.x<o&&g.y>0&&g.y<a)for(e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r.tempTexture),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGB,g.x-8,g.y-8,16,16,0),e.uniform1i(v.renderType,0),e.uniform2f(v.scale,p.x,p.y),e.uniform3f(v.screenPosition,m.x,m.y,m.z),e.disable(e.BLEND),e.enable(e.DEPTH_TEST),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,r.occlusionTexture),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,g.x-8,g.y-8,16,16,0),e.uniform1i(v.renderType,1),e.disable(e.DEPTH_TEST),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r.tempTexture),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),_.positionScreen.copy(m),_.customUpdateCallback?_.customUpdateCallback(_):_.updateLensFlares(),e.uniform1i(v.renderType,2),e.enable(e.BLEND),x=0,T=_.lensFlares.length;T>x;x++)b=_.lensFlares[x],b.opacity>.001&&b.scale>.001&&(m.x=b.x,m.y=b.y,m.z=b.z,f=b.size*b.scale/a,p.x=f*c,p.y=f,e.uniform3f(v.screenPosition,m.x,m.y,m.z),e.uniform2f(v.scale,p.x,p.y),e.uniform1f(v.rotation,b.rotation),e.uniform1f(v.opacity,b.opacity),e.uniform3f(v.color,b.color.r,b.color.g,b.color.b),i.setBlending(b.blending,b.blendEquation,b.blendSrc,b.blendDst),i.setTexture(b.texture,1),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0));e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthMask(!0)}}},THREE.ShadowMapPlugin=function(){function t(t,e){var i=new THREE.DirectionalLight;i.isVirtual=!0,i.onlyShadow=!0,i.castShadow=!0,i.shadowCameraNear=t.shadowCameraNear,i.shadowCameraFar=t.shadowCameraFar,i.shadowCameraLeft=t.shadowCameraLeft,i.shadowCameraRight=t.shadowCameraRight,i.shadowCameraBottom=t.shadowCameraBottom,i.shadowCameraTop=t.shadowCameraTop,i.shadowCameraVisible=t.shadowCameraVisible,i.shadowDarkness=t.shadowDarkness,i.shadowBias=t.shadowCascadeBias[e],i.shadowMapWidth=t.shadowCascadeWidth[e],i.shadowMapHeight=t.shadowCascadeHeight[e],i.pointsWorld=[],i.pointsFrustum=[];
for(var n=i.pointsWorld,r=i.pointsFrustum,o=0;8>o;o++)n[o]=new THREE.Vector3,r[o]=new THREE.Vector3;var a=t.shadowCascadeNearZ[e],s=t.shadowCascadeFarZ[e];return r[0].set(-1,-1,a),r[1].set(1,-1,a),r[2].set(-1,1,a),r[3].set(1,1,a),r[4].set(-1,-1,s),r[5].set(1,-1,s),r[6].set(-1,1,s),r[7].set(1,1,s),i}function e(t,e){var i=t.shadowCascadeArray[e];i.position.copy(t.position),i.target.position.copy(t.target.position),i.lookAt(i.target),i.shadowCameraVisible=t.shadowCameraVisible,i.shadowDarkness=t.shadowDarkness,i.shadowBias=t.shadowCascadeBias[e];var n=t.shadowCascadeNearZ[e],r=t.shadowCascadeFarZ[e],o=i.pointsFrustum;o[0].z=n,o[1].z=n,o[2].z=n,o[3].z=n,o[4].z=r,o[5].z=r,o[6].z=r,o[7].z=r}function i(t,e){var i=e.shadowCamera,n=e.pointsFrustum,r=e.pointsWorld;d.set(1/0,1/0,1/0),f.set(-1/0,-1/0,-1/0);for(var o=0;8>o;o++){var a=r[o];a.copy(n[o]),THREE.ShadowMapPlugin.__projector.unprojectVector(a,t),a.applyMatrix4(i.matrixWorldInverse),a.x<d.x&&(d.x=a.x),a.x>f.x&&(f.x=a.x),a.y<d.y&&(d.y=a.y),a.y>f.y&&(f.y=a.y),a.z<d.z&&(d.z=a.z),a.z>f.z&&(f.z=a.z)}i.left=d.x,i.right=f.x,i.top=f.y,i.bottom=d.y,i.updateProjectionMatrix()}function n(t){return t.material instanceof THREE.MeshFaceMaterial?t.material.materials[0]:t.material}var r,o,a,s,l,h,c=new THREE.Frustum,u=new THREE.Matrix4,d=new THREE.Vector3,f=new THREE.Vector3,p=new THREE.Vector3;this.init=function(t){r=t.context,o=t;var e=THREE.ShaderLib.depthRGBA,i=THREE.UniformsUtils.clone(e.uniforms);a=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:i}),s=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:i,morphTargets:!0}),l=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:i,skinning:!0}),h=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:i,morphTargets:!0,skinning:!0}),a._shadowPass=!0,s._shadowPass=!0,l._shadowPass=!0,h._shadowPass=!0},this.render=function(t,e){o.shadowMapEnabled&&o.shadowMapAutoUpdate&&this.update(t,e)},this.update=function(d,f){var m,g,v,y,E,x,T,_,b,w,R,S,M,H,C=[],A=0,P=null;for(r.clearColor(1,1,1,1),r.disable(r.BLEND),r.enable(r.CULL_FACE),r.frontFace(r.CCW),r.cullFace(o.shadowMapCullFace===THREE.CullFaceFront?r.FRONT:r.BACK),o.setDepthTest(!0),m=0,g=d.__lights.length;g>m;m++)if(M=d.__lights[m],M.castShadow)if(M instanceof THREE.DirectionalLight&&M.shadowCascade)for(E=0;E<M.shadowCascadeCount;E++){var L;if(M.shadowCascadeArray[E])L=M.shadowCascadeArray[E];else{L=t(M,E),L.originalCamera=f;var O=new THREE.Gyroscope;O.position=M.shadowCascadeOffset,O.add(L),O.add(L.target),f.add(O),M.shadowCascadeArray[E]=L,0}e(M,E),C[A]=L,A++}else C[A]=M,A++;for(m=0,g=C.length;g>m;m++){if(M=C[m],!M.shadowMap){var D=THREE.LinearFilter;o.shadowMapType===THREE.PCFSoftShadowMap&&(D=THREE.NearestFilter);var z={minFilter:D,magFilter:D,format:THREE.RGBAFormat};M.shadowMap=new THREE.WebGLRenderTarget(M.shadowMapWidth,M.shadowMapHeight,z),M.shadowMapSize=new THREE.Vector2(M.shadowMapWidth,M.shadowMapHeight),M.shadowMatrix=new THREE.Matrix4}if(!M.shadowCamera){if(M instanceof THREE.SpotLight)M.shadowCamera=new THREE.PerspectiveCamera(M.shadowCameraFov,M.shadowMapWidth/M.shadowMapHeight,M.shadowCameraNear,M.shadowCameraFar);else{if(!(M instanceof THREE.DirectionalLight))continue;M.shadowCamera=new THREE.OrthographicCamera(M.shadowCameraLeft,M.shadowCameraRight,M.shadowCameraTop,M.shadowCameraBottom,M.shadowCameraNear,M.shadowCameraFar)}d.add(M.shadowCamera),d.autoUpdate===!0&&d.updateMatrixWorld()}for(M.shadowCameraVisible&&!M.cameraHelper&&(M.cameraHelper=new THREE.CameraHelper(M.shadowCamera),M.shadowCamera.add(M.cameraHelper)),M.isVirtual&&L.originalCamera==f&&i(f,M),x=M.shadowMap,T=M.shadowMatrix,_=M.shadowCamera,_.position.getPositionFromMatrix(M.matrixWorld),p.getPositionFromMatrix(M.target.matrixWorld),_.lookAt(p),_.updateMatrixWorld(),_.matrixWorldInverse.getInverse(_.matrixWorld),M.cameraHelper&&(M.cameraHelper.visible=M.shadowCameraVisible),M.shadowCameraVisible&&M.cameraHelper.update(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(_.projectionMatrix),T.multiply(_.matrixWorldInverse),u.multiplyMatrices(_.projectionMatrix,_.matrixWorldInverse),c.setFromMatrix(u),o.setRenderTarget(x),o.clear(),H=d.__webglObjects,v=0,y=H.length;y>v;v++)R=H[v],S=R.object,R.render=!1,S.visible&&S.castShadow&&(!(S instanceof THREE.Mesh||S instanceof THREE.ParticleSystem)||!S.frustumCulled||c.intersectsObject(S))&&(S._modelViewMatrix.multiplyMatrices(_.matrixWorldInverse,S.matrixWorld),R.render=!0);var N,F,U;for(v=0,y=H.length;y>v;v++)R=H[v],R.render&&(S=R.object,b=R.buffer,N=n(S),F=S.geometry.morphTargets.length>0&&N.morphTargets,U=S instanceof THREE.SkinnedMesh&&N.skinning,w=S.customDepthMaterial?S.customDepthMaterial:U?F?h:l:F?s:a,b instanceof THREE.BufferGeometry?o.renderBufferDirect(_,d.__lights,P,w,b,S):o.renderBuffer(_,d.__lights,P,w,b,S));for(H=d.__webglObjectsImmediate,v=0,y=H.length;y>v;v++)R=H[v],S=R.object,S.visible&&S.castShadow&&(S._modelViewMatrix.multiplyMatrices(_.matrixWorldInverse,S.matrixWorld),o.renderImmediateObject(_,d.__lights,P,a,S))}var I=o.getClearColor(),k=o.getClearAlpha();r.clearColor(I.r,I.g,I.b,k),r.enable(r.BLEND),o.shadowMapCullFace===THREE.CullFaceFront&&r.cullFace(r.BACK)}},THREE.ShadowMapPlugin.__projector=new THREE.Projector,THREE.SpritePlugin=function(){function t(t,e){var n=i.createProgram(),r=i.createShader(i.FRAGMENT_SHADER),o=i.createShader(i.VERTEX_SHADER),a="precision "+e+" float;\n";return i.shaderSource(r,a+t.fragmentShader),i.shaderSource(o,a+t.vertexShader),i.compileShader(r),i.compileShader(o),i.attachShader(n,r),i.attachShader(n,o),i.linkProgram(n),n}function e(t,e){return t.z!==e.z?e.z-t.z:e.id-t.id}var i,n,r,o={};this.init=function(e){i=e.context,n=e,r=e.getPrecision(),o.vertices=new Float32Array(16),o.faces=new Uint16Array(6);var a=0;o.vertices[a++]=-1,o.vertices[a++]=-1,o.vertices[a++]=0,o.vertices[a++]=0,o.vertices[a++]=1,o.vertices[a++]=-1,o.vertices[a++]=1,o.vertices[a++]=0,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=-1,o.vertices[a++]=1,o.vertices[a++]=0,o.vertices[a++]=1,a=0,o.faces[a++]=0,o.faces[a++]=1,o.faces[a++]=2,o.faces[a++]=0,o.faces[a++]=2,o.faces[a++]=3,o.vertexBuffer=i.createBuffer(),o.elementBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,o.vertices,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,o.faces,i.STATIC_DRAW),o.program=t(THREE.ShaderSprite.sprite,r),o.attributes={},o.uniforms={},o.attributes.position=i.getAttribLocation(o.program,"position"),o.attributes.uv=i.getAttribLocation(o.program,"uv"),o.uniforms.uvOffset=i.getUniformLocation(o.program,"uvOffset"),o.uniforms.uvScale=i.getUniformLocation(o.program,"uvScale"),o.uniforms.rotation=i.getUniformLocation(o.program,"rotation"),o.uniforms.scale=i.getUniformLocation(o.program,"scale"),o.uniforms.alignment=i.getUniformLocation(o.program,"alignment"),o.uniforms.color=i.getUniformLocation(o.program,"color"),o.uniforms.map=i.getUniformLocation(o.program,"map"),o.uniforms.opacity=i.getUniformLocation(o.program,"opacity"),o.uniforms.useScreenCoordinates=i.getUniformLocation(o.program,"useScreenCoordinates"),o.uniforms.sizeAttenuation=i.getUniformLocation(o.program,"sizeAttenuation"),o.uniforms.screenPosition=i.getUniformLocation(o.program,"screenPosition"),o.uniforms.modelViewMatrix=i.getUniformLocation(o.program,"modelViewMatrix"),o.uniforms.projectionMatrix=i.getUniformLocation(o.program,"projectionMatrix"),o.uniforms.fogType=i.getUniformLocation(o.program,"fogType"),o.uniforms.fogDensity=i.getUniformLocation(o.program,"fogDensity"),o.uniforms.fogNear=i.getUniformLocation(o.program,"fogNear"),o.uniforms.fogFar=i.getUniformLocation(o.program,"fogFar"),o.uniforms.fogColor=i.getUniformLocation(o.program,"fogColor"),o.uniforms.alphaTest=i.getUniformLocation(o.program,"alphaTest")},this.render=function(t,r,a,s){var l=t.__webglSprites,h=l.length;if(h){var c=o.attributes,u=o.uniforms,d=s/a,f=.5*a,p=.5*s;i.useProgram(o.program),i.enableVertexAttribArray(c.position),i.enableVertexAttribArray(c.uv),i.disable(i.CULL_FACE),i.enable(i.BLEND),i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer),i.vertexAttribPointer(c.position,2,i.FLOAT,!1,16,0),i.vertexAttribPointer(c.uv,2,i.FLOAT,!1,16,8),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer),i.uniformMatrix4fv(u.projectionMatrix,!1,r.projectionMatrix.elements),i.activeTexture(i.TEXTURE0),i.uniform1i(u.map,0);var m=0,g=0,v=t.fog;v?(i.uniform3f(u.fogColor,v.color.r,v.color.g,v.color.b),v instanceof THREE.Fog?(i.uniform1f(u.fogNear,v.near),i.uniform1f(u.fogFar,v.far),i.uniform1i(u.fogType,1),m=1,g=1):v instanceof THREE.FogExp2&&(i.uniform1f(u.fogDensity,v.density),i.uniform1i(u.fogType,2),m=2,g=2)):(i.uniform1i(u.fogType,0),m=0,g=0);var y,E,x,T,_,b=[];for(y=0;h>y;y++)E=l[y],x=E.material,E.visible&&0!==x.opacity&&(x.useScreenCoordinates?E.z=-E.position.z:(E._modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,E.matrixWorld),E.z=-E._modelViewMatrix.elements[14]));for(l.sort(e),y=0;h>y;y++)E=l[y],x=E.material,E.visible&&0!==x.opacity&&x.map&&x.map.image&&x.map.image.width&&(i.uniform1f(u.alphaTest,x.alphaTest),x.useScreenCoordinates===!0?(i.uniform1i(u.useScreenCoordinates,1),i.uniform3f(u.screenPosition,(E.position.x*n.devicePixelRatio-f)/f,(p-E.position.y*n.devicePixelRatio)/p,Math.max(0,Math.min(1,E.position.z))),b[0]=n.devicePixelRatio,b[1]=n.devicePixelRatio):(i.uniform1i(u.useScreenCoordinates,0),i.uniform1i(u.sizeAttenuation,x.sizeAttenuation?1:0),i.uniformMatrix4fv(u.modelViewMatrix,!1,E._modelViewMatrix.elements),b[0]=1,b[1]=1),_=t.fog&&x.fog?g:0,m!==_&&(i.uniform1i(u.fogType,_),m=_),T=1/(x.scaleByViewport?s:1),b[0]*=T*d*E.scale.x,b[1]*=T*E.scale.y,i.uniform2f(u.uvScale,x.uvScale.x,x.uvScale.y),i.uniform2f(u.uvOffset,x.uvOffset.x,x.uvOffset.y),i.uniform2f(u.alignment,x.alignment.x,x.alignment.y),i.uniform1f(u.opacity,x.opacity),i.uniform3f(u.color,x.color.r,x.color.g,x.color.b),i.uniform1f(u.rotation,E.rotation),i.uniform2fv(u.scale,b),n.setBlending(x.blending,x.blendEquation,x.blendSrc,x.blendDst),n.setDepthTest(x.depthTest),n.setDepthWrite(x.depthWrite),n.setTexture(x.map,0),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0));i.enable(i.CULL_FACE)}}},THREE.DepthPassPlugin=function(){function t(t){return t.material instanceof THREE.MeshFaceMaterial?t.material.materials[0]:t.material}this.enabled=!1,this.renderTarget=null;var e,i,n,r,o,a,s=new THREE.Frustum,l=new THREE.Matrix4;this.init=function(t){e=t.context,i=t;var s=THREE.ShaderLib.depthRGBA,l=THREE.UniformsUtils.clone(s.uniforms);n=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l}),r=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0}),o=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,skinning:!0}),a=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0,skinning:!0}),n._shadowPass=!0,r._shadowPass=!0,o._shadowPass=!0,a._shadowPass=!0},this.render=function(t,e){this.enabled&&this.update(t,e)},this.update=function(h,c){var u,d,f,p,m,g,v,y=null;for(e.clearColor(1,1,1,1),e.disable(e.BLEND),i.setDepthTest(!0),h.autoUpdate===!0&&h.updateMatrixWorld(),c.matrixWorldInverse.getInverse(c.matrixWorld),l.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),s.setFromMatrix(l),i.setRenderTarget(this.renderTarget),i.clear(),v=h.__webglObjects,u=0,d=v.length;d>u;u++)m=v[u],g=m.object,m.render=!1,g.visible&&(!(g instanceof THREE.Mesh||g instanceof THREE.ParticleSystem)||!g.frustumCulled||s.intersectsObject(g))&&(g._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,g.matrixWorld),m.render=!0);var E,x,T;for(u=0,d=v.length;d>u;u++)if(m=v[u],m.render){if(g=m.object,f=m.buffer,g instanceof THREE.ParticleSystem&&!g.customDepthMaterial)continue;E=t(g),E&&i.setMaterialFaces(g.material),x=g.geometry.morphTargets.length>0&&E.morphTargets,T=g instanceof THREE.SkinnedMesh&&E.skinning,p=g.customDepthMaterial?g.customDepthMaterial:T?x?a:o:x?r:n,f instanceof THREE.BufferGeometry?i.renderBufferDirect(c,h.__lights,y,p,f,g):i.renderBuffer(c,h.__lights,y,p,f,g)}for(v=h.__webglObjectsImmediate,u=0,d=v.length;d>u;u++)m=v[u],g=m.object,g.visible&&(g._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,g.matrixWorld),i.renderImmediateObject(c,h.__lights,y,n,g));var _=i.getClearColor(),b=i.getClearAlpha();e.clearColor(_.r,_.g,_.b,b),e.enable(e.BLEND)}},THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},lensFlare:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}},THREE.ShaderSprite={sprite:{vertexShader:["uniform int useScreenCoordinates;","uniform int sizeAttenuation;","uniform vec3 screenPosition;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 alignment;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position + alignment;","vec2 rotatedPosition;","rotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;","rotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;","vec4 finalPosition;","if( useScreenCoordinates != 0 ) {","finalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );","} else {","finalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );","}","gl_Position = finalPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")}},define("three",function(t){return function(){var e;return e||t.THREE}}(this)),define("core/BaseObject",["Class","three"],function(t,e){var i=new t({doNotEncapsulate:!0,initialize:function(t){this.setParams(t)},setParams:function(t){if(void 0!==t)for(var i in t){var n=t[i];if(void 0!==n&&i in this){var r=this[i];r instanceof e.Color?r.set(n):r instanceof e.Vector3&&n instanceof e.Vector3?r.copy(n):this[i]=n}}}});return i});var datCustom=datCustom||{};datCustom.gui=datCustom.gui||{},datCustom.utils=datCustom.utils||{},datCustom.controllers=datCustom.controllers||{},datCustom.dom=datCustom.dom||{},datCustom.color=datCustom.color||{},datCustom.utils.css=function(){return{load:function(t,e){e=e||document;var i=e.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=t,e.getElementsByTagName("head")[0].appendChild(i)},inject:function(t,e){e=e||document;var i=document.createElement("style");i.type="text/css",i.innerHTML=t,e.getElementsByTagName("head")[0].appendChild(i)}}}(),datCustom.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var i in e)this.isUndefined(e[i])||(t[i]=e[i])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var i in e)this.isUndefined(t[i])&&(t[i]=e[i])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var i=e.call(arguments),n=t.length-1;n>=0;n--)i=[t[n].apply(this,i)];return i[0]}},each:function(e,i,n){if(t&&e.forEach===t)e.forEach(i,n);else if(e.length===e.length+0){for(var r=0,o=e.length;o>r;r++)if(r in e&&i.call(n,e[r],r)===this.BREAK)return}else for(var r in e)if(i.call(n,e[r],r)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),datCustom.controllers.Controller=function(t){var e=function(t,e){this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0};return t.extend(e.prototype,{onChange:function(t){return this.__onChange=t,this},onFinishChange:function(t){return this.__onFinishChange=t,this},setValue:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),e}(datCustom.utils.common),datCustom.dom.dom=function(t){function e(e){if("0"===e||t.isUndefined(e))return 0;var i=e.match(r);return t.isNull(i)?0:parseFloat(i[1])}var i={HTMLEvents:["change"],MouseEvents:["click","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},n={};t.each(i,function(e,i){t.each(e,function(t){n[t]=i})});var r=/(\d+(\.\d+)?)px/,o={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(e,i,n){t.isUndefined(i)&&(i=!0),t.isUndefined(n)&&(n=!0),e.style.position="absolute",i&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,i,r,o){r=r||{};var a=n[i];if(!a)throw new Error("Event type "+i+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":var l=r.x||r.clientX||0,h=r.y||r.clientY||0;s.initMouseEvent(i,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,l,h,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=s.initKeyboardEvent||s.initKeyEvent;t.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(i,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:s.initEvent(i,r.bubbles||!1,r.cancelable||!0)}t.defaults(s,o),e.dispatchEvent(s)},bind:function(t,e,i,n){return n=n||!1,t.addEventListener?t.addEventListener(e,i,n):t.attachEvent&&t.attachEvent("on"+e,i),o},unbind:function(t,e,i,n){return n=n||!1,t.removeEventListener?t.removeEventListener(e,i,n):t.detachEvent&&t.detachEvent("on"+e,i),o},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var i=t.className.split(/ +/);-1==i.indexOf(e)&&(i.push(e),t.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return o},removeClass:function(t,e){if(e){if(void 0!==t.className)if(t.className===e)t.removeAttribute("class");else{var i=t.className.split(/ +/),n=i.indexOf(e);-1!=n&&(i.splice(n,1),t.className=i.join(" "))}}else t.className=void 0;return o},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var i=getComputedStyle(t);return e(i["border-left-width"])+e(i["border-right-width"])+e(i["padding-left"])+e(i["padding-right"])+e(i.width)},getHeight:function(t){var i=getComputedStyle(t);return e(i["border-top-width"])+e(i["border-bottom-width"])+e(i["padding-top"])+e(i["padding-bottom"])+e(i.height)},getOffset:function(t){var e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop;while(t=t.offsetParent);return e},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};return o}(datCustom.utils.common),datCustom.controllers.OptionController=function(t,e,i){var n=function(t,r,o){n.superclass.call(this,t,r);var a=this;if(this.__select=document.createElement("select"),i.isArray(o)){var s={};i.each(o,function(t){s[t]=t}),o=s}i.each(o,function(t,e){var i=document.createElement("option");i.innerHTML=e,i.setAttribute("value",t),a.__select.appendChild(i)}),this.updateDisplay(),e.bind(this.__select,"change",function(){var t=this.options[this.selectedIndex].value;a.setValue(t)}),this.domElement.appendChild(this.__select)};return n.superclass=t,i.extend(n.prototype,t.prototype,{setValue:function(t){var e=n.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),n.superclass.prototype.updateDisplay.call(this)}}),n}(datCustom.controllers.Controller,datCustom.dom.dom,datCustom.utils.common),datCustom.controllers.NumberController=function(t,e){function i(t){return t=t.toString(),t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var n=function(t,r,o){n.superclass.call(this,t,r),o=o||{},this.__min=o.min,this.__max=o.max,this.__step=o.step,this.__impliedStep=e.isUndefined(this.__step)?0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(Math.abs(this.initialValue))/Math.LN10))/10:this.__step,this.__precision=i(this.__impliedStep)};return n.superclass=t,e.extend(n.prototype,t.prototype,{setValue:function(t){return void 0!==this.__min&&t<this.__min?t=this.__min:void 0!==this.__max&&t>this.__max&&(t=this.__max),void 0!==this.__step&&t%this.__step!=0&&(t=Math.round(t/this.__step)*this.__step),n.superclass.prototype.setValue.call(this,t)},min:function(t){return this.__min=t,this},max:function(t){return this.__max=t,this},step:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=i(t),this}}),n}(datCustom.controllers.Controller,datCustom.utils.common),datCustom.controllers.NumberControllerBox=function(t,e,i){function n(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i}var r=function(t,n,o){function a(){var t=parseFloat(h.__input.value);i.isNaN(t)||h.setValue(t)}function s(){a(),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function l(){}this.__truncationSuspended=!1,r.superclass.call(this,t,n,o);var h=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"change",a),e.bind(this.__input,"blur",s),e.bind(this.__input,"mousedown",l),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=t,i.extend(r.prototype,t.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():n(this.getValue(),this.__precision),r.superclass.prototype.updateDisplay.call(this)}}),r}(datCustom.controllers.NumberController,datCustom.dom.dom,datCustom.utils.common),datCustom.controllers.NumberControllerSlider=function(t,e,i,n,r){var o=function(t,i,n,r,a){o.superclass.call(this,t,i,{min:n,max:r,step:a});this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),e.bind(this.__background,"mousedown",f),e.addClass(this.__background,"slider"),e.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return o.superclass=t,o.useDefaultStyles=function(){i.inject(r)},n.extend(o.prototype,t.prototype,{updateDisplay:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",o.superclass.prototype.updateDisplay.call(this)}}),o}(datCustom.controllers.NumberController,datCustom.dom.dom,datCustom.utils.css,datCustom.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),datCustom.controllers.FunctionController=function(t,e,i){var n=function(t,i,r){n.superclass.call(this,t,i);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===r?"Fire":r,e.bind(this.__button,"click",function(t){return t.preventDefault(),o.fire(),!1}),e.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return n.superclass=t,i.extend(n.prototype,t.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),n}(datCustom.controllers.Controller,datCustom.dom.dom,datCustom.utils.common),datCustom.controllers.BooleanController=function(t,e,i){var n=function(t,i){function r(){o.setValue(!o.__prev)}n.superclass.call(this,t,i);var o=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),e.bind(this.__checkbox,"change",r,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return n.superclass=t,i.extend(n.prototype,t.prototype,{setValue:function(t){var e=n.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,n.superclass.prototype.updateDisplay.call(this)}}),n}(datCustom.controllers.Controller,datCustom.dom.dom,datCustom.utils.common),datCustom.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var i=e.hex.toString(16);i.length<6;)i="0"+i;return"#"+i}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(datCustom.utils.common),datCustom.color.interpret=function(t,e){var i,n,r=function(){n=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(o,function(r){return r.litmus(t)?(e.each(r.conversions,function(r,o){return i=r.read(t),n===!1&&i!==!1?(n=i,i.conversionName=o,i.conversion=r,e.BREAK):void 0}),e.BREAK):void 0}),n},o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1
},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return r}(datCustom.color.toString,datCustom.utils.common),datCustom.GUI=datCustom.gui.GUI=function(t,e,i,n,r,o,a,s,l,h,c,u,d,f,p){function m(t,e,i,o){if(void 0===e[i])throw new Error("Object "+e+' has no property "'+i+'"');var a;if(o.color)a=new c(e,i);else{var s=[e,i].concat(o.factoryArgs);a=n.apply(t,s)}o.before instanceof r&&(o.before=o.before.__li),y(t,a),f.addClass(a.domElement,"c");var l=document.createElement("span");f.addClass(l,"property-name"),l.innerHTML=a.property;var h=document.createElement("div");h.appendChild(l),h.appendChild(a.domElement);var u=g(t,h,o.before);return f.addClass(u,U.CLASS_CONTROLLER_ROW),f.addClass(u,typeof a.getValue()),v(t,u,a),t.__controllers.push(a),a}function g(t,e,i){var n=document.createElement("li");return e&&n.appendChild(e),i?t.__ul.insertBefore(n,params.before):t.__ul.appendChild(n),t.onResize(),n}function v(){}function y(t,e){var i=t.getRoot(),n=i.__rememberedObjects.indexOf(e.object);if(-1!=n){var r=i.__rememberedObjectIndecesToControllers[n];if(void 0===r&&(r={},i.__rememberedObjectIndecesToControllers[n]=r),r[e.property]=e,i.load&&i.load.remembered){var o,a=i.load.remembered;if(a[t.preset])o=a[t.preset];else{if(!a[O])return;o=a[O]}if(o[n]&&void 0!==o[n][e.property]){var s=o[n][e.property];e.initialValue=s,e.setValue(s)}}}}function E(t,e){return document.location.href+"."+e}function x(){}function T(){}function _(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function b(t,e){var i={};return p.each(t.__rememberedObjects,function(n,r){var o={},a=t.__rememberedObjectIndecesToControllers[r];p.each(a,function(t,i){o[i]=e?t.initialValue:t.getValue()}),i[r]=o}),i}function w(t,e,i){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.__preset_select.appendChild(n),i&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function R(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value==t.preset&&(t.__preset_select.selectedIndex=e)}function S(t,e){var i=t.__preset_select[t.__preset_select.selectedIndex];i.innerHTML=e?i.value+"*":i.value}function M(t){0!=t.length&&u(function(){M(t)}),p.each(t,function(t){t.updateDisplay()})}t.inject(i);var H,C,A="dg",P=72,L=20,O="Default",D=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),z=!0,N=!1,F=[],U=function(t){function e(){localStorage.setItem(E(n,"gui"),JSON.stringify(n.getSaveObject()))}function i(){var t=n.getRoot();t.width+=1,p.defer(function(){t.width-=1})}var n=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),f.addClass(this.domElement,A),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],t=t||{},t=p.defaults(t,{autoPlace:!0,width:U.DEFAULT_WIDTH}),t=p.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace}),p.isUndefined(t.load)?t.load={preset:O}:t.preset&&(t.load.preset=t.preset),p.isUndefined(t.parent)&&t.hideable&&F.push(this),t.resizable=p.isUndefined(t.parent)&&t.resizable,t.autoPlace&&p.isUndefined(t.scrollable)&&(t.scrollable=!0);var r=D&&"true"===localStorage.getItem(E(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){return n.parent?n.getRoot().preset:t.load.preset},set:function(e){n.parent?n.getRoot().preset=e:t.load.preset=e,R(this),n.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e,_(n,e)}},name:{get:function(){return t.name},set:function(e){t.name=e,a&&(a.innerHTML=t.name)}},closed:{get:function(){return t.closed},set:function(e){t.closed=e,t.closed?f.addClass(n.__ul,U.CLASS_CLOSED):f.removeClass(n.__ul,U.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?U.TEXT_OPEN:U.TEXT_CLOSED)}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return r},set:function(t){D&&(r=t,t?f.bind(window,"unload",e):f.unbind(window,"unload",e),localStorage.setItem(E(n,"isLocal"),t))}}}),p.isUndefined(t.parent)){if(t.closed=!1,f.addClass(this.domElement,U.CLASS_MAIN),f.makeSelectable(this.domElement,!1),D&&r){n.useLocalStorage=!0;var o=localStorage.getItem(E(this,"gui"));o&&(t.load=JSON.parse(o))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=U.TEXT_CLOSED,f.addClass(this.__closeButton,U.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),f.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===t.closed&&(t.closed=!0);var a=document.createTextNode(t.name);f.addClass(a,"controller-name");var s=g(n,a),l=function(t){return t.preventDefault(),n.closed=!n.closed,!1};f.addClass(this.__ul,U.CLASS_CLOSED),f.addClass(s,"title"),f.bind(s,"click",l),t.closed||(this.closed=!1)}t.autoPlace&&(p.isUndefined(t.parent)&&(z&&(C=document.createElement("div"),f.addClass(C,A),f.addClass(C,U.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(C),z=!1),C.appendChild(this.domElement),f.addClass(this.domElement,U.CLASS_AUTO_PLACE)),this.parent||_(n,t.width)),f.bind(window,"resize",function(){n.onResize()}),f.bind(this.__ul,"webkitTransitionEnd",function(){n.onResize()}),f.bind(this.__ul,"transitionend",function(){n.onResize()}),f.bind(this.__ul,"oTransitionEnd",function(){n.onResize()}),this.onResize(),t.resizable&&T(this);n.getRoot();t.parent||i()};return U.toggleHide=function(){N=!N,p.each(F,function(t){t.domElement.style.zIndex=N?-999:999,t.domElement.style.opacity=N?0:1})},U.CLASS_AUTO_PLACE="a",U.CLASS_AUTO_PLACE_CONTAINER="ac",U.CLASS_MAIN="main",U.CLASS_CONTROLLER_ROW="cr",U.CLASS_TOO_TALL="taller-than-window",U.CLASS_CLOSED="closed",U.CLASS_CLOSE_BUTTON="close-button",U.CLASS_DRAG="drag",U.DEFAULT_WIDTH=245,U.TEXT_CLOSED="Close Controls",U.TEXT_OPEN="Open Controls",f.bind(window,"keydown",function(t){"text"!==document.activeElement.type&&(t.which===P||t.keyCode==P)&&U.toggleHide()},!1),p.extend(U.prototype,{add:function(t,e){return m(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return m(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.slice(this.__controllers.indexOf(t),1);var e=this;p.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&C.removeChild(this.domElement)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var i=new U(e);this.__folders[t]=i;var n=g(this,i.domElement);return f.addClass(n,"folder"),i.li=n,i},removeFolder:function(t,e){var i=this.__folders[t];if(!i){if(e)return;throw t}if(i.open(),i.hasOwnProperty("__controllers"))for(var n=i.__controllers.length-1;n>=0;n--){var r=i.__controllers[n];r.label&&i.remove(r)}if(i.hasOwnProperty("__folders"))for(key in i.__folders)try{i.removeFolder(i.__folders[key].name)}catch(o){}i.close(),this.__ul.removeChild(i.li),f.removeClass(i.li,"folder"),this.__folders[t]=void 0,this.onResize()},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=f.getOffset(t.__ul).top,i=0;p.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(i+=f.getHeight(e))}),window.innerHeight-e-L<i?(f.addClass(t.domElement,U.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-L+"px"):(f.removeClass(t.domElement,U.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&p.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(p.isUndefined(H)&&(H=new d,H.domElement.innerHTML=e),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;p.each(Array.prototype.slice.call(arguments),function(e){0==t.__rememberedObjects.length&&x(t),-1==t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&_(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=b(this)),t.folders={},p.each(this.__folders,function(e,i){t.folders[i]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=b(this),S(this,!1)},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[O]=b(this,!0)),this.load.remembered[t]=b(this),this.preset=t,w(this,t,!0)},revert:function(t){p.each(this.__controllers,function(e){this.getRoot().load.remembered?y(t||this.getRoot(),e):e.setValue(e.initialValue)},this),p.each(this.__folders,function(t){t.revert(t)}),t||S(this.getRoot(),!1)},listen:function(t){var e=0==this.__listening.length;this.__listening.push(t),e&&M(this.__listening)}}),U}(datCustom.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>datCustom.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:2000}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#dd3a20}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#dd3a20 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",datCustom.controllers.factory=function(t,e,i,n,r,o,a){return function(s,l){var h=s[l];return a.isArray(arguments[2])||a.isObject(arguments[2])?new t(s,l,arguments[2]):a.isNumber(h)?a.isNumber(arguments[2])&&a.isNumber(arguments[3])?new i(s,l,arguments[2],arguments[3],arguments[4]):new e(s,l,{min:arguments[2],max:arguments[3],step:arguments[4]}):a.isString(h)?new n(s,l):a.isFunction(h)?new r(s,l,""):a.isBoolean(h)?new o(s,l):void 0}}(datCustom.controllers.OptionController,datCustom.controllers.NumberControllerBox,datCustom.controllers.NumberControllerSlider,datCustom.controllers.StringController=function(t,e,i){var n=function(t,i){function r(){a.setValue(a.__input.value)}function o(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}n.superclass.call(this,t,i);var a=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"keyup",r),e.bind(this.__input,"change",r),e.bind(this.__input,"blur",o),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return n.superclass=t,i.extend(n.prototype,t.prototype,{updateDisplay:function(){return e.isActive(this.__input)||(this.__input.value=this.getValue()),n.superclass.prototype.updateDisplay.call(this)}}),n}(datCustom.controllers.Controller,datCustom.dom.dom,datCustom.utils.common),datCustom.controllers.FunctionController,datCustom.controllers.BooleanController,datCustom.utils.common),datCustom.controllers.Controller,datCustom.controllers.BooleanController,datCustom.controllers.FunctionController,datCustom.controllers.NumberControllerBox,datCustom.controllers.NumberControllerSlider,datCustom.controllers.OptionController,datCustom.controllers.ColorController=function(t,e,i,n,r){var o=function(){};return o}(datCustom.controllers.Controller,datCustom.dom.dom,datCustom.color.Color=function(t,e,i,n){function r(t,e,i){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(a(this,e,i),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(a(this,e,i),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(s(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[e]=t}})}function a(t,i,r){if("HEX"===t.__state.space)t.__state[i]=e.component_from_hex(t.__state.hex,r);else{if("HSV"!==t.__state.space)throw"Corrupted color state";n.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function s(t){var i=e.rgb_to_hsv(t.r,t.g,t.b);n.extend(t.__state,{s:i.s,v:i.v}),n.isNaN(i.h)?n.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=i.h}var l=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return l.COMPONENTS=["r","g","b","h","s","v","hex","a"],n.extend(l.prototype,{toString:function(){return i(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),r(l.prototype,"r",2),r(l.prototype,"g",1),r(l.prototype,"b",0),o(l.prototype,"h"),o(l.prototype,"s"),o(l.prototype,"v"),Object.defineProperty(l.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(l.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),l}(datCustom.color.interpret,datCustom.color.math=function(){var t;return{hsv_to_rgb:function(t,e,i){var n=Math.floor(t/60)%6,r=t/60-Math.floor(t/60),o=i*(1-e),a=i*(1-r*e),s=i*(1-(1-r)*e),l=[[i,s,o],[a,i,o],[o,i,s],[o,a,i],[s,o,i],[i,o,a]][n];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(t,e,i){var n,r,o=Math.min(t,e,i),a=Math.max(t,e,i),s=a-o;return 0==a?{h:0/0,s:0,v:0}:(r=s/a,n=t==a?(e-i)/s:e==a?2+(i-t)/s:4+(t-e)/s,n/=6,0>n&&(n+=1),{h:360*n,s:r,v:a/255})},rgb_to_hex:function(t,e,i){var n=this.hex_with_component(0,2,t);return n=this.hex_with_component(n,1,e),n=this.hex_with_component(n,0,i)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,i,n){return n<<(t=8*i)|e&~(255<<t)}}}(),datCustom.color.toString,datCustom.utils.common),datCustom.color.interpret,datCustom.utils.common),datCustom.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),datCustom.dom.CenteredDiv=function(t,e){var i=function(){this.backgroundElement=document.createElement("div"),e.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),t.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),e.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var i=this;t.bind(this.backgroundElement,"click",function(){i.hide()})};return i.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),e.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},i.prototype.hide=function(){var e=this,i=function(){e.domElement.style.display="none",e.backgroundElement.style.display="none",t.unbind(e.domElement,"webkitTransitionEnd",i),t.unbind(e.domElement,"transitionend",i),t.unbind(e.domElement,"oTransitionEnd",i)};t.bind(this.domElement,"webkitTransitionEnd",i),t.bind(this.domElement,"transitionend",i),t.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},i.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-t.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-t.getHeight(this.domElement)/2+"px"},i}(datCustom.dom.dom,datCustom.utils.common),datCustom.dom.dom,datCustom.utils.common),define("GUI",function(t){return function(){var e;return e||t.datCustom}}(this)),define("utils/ColorUtils",["Class","three"],function(t,e){var i=new t({});return i.hexToR=function(t){return parseInt(i.cutHex(t).substring(0,2),16)},i.hexToG=function(t){return parseInt(i.cutHex(t).substring(2,4),16)},i.hexToB=function(t){return parseInt(i.cutHex(t).substring(4,6),16)},i.cutHex=function(t){return"#"==t.charAt(0)?t.substring(1,7):t},i.isHex=function(t){return"string"==typeof t||t instanceof String?"#"==t.charAt(0)&&7==t.length:void 0},i.getHexNumber=function(t){var i=new e.Color(t);return i.getHex()},i.incrementH=function(t,e){i.incrementHSL(t,"h",e)},i.incrementS=function(t,e){i.incrementHSL(t,"s",e)},i.incrementL=function(t,e){i.incrementHSL(t,"l",e)},i.incrementHSL=function(t,e,i){var n=t.getHSL();n[e]+=i,t.setHSL(n.h,n.s,n.l)},i}),define("utils/ModelUtils",["Class","Signal","utils/ColorUtils"],function(t,e,i){var n=new t({});return n.debug=!1,n.encapsulate=function(t,e){if(t.hasOwnProperty(e)){var i={value:t[e]};return t[e]=i,i}throw"bad encapsulation attempt: object does not have value called: "+e},n.activate=function(t){t.hasOwnProperty("value")&&!t.hasOwnProperty("_value")&&(t.onChangedSignal=new e,t._value=t.value,Object.defineProperty(t,"value",{set:function(t){this._value=t,this.onChangedSignal.dispatch(t)},get:function(){return this._value}}))},n.encapsulateAndActivate=function(t,e){n.debug&&0;var i=n.encapsulate(t,e);return n.activate(i),n.debug&&0,i},n.recursiveEncapsulateAndActivate=function(t){var e=[];for(var i in t)e.push(i);for(var r=e.length-1;r>=0;r--){var i=e[r],o=t[i],a=!1,s=!1;o instanceof Object&&(o.hasOwnProperty("value")?(a=!0,o.hasOwnProperty("onChangedSignal")&&(s=!0),n.debug&&0):o instanceof Function?(a=s=!0,n.debug&&0):o.hasOwnProperty("doNotEncapsulate")?(a=s=!0,n.debug&&0):"collectionSignals"==i?(a=s=!0,n.debug&&0):(n.debug&&0,n.recursiveEncapsulateAndActivate(o),a=s=!0)),a||s?s||n.activate(t[i]):n.encapsulateAndActivate(t,i)}},n.decapsulate=function(t,e){return t[e].hasOwnProperty("value")?(t[e]=t[e].value,!0):!1},n.deactivate=function(t){return t.hasOwnProperty("_gsTweenID")&&delete t._gsTweenID,t.hasOwnProperty("onChangedSignal")&&t.hasOwnProperty("_value")?(t.value=void 0,delete t.value,t.onChangedSignal=void 0,delete t.onChangedSignal,t.value=t._value,t._value=void 0,delete t._value,!0):!1},n.deactivateAndDecapsulate=function(t,e){n.deactivate(t[e])?n.debug&&0:n.debug&&0,n.decapsulate(t,e)?n.debug&&0:n.debug&&0},n.recursiveDeactivateAndDecapsulate=function(t,e){var i=[];for(var r in t)i.push(r);for(var o=i.length-1;o>=0;o--){var r=i[o],a=t[r],s=!0,l=!0;a instanceof Object&&(a.hasOwnProperty("value")?(a.hasOwnProperty("onChangedSignal")&&(s=!1),!e&&(a.hasOwnProperty("min")||a.hasOwnProperty("max")||a.hasOwnProperty("step")||a.hasOwnProperty("choicesSource")||a.hasOwnProperty("doNotGUI"))||(l=!1,n.debug&&0)):a instanceof Function?(s=l=!0,n.debug&&0):"collectionSignals"==r?(s=l=!0,n.debug&&0,delete t[r]):a.hasOwnProperty("doNotEncapsulate")?(s=l=!0,n.debug&&0):(n.debug&&0,n.recursiveDeactivateAndDecapsulate(a,e),s=l=!0)),s||l?s||(n.deactivate(t[r])?n.debug&&0:n.debug&&0):n.deactivateAndDecapsulate(t,r)}},n.validate=function(t){var e={};return t.hasOwnProperty("value")?(e.isValue=!0,t.hasOwnProperty("onChangedSignal")&&(e.isActivated=!0)):t instanceof Function||(e.isNested=!0),e},n.recursiveCopy=function(t,e,r,o,a,s){n.debug&&0;for(var l in e)if(t.hasOwnProperty(l)){{var h=e[l],c=t[l],u=n.validate(h);n.validate(c)}u.isNested?s=n.recursiveCopy(t[l],e[l],r,o,a,s):u.isValue&&t[l].value!=e[l].value&&(r?(i.isHex(t[l].value)?(n.debug&&0,TweenLite.to(t[l],a,{colorProps:{value:e[l].value},delay:s})):isNaN(t[l].value)||""==t[l].value||t[l].value===!0||t[l].value===!1?(n.debug&&0,t[l].value=e[l].value):(n.debug&&0,TweenLite.to(t[l],a,{value:e[l].value,delay:s})),s+=o):(n.debug&&0,t[l].value=e[l].value))}return s},n}),define("core/BaseObjectActive",["Class","three","utils/ModelUtils"],function(t,e,i){var n=new t({doNotEncapsulate:!0,initialize:function(t){this.setParams(t)},setParams:function(t){if(void 0!==t){i.recursiveEncapsulateAndActivate(t);var n=[];for(var r in t)n.push(r);for(var o=n.length-1;o>=0;o--){var r=n[o],a=t[r];if(void 0!==a&&r in this){var s=this[r];s instanceof e.Color?s.set(a):s instanceof e.Vector3&&a instanceof e.Vector3?s.copy(a):(this[r]=a,this["_"+r]=a)}}}},transition:function(t){void 0!==t&&i.recursiveCopy(this,t)}});return n}),define("managers/TiltManager",["Class","core/BaseObject","Global"],function(t,e,i){var n=new t({Extends:e,speed:{value:.1,min:0,max:1,step:.001},panRange:{value:1.2,min:0,max:5,step:.001},angleRange:{value:2,min:0,max:5,step:.001},rangeScaleX:{value:1,min:0,max:1,step:.001},rangeScaleY:{value:.5,min:0,max:1,step:.001},angleX:0,angleY:0,targetAngleX:0,targetAngleY:0,initialize:function(t){if(n.instance)throw"Singleton enforcer!";n.instance=this,this.parent(t)},onMouseMove:function(t){this.targetAngleY=(t.clientX-i.widthHalf)/i.width*this.angleRange.value,this.targetAngleX=(t.clientY-i.heightHalf)/i.height*this.angleRange.value},update:function(){this.angleX-=(this.angleX-this.targetAngleX)*this.speed.value*this.rangeScaleY.value,this.angleY-=(this.angleY-this.targetAngleY)*this.speed.value*this.rangeScaleX.value}});return n}),define("controllers/CameraControllerMouseParallax",["Class","core/BaseObject","managers/TiltManager","Global","three"],function(t,e,i,n,r){var o=new t({Extends:e,camera:void 0,scene:void 0,debugFPSControls:!1,defaultPosition:void 0,defaultRotation:void 0,camMoveSpeed:10,camStrafeSpeed:10,camTurnSpeed:.05,tiltCam:!0,targetPosition:void 0,tiltSpeed:.01,targetCameraDistance:0,initialize:function(t){this.parent(t),window.addEventListener("DOMMouseScroll",this.onMouseWheelHandler.bind(this),!1),this.targetPosition=new r.Vector2(0,0),this.tiltCam=!0,this.identityCameraPosition=new r.Vector3(0,0,400),this.matrixAngleX=new r.Matrix4,this.matrixAngleY=new r.Matrix4},update:function(){var t=this.camera;if(this.debugFPSControls){if(!n.keyboard.pressed("shift"))return;n.keyboard.pressed("W")&&(t.translateZ(-this.camMoveSpeed),this.tiltCam=!1),n.keyboard.pressed("S")&&(t.translateZ(this.camMoveSpeed),this.tiltCam=!1),n.keyboard.pressed("A")&&(t.translateX(-this.camStrafeSpeed),this.tiltCam=!1),n.keyboard.pressed("D")&&(t.translateX(this.camStrafeSpeed),this.tiltCam=!1),n.keyboard.pressed("C")&&(t.translateY(-this.camStrafeSpeed),this.tiltCam=!1),n.keyboard.pressed("E")&&(t.translateY(this.camStrafeSpeed),this.tiltCam=!1),n.keyboard.pressed("left")&&(t.rotateY(this.camTurnSpeed),this.tiltCam=!1),n.keyboard.pressed("right")&&(t.rotateY(-this.camTurnSpeed),this.tiltCam=!1),n.keyboard.pressed("up")&&(t.rotateX(this.camTurnSpeed),this.tiltCam=!1),n.keyboard.pressed("down")&&(t.rotateX(-this.camTurnSpeed),this.tiltCam=!1),n.keyboard.pressed("R")&&(t.position=this.defaultPosition.clone(),t.rotation.x=this.defaultRotation.x,t.rotation.y=this.defaultRotation.y,t.rotation.z=this.defaultRotation.z,this.tiltCam=!0)}if(this.tiltCam){this.matrixAngleX.makeRotationX(i.instance.angleX),this.matrixAngleY.makeRotationY(i.instance.angleY);var e=this.matrixAngleX.clone().multiply(this.matrixAngleY),r=this.identityCameraPosition.clone().applyMatrix4(e);t.position.copy(r),t.lookAt(this.scene.position)}},onMouseMove:function(t){this.targetAngleY=(t.clientX-n.widthHalf)/n.width*2,this.targetAngleX=(t.clientY-n.heightHalf)/n.height*2},onMouseWheelHandler:function(t){if(n.keyboard.pressed("shift")){var t=window.event||t,e=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));this.camera.fov-=e,this.camera.onFOVChangedSignal.dispatch(),n.cameraFOV=this.camera.fov,this.camera.updateProjectionMatrix(),this.camera.far=n.cameraDistanceFar}}});return o}),define("managers/SceneManager",["Class","core/BaseObjectActive","three","Global","controllers/CameraControllerMouseParallax","Signal","utils/ColorUtils"],function(t,e,i,n,r,o,a){var s=new t({Extends:e,scene:void 0,camera:void 0,cameraController:void 0,cameraFOV:37,fog:void 0,distanceNear:1,distanceFar:3e3,emDoodle:void 0,camDefaultRotation:void 0,camDefaultPosition:void 0,bgColor:16777215,mouseStrength:1,lighting:"light",onEmDoodleRequestSignal:void 0,initialize:function(t){if(s.instance)throw"Singleton enforcer!";s.instance=this,this.onEmDoodleRequestSignal=new o,this.parent(t)},setParams:function(t){t.fog||(t.fog={near:1,far:800}),t.emDoodle||(t.emDoodle={choicesSource:"emDoodles",value:"planet"}),t.bgColor||(t.bgColor=this.bgColor),t.mouseStrength||(t.mouseStrength={value:1,min:-10,max:10,step:.01}),t.lighting||(t.lighting={value:"light",choicesSource:"lighting"}),this.parent(t),this.scene||(this.scene=new i.Scene),this.scene.fog?(this.scene.fog.color.setHex(a.getHexNumber(this.bgColor.value)),this.scene.fog.near=this.fog.near.value,this.scene.fog.far=this.fog.far.value):this.scene.fog=new i.Fog(this.bgColor.value,this.fog.near.value,this.fog.far.value),n.cameraFOV=this.cameraFOV.value,n.cameraDistanceNear=this.distanceNear.value,n.cameraDistanceFar=this.distanceFar.value,this.onEmDoodleRequestSignal.dispatch(this.emDoodle.value),this.bgColor.onChangedSignal.add(function(t){this.scene.fog.color.setHex(a.getHexNumber(t))}.bind(this)),this.fog.near.onChangedSignal.add(function(t){this.scene.fog.near=t}.bind(this)),this.fog.far.onChangedSignal.add(function(t){this.scene.fog.far=t}.bind(this)),this.camera||(this.camera=new i.PerspectiveCamera(this.cameraFOV.value,n.aspectRatio,this.distanceNear.value,this.distanceFar.value),this.camera.onFOVChangedSignal=new o,this.scene.add(this.camera)),this.cameraController||(this.cameraController=new r({camera:this.camera,scene:this.scene,defaultPosition:new i.Vector3(this.camDefaultPosition.x.value,this.camDefaultPosition.y.value,this.camDefaultPosition.z.value),defaultRotation:new i.Euler(this.camDefaultRotation.x.value,this.camDefaultRotation.y.value,this.camDefaultRotation.z.value)})),this.camera.position=new i.Vector3(this.camDefaultPosition.x.value,this.camDefaultPosition.y.value,this.camDefaultPosition.z.value),this.camera.far=n.cameraDistanceFar,n.mouseStrength=this.mouseStrength.value,this.mouseStrength.onChangedSignal.add(function(t){n.mouseStrength=t
}.bind(this)),this.emDoodle.onChangedSignal.add(function(t){this.onEmDoodleRequestSignal.dispatch(t)}.bind(this))},update:function(){this.cameraController&&this.cameraController.update()}});return s}),define("text",["module"],function(t){"use strict";var e,i,n,r,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,h="undefined"!=typeof location&&location.href,c=h&&location.protocol&&location.protocol.replace(/\:/,""),u=h&&location.hostname,d=h&&(location.port||void 0),f={},p=t.config&&t.config()||{};return e={version:"2.0.10",strip:function(t){if(t){t=t.replace(s,"");var e=t.match(l);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;3>e;e+=1){i=a[e];try{t=new ActiveXObject(i)}catch(n){}if(t){a=[i];break}}return t},parseName:function(t){var e,i,n,r=!1,o=t.indexOf("."),a=0===t.indexOf("./")||0===t.indexOf("../");return-1!==o&&(!a||o>1)?(e=t.substring(0,o),i=t.substring(o+1,t.length)):e=t,n=i||e,o=n.indexOf("!"),-1!==o&&(r="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:e=n),{moduleName:e,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,r){var o,a,s,l=e.xdRegExp.exec(t);return l?(o=l[2],a=l[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==i||a&&a.toLowerCase()!==n.toLowerCase()||(s||a)&&s!==r)):!0},finishLoad:function(t,i,n,r){n=i?e.strip(n):n,p.isBuild&&(f[t]=n),r(n)},load:function(t,i,n,r){if(r.isBuild&&!r.inlineText)return void n();p.isBuild=r.isBuild;var o=e.parseName(t),a=o.moduleName+(o.ext?"."+o.ext:""),s=i.toUrl(a),l=p.useXhr||e.useXhr;return 0===s.indexOf("empty:")?void n():void(!h||l(s,c,u,d)?e.get(s,function(i){e.finishLoad(t,o.strip,i,n)},function(t){n.error&&n.error(t)}):i([a],function(t){e.finishLoad(o.moduleName+"."+o.ext,o.strip,t,n)}))},write:function(t,i,n){if(f.hasOwnProperty(i)){var r=e.jsEscape(f[i]);n.asModule(t+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(t,i,n,r,o){var a=e.parseName(i),s=a.ext?"."+a.ext:"",l=a.moduleName+s,h=n.toUrl(a.moduleName+s)+".js";e.load(l,n,function(){var i=function(t){return r(h,t)};i.asModule=function(t,e){return r.asModule(t,h,e)},e.write(t,l,i,o)},o)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var r=i.readFileSync(t,"utf8");0===r.indexOf("")&&(r=r.substring(1)),e(r)}catch(o){n(o)}}):"xhr"===p.env||!p.env&&e.createXhr()?e.get=function(t,i,n,r){var o,a=e.createXhr();if(a.open("GET",t,!0),r)for(o in r)r.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),r[o]);p.onXhr&&p.onXhr(a,t),a.onreadystatechange=function(){var e,r;4===a.readyState&&(e=a.status,e>399&&600>e?(r=new Error(t+" HTTP status: "+e),r.xhr=a,n(r)):i(a.responseText),p.onXhrComplete&&p.onXhrComplete(a,t))},a.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,r="utf-8",o=new java.io.File(t),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),l="";try{for(i=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=s.readLine());)i.append(a),i.append(n);l=String(i.toString())}finally{s.close()}e(l)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,a,s,l={};o&&(t=t.replace(/\//g,"\\")),s=new FileUtils.File(t);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),i.init(s,1,0,!1),a=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),a.init(i,"utf-8",i.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(i.available(),l),a.close(),i.close(),e(l.value)}catch(h){throw new Error((s&&s.path||"")+": "+h)}}),e}),define("text!shaders/PhongTriangleSpriteParticles.vsh",[],function(){return"#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif\n#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif\n#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif\n#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif\n#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\n    float j = i * 4.0;\n    float x = mod( j, N_BONE_PIXEL_X );\n    float y = floor( j / N_BONE_PIXEL_X );\n    const float dx = 1.0 / N_BONE_PIXEL_X;\n    const float dy = 1.0 / N_BONE_PIXEL_Y;\n    y = dy * ( y + 0.5 );\n    vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n    vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n    vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n    vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n    mat4 bone = mat4( v1, v2, v3, v4 );\n    return bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\n    mat4 bone = boneGlobalMatrices[ int(i) ];\n    return bone;\n}\n#endif\n#endif\n#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif\n//begin injection\nmat4 rotationMatrix( const in vec3 axis, const in float angle)\n{\n    vec3 axisB = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    return mat4(oc * axisB.x * axisB.x + c, oc * axisB.x * axisB.y - axisB.z * s, oc * axisB.z * axisB.x + axisB.y * s, 0.0,\n                oc * axisB.x * axisB.y + axisB.z * s, oc * axisB.y * axisB.y + c, oc * axisB.y * axisB.z - axisB.x * s, 0.0,\n                oc * axisB.z * axisB.x - axisB.y * s, oc * axisB.y * axisB.z + axisB.x * s, oc * axisB.z * axisB.z + c, 0.0,\n                0.0, 0.0, 0.0, 1.0);\n}\nattribute vec3 motionPosition;\nattribute vec2 triangleOffset;\nattribute float spin;\nuniform float aspectRatio;\n//end injection\nvoid main() {\n    //begin injection\n    //mat4 spinMatrix = rotationMatrix(motionAxisAngle, spin);\n    vec3 myPosition = position.xyz;\n    //end injection\n    #if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\n    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n    #endif\n    #ifdef USE_LIGHTMAP\n    vUv2 = uv2;\n    #endif\n    #ifdef USE_COLOR\n    #ifdef GAMMA_INPUT\n    vColor = color * color;\n    #else\n    vColor = color;\n    #endif\n    #endif\n    #ifdef USE_MORPHNORMALS\n    vec3 morphedNormal = vec3( 0.0 );\n    morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n    morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n    morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n    morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n    morphedNormal += normal;\n    #endif\n    #ifdef USE_SKINNING\n    mat4 boneMatX = getBoneMatrix( skinIndex.x );\n    mat4 boneMatY = getBoneMatrix( skinIndex.y );\n    #endif\n    #ifdef USE_SKINNING\n    mat4 skinMatrix = skinWeight.x * boneMatX;\n    skinMatrix  += skinWeight.y * boneMatY;\n    #ifdef USE_MORPHNORMALS\n    vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n    #else\n    vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n    #endif\n    #endif\n    vec3 objectNormal;\n    #ifdef USE_SKINNING\n    objectNormal = skinnedNormal.xyz;\n    #endif\n    #if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\n    objectNormal = morphedNormal;\n    #endif\n    #if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\n    objectNormal = normal;\n    #endif\n    #ifdef FLIP_SIDED\n    objectNormal = -objectNormal;\n    #endif\n    vec3 transformedNormal = normalMatrix * objectNormal;\n    vNormal = normalize( transformedNormal );\n    //begin injection\n    //vNormal = (spinMatrix * vec4(vNormal, 0)).xyz;\n    //end injection\n    #ifdef USE_MORPHTARGETS\n    vec3 morphed = vec3( 0.0 );\n    morphed += ( morphTarget0 - myPosition ) * morphTargetInfluences[ 0 ];\n    morphed += ( morphTarget1 - myPosition ) * morphTargetInfluences[ 1 ];\n    morphed += ( morphTarget2 - myPosition ) * morphTargetInfluences[ 2 ];\n    morphed += ( morphTarget3 - myPosition ) * morphTargetInfluences[ 3 ];\n    #ifndef USE_MORPHNORMALS\n    morphed += ( morphTarget4 - myPosition ) * morphTargetInfluences[ 4 ];\n    morphed += ( morphTarget5 - myPosition ) * morphTargetInfluences[ 5 ];\n    morphed += ( morphTarget6 - myPosition ) * morphTargetInfluences[ 6 ];\n    morphed += ( morphTarget7 - myPosition ) * morphTargetInfluences[ 7 ];\n    #endif\n    morphed += myPosition;\n    #endif\n    #ifdef USE_SKINNING\n    #ifdef USE_MORPHTARGETS\n    vec4 skinVertex = vec4( morphed, 1.0 );\n    #else\n    vec4 skinVertex = vec4( myPosition, 1.0 );\n    #endif\n    vec4 skinned  = boneMatX * skinVertex * skinWeight.x;\n    skinned       += boneMatY * skinVertex * skinWeight.y;\n    #endif\n    vec4 mvPosition;\n    #ifdef USE_SKINNING\n    mvPosition = modelViewMatrix * skinned;\n    #endif\n    #if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\n    mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n    #endif\n    #if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\n    mvPosition = modelViewMatrix * vec4( myPosition, 1.0 );\n    #endif\n\n    gl_Position = projectionMatrix * mvPosition;\n    //begin injection\n    gl_Position.xy += vec2(triangleOffset.x / aspectRatio, triangleOffset.y);\n    //end injection\n    vViewPosition = -mvPosition.xyz;\n    #if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n    #ifdef USE_SKINNING\n    vec4 worldPosition = modelMatrix * skinned;\n    #endif\n    #if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n    vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n    #endif\n    #if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n    vec4 worldPosition = modelMatrix * vec4( myPosition, 1.0 );\n    #endif\n    #endif\n    #if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\n    vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\n    worldNormal = normalize( worldNormal );\n    vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n    if ( useRefract ) {\n        vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n    } else {\n        vReflect = reflect( cameraToVertex, worldNormal );\n    }\n    #endif\n    #ifndef PHONG_PER_PIXEL\n    #if MAX_POINT_LIGHTS > 0\n    for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n        vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n        vec3 lVector = lPosition.xyz - mvPosition.xyz;\n        float lDistance = 1.0;\n        if ( pointLightDistance[ i ] > 0.0 )\n        lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n        vPointLight[ i ] = vec4( lVector, lDistance );\n    }\n    #endif\n    #if MAX_SPOT_LIGHTS > 0\n    for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n        vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n        vec3 lVector = lPosition.xyz - mvPosition.xyz;\n        float lDistance = 1.0;\n        if ( spotLightDistance[ i ] > 0.0 )\n        lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n        vSpotLight[ i ] = vec4( lVector, lDistance );\n    }\n    #endif\n    #endif\n    #if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\n    vWorldPosition = worldPosition.xyz;\n    #endif\n    #ifdef USE_SHADOWMAP\n    for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n        vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n    }\n    #endif\n}"}),define("utils/FileUtils",["Class","Global"],function(t,e){var i=new t({});return i.debug=!1,i.fileExists=function(t){var i=new XMLHttpRequest;i.open("HEAD",e.assetsPath+t,!1);try{i.send()}catch(n){}return 404!=i.status},i._textureURLs={},i.verifyAndLoadTexture=function(t,n,r,o,a){var s,l=n.uuid+"_"+r;if(i.debug&&0,t.indexOf(".jpg")!=t.length-4&&t.indexOf(".jpeg")!=t.length-5&&t.indexOf(".png")!=t.length-4||i._textureURLs[l]==t){if(""==t&&i._textureURLs[l]!=t)return i._textureURLs[l]=t,i.debug&&0,s=null,a||(n[r]&&n[r].dispose(),n[r]=s,n.needsUpdate=!0),o&&o(),s;if(i._textureURLs[l]!=t)return i._textureURLs[l]=t,i.loadPlaceHolderTexture(n,r,o,a)}else{if(i._textureURLs[l]=t,!i.fileExists(t))return i.loadPlaceHolderTexture(n,r,o,a);if(!n[r]||n[r].sourceFile!=t)return i.debug&&0,s=THREE.ImageUtils.loadTexture(e.assetsPath+t),a||(n[r]&&n[r].dispose(),n[r]=s,n.needsUpdate=!0),o&&o(),s;i.debug&&0}},i.loadPlaceHolderTexture=function(t,n,r,o){var a,s=e.assetsPath+e.textureNotFound;return t[n]&&t[n].sourceFile==s?void 0:(i.debug&&0,a=THREE.ImageUtils.loadTexture(s),o||(t[n]&&t[n].dispose(),t[n]=a,t.needsUpdate=!0),r&&r(),a)},i}),define("objects/Layer",["Class","three","core/BaseObjectActive","Global","utils/ColorUtils","utils/FileUtils"],function(t,e,i){var n=new t({Extends:i,material:void 0,geometry:void 0,display:void 0,materialObject:null,initialize:function(t){this.parent(t)},initHooks:function(){},hide:function(){this.display.visible=!1},show:function(){this.display.visible=!0},destroy:function(){throw"Override destroy method"}});return n}),define("objects/ParticleLayer",["Class","three","core/BaseObjectActive","Global","utils/ColorUtils","utils/FileUtils","objects/Layer"],function(t,e,i,n,r,o,a){var a=new t({Extends:a,total:500,_desiredTotal:0,_actualTotal:0,bounds:null,boundsHalf:null,boundsOffset:void 0,physics:void 0,motionVectors:void 0,spins:void 0,initialize:function(t){this.bounds=new e.Vector3(400,250,0),this.boundsOffset=new e.Vector3(0,0,-390),this.parent(t),this.boundsHalf=new e.Vector3(.5*this.bounds.x,.5*this.bounds.y,.5*this.bounds.z),this.motionVectors=[],this._desiredTotal=~~this.total.value,this.total.value=0,this._actualTotal=0,this.initMaterial(),this.initHooks()},initHooks:function(){this.parent(),this.total.onChangedSignal.add(function(t){t=~~t,_desiredTotal=t;var e=t-this._actualTotal;e>0?this.addParticles(~~e):0>e&&this.removeParticles(-~~e)}.bind(this))},addParticles:function(){this._actualTotal=~~this.total.value},removeParticles:function(){this._actualTotal=~~this.total.value},showOne:function(){this.display.visible=!0}});return a}),define("objects/SpriteParticles2",["Class","core/BaseObjectActive","three","text","text!shaders/PhongTriangleSpriteParticles.vsh","utils/ColorUtils","Global","objects/ParticleLayer","utils/FileUtils"],function(t,e,i,n,r,o,a,s,l){var h=new t({Extends:s,blendMode:null,size:10,motionVectors:null,physics:void 0,renderOnTop:!0,fog:!0,offsetZ:0,initialize:function(t){this.parent(t),this.initMaterial(),this.total.value=~~this._desiredTotal},initHooks:function(){this.parent(),this.size.onChangedSignal.add(function(t){this.materialObject.size=t}.bind(this)),this.material.color.onChangedSignal.add(function(t){this.materialObject.color.setHex(o.getHexNumber(t))}.bind(this)),this.material.image.onChangedSignal.add(function(t){l.verifyAndLoadTexture(t,this.materialObject,"map")}.bind(this)),this.renderOnTop.onChangedSignal.add(function(t){this.materialObject.depthTest=!t,this.materialObject.needsUpdate=!0}.bind(this)),this.fog.onChangedSignal.add(function(t){this.materialObject.fog=t,this.materialObject.needsUpdate=!0}.bind(this)),this.blendMode.blendSrc.onChangedSignal.add(function(t){this.display.material.blendSrc=i[t+"Factor"]}.bind(this)),this.blendMode.blendDst.onChangedSignal.add(function(t){this.display.material.blendDst=i[t+"Factor"]}.bind(this)),this.blendMode.blendEquation.onChangedSignal.add(function(t){this.display.material.blendEquation=i[t+"Equation"]}.bind(this))},addParticles:function(t){this.parent(t);var e=this.initGeometry();this.initPhysics(),this.resetDisplayObject(e)},removeParticles:function(t){this.parent(t);var e=this.initGeometry();this.initPhysics(),this.resetDisplayObject(e)},initMaterial:function(){this.materialObject=new i.ParticleBasicMaterial({color:this.material.color.value,size:this.size.value,transparent:!0,depthTest:!this.renderOnTop.value,blending:i.CustomBlending,blendSrc:i[this.blendMode.blendSrc.value+"Factor"],blendDst:i[this.blendMode.blendDst.value+"Factor"],blendEquation:i[this.blendMode.blendEquation.value+"Equation"],fog:this.fog.value}),l.verifyAndLoadTexture(this.material.image.value,this.materialObject,"map")},initGeometry:function(){var t;this.display&&(t=this.display.parent,t.remove(this.display),this.display=void 0),this.geometry&&this.geometry.dispose(),this.geometry=new i.Geometry;for(var e=this._actualTotal-1;e>=0;e--)this.geometry.vertices.push(new i.Vector3(Math.random()*this.bounds.x-this.boundsHalf.x,Math.random()*this.bounds.y-this.boundsHalf.y,Math.random()*this.bounds.z));return t},initPhysics:function(){this.motionVectors=new Float32Array(3*this._actualTotal);for(var t=this._actualTotal-1;t>=0;t--){var e=3*t;this.motionVectors[e]=0,this.motionVectors[e+1]=0,this.motionVectors[e+2]=0}},resetDisplayObject:function(t){this.display&&(t=this.display.parent,t.remove(this.display)),this.display=new i.ParticleSystem(this.geometry,this.materialObject),this.display.sortParticles=!0,this.display.position.z=this.boundsHalf.z,t&&(t.add(this.display),this._scene=t)},applyVectorField:function(t,e,n,r,o,a,s,l,h,c){for(var u=new i.Vector3(0,0,0),d=this.motionVectors,f=this.geometry.vertices,p=this._actualTotal,m=this.physics.responsiveness.value,g=this.physics.drag.value,v=~~(Math.random()*l),y=this.boundsHalf.z,E=p-1;E>=0;E--){var x=f[E],T=3*E,_=(Math.max(0,Math.min(n.x,~~(x.x*r.x+o.x)))+Math.max(0,Math.min(n.y,~~(x.y*r.y+o.y)))*e.x+Math.max(0,Math.min(n.z,~~((x.z+y)*r.z+o.z)))*e.xy)*a;for(u.x=(t[_]-d[T])*m,u.y=(t[_+1]-d[T+1])*m,u.z=(t[_+2]-d[T+2])*m,t[_]-=u.x,t[_+1]-=u.y,t[_+2]-=u.z,d[T]+=u.x,d[T+1]+=u.y,d[T+2]+=u.z,d[T]*=g,d[T+1]*=g,d[T+2]*=g,x.x+=d[T],x.y+=d[T+1],x.z+=d[T+2],d[T]+=s[v],d[T+1]+=s[v+1],d[T+2]+=s[v+2];x.x>c.x;)x.x-=h.x;for(;x.x<-c.x;)x.x+=h.x;for(;x.y>c.y;)x.y-=h.y;for(;x.y<-c.y;)x.y+=h.y;for(;x.z>0;)x.z-=h.z;for(;x.z<-h.z;)x.z+=h.z;v+=a}return this.geometry.__dirtyVertices=!0,this._actualTotal},destroy:function(){this.geometry.dispose(),this.materialObject.map&&this.materialObject.map.dispose(),this.materialObject.normalMap&&this.materialObject.normalMap.dispose(),this.materialObject.specularMap&&this.materialObject.specularMap.dispose(),this.materialObject.dispose()}});return h}),define("objects/CanvasParticles",["Class","three","core/BaseObjectActive","Global","utils/ColorUtils","utils/FileUtils","objects/ParticleLayer","managers/SceneManager"],function(t,e,i,n,r,o,a,s){var l=new t({Extends:a,scale:void 0,image:void 0,children:void 0,blendMode:"No",opacity:1,initialize:function(t){for(void 0===t.opacity&&(t.opacity={value:1,min:0,max:1,step:.01}),this.children=[];-1!=t.image._value.indexOf(" ");)t.image._value=t.image._value.replace(" ","_");this.parent(t),this.display=new e.Object3D,this.total.value=this._desiredTotal},initHooks:function(){this.parent(),this.scale.min.onChangedSignal.add(function(){this.reScale()}.bind(this)),this.scale.max.onChangedSignal.add(function(){this.reScale()}.bind(this)),this.image.onChangedSignal.add(function(t){this.materialObject&&(o.verifyAndLoadTexture(t,this.materialObject,"map"),this.cloneMaterials())}.bind(this)),this.opacity.onChangedSignal.add(function(t){this.materialObject.opacity=t}.bind(this)),this.blendMode.onChangedSignal.add(function(t){this.materialObject.blending=e[t+"Blending"]}.bind(this))},reScale:function(){for(var t=this.scale.max.value-this.scale.min.value,e=this.children.length-1;e>=0;e--){var i=this.children[e];i.scale.x=i.scale.y=i.scale.z=this.scale.min.value+i.scale.global*t}},initMaterial:function(){this.materialObject=new e.ParticleBasicMaterial({blending:e[this.blendMode.value+"Blending"],opacity:this.opacity.value}),o.verifyAndLoadTexture(this.image.value,this.materialObject,"map"),this.cloneMaterials()},cloneMaterials:function(){for(var t=this.children.length-1;t>=0;t--)this.children[t].material=this.materialObject.clone()},addParticles:function(t){for(var i=this.scale.max.value-this.scale.min.value,n=~~this.total.value-1;n>=this._actualTotal;n--){this.motionVectors[n]=new e.Vector3;var r=new e.Particle(this.materialObject.clone());r.name=this.model,r.scale.global=Math.random(),r.scale.x=r.scale.y=this.scale.min.value+r.scale.global*i;for(var o=Math.random()*this.bounds.x-this.boundsHalf.x,a=Math.random()*this.bounds.y-this.boundsHalf.y,s=Math.sqrt(o*o+a*a),l=50+100*Math.random();l>s;)o=Math.random()*this.bounds.x-this.boundsHalf.x,a=Math.random()*this.bounds.y-this.boundsHalf.y,s=Math.sqrt(o*o+a*a),l=50+100*Math.random();r.position.x=o,r.position.y=a,r.position.z=Math.random()*this.bounds.z-this.boundsHalf.z-this.boundsOffset.z,this.children[n]=r,this.display.add(r)}this.parent(t)},removeParticles:function(t){t=t>this._actualTotal?this._actualTotal:t;for(var e=this._actualTotal-t,i=this._actualTotal-1;i>=e;i--)this.display.remove(this.children[i]);this.children.splice(e,t),this.parent(t)},applyVectorField:function(t,i,n,r,o,a,l,h,c,u){for(var d=~~(Math.random()*h),f=new e.Vector3(0,0,0),p=this.physics.responsiveness.value,m=this.physics.drag.value,g=s.instance.fog,v=g.far.value-g.near.value,y=g.far.value,E=s.instance.camera.position.z,x=this.opacity.value,T=this._actualTotal-1;T>=0;T--){var _=this.children[T],b=_.position;b.x>u.x&&(b.x-=c.x),b.x<-u.x&&(b.x+=c.x),b.y>u.y&&(b.y-=c.y),b.y<-u.y&&(b.y+=c.y),b.z>u.z&&(b.z-=c.z),b.z<-u.z&&(b.z+=c.z);var w=_.position.z-E+y;_.material.opacity=Math.min(1,Math.max(w/v))*x;var R=this.motionVectors[T],S=(Math.max(0,Math.min(n.x,~~(b.x*r.x+o.x)))+Math.max(0,Math.min(n.y,~~(b.y*r.y+o.y)))*i.x+Math.max(0,Math.min(n.z,~~(b.z*r.z+o.z)))*i.xy)*a;f.x=(t[S]-R.x)*p,f.y=(t[S+1]-R.y)*p,f.z=(t[S+2]-R.z)*p,t[S]-=f.x,t[S+1]-=f.y,t[S+2]-=f.z,R.x+=f.x,R.y+=f.y,R.z+=f.z,R.x*=m,R.y*=m,R.z*=m,b.x+=R.x,b.y+=R.y,b.z+=R.z,R.x+=l[d],R.y+=l[d+1],R.z+=l[d+2]}return this._actualTotal},destroy:function(){for(var t=this._actualTotal-1;t>=0;t--){var e=this.children[t];e.material.dispose(),this.display.remove(e)}}});return l}),define("text!shaders/PhongShardParticles.vsh",[],function(){return"#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif\n#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif\n#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif\n#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif\n#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\n    float j = i * 4.0;\n    float x = mod( j, N_BONE_PIXEL_X );\n    float y = floor( j / N_BONE_PIXEL_X );\n    const float dx = 1.0 / N_BONE_PIXEL_X;\n    const float dy = 1.0 / N_BONE_PIXEL_Y;\n    y = dy * ( y + 0.5 );\n    vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n    vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n    vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n    vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n    mat4 bone = mat4( v1, v2, v3, v4 );\n    return bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\n    mat4 bone = boneGlobalMatrices[ int(i) ];\n    return bone;\n}\n#endif\n#endif\n#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif\n//begin injection\nmat4 rotationMatrix( const in vec3 axis, const in float angle)\n{\n    vec3 axisB = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    return mat4(oc * axisB.x * axisB.x + c, oc * axisB.x * axisB.y - axisB.z * s, oc * axisB.z * axisB.x + axisB.y * s, 0.0,\n                oc * axisB.x * axisB.y + axisB.z * s, oc * axisB.y * axisB.y + c, oc * axisB.y * axisB.z - axisB.x * s, 0.0,\n                oc * axisB.z * axisB.x - axisB.y * s, oc * axisB.y * axisB.z + axisB.x * s, oc * axisB.z * axisB.z + c, 0.0,\n                0.0, 0.0, 0.0, 1.0);\n}\nattribute vec3 motionPosition;\nattribute vec3 motionAxisAngle;\nattribute float spin;\n//end injection\nvoid main() {\n    //begin injection\n    mat4 spinMatrix = rotationMatrix(motionAxisAngle, spin);\n    vec3 myPosition = (spinMatrix * vec4(position, 0)).xyz;\n    myPosition.xyz += motionPosition;\n    //end injection\n    #if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\n    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n    #endif\n    #ifdef USE_LIGHTMAP\n    vUv2 = uv2;\n    #endif\n    #ifdef USE_COLOR\n    #ifdef GAMMA_INPUT\n    vColor = color * color;\n    #else\n    vColor = color;\n    #endif\n    #endif\n    #ifdef USE_MORPHNORMALS\n    vec3 morphedNormal = vec3( 0.0 );\n    morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n    morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n    morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n    morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n    morphedNormal += normal;\n    #endif\n    #ifdef USE_SKINNING\n    mat4 boneMatX = getBoneMatrix( skinIndex.x );\n    mat4 boneMatY = getBoneMatrix( skinIndex.y );\n    #endif\n    #ifdef USE_SKINNING\n    mat4 skinMatrix = skinWeight.x * boneMatX;\n    skinMatrix  += skinWeight.y * boneMatY;\n    #ifdef USE_MORPHNORMALS\n    vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n    #else\n    vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n    #endif\n    #endif\n    vec3 objectNormal;\n    #ifdef USE_SKINNING\n    objectNormal = skinnedNormal.xyz;\n    #endif\n    #if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\n    objectNormal = morphedNormal;\n    #endif\n    #if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\n    objectNormal = normal;\n    #endif\n    #ifdef FLIP_SIDED\n    objectNormal = -objectNormal;\n    #endif\n    vec3 transformedNormal = normalMatrix * objectNormal;\n    vNormal = normalize( transformedNormal );\n    //begin injection\n    vNormal = (spinMatrix * vec4(vNormal, 0)).xyz;\n    //end injection\n    #ifdef USE_MORPHTARGETS\n    vec3 morphed = vec3( 0.0 );\n    morphed += ( morphTarget0 - myPosition ) * morphTargetInfluences[ 0 ];\n    morphed += ( morphTarget1 - myPosition ) * morphTargetInfluences[ 1 ];\n    morphed += ( morphTarget2 - myPosition ) * morphTargetInfluences[ 2 ];\n    morphed += ( morphTarget3 - myPosition ) * morphTargetInfluences[ 3 ];\n    #ifndef USE_MORPHNORMALS\n    morphed += ( morphTarget4 - myPosition ) * morphTargetInfluences[ 4 ];\n    morphed += ( morphTarget5 - myPosition ) * morphTargetInfluences[ 5 ];\n    morphed += ( morphTarget6 - myPosition ) * morphTargetInfluences[ 6 ];\n    morphed += ( morphTarget7 - myPosition ) * morphTargetInfluences[ 7 ];\n    #endif\n    morphed += myPosition;\n    #endif\n    #ifdef USE_SKINNING\n    #ifdef USE_MORPHTARGETS\n    vec4 skinVertex = vec4( morphed, 1.0 );\n    #else\n    vec4 skinVertex = vec4( myPosition, 1.0 );\n    #endif\n    vec4 skinned  = boneMatX * skinVertex * skinWeight.x;\n    skinned       += boneMatY * skinVertex * skinWeight.y;\n    #endif\n    vec4 mvPosition;\n    #ifdef USE_SKINNING\n    mvPosition = modelViewMatrix * skinned;\n    #endif\n    #if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\n    mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n    #endif\n    #if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\n    mvPosition = modelViewMatrix * vec4( myPosition, 1.0 );\n    #endif\n    gl_Position = projectionMatrix * mvPosition;\n    vViewPosition = -mvPosition.xyz;\n    #if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n    #ifdef USE_SKINNING\n    vec4 worldPosition = modelMatrix * skinned;\n    #endif\n    #if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n    vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n    #endif\n    #if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n    vec4 worldPosition = modelMatrix * vec4( myPosition, 1.0 );\n    #endif\n    #endif\n    #if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\n    vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\n    worldNormal = normalize( worldNormal );\n    vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n    if ( useRefract ) {\n        vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n    } else {\n        vReflect = reflect( cameraToVertex, worldNormal );\n    }\n    #endif\n    #ifndef PHONG_PER_PIXEL\n    #if MAX_POINT_LIGHTS > 0\n    for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n        vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n        vec3 lVector = lPosition.xyz - mvPosition.xyz;\n        float lDistance = 1.0;\n        if ( pointLightDistance[ i ] > 0.0 )\n        lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n        vPointLight[ i ] = vec4( lVector, lDistance );\n    }\n    #endif\n    #if MAX_SPOT_LIGHTS > 0\n    for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n        vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n        vec3 lVector = lPosition.xyz - mvPosition.xyz;\n        float lDistance = 1.0;\n        if ( spotLightDistance[ i ] > 0.0 )\n        lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n        vSpotLight[ i ] = vec4( lVector, lDistance );\n    }\n    #endif\n    #endif\n    #if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\n    vWorldPosition = worldPosition.xyz;\n    #endif\n    #ifdef USE_SHADOWMAP\n    for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n        vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n    }\n    #endif\n}"
}),define("objects/ShardParticles",["Class","core/BaseObjectActive","three","text","text!shaders/PhongShardParticles.vsh","utils/ColorUtils"],function(t,e,i,n,r,o){var a=new t({Extends:e,display:void 0,geometry:void 0,material:void 0,materialObject:void 0,initd:!1,total:0,bounds:void 0,boundsOffset:void 0,boundsHalf:void 0,triangleSize:10,motionVectors:void 0,physics:void 0,initialize:function(t){this.bounds=new i.Vector3(400,250,0),this.boundsOffset=new i.Vector3(0,0,-390),this.parent(t),this.initd=!0,this.boundsHalf=new i.Vector3(.5*this.bounds.x,.5*this.bounds.y,.5*this.bounds.z),this.initMaterial(),this.initGeometry(),this.resetDisplayObject(),this.total.onChangedSignal.add(function(){this.initGeometry(),this.resetDisplayObject()}.bind(this)),this.triangleSize.onChangedSignal.add(function(){this._sizeChanged=!0,this.initGeometry(),this.resetDisplayObject()}.bind(this)),this.material.color.onChangedSignal.add(function(t){this.materialObject.uniforms.diffuse.value.r=o.hexToR(t)/255,this.materialObject.uniforms.diffuse.value.g=o.hexToG(t)/255,this.materialObject.uniforms.diffuse.value.b=o.hexToB(t)/255}.bind(this)),this.material.ambient.onChangedSignal.add(function(t){this.materialObject.uniforms.ambient.value.r=o.hexToR(t)/255,this.materialObject.uniforms.ambient.value.g=o.hexToG(t)/255,this.materialObject.uniforms.ambient.value.b=o.hexToB(t)/255}.bind(this)),this.material.specular.onChangedSignal.add(function(t){this.materialObject.uniforms.specular.value.r=o.hexToR(t)/255,this.materialObject.uniforms.specular.value.g=o.hexToG(t)/255,this.materialObject.uniforms.specular.value.b=o.hexToB(t)/255}.bind(this)),this.material.shininess.onChangedSignal.add(function(t){this.materialObject.uniforms.shininess.value=t}.bind(this))},onLightReset:function(){this.materialObject.needsUpdate=!0},initMaterial:function(){var t=i.ShaderLib.phong,e=i.UniformsUtils.clone(t.uniforms),n={motionPosition:{type:"v3",value:[]},motionAxisAngle:{type:"v3",value:[]},spin:{type:"f",value:[]}};this.materialObject=new i.ShaderMaterial({uniforms:e,vertexShader:r,fragmentShader:t.fragmentShader,attributes:n,lights:!0,fog:!0,side:i.DoubleSide}),this.materialObject.uniforms.diffuse.value.r=o.hexToR(this.material.color.value)/255,this.materialObject.uniforms.diffuse.value.g=o.hexToG(this.material.color.value)/255,this.materialObject.uniforms.diffuse.value.b=o.hexToB(this.material.color.value)/255,this.materialObject.uniforms.ambient.value.r=o.hexToR(this.material.ambient.value)/255,this.materialObject.uniforms.ambient.value.g=o.hexToG(this.material.ambient.value)/255,this.materialObject.uniforms.ambient.value.b=o.hexToB(this.material.ambient.value)/255,this.materialObject.uniforms.specular.value.r=o.hexToR(this.material.specular.value)/255,this.materialObject.uniforms.specular.value.g=o.hexToG(this.material.specular.value)/255,this.materialObject.uniforms.specular.value.b=o.hexToB(this.material.specular.value)/255,this.materialObject.uniforms.shininess.value=this.material.shininess.value},initGeometry:function(){var t=this.geometry,e=0;t&&!this.forceRegenerate&&(this.forceRegenerate=!1,e=this.geometry.attributes.index.numItems/3),this._sizeChanged&&(e=0,this._sizeChanged=!1),this.geometry=new i.BufferGeometry,this.geometry.dynamic=!0,this.geometry.attributes={index:{itemSize:1,array:new Uint16Array(3*~~this.total.value),numItems:3*~~this.total.value},position:{itemSize:3,array:new Float32Array(3*~~this.total.value*3),numItems:3*~~this.total.value*3},normal:{itemSize:3,array:new Float32Array(3*~~this.total.value*3),numItems:3*~~this.total.value*3},color:{itemSize:3,array:new Float32Array(3*~~this.total.value*3),numItems:3*~~this.total.value*3},motionPosition:{itemSize:3,array:new Float32Array(3*~~this.total.value*3),numItems:3*~~this.total.value*3},motionAxisAngle:{itemSize:3,array:new Float32Array(3*~~this.total.value*3),numItems:3*~~this.total.value*3},spin:{itemSize:1,array:new Float32Array(3*~~this.total.value),numItems:3*~~this.total.value}};for(var n=21845,r=this.geometry.attributes.index.array,o=0;o<r.length;o++)r[o]=o%(3*n);var a,s=this.geometry.attributes.position.array,l=this.geometry.attributes.normal.array,h=this.geometry.attributes.color.array,c=this.geometry.attributes.motionPosition.array,u=this.geometry.attributes.motionAxisAngle.array,d=this.geometry.attributes.spin.array;t&&(a=this.motionVectors),this.motionVectors=new Float32Array(3*~~this.total.value);for(var o=~~this.total.value-1;o>=e;--o){var f=3*o;this.motionVectors[f]=0,this.motionVectors[f+1]=0,this.motionVectors[f+2]=0}for(var o=e-1;o>=0;--o){var f=3*o;this.motionVectors[f]=a[f],this.motionVectors[f+1]=a[f+1],this.motionVectors[f+2]=a[f+2]}for(var p=this.bounds.x,m=p/2,g=this.bounds.y,v=g/2,y=this.bounds.z,E=y/2,x=1+Math.random()*this.triangleSize.value,T=x/2,_=new i.Vector3,b=new i.Vector3,w=new i.Vector3,R=new i.Vector3,S=new i.Vector3,_=new i.Vector3,b=new i.Vector3,w=new i.Vector3,R=new i.Vector3,S=new i.Vector3,M=this.boundsOffset.z,o=~~this.total.value-1;o>=e;--o){var f=3*o,H=9*o;x=Math.random()*this.triangleSize.value*.5+.5*this.triangleSize.value,T=x/2;for(var C=Math.random()*p-m,A=Math.random()*g-v,P=Math.sqrt(C*C+A*A),L=50+100*Math.random();L>P;)C=Math.random()*p-m,A=Math.random()*g-v,P=Math.sqrt(C*C+A*A),L=50+100*Math.random();var O=Math.random()*y-E-M,D=Math.random()*x-T,z=Math.random()*x-T,N=Math.random()*x-T,F=Math.random()*x-T,U=Math.random()*x-T,I=Math.random()*x-T,k=Math.random()*x-T,V=Math.random()*x-T,B=Math.random()*x-T;s[H]=D,s[H+1]=z,s[H+2]=N,s[H+3]=F,s[H+4]=U,s[H+5]=I,s[H+6]=k,s[H+7]=V,s[H+8]=B,c[H]=C,c[H+1]=A,c[H+2]=O,c[H+3]=C,c[H+4]=A,c[H+5]=O,c[H+6]=C,c[H+7]=A,c[H+8]=O,_.set(D,z,N),b.set(F,U,I),w.set(k,V,B),R.subVectors(w,b),S.subVectors(_,b),R.cross(S),R.normalize();var j=R.x,G=R.y,W=R.z;l[H]=j,l[H+1]=G,l[H+2]=W,l[H+3]=j,l[H+4]=G,l[H+5]=W,l[H+6]=j,l[H+7]=G,l[H+8]=W,h[H]=Math.random(),h[H+1]=Math.random(),h[H+2]=Math.random(),h[H+3]=Math.random(),h[H+4]=Math.random(),h[H+5]=Math.random(),h[H+6]=Math.random(),h[H+7]=Math.random(),h[H+8]=Math.random();var X=Math.random(),q=Math.random(),Y=Math.random();u[H]=X,u[H+1]=q,u[H+2]=Y,u[H+3]=X,u[H+4]=q,u[H+5]=Y,u[H+6]=X,u[H+7]=q,u[H+8]=Y,d[f]=d[f+1]=d[f+2]=0}if(t){for(var K=t.attributes.position.array,$=t.attributes.normal.array,Q=t.attributes.color.array,Z=t.attributes.motionPosition.array,J=t.attributes.motionAxisAngle.array,te=t.attributes.spin.array,o=e-1;o>=0;--o){for(var f=3*o,ee=8;ee>=0;--ee){var H=9*o+ee;s[H]=K[H],c[H]=Z[H],l[H]=$[H],h[H]=Q[H],u[H]=J[H]}d[f]=d[f+1]=d[f+2]=te[f]}t.dispose()}this.geometry.offsets=[];for(var ie=~~this.total.value/n,o=0;ie>o;o++){var ne={start:o*n*3,index:o*n*3,count:3*Math.min(~~this.total.value-o*n,n)};this.geometry.offsets.push(ne)}this.geometry.computeBoundingSphere()},resetDisplayObject:function(){var t;this.display&&(t=this.display.parent,t.remove(this.display)),this.display=new i.Mesh(this.geometry,this.materialObject),t&&t.add(this.display)},applyVectorField:function(t,e,n,r,o,a,s,l,h,c){for(var u=.03,d=this.geometry.attributes.motionPosition,f=d.array,p=this.geometry.attributes.spin,m=p.array,g=new i.Vector3(0,0,0),v=this.motionVectors,y=~~this.total.value,E=this.physics.responsiveness.value,x=this.physics.drag.value,T=~~(Math.random()*l),_=y-1;_>=0;_--){var b=3*_,w=3*b,R=w+3,S=w+6,M=(Math.max(0,Math.min(n.x,~~(f[w]*r.x+o.x)))+Math.max(0,Math.min(n.y,~~(f[w+1]*r.y+o.y)))*e.x+Math.max(0,Math.min(n.z,~~(f[w+2]*r.z+o.z)))*e.xy)*a;for(g.x=(t[M]-v[b])*E,g.y=(t[M+1]-v[b+1])*E,g.z=(t[M+2]-v[b+2])*E,t[M]-=g.x,t[M+1]-=g.y,t[M+2]-=g.z,v[b]+=g.x,v[b+1]+=g.y,v[b+2]+=g.z,v[b]*=x,v[b+1]*=x,v[b+2]*=x,f[w]+=v[b],f[w+1]+=v[b+1],f[w+2]+=v[b+2],v[b]+=s[T],v[b+1]+=s[T+1],v[b+2]+=s[T+2];f[w]>c.x;)f[w]-=h.x;for(;f[w]<-c.x;)f[w]+=h.x;for(;f[w+1]>c.y;)f[w+1]-=h.y;for(;f[w+1]<-c.y;)f[w+1]+=h.y;for(;f[w+2]>c.z;)f[w+2]-=h.z;for(;f[w+2]<-c.z;)f[w+2]+=h.z;f[R]=f[S]=f[w],f[R+1]=f[S+1]=f[w+1],f[R+2]=f[S+2]=f[w+2],m[b]=m[b+1]=m[b+2]+=u,T+=a}return p.needsUpdate=!0,d.needsUpdate=!0,~~this.total.value},destroy:function(){this.materialObject.map&&this.materialObject.map.dispose(),this.materialObject.normalMap&&this.materialObject.normalMap.dispose(),this.materialObject.specularMap&&this.materialObject.specularMap.dispose(),this.materialObject.dispose(),this.geometry.dispose()},hide:function(){this.display.visible=!1},show:function(){this.display.visible=!0},showOne:function(){this.totalBackup=~~this.total.value,this.forceRegenerate=!0,this.total.value=1,this.display.visible=!0;var t=this.geometry.attributes.motionPosition.array;t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=0;var e=this.geometry.attributes.spin.array;e[0]=e[1]=e[2]=100*Math.random()}});return a}),define("objects/MeshParticles",["Class","three","core/BaseObjectActive","Global","utils/ColorUtils","utils/FileUtils","objects/ParticleLayer"],function(t,e,i,n,r,o,a){var s=new t({Extends:a,scale:void 0,mesh:void 0,shouldRememberPreviousPositions:!1,previousPositions:void 0,spinsCached:void 0,children:void 0,onLoadCallback:void 0,loaded:!1,universalScale:.01,initialize:function(t){switch(this.parent(t),this.children=[],this.spins=[],this.spinsCached=[],this.physics.spin.mode.value){case"upright":this.spinFunc=this.spinFuncUpright,this.shouldRememberPreviousPositions=!0,this.previousPositions=[];break;default:this.spinFunc=this.spinFuncNormal}this.display=new e.Object3D},onLightReset:function(){this.materialObject.needsUpdate=!0},initHooks:function(){this.parent(),this.scale.min.onChangedSignal.add(function(){this.reScale()}.bind(this)),this.scale.max.onChangedSignal.add(function(){this.reScale()}.bind(this)),this.physics.spin.strength.onChangedSignal.add(function(t){this.reSpin(t)}.bind(this)),this.material.color.onChangedSignal.add(function(t){this.materialObject.color.setHex(r.getHexNumber(t))}.bind(this)),this.material.ambient.onChangedSignal.add(function(t){this.materialObject.ambient.setHex(r.getHexNumber(t))}.bind(this)),this.material.specular.onChangedSignal.add(function(t){this.materialObject.specular.setHex(r.getHexNumber(t))}.bind(this)),this.material.emissive.onChangedSignal.add(function(t){this.materialObject.emissive.setHex(r.getHexNumber(t))}.bind(this)),this.material.shininess.onChangedSignal.add(function(t){this.materialObject.shininess=t}.bind(this)),this.mesh.onChangedSignal.add(function(t){this.verifyAndLoadMesh(t)}.bind(this)),this.material.shading.onChangedSignal.add(function(t){this.materialObject.shading=e[t+"Shading"]}.bind(this)),this.material.textures.diffuse.onChangedSignal.add(function(t){o.verifyAndLoadTexture(t,this.materialObject,"map",this.updateGeometry.bind(this))}.bind(this)),this.material.textures.normal.onChangedSignal.add(function(t){o.verifyAndLoadTexture(t,this.materialObject,"normalMap",this.updateGeometry.bind(this))}.bind(this)),this.material.textures.specular.onChangedSignal.add(function(t){o.verifyAndLoadTexture(t,this.materialObject,"specularMap",this.updateGeometry.bind(this))}.bind(this))},verifyAndLoadMesh:function(t){this.loaded=!1,t.indexOf(".json")==t.length-5&&this._meshURL!=t&&(this._meshURL=t,o.fileExists(t)&&this.load())},reSpin:function(t){for(var e=this._actualTotal-1;e>=0;e--){var i=3*e;this.spinsCached[i]=this.spins[i]*t,this.spinsCached[i+1]=this.spins[i+1]*t}},reScale:function(){for(var t=this.scale.max.value-this.scale.min.value,e=this.children.length-1;e>=0;e--){var i=this.children[e];i.scale.x=i.scale.y=i.scale.z=(this.scale.min.value+i.scale.global*t)*this.universalScale}},initMaterial:function(){this.materialObject=new e.MeshPhongMaterial({shininess:this.material.shininess.value,lights:!0,fog:!0,color:this.material.color.value,shininess:this.material.shininess.value,ambient:this.material.ambient.value,specular:this.material.specular.value,emissive:this.material.emissive.value,overdraw:!0,shading:e[this.material.shading.value+"Shading"]}),o.verifyAndLoadTexture(this.material.textures.diffuse.value,this.materialObject,"map",this.updateGeometry.bind(this)),o.verifyAndLoadTexture(this.material.textures.normal.value,this.materialObject,"normalMap",this.updateGeometry.bind(this)),o.verifyAndLoadTexture(this.material.textures.specular.value,this.materialObject,"specularMap",this.updateGeometry.bind(this))},load:function(t){this.onLoadCallback=t;var i=new e.JSONLoader;i.load(n.assetsPath+this.mesh.value,this.modelLoadComplete.bind(this)),this.loaded=!1},modelLoadComplete:function(t){this.loaded=!0,this.geometry&&this.geometry.dispose(),this.geometry=t,t.computeFaceNormals(),t.computeVertexNormals();for(var i=this.children.length-1;i>=0;i--){var n=this.children[i];this.display.remove(n);var r=new e.Mesh(t,n.material);r.position.copy(n.position),r.scale.copy(n.scale),r.scale.global=n.scale.global,this.display.add(r),this.children[i]=r}this.total.value=this._desiredTotal,this.onLoadCallback&&this.onLoadCallback(this)},addParticles:function(t){if(this.loaded){for(var i=this.scale.max.value-this.scale.min.value,n=~~this.total.value-1;n>=this._actualTotal;n--){var r=3*n;this.motionVectors[n]=new e.Vector3;var o=new e.Mesh(this.geometry,this.materialObject);o.name=this.model,o.rotation.x=1e3*Math.random(),o.rotation.y=1e3*Math.random(),o.rotation.z=1e3*Math.random(),o.scale.global=Math.random(),o.scale.x=o.scale.y=o.scale.z=(this.scale.min.value+o.scale.global*i)*this.universalScale,o.position.x=Math.random()*this.bounds.x-this.boundsHalf.x,o.position.y=Math.random()*this.bounds.y-this.boundsHalf.y,o.position.z=Math.random()*this.bounds.z-this.boundsHalf.z,this.children[n]=o,this.spins[r]=Math.random()-.5,this.spins[r+1]=Math.random()-.5,this.spinsCached[r]=this.spins[r]*this.physics.spin.strength.value,this.spinsCached[r+1]=this.spins[r+1]*this.physics.spin.strength.value,this.shouldRememberPreviousPositions&&(this.previousPositions[n]=o.position.clone()),this.display.add(o)}this.parent(t)}},removeParticles:function(t){if(this.loaded){t=t>this._actualTotal?this._actualTotal:t;for(var e=this._actualTotal-t,i=this._actualTotal-1;i>=e;i--)this.display.remove(this.children[i]);this.children.splice(e,t),this.parent(t)}},rememberPreviousPositions:function(){for(var t=this._actualTotal-1;t>=0;t--){var e=this.previousPositions[t],i=this.children[t],n=i.position;e.x-=(e.x-n.x)*this.physics.spin.strength.value,e.y-=(e.y-n.y)*this.physics.spin.strength.value,e.z-=(e.z-n.z)*this.physics.spin.strength.value}},applyVectorField:function(t,i,n,r,o,a,s,l,h,c){if(this.loaded){{var u=~~(Math.random()*l),d=new e.Vector3(0,0,0),f=this.physics.responsiveness.value,p=this.physics.drag.value;this.spins}this.shouldRememberPreviousPositions&&this.rememberPreviousPositions();for(var m=this._actualTotal-1;m>=0;m--){var g=this.children[m],v=this.motionVectors[m],y=g.position,E=(Math.max(0,Math.min(n.x,~~(y.x*r.x+o.x)))+Math.max(0,Math.min(n.y,~~(y.y*r.y+o.y)))*i.x+Math.max(0,Math.min(n.z,~~(y.z*r.z+o.z)))*i.xy)*a;d.x=(t[E]-v.x)*f,d.y=(t[E+1]-v.y)*f,d.z=(t[E+2]-v.z)*f,t[E]-=d.x,t[E+1]-=d.y,t[E+2]-=d.z,v.x+=d.x,v.y+=d.y,v.z+=d.z,v.x*=p,v.y*=p,v.z*=p,y.x+=v.x,y.y+=v.y,y.z+=v.z,v.x+=s[u],v.y+=s[u+1],v.z+=s[u+2],y.x>c.x&&(y.x-=h.x,this.shouldRememberPreviousPositions&&(this.previousPositions[m].x-=h.x)),y.x<-c.x&&(y.x+=h.x,this.shouldRememberPreviousPositions&&(this.previousPositions[m].x+=h.x)),y.y>c.y&&(y.y-=h.y,this.shouldRememberPreviousPositions&&(this.previousPositions[m].y-=h.y)),y.y<-c.y&&(y.y+=h.y,this.shouldRememberPreviousPositions&&(this.previousPositions[m].y+=h.y)),y.z>c.z&&(y.z-=h.z,this.shouldRememberPreviousPositions&&(this.previousPositions[m].z-=h.z)),y.z<-c.z&&(y.z+=h.z,this.shouldRememberPreviousPositions&&(this.previousPositions[m].z+=h.z)),this.spinFunc(g,m)}return this._actualTotal}},updateGeometry:function(){this.geometry&&(this.geometry.buffersNeedUpdate=!0,this.geometry.uvsNeedUpdate=!0)},spinFuncNormal:function(t,e){var i=3*e;t.rotation.x+=this.spinsCached[i],t.rotation.y+=this.spinsCached[i+1]},spinFuncUpright:function(t,e){var i=this.previousPositions[e].y;this.previousPositions[e].y-=2*(this.previousPositions[e].y-t.position.y),t.lookAt(this.previousPositions[e]),this.previousPositions[e].y=i},hide:function(){for(var t=this.children.length-1;t>=0;t--)this.children[t].visible=!1;this.parent()},show:function(){for(var t=this.children.length-1;t>=0;t--)this.children[t].visible=!0;this.parent()},showOne:function(){if(!(~~this.total.value<1)){var t=this.children[~~(Math.random()*this._actualTotal)];t.visible=!0,t.position.x=t.position.y=t.position.z=0,t.scale.x=t.scale.y=t.scale.z=this.scale.max.value*this.universalScale}},destroy:function(){this.materialObject.map&&this.materialObject.map.dispose(),this.materialObject.normalMap&&this.materialObject.normalMap.dispose(),this.materialObject.specularMap&&this.materialObject.specularMap.dispose(),this.materialObject&&this.materialObject.dispose(),this.geometry&&this.geometry.dispose()}});return s}),define("objects/MeshObject",["Class","three","Global","utils/FileUtils","utils/ColorUtils","objects/Layer"],function(t,e,i,n,r,o){var a=new t({Extends:o,transform:null,mesh:void 0,onLoadCallback:void 0,loaded:!1,universalScale:.01,initialize:function(t){void 0===t.transform.position&&(t.transform.position={x:{value:0,min:-500,max:500,step:.01},y:{value:0,min:-500,max:500,step:.01},z:{value:0,min:-500,max:500,step:.01}}),void 0===t.transform.rotation&&(t.transform.rotation={x:{value:0,min:-180,max:180,step:.01},y:{value:0,min:-180,max:180,step:.01},z:{value:0,min:-180,max:180,step:.01}}),this.parent(t),this.initMaterial(),this.initHooks()},onLightReset:function(){this.materialObject.needsUpdate=!0},initMaterial:function(){this.materialObject=new e.MeshPhongMaterial({shininess:this.material.shininess.value,lights:!0,fog:!0,color:this.material.color.value,shininess:this.material.shininess.value,ambient:this.material.ambient.value,specular:this.material.specular.value,emissive:this.material.emissive.value,overdraw:!0,shading:e[this.material.shading.value+"Shading"]}),n.verifyAndLoadTexture(this.material.textures.diffuse.value,this.materialObject,"map",this.updateGeometry.bind(this)),n.verifyAndLoadTexture(this.material.textures.normal.value,this.materialObject,"normalMap",this.updateGeometry.bind(this)),n.verifyAndLoadTexture(this.material.textures.specular.value,this.materialObject,"specularMap",this.updateGeometry.bind(this))},load:function(t){this.onLoadCallback=t;var n=new e.JSONLoader;n.load(i.assetsPath+this.mesh.value,this.modelLoadComplete.bind(this)),this.loaded=!1},modelLoadComplete:function(t){if(this.loaded=!0,this.geometry&&this.geometry.dispose(),this.geometry=t,t.computeFaceNormals(),t.computeVertexNormals(),this.display&&this.display.parent){var i=this.display,n=this.display.parent;n.remove(this.display);var r=new e.Mesh(t,i.material);r.position.copy(i.position),r.scale.copy(i.scale),n.add(r)}else this.display=new e.Mesh(t,this.materialObject),this.display.scale.x=this.display.scale.y=this.display.scale.z=this.transform.scale.value*this.universalScale,this.display.position.x=this.transform.position.x.value,this.display.position.y=this.transform.position.y.value,this.display.position.z=this.transform.position.z.value,this.display.rotation.x=this.transform.rotation.x.value*Math.PI/180,this.display.rotation.y=this.transform.rotation.y.value*Math.PI/180,this.display.rotation.z=this.transform.rotation.z.value*Math.PI/180;this.onLoadCallback&&this.onLoadCallback(this)},initHooks:function(){this.parent(),this.transform.scale.onChangedSignal.add(function(t){this.display&&(this.display.scale.x=this.display.scale.y=this.display.scale.z=t*this.universalScale)}.bind(this)),this.transform.position.x.onChangedSignal.add(function(t){this.display&&(this.display.position.x=t)}.bind(this)),this.transform.position.y.onChangedSignal.add(function(t){this.display&&(this.display.position.y=t)}.bind(this)),this.transform.position.z.onChangedSignal.add(function(t){this.display&&(this.display.position.z=t)}.bind(this)),this.transform.rotation.x.onChangedSignal.add(function(t){this.display&&(this.display.rotation.x=t*Math.PI/180)}.bind(this)),this.transform.rotation.y.onChangedSignal.add(function(t){this.display&&(this.display.rotation.y=t*Math.PI/180)}.bind(this)),this.transform.rotation.z.onChangedSignal.add(function(t){this.display&&(this.display.rotation.z=t*Math.PI/180)}.bind(this)),this.transform.scale.onChangedSignal.add(function(t){this.display&&(this.display.scale.x=this.display.scale.y=this.display.scale.z=t*this.universalScale)}.bind(this)),this.material.color.onChangedSignal.add(function(t){this.materialObject.color.setHex(r.getHexNumber(t))}.bind(this)),this.material.ambient.onChangedSignal.add(function(t){this.materialObject.ambient.setHex(r.getHexNumber(t))}.bind(this)),this.material.specular.onChangedSignal.add(function(t){this.materialObject.specular.setHex(r.getHexNumber(t))}.bind(this)),this.material.emissive.onChangedSignal.add(function(t){this.materialObject.emissive.setHex(r.getHexNumber(t))}.bind(this)),this.material.shininess.onChangedSignal.add(function(t){this.materialObject.shininess=t}.bind(this)),this.mesh.onChangedSignal.add(function(t){this.verifyAndLoadMesh(t)}.bind(this)),this.material.shading.onChangedSignal.add(function(t){this.materialObject.shading=e[t+"Shading"]}.bind(this)),this.material.textures.diffuse.onChangedSignal.add(function(t){n.verifyAndLoadTexture(t,this.materialObject,"map",this.updateGeometry.bind(this))}.bind(this)),this.material.textures.normal.onChangedSignal.add(function(t){n.verifyAndLoadTexture(t,this.materialObject,"normalMap",this.updateGeometry.bind(this))}.bind(this)),this.material.textures.specular.onChangedSignal.add(function(t){n.verifyAndLoadTexture(t,this.materialObject,"specularMap",this.updateGeometry.bind(this))}.bind(this))},verifyAndLoadMesh:function(t){this.loaded=!1,t.indexOf(".json")==t.length-5&&this._meshURL!=t&&(this._meshURL=t,n.fileExists(t)&&this.load())},updateGeometry:function(){this.geometry&&(this.geometry.buffersNeedUpdate=!0,this.geometry.uvsNeedUpdate=!0)},destroy:function(){this.materialObject.map&&this.materialObject.map.dispose(),this.materialObject.normalMap&&this.materialObject.normalMap.dispose(),this.materialObject.specularMap&&this.materialObject.specularMap.dispose(),this.materialObject&&this.materialObject.dispose(),this.geometry&&this.geometry.dispose()}});return a}),define("objects/SphereObject",["Class","three","core/BaseObject"],function(t,e,i){var n=new t({Extends:i,display:null,radius:100,segsLat:8,segsLong:16,x:0,y:0,z:0,color:"#3f3f00",ambient:"#ff0000",emissive:"#dd3a20",specular:"#ffffff",shininess:100,motionVector:null,diffuseMap:null,specularMap:null,normalMap:null,inertia:.01,responsiveness:.05,drag:.99,initialize:function(t){this.parent(t);var i=new e.MeshPhongMaterial({map:e.ImageUtils.loadTexture(this.diffuseMap),color:this.color,shininess:this.shininess,ambient:this.ambient,specular:this.specular,lights:!0,fog:!0,normalMap:e.ImageUtils.loadTexture(this.normalMap),specularMap:e.ImageUtils.loadTexture(this.specularMap)});this.motionVector=new e.Vector3,this.display=new e.Mesh(new e.SphereGeometry(this.radius,this.segsLong,this.segsLat),i),this.display.position.x=this.x,this.display.position.y=this.y,this.display.position.z=this.z},applyVectorField:function(t,i,n,r,o,a,s,l,h,c){var u=~~(Math.random()*l),d=this.display.position,f=this.responsiveness,p=this.drag,m=new e.Vector3(0,0,0),g=this.motionVectors,v=(Math.max(0,Math.min(n.x,~~(d.x*r.x+o.x)))+Math.max(0,Math.min(n.y,~~(d.y*r.y+o.y)))*i.x+Math.max(0,Math.min(n.z,~~(d.z*r.z+o.z)))*i.xy)*a;for(m.x=(t[v]-g.x)*f,m.y=(t[v+1]-g.y)*f,m.z=(t[v+2]-g.z)*f,t[v]-=m.x,t[v+1]-=m.y,t[v+2]-=m.z,g.x+=m.x,g.y+=m.y,g.z+=m.z,g.x*=p,g.y*=p,g.z*=p,d.x+=g.x,d.y+=g.y,d.z+=g.z,g.x+=s[u],g.y+=s[u+1],g.z+=s[u+2];d.x>c.x;)d.x-=h.x;for(;d.x<-c.x;)d.x+=h.x;for(;d.y>c.y;)d.y-=h.y;for(;d.y<-c.y;)d.y+=h.y;for(;d.z>c.z;)d.z-=h.z;for(;d.z<-c.z;)d.z+=h.z}});return n}),define("objects/SphereParticles",["Class","three","core/BaseObject"],function(t,e,i){var n=new t({Extends:i,display:null,radius:100,segsLat:8,segsLong:16,xMin:0,yMin:0,zMin:0,xMax:100,yMax:100,zMax:100,scaleMin:1,scaleMax:3,color:"#3f3f00",ambient:"#ff0000",emissive:"#dd3a20",specular:"#ffffff",shininess:100,motionVectors:null,spins:null,diffuseMap:null,specularMap:null,normalMap:null,inertia:.01,responsiveness:.05,drag:.99,total:10,children:null,spinStrength:.1,initialize:function(t){this.parent(t),this.children=[],this.spins=[],this.motionVectors=[];for(var i=new e.MeshPhongMaterial({map:e.ImageUtils.loadTexture(this.diffuseMap),color:this.color,shininess:this.shininess,ambient:this.ambient,specular:this.specular,lights:!0,fog:!0,normalMap:e.ImageUtils.loadTexture(this.normalMap),specularMap:e.ImageUtils.loadTexture(this.specularMap),normalScale:new e.Vector2(2,2)}),n=new e.SphereGeometry(this.radius,this.segsLong,this.segsLat),r=this.total-1;r>=0;r--){var o=3*r;this.motionVectors[r]=new e.Vector3;var a=new e.Mesh(n,i),s=this.xMax-this.xMin,l=this.yMax-this.yMin,h=this.zMax-this.zMin,c=this.scaleMax-this.scaleMin;a.scale.x=a.scale.y=a.scale.z=this.scaleMin+Math.random()*c,a.position.x=this.xMin+Math.random()*s,a.position.y=this.yMin+Math.random()*l,a.position.z=this.zMin+Math.random()*h,this.children[r]=a,this.spins[o]=(Math.random()-.5)*this.spinStrength,this.spins[o+1]=(Math.random()-.5)*this.spinStrength}},applyVectorField:function(t,i,n,r,o,a,s,l,h,c){for(var u=~~(Math.random()*l),d=this.total-1;d>=0;d--){var f=3*d,p=this.children[d],m=this.motionVectors[d],g=p.position,v=new e.Vector3(0,0,0),y=(Math.max(0,Math.min(n.x,~~(g.x*r.x+o.x)))+Math.max(0,Math.min(n.y,~~(g.y*r.y+o.y)))*i.x+Math.max(0,Math.min(n.z,~~(g.z*r.z+o.z)))*i.xy)*a;for(v.x=(t[y]-m.x)*this.responsiveness,v.y=(t[y+1]-m.y)*this.responsiveness,v.z=(t[y+2]-m.z)*this.responsiveness,t[y]-=v.x,t[y+1]-=v.y,t[y+2]-=v.z,m.x+=v.x,m.y+=v.y,m.z+=v.z,m.x*=this.drag,m.y*=this.drag,m.z*=this.drag,g.x+=m.x,g.y+=m.y,g.z+=m.z,m.x+=s[u],m.y+=s[u+1],m.z+=s[u+2];g.x>c.x;)g.x-=h.x;for(;g.x<-c.x;)g.x+=h.x;for(;g.y>c.y;)g.y-=h.y;for(;g.y<-c.y;)g.y+=h.y;for(;g.z>c.z;)g.z-=h.z;for(;g.z<-c.z;)g.z+=h.z;p.rotation.x+=this.spins[f],p.rotation.y+=this.spins[f+1]}}});return n}),define("objects/WireCloud",["Class","three","core/BaseObject"],function(t,e,i){var n=new t({Extends:i,xMin:0,yMin:0,zMin:0,xMax:100,yMax:100,zMax:100,color:"#ffffff",ambient:"#1f7fff",emissive:"#dd3a20",positions:null,positions2:null,motionVectors:null,inertia:.01,responsiveness:.05,drag:.99,vertexCount:10,display:null,idealDistance:30,initialize:function(t){this.parent(t),this.positions=[],this.positions2=[],this.motionVectors=[];for(var i=new e.LineBasicMaterial({color:this.color}),n=new e.Geometry,r=this.xMax-this.xMin,o=this.yMax-this.yMin,a=this.zMax-this.zMin,s=(this.scaleMax-this.scaleMin,this.vertexCount-1);s>=0;s--){this.positions[s]=new e.Vector3(this.xMin+Math.random()*r,this.yMin+Math.random()*o,this.zMin+Math.random()*a),this.motionVectors[s]=new e.Vector3,s<this.vertexCount-1&&(this.positions2[s]=this.positions[s+1])}this.positions2[this.vertexCount-1]=this.positions[0];for(var s=this.vertexCount-2;s>=0;s--)n.vertices.push(this.positions[s+1]),n.vertices.push(this.positions[s]);n.vertices.push(this.positions[0]),n.vertices.push(this.positions[this.vertexCount-1]),this.display=new e.Line(n,i,e.LinePieces),this.display.dynamic=!0,n.dynamic=!0,n.computeLineDistances()},applyVectorField:function(t,i,n,r,o,a,s,l,h,c){for(var u=~~(Math.random()*l),d=new e.Vector3(0,0,0),f=new e.Vector3(0,0,0),p=this.idealDistance,m=this.responsiveness,g=this.drag,v=this.vertexCount-1;v>=0;v--){var y=this.motionVectors[v],E=this.positions[v],x=this.positions2[v];f.x=E.x-x.x,f.y=E.y-x.y,f.z=E.z-x.z,f.multiplyScalar(.001*(f.length()/p-1)),E.sub(f);var T=(Math.max(0,Math.min(n.x,~~(E.x*r.x+o.x)))+Math.max(0,Math.min(n.y,~~(E.y*r.y+o.y)))*i.x+Math.max(0,Math.min(n.z,~~(E.z*r.z+o.z)))*i.xy)*a;for(d.x=(t[T]-y.x)*m,d.y=(t[T+1]-y.y)*m,d.z=(t[T+2]-y.z)*m,t[T]-=d.x,t[T+1]-=d.y,t[T+2]-=d.z,y.x+=d.x,y.y+=d.y,y.z+=d.z,y.x*=g,y.y*=g,y.z*=g,E.x+=y.x,E.y+=y.y,E.z+=y.z,y.x+=s[u],y.y+=s[u+1],y.z+=s[u+2];E.x>c.x;)E.x-=h.x;for(;E.x<-c.x;)E.x+=h.x;for(;E.y>c.y;)E.y-=h.y;for(;E.y<-c.y;)E.y+=h.y;for(;E.z>c.z;)E.z-=h.z;for(;E.z<-c.z;)E.z+=h.z}this.display.geometry.verticesNeedUpdate=!0,this.display.geometry.computeLineDistances()}});return n}),define("physics/VectorField",["Class","core/BaseObjectActive","three","objects/CanvasParticles","objects/ShardParticles","objects/SpriteParticles2","objects/SphereObject","objects/SphereParticles","objects/MeshParticles","objects/WireCloud","Global"],function(t,e,i,n,r,o,a,s,l,h,c){var u=new t({Extends:e,resolution:void 0,resolutionMinusOne:void 0,size:void 0,sizeHalf:void 0,position:void 0,posToIndexScale:void 0,posToIndexTranslate:void 0,dimensions:3,fade:.99,spin:void 0,motion:void 0,attractionToMiddle:void 0,randomness:void 0,timeScale:void 0,randomValues:void 0,randomValuesOffset:1e4,randomValueScale:.1,data:void 0,restingData:void 0,objects:void 0,dirty:0,translateX:0,translateY:0,translateZ:0,initialize:function(t){this.objects=[],this.parent(t)},setParams:function(t){t.strength&&delete t.strength,t.type&&delete t.type,t.spin||(t.spin={x:{value:0,min:-10,max:10,step:.01},y:{value:0,min:-10,max:10,step:.01},z:{value:0,min:-10,max:10,step:.01}}),t.motion||(t.motion={x:{value:0,min:-10,max:10,step:.01},y:{value:0,min:-10,max:10,step:.01},z:{value:0,min:-10,max:10,step:.01}}),t.attractionToMiddle||(t.attractionToMiddle={x:{value:.01,min:0,max:1,step:.01},y:{value:.01,min:0,max:1,step:.01},z:{value:.01,min:0,max:1,step:.01}}),t.randomness||(t.randomness={x:{value:.5,min:0,max:10,step:.001},y:{value:.5,min:0,max:10,step:.001},z:{value:.5,min:0,max:10,step:.001}}),t.timeScale||(t.timeScale={value:1,min:-3,max:3,step:.001}),this.parent(t),this.resolution=this.resolution?this.resolution:new i.Vector3(80,48,48),this.resolution.xy=this.resolution.x*this.resolution.y,this.resolutionMinusOne=new i.Vector3(this.resolution.x-1,this.resolution.y-1,this.resolution.z-1),this.size=this.size?this.size:new i.Vector3(800,480,800),this.sizeHalf=new i.Vector3(.5*this.size.x,.5*this.size.y,.5*this.size.z),this.position=this.position?this.position:new i.Vector3(this.size.x*-.5,this.size.y*-.5,this.size.z*-.5),this.posToIndexScale=new i.Vector3(this.resolution.x/this.size.x,this.resolution.y/this.size.y,this.resolution.z/this.size.z),this.posToIndexTranslate=new i.Vector3(.5*this.resolution.x,.5*this.resolution.y,.5*this.resolution.z);var e=this.resolution.x*this.resolution.y*this.resolution.z*this.dimensions;this.data=new Float32Array(e),this.restingData=new Float32Array(e),this.randomValues=new Float32Array(e+this.randomValuesOffset),this.initInitialVectors(10),this.initRestingState(),this.spin.x.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.spin.y.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.spin.z.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.motion.x.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.motion.y.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.motion.z.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.attractionToMiddle.x.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.attractionToMiddle.y.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.attractionToMiddle.z.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.randomness.x.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.randomness.y.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.randomness.z.onChangedSignal.add(function(){this.makeDirty()}.bind(this)),this.timeScale.onChangedSignal.add(function(){this.makeDirty()}.bind(this))},makeDirty:function(){0==this.dirty?this.dirty=100:this.stillDirty=!0},initInitialVectors:function(t){t=void 0!==t?t:1;for(var e=this.resolutionMinusOne.z;e>=0;e--)for(var i=this.resolutionMinusOne.y;i>=0;i--)for(var n=this.resolutionMinusOne.x;n>=0;n--){var r=(e*this.resolution.xy+i*this.resolution.x+n)*this.dimensions;this.data[r]=(Math.random()-.5)*t,this.data[r+1]=(Math.random()-.5)*t,this.data[r+2]=(Math.random()-.5)*t
}},initRestingState:function(){for(var t={x:0,y:0,z:0},e=.5*Math.PI,i=this.timeScale.value,n=this.spin.x.value*i,r=this.spin.y.value*i,o=this.spin.z.value*i,a=this.randomness.x.value*i,s=this.randomness.y.value*i,l=this.randomness.z.value*i,h=.01*this.attractionToMiddle.x.value*Math.abs(i),c=.01*this.attractionToMiddle.y.value*Math.abs(i),u=.01*this.attractionToMiddle.z.value*Math.abs(i),d=this.motion.x.value*i,f=this.motion.y.value*i,p=this.motion.z.value*i,m=this.resolutionMinusOne.z;m>=0;m--)for(var g=this.resolutionMinusOne.y;g>=0;g--)for(var v=this.resolutionMinusOne.x;v>=0;v--){var y=(m*this.resolution.xy+g*this.resolution.x+v)*this.dimensions;if(t.x=(v-this.posToIndexTranslate.x)/this.posToIndexScale.x,t.y=(g-this.posToIndexTranslate.y)/this.posToIndexScale.y,t.z=(m-this.posToIndexTranslate.z)/this.posToIndexScale.z,this.restingData[y]=0,this.restingData[y+1]=0,this.restingData[y+2]=0,0!=o){var E=Math.atan2(t.y,t.x)+e;this.restingData[y]+=Math.cos(E)*o,this.restingData[y+1]+=Math.sin(E)*o}if(0!=r){var x=Math.atan2(t.z,t.x)+e;this.restingData[y]+=Math.cos(x)*r,this.restingData[y+2]+=Math.sin(x)*r}if(0!=n){var T=Math.atan2(t.z,t.y)+e;this.restingData[y+1]+=Math.cos(T)*n,this.restingData[y+2]+=Math.sin(T)*n}this.restingData[y]+=(Math.random()-.5)*a,this.restingData[y+1]+=(Math.random()-.5)*s,this.restingData[y+2]+=(Math.random()-.5)*l,this.restingData[y]-=t.x*h,this.restingData[y+1]-=t.y*c,this.restingData[y+2]-=t.z*u,this.restingData[y]+=d,this.restingData[y+1]+=f,this.restingData[y+2]+=p}},add:function(t){this.objects.push(t)},remove:function(t){var e=this.objects.indexOf(t);-1!=e?this.objects.splice(e,1):0},addMany:function(t){this.objects.concat(t)},update:function(){var t=0;this.dirty>0&&((100==this.dirty||1==this.dirty&&this.stillDirty)&&(this.stillDirty=!1,this.initRestingState()),this.dirty--);for(var e=this.objects.length-1;e>=0;e--){var i=this.objects[e];(i instanceof r||i instanceof o||i instanceof a||i instanceof n||i instanceof s||i instanceof l||i instanceof h)&&(t+=i.applyVectorField(this.data,this.resolution,this.resolutionMinusOne,this.posToIndexScale,this.posToIndexTranslate,this.dimensions,this.randomValues,this.randomValuesOffset,this.size,this.sizeHalf,this.translateX,this.translateY,this.translateZ))}for(var c=this.data,u=this.restingData,d=this.fade.value,e=this.data.length-1;e>=0;e--)c[e]-=(c[e]-u[e])*d;return t},applyMotionPacket:function(t,e){this.applySphericalMotionVector(t,e,30,30,600)},applyGlobalMotion:function(t,e,i,n,r,o){this.translateX=t+n,this.translateY=e+r,this.translateZ=i+o},applySphericalMotionVector:function(t,e,i,n,r){for(var o=this.resolution,a=this.resolutionMinusOne,s=this.posToIndexScale,l=this.posToIndexTranslate,h=this.dimensions,u=this.data,d=c.mouseStrength,f=~~(i*s.x),p=~~(n*s.y),m=~~(r*s.z),g=~~(t.x*s.x+l.x),v=~~(t.y*s.y+l.y),y=~~(t.z*s.z+l.z),E=((Math.max(0,Math.min(a.x,g))+Math.max(0,Math.min(a.y,v))*o.x+Math.max(0,Math.min(a.z,y))*o.xy)*h,Math.max(0,Math.min(a.x,g-f))),x=Math.max(0,Math.min(a.x,g+f)),T=Math.max(0,Math.min(a.y,v-p)),_=Math.max(0,Math.min(a.y,v+p)),b=Math.max(0,Math.min(a.z,y-m)),w=Math.max(0,Math.min(a.z,y+m)),R=w;R>=b;R--)for(var S=_;S>=T;S--)for(var M=x;M>=E;M--){var H=(M+S*o.x+R*o.xy)*h;u[H]=e.x*d,u[H+1]=e.y*-d}},destroy:function(){this.objects.length>0&&this.objects.splice(0,this.objects.length)}});return u}),define("physics/PhysicsController",["Class","core/BaseObject","three","Global","managers/SceneManager"],function(t,e,i,n,r){var o=new t({Extends:e,manager:void 0,interactivePlane:void 0,position:null,motionVector:null,projector:void 0,camera:void 0,name:void 0,motionPackets:void 0,packetLife:.05,initialize:function(t){this.parent(t),this.vectorFields=[],this.motionPackets=[],this.projector=new i.Projector,this.attemptToActivate(),this.position=new i.Vector2(0,0),this.lastPosition=new i.Vector2(0,0),this.motionVector=new i.Vector2(0,0)},attemptToActivate:function(){var t=!1;this.camera||(this.camera=r.instance.camera,this.camera||(t=!0)),this.interactivePlane||(this.interactivePlane=this.manager.interactivePlane,this.interactivePlane||(t=!0)),t?setTimeout(this.attemptToActivate.bind(this),1e3):this.connect()},connect:function(){throw"Override this."},addVectorField:function(t){this.vectorFields.push(t)},removeVectorField:function(t){this.vectorFields.splice(this.vectorFields.indexOf(t),1)},attemptMovement:function(t){if(this.detectMovement()){this.lastPosition.x=this.position.x,this.lastPosition.y=this.position.y;var e=this.position.x/n.width*2,r=this.position.y/n.height*2,o=new i.Vector3(-e,r,.5);this.projector.unprojectVector(o,this.camera);var a=new i.Raycaster(this.camera.position,o.sub(this.camera.position).normalize()),s=a.intersectObjects([this.interactivePlane]);if(s.length>0){var l=s[0].point;this.position.x=l.x,this.position.y=l.y;for(var h=this.vectorFields.length-1;h>=0;h--){var c={time:t,position:{x:this.position.x,y:this.position.y},vector:{x:this.motionVector.x,y:this.motionVector.y}};this.motionPackets.push(c)}}}},detectMovement:function(){return this.motionVector.x=this.lastPosition.x-this.position.x,this.motionVector.y=this.lastPosition.y-this.position.y,0!=this.motionVector.x||0!=this.motionVector.y?!0:!1},update:function(){for(var t=this.motionPackets.length-1;t>=0;t--){var e=this.motionPackets[t];if(e.time-=n.timeSinceLastFrame,e.time<=0)for(var i=this.vectorFields.length-1;i>=0;i--)this.vectorFields[i].applyMotionPacket(e.position,e.vector);e.time<-this.packetLife&&this.motionPackets.splice(t,1)}}});return o}),define("physics/PhysicsMouseController",["Class","core/BaseObject","three","Global","managers/SceneManager","physics/PhysicsController"],function(t,e,i,n,r,o){var a=new t({Extends:o,mouseSpeed:0,lastMouseMovementTime:.001*Date.now(),mouseInactiveTimeThreshold:.25,initialize:function(t){this.name="mouse",this.parent(t)},connect:function(){},onDocumentMouseMove:function(){},update:function(){this.parent(),n.now-this.lastMouseMovementTime>this.mouseInactiveTimeThreshold&&(this.lastMouseMovementTime=n.now,this.motionVector.x=0,this.motionVector.y=0,this.mouseSpeed=0)}});return a}),define("managers/CollectionManager",["Class","three","core/BaseObject","Global","objects/SpriteParticles2","objects/CanvasParticles","objects/ShardParticles","objects/MeshParticles","objects/MeshObject","managers/SceneManager","managers/VectorFieldManager"],function(t,e,i){var n=new t({Extends:i,collection:void 0,data:void 0,transitions:!1,initialize:function(t){this.parent(t),this.collection={}},addMany:function(t){if(this.data)if(this.transitions){for(var e in t)"collectionSignals"!=e&&(this.collection.hasOwnProperty(e)?this.collection[e].transition(this.data[e]):this.add(e,t[e]));for(var e in this.collection)t.hasOwnProperty(e)||this.remove(e)}else{for(var e in this.collection)this.remove(e);for(var e in t)"collectionSignals"!=e&&this.add(e,t[e])}else{this.data=t,this.data.collectionSignals.add.add(this.add.bind(this)),this.data.collectionSignals.remove.add(this.remove.bind(this));for(var e in t)"collectionSignals"!=e&&this.add(e,t[e])}},add:function(t,e){this.collection[t]&&this.remove(t);var i=this.newObjectFromData(e);return i.name=t,this.collection[t]=i,this.data[t]=e,i},remove:function(t){delete this.collection[t],delete this.data[t]},newObjectFromData:function(){throw"override this!"}});return n}),define("managers/VectorFieldManager",["Class","three","physics/VectorField","physics/PhysicsMouseController","Global","managers/SceneManager","managers/CollectionManager","utils/ModelUtils"],function(t,e,i,n,r,o,a,s){var l=new t({Extends:a,interactivePlane:null,controllers:null,debugInteraction:!1,initialize:function(t){if(l.instance)throw"Singleton enforcer!";l.instance=this,this.parent(t),this.controllers=[],this.addController(new n({manager:this}))},update:function(){var t=0;for(var e in this.collection)t+=this.collection[e].update();for(var i=this.controllers.length-1;i>=0;i--)this.controllers[i].update()},add:function(t,i){var n=this.parent(t,i);n.name=t,this.interactivePlane||(this.interactivePlane=new e.Mesh(new e.PlaneGeometry(n.size.x,n.size.y,this.debugInteraction?n.resolution.x:1,this.debugInteraction?n.resolution.y:1),new e.MeshBasicMaterial({color:"#00ff00",wireframe:!0})),this.interactivePlane.visible=this.debugInteraction,o.instance.scene.add(this.interactivePlane));for(var r=this.controllers.length-1;r>=0;r--)this.controllers[r].addVectorField(n);return n},newObjectFromData:function(t){return new i(t)},addObject:function(t,e){if("every"==e)for(var i in this.collection)this.collection[i].add(t);else this.collection[e]?this.collection[e].add(t):0},removeObject:function(t,e){if("every"==e)for(var i in this.collection)this.collection[i].remove(t);else this.collection[e]?this.collection[e].remove(t):0},addManyObjects:function(t,e){this.collection[e]?this.collection[e].addMany(t):0},addController:function(t){this.controllers.push(t);for(var e in this.collection)t.addVectorField(this.collection[e])},remove:function(t){for(var e=this.controllers.length-1;e>=0;e--)this.controllers[e].removeVectorField(this.collection[t]);this.collection[t].destroy(),this.parent(t)},override:function(t){var e=$.extend(!0,{},t);s.recursiveEncapsulateAndActivate(e);for(var i in this.collection)s.recursiveCopy(this.collection[i],e,!1)}});return l}),define("physics/Collider",["Class","core/BaseObjectActive","three","objects/CanvasParticles","objects/ShardParticles","objects/SpriteParticles2","objects/SphereObject","objects/SphereParticles","objects/MeshParticles","objects/WireCloud","Global"],function(t,e,i,n,r){var o=new t({Extends:e,position:null,radius:10,initialize:function(t){this.objects=[],this.parent(t)},setParams:function(t){this.parent(t)},applyCollision:function(t){}});return o}),define("managers/ColliderManager",["Class","three","physics/Collider","Global","managers/CollectionManager"],function(t,e,i,n,r){var o=new t({Extends:r,debugInteraction:!0,initialize:function(t){if(o.instance)throw"Singleton enforcer!";o.instance=this,this.parent(t)},update:function(){var t=0;for(var e in this.collection)t+=this.collection[e].update()},add:function(t,e){var i=this.parent(t,e);return i.name=t,i},newObjectFromData:function(t){return new i(t)},remove:function(t){this.collection[t].destroy(),this.parent(t)},update:function(){for(var t=LayerManager.instance.collection,e=t.length-1;e>=0;e--){var i=t[e];if(i instanceof ShardParticles||i instanceof ParticleLayer)for(var n=this.collection.length-1;n>=0;n--)this.collection[n].applyCollision(i)}return processedParticles}});return o}),define("managers/LayerManager",["Class","three","core/BaseObject","Global","objects/SpriteParticles2","objects/CanvasParticles","objects/ShardParticles","objects/MeshParticles","objects/MeshObject","managers/SceneManager","managers/VectorFieldManager","managers/ColliderManager","managers/CollectionManager","utils/ModelUtils"],function(t,e,i,n,r,o,a,s,l,h,c,u,d,f){var p=new t({Extends:d,camera:void 0,scene:void 0,queue:void 0,extraCanvasLayers:void 0,initialize:function(t){if(p.instance)throw"Singleton enforcer!";p.instance=this,this.parent(t),this.queue=[],this.camera=h.instance.camera,this.scene=h.instance.scene,this.extraCanvasLayers=[]},add:function(t,e){var i=this.parent(t,e);return i.queued||this.scene.add(i.display),i},newObjectFromData:function(t){var e;switch(t.type.value){case"shardParticles":e=new a(t),c.instance.addObject(e,e.physics.vectorField.value);break;case"meshParticles":e=new s(t),this.addToQueue(e),e.queued=!0;break;case"meshObject":e=new l(t),this.addToQueue(e),e.queued=!0;break;case"spriteParticles":e=new r(t),c.instance.addObject(e,e.physics.vectorField.value);break;case"canvasParticles":e=new o(t),c.instance.addObject(e,e.physics.vectorField.value);break;default:return}return e.birthTime=n.now,e},remove:function(t){var e=this.collection[t];this.scene.remove(e.display),c.instance.removeObject(e,e.physics.vectorField.value),e.destroy(),this.parent(t)},addToQueue:function(t){this.queue.push(t),this.bumpQueue()},bumpQueue:function(){if(this.queue.length>0){var t=this.queue.splice(0,1)[0];t.load(this.onModelLayerLoadComplete.bind(this))}},onModelLayerLoadComplete:function(t){t.display&&this.scene.add(t.display),t.physics&&t.physics.vectorField&&c.instance.addObject(t,t.physics.vectorField.value),this.bumpQueue()},onLightReset:function(){for(var t in this.collection){var e=this.collection[t];e.hasOwnProperty("materialObject")}},hideAll:function(){for(var t in this.collection)this.collection[t].hide()},showAll:function(){for(var t in this.collection)this.collection[t].show()},overrideColor:function(t){for(var e in this.collection){var i=this.collection[e];i instanceof a||i instanceof s?(TweenLite.to(i.material.color,1,{colorProps:{value:t}}),TweenLite.to(i.material.ambient,1,{colorProps:{value:t}})):i instanceof r&&TweenLite.to(i.material.color,1,{colorProps:{value:t}})}},overrideLayer:function(t,e){if(e.hasOwnProperty("physics")){if(this.collection[t])return;var i=$.extend(!0,{},e);i.physics.vectorField="every",f.recursiveEncapsulateAndActivate(i);var n=[];for(var r in this.collection){var o=this.collection[r];o instanceof s&&n.push(o)}n.sort(function(t,e){return t.birthTime-e.birthTime}),n.length>=2&&this.remove(n[0].name),this.add(t,i)}else{for(var r in e){if(this.collection[r])return;var i=$.extend(!0,{},e[r]);i.physics.vectorField="every",f.recursiveEncapsulateAndActivate(i),this.extraCanvasLayers.push(this.add(r,i))}for(this.extraCanvasLayers.sort(function(t,e){return t.birthTime-e.birthTime});this.extraCanvasLayers.length>12;)this.remove(this.extraCanvasLayers.shift().name)}}});return p}),define("objects/LensOverlay",["Class","three","core/BaseObjectActive","Global","utils/ColorUtils","managers/SceneManager","utils/FileUtils"],function(t,e,i,n,r,o,a){var s=new t({Extends:i,camera:void 0,position:void 0,z:-10,scale:void 0,image:void 0,geometry:void 0,display:void 0,blendMode:void 0,spinSpeed:0,texture:void 0,nextTexture:void 0,nextBlendSrc:void 0,nextBlendDst:void 0,nextBlendEquation:void 0,textureWrapS:e.RepeatWrapping,textureWrapT:e.RepeatWrapping,textureRepeatX:1,textureRepeatY:1,color:"#ffffff",colorToUse:"#ffffff",invertColorToUse:!1,invertColor:!1,nextInvertColor:!1,fitToScreen:!1,fitToScreenKeepAspect:!1,fitToScreenTilePixels:!1,pixelsNoScale:!1,safetyRatio:1,opacity:1,visible:!0,dirty:!1,dirtyOpacity:1,dirtyOpacityStepIn:.01,dirtyOpacityStepOut:.5,initialize:function(t){this.parent(t),this.camera=o.instance.camera,this.pixelsNoScale.value&&(this.fitToScreenTilePixels.value=!0),this.fitToScreenTilePixels.value&&(this.fitToScreenKeepAspect.value=!0),this.spinSpeed.value&&(this.safetyRatio=Math.pow(2,.5)),this.invertColorToUse=this.invertColor.value,this.generateColor(),this.materialObject=new e.MeshBasicMaterial({blending:e.CustomBlending,blendSrc:e[t.blendMode.blendSrc.value+"Factor"],blendDst:e[t.blendMode.blendDst.value+"Factor"],blendEquation:e[t.blendMode.blendEquation.value+"Equation"],transparent:!0,color:this.colorToUse,depthTest:!0,depthWrite:!1,opacity:this.opacity.value,fog:!1,lights:!1,overdraw:!0}),this.geometry=new e.PlaneGeometry(100,100,1,1),this.display=new e.Mesh(this.geometry,this.materialObject),this.nextTexture=a.verifyAndLoadTexture(this.image.value,this.materialObject,"map",void 0,!0),this.display.position.x=this.position.x.value,this.display.position.y=this.position.y.value,this.display.position.z=this.z.value,this.display.scale.x=this.scale.x.value,this.display.scale.y=this.scale.y.value,this.display.visible=this.visible.value,this.image.onChangedSignal.add(function(t){this.nextTexture=a.verifyAndLoadTexture(t,this.materialObject,"map",void 0,!0)}.bind(this)),this.position.x.onChangedSignal.add(function(t){this.display.position.x=t}.bind(this)),this.position.y.onChangedSignal.add(function(t){this.display.position.y=t}.bind(this)),this.z.onChangedSignal.add(function(t){this.display.position.z=t,this.onWindowResize()}.bind(this)),this.visible.onChangedSignal.add(function(t){this.display.visible=t}.bind(this)),this.blendMode.blendSrc.onChangedSignal.add(function(t){this.nextBlendSrc=e[t+"Factor"]}.bind(this)),this.blendMode.blendDst.onChangedSignal.add(function(t){this.nextBlendDst=e[t+"Factor"]}.bind(this)),this.blendMode.blendEquation.onChangedSignal.add(function(t){this.nextBlendEquation=e[t+"Equation"]}.bind(this)),this.fitToScreen.onChangedSignal.add(function(){this.onWindowResize()}.bind(this)),this.fitToScreenKeepAspect.onChangedSignal.add(function(){this.onWindowResize()}.bind(this)),this.fitToScreenTilePixels.onChangedSignal.add(function(){this.onWindowResize()}.bind(this)),this.pixelsNoScale.onChangedSignal.add(function(){this.onWindowResize()}.bind(this)),this.opacity.onChangedSignal.add(function(t){this.display.material.opacity=t}.bind(this)),this.spinSpeed.onChangedSignal.add(function(t){this.safetyRatio=t?Math.pow(2,.5):1,this.onWindowResize(),this.display.rotation.z=t?n.now*this.spinSpeed.value:0}.bind(this)),this.color.onChangedSignal.add(function(){this.generateColor(),this.display.material.color.setHex(this.colorToUse)}.bind(this)),this.invertColor.onChangedSignal.add(function(t){this.nextInvertColor=t}.bind(this)),this.onWindowResize()},transitionTexture:function(t,e,i,n){opacity>0&&TweenLite.to(e,.5,{opacity:0,onComplete:function(){}}),a.verifyAndLoadTexture(t,e,i,n)},generateColor:function(){if(this.invertColorToUse){var t=new e.Color(this.color.value),i=new e.Color;i.r=1-t.r,i.g=1-t.g,i.b=1-t.b,this.colorToUse=i.getHex()}else this.colorToUse=r.getHexNumber(this.color.value)},update:function(){if(void 0!==this.nextTexture||void 0!==this.nextBlendSrc||void 0!==this.nextBlendDst||void 0!==this.nextBlendEquation||void 0!==this.nextInvertColor?this.dirtyOpacity>0?(this.dirtyOpacity-=this.dirtyOpacityStepOut,this.materialObject.opacity=Math.max(0,Math.min(1,this.opacity.value*this.dirtyOpacity))):(void 0!==this.nextTexture&&(null===this.nextTexture||this.nextTexture.image.complete?(this.texture=this.nextTexture,this.materialObject.map&&this.materialObject.map.dispose(),this.materialObject.map=this.texture,this.materialObject.needsUpdate=!0,this.geometry.buffersNeedUpdate=!0,this.geometry.uvsNeedUpdate=!0,this.nextTexture=void 0):0),void 0!==this.nextBlendSrc&&(this.materialObject.blendSrc=this.nextBlendSrc,this.nextBlendSrc=void 0),void 0!==this.nextBlendDst&&(this.materialObject.blendDst=this.nextBlendDst,this.nextBlendDst=void 0),void 0!==this.nextBlendEquation&&(this.materialObject.blendEquation=this.nextBlendEquation,this.nextBlendEquation=void 0),void 0!==this.nextInvertColor&&(this.invertColorToUse=this.nextInvertColor,this.generateColor(),this.materialObject.color.setHex(this.colorToUse),this.nextInvertColor=void 0)):this.dirtyOpacity<1&&(this.dirtyOpacity+=this.dirtyOpacityStepIn,this.materialObject.opacity=Math.max(0,Math.min(1,this.opacity.value*this.dirtyOpacity))),0!=this.spinSpeed.value?this.display.rotation.z+=n.timeSinceLastFrame*this.spinSpeed.value:this.display.rotation.z=0,this.fitToScreenTilePixels.value){var t=1*this.safetyRatio,e=1*this.safetyRatio;this.pixelsNoScale.value&&(this.scale.y.value/this.scale.x.value>n.aspectRatio?(t/=this.texture.image.height/n.height,e=t):(t/=this.texture.image.width/n.width,e=t)),this.texture&&(this.texture.offset.set(t*-.5+.5,e*-.5+.5),this.texture.repeat.set(t,e))}},onWindowResize:function(){if(this.fitToScreen.value){var t=this.camera.fov/360*Math.PI,e=Math.sin(t)/Math.cos(t),i=-this.z.value/this.display.geometry.width*n.aspectRatio*e*2*this.safetyRatio,r=-this.z.value/this.display.geometry.height*e*2*this.safetyRatio;this.fitToScreenKeepAspect.value&&(r/i>n.aspectRatio?i/=n.aspectRatio:r=i),this.display.scale.x=i,this.display.scale.y=r}},onCameraFOVChanged:function(){this.fitToScreen.value&&this.onWindowResize()},preventRotation:function(){this._safetyRatioBackup=this.safetyRatio,this.safetyRatio=1,this.onWindowResize(),this.display.rotation.z=0},allowRotation:function(){this.safetyRatio=this._safetyRatioBackup,this.onWindowResize(),this.display.rotation.z=n.now*this.spinSpeed.value},hide:function(){this.display.visible=!1},show:function(){this.display.visible=this.visible.value},destroy:function(){this.materialObject.map&&this.materialObject.map.dispose(),this.materialObject.normalMap&&this.materialObject.normalMap.dispose(),this.materialObject.specularMap&&this.materialObject.specularMap.dispose(),this.materialObject.dispose(),this.geometry.dispose()}});return s}),define("managers/LensOverlayManager",["Class","three","core/BaseObject","objects/LensOverlay","Global","managers/SceneManager","managers/CollectionManager"],function(t,e,i,n,r,o,a){var s=new t({Extends:a,camera:void 0,x:0,y:0,z:0,display:void 0,initialize:function(t){if(s.instance)throw"Singleton enforcer!";s.instance=this,this.parent(t),this.camera=o.instance.camera,this.display=new e.Object3D,this.camera.add(this.display),this.display.position.x=this.x,this.display.position.y=this.y,this.display.position.z=this.z,window.addEventListener("resize",this.onWindowResize.bind(this),!1),this.camera.onFOVChangedSignal.add(this.onCameraFOVChanged.bind(this)),this.onWindowResize()},addMany:function(t){this.parent(t),this.onWindowResize()},add:function(t,e){var i=this.parent(t,e);return this.display.add(i.display),i},newObjectFromData:function(t){return new n(t)},remove:function(t){this.display.remove(this.collection[t].display),this.collection[t].destroy(),this.parent(t)},update:function(){for(var t in this.collection)this.collection[t].update()},onCameraFOVChanged:function(){for(var t in this.collection)this.collection[t].onCameraFOVChanged()},onWindowResize:function(){for(var t in this.collection)this.collection[t].onWindowResize()},preventRotation:function(){for(var t in this.collection)this.collection[t].preventRotation()},allowRotation:function(){for(var t in this.collection)this.collection[t].allowRotation()},hideAll:function(){for(var t in this.collection)this.collection[t].hide()},showAll:function(){for(var t in this.collection)this.collection[t].show()},makeTransparent:function(){this.transparentMode=!0;for(var t in this.collection)1==this.collection[t].opacity.value&&TweenLite.to(this.collection[t].opacity,1,{value:.5})}});return s}),define("objects/Light",["Class","core/BaseObjectActive","three","Global"],function(t,e,i){var n=new t({Extends:e,type:"point",illuminate:!0,color:"#ffffff",intensity:1,lensFlare:void 0,textureFlare0:void 0,textureFlare2:void 0,textureFlare3:void 0,lensFlareUpdateCallback:void 0,position:void 0,initialize:function(t){t.type||(t.type=this.type),n.initdStatic||n.initStatic(),this.parent(t);var e=!0;switch(this.type.value){case"point":this.light=new i.PointLight(this.color.value,this.intensity.value,4500);break;case"directional":this.light=new i.DirectionalLight(this.color.value,this.intensity.value);break;case"ambient":this.light=new i.AmbientLight(this.color.value),e=!1}e&&this.light.position.set(this.position.x.value,this.position.y.value,this.position.z.value),this.color.onChangedSignal.add(function(t){this.light.color=new i.Color(t)}.bind(this)),this.illuminate instanceof Object&&this.illuminate.onChangedSignal.add(function(t){this.light.visible=t}.bind(this)),this.intensity instanceof Object&&this.intensity.onChangedSignal.add(function(t){this.light.intensity=t}.bind(this)),e&&(this.position.x.onChangedSignal.add(function(t){this.light.position.x=t}.bind(this)),this.position.y.onChangedSignal.add(function(t){this.light.position.y=t}.bind(this)),this.position.z.onChangedSignal.add(function(t){this.light.position.z=t}.bind(this)))}});return n.initStatic=function(){n.initdStatic=!0},n}),define("managers/LightManager",["Class","three","objects/Light","Signal","managers/SceneManager","managers/CollectionManager"],function(t,e,i,n,r,o){var a=new t({Extends:o,scene:void 0,onLightResetSignal:void 0,initialize:function(t){if(a.instance)throw"Singleton enforcer!";a.instance=this,this.parent(t),this.scene=r.instance.scene,this.onLightResetSignal=new n},newObjectFromData:function(t){return new i(t)},add:function(t,e){var i=this.parent(t,e);i.illuminate.value&&this.scene.add(i.light),this.onLightResetSignal.dispatch()},remove:function(t){var e=this.collection[t];e.illuminate.value&&this.scene.remove(e.light),this.parent(t),this.onLightResetSignal.dispatch()},overrideColor:function(t){for(var e in this.collection){var i=this.collection[e];TweenLite.to(i.color,1,{colorProps:{value:t}})}}});return a});var Stats=function(){var t=Date.now(),e=t,i=0,n=1/0,r=0,o=0,a=1/0,s=0,l=0,h=0,c=document.createElement("div");c.id="stats",c.addEventListener("mousedown",function(t){t.preventDefault(),y(++h%2)},!1),c.style.cssText="width:80px;opacity:0.9;cursor:pointer";var u=document.createElement("div");u.id="fps",u.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",c.appendChild(u);var d=document.createElement("div");d.id="fpsText",d.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",d.innerHTML="FPS",u.appendChild(d);var f=document.createElement("div");for(f.id="fpsGraph",f.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",u.appendChild(f);74>f.children.length;){var p=document.createElement("span");p.style.cssText="width:1px;height:30px;float:left;background-color:#113",f.appendChild(p)}var m=document.createElement("div");m.id="ms",m.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",c.appendChild(m);var g=document.createElement("div");g.id="msText",g.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",g.innerHTML="MS",m.appendChild(g);var v=document.createElement("div");for(v.id="msGraph",v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",m.appendChild(v);74>v.children.length;)p=document.createElement("span"),p.style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(p);var y=function(t){switch(h=t){case 0:u.style.display="block",m.style.display="none";break;case 1:u.style.display="none",m.style.display="block"}};return{REVISION:11,domElement:c,setMode:y,begin:function(){t=Date.now()},end:function(){var h=Date.now();i=h-t,n=Math.min(n,i),r=Math.max(r,i),g.textContent=i+" MS ("+n+"-"+r+")";var c=Math.min(30,30-30*(i/200));return v.appendChild(v.firstChild).style.height=c+"px",l++,h>e+1e3&&(o=Math.round(1e3*l/(h-e)),a=Math.min(a,o),s=Math.max(s,o),d.textContent=o+" FPS ("+a+"-"+s+")",c=Math.min(30,30-30*(o/100)),f.appendChild(f.firstChild).style.height=c+"px",e=h,l=0),h},update:function(){t=this.end()}}};define("stats",function(t){return function(){var e;return e||t.Stats}}(this));var THREEx=THREEx||{};THREEx.RendererStats=function(){var t=document.createElement("div");t.style.cssText="width:80px;opacity:0.9;cursor:pointer";var e=document.createElement("div");e.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#200;",t.appendChild(e);var i=document.createElement("div");i.style.cssText="color:#f00;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",i.innerHTML="WebGLRenderer",e.appendChild(i);for(var n=[],r=9,o=0;r>o;o++)n[o]=document.createElement("div"),n[o].style.cssText="color:#f00;background-color:#311;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",e.appendChild(n[o]),n[o].innerHTML="-";var a=Date.now();return{domElement:t,update:function(t){if(!(Date.now()-a<1e3/30)){a=Date.now();var e=0;n[e++].textContent="== Memory =====",n[e++].textContent="Programs: "+t.info.memory.programs,n[e++].textContent="Geometries: "+t.info.memory.geometries,n[e++].textContent="Textures: "+t.info.memory.textures,n[e++].textContent="== Render =====",n[e++].textContent="Calls: "+t.info.render.calls,n[e++].textContent="Vertices: "+t.info.render.vertices,n[e++].textContent="Faces: "+t.info.render.faces,n[e++].textContent="Points: "+t.info.render.points}}}},define("RendererStats",function(){});var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(t){return!1}}()};define("detector",function(t){return function(){var e;return e||t.Detector}}(this)),define("performance/FPS",["Class","core/BaseObject"],function(t,e){var i=new t({Extends:e,filterStrength:20,frameTime:0,lastLoop:0,thisLoop:0,dirty:0,fps:0,initialize:function(){if(i.instance)throw"Singleton enforcer!";i.instance=this,this.lastLoop=new Date},update:function(){var t=(this.thisLoop=new Date)-this.lastLoop;this.frameTime+=(t-this.frameTime)/this.filterStrength,this.lastLoop=this.thisLoop,this.fps=1e3/this.frameTime}});return i}),define("performance/PerformanceTweaker",["Class","core/BaseObject","Signal","performance/FPS"],function(t,e,i,n){var r=new t({Extends:e,denominator:1,degradeWhen:15,upgradeWhen:26,denominatorMax:8,minScale:.75,dirty:0,updateFrequency:5,changeFactor:1.25,onChange:void 0,initialize:function(t){this.parent(t),this.lastLoop=new Date,this.onChange=new i},update:function(){n.instance.update(),0==this.dirty&&(n.instance.fps<=this.degradeWhen?(this.denominator*=this.changeFactor,this.denominator<=this.denominatorMax?this.makeDirty():this.denominator=this.denominatorMax):n.instance.fps>=this.upgradeWhen&&(this.denominator/=this.changeFactor,this.denominator>=.99?this.makeDirty():this.denominator=1)),this.dirty>0&&this.dirty--},makeDirty:function(){this.onChange.dispatch(Math.max(this.minScale,1/this.denominator)),this.dirty=this.updateFrequency}});return r}),!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define("TextManager",t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.TextManager=t()}}(function(){var t;return function e(t,i,n){function r(a,s){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var h=i[a]={exports:{}};t[a][0].call(h.exports,function(e){var i=t[a][1][e];return r(i?i:e)},h,h.exports,e,t,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e){var i=t("klasse"),n=t("vecmath").Vector3,r=(new n,new i({initialize:function(t,e,i,n){this.p1=t,this.p2=e,"number"!=typeof n&&(n=t.position.distance(e.position)),this.restingDistance=n,this.originalRestingDistance=this.restingDistance,this.stiffness="number"==typeof i?i:.01,this.originalStiffness=i,this.tearDistance=Number.MAX_VALUE},solve:function(){var t=this.p1,e=this.p2,i=this.restingDistance,n=this.stiffness,r=e.position.x-t.position.x,o=e.position.y-t.position.y,a=e.position.z-t.position.z,s=Math.sqrt(r*r+o*o+a*a),l=0===s?i:(i-s)/s,h=1/t.mass,c=1/e.mass,u=h/(h+c)*n,d=n-u,f=1;return t.velocity.x-=r*u*l*f,t.velocity.y-=o*u*l*f,t.velocity.z-=a*u*l*f,e.velocity.x+=r*d*l*f,e.velocity.y+=o*d*l*f,e.velocity.z+=a*d*l*f,s}}));e.exports=r},{klasse:34,vecmath:61}],2:[function(t,e){function i(t,e,i,n,r,o){t.beginPath();for(var a=0,s=n[0].alpha,l=0;l<e.length;l+=3){var h=e[l].position,c=e[l+1].position,u=e[l+2].position,d=e[l].word,f=n[d],p=f.y;d!==a&&(t.globalAlpha=s,s=f.alpha,y=!0,t.closePath(),r?t.fill():t.stroke(),t.beginPath()),o&&t.beginPath(),i.project(h,m);var g=m.x,v=m.y;t.moveTo(m.x,m.y+p),i.project(c,m),t.lineTo(m.x,m.y+p),i.project(u,m),t.lineTo(m.x,m.y+p);var y=!1;o?(t.globalAlpha=s,t.closePath(),r?t.fill():t.stroke()):t.lineTo(g,v+p),a=d}o||(t.globalAlpha=s,r?t.fill():t.stroke())}var n=(t("vecmath").Vector2,t("vecmath").Vector3),r=(t("vecmath").Matrix4,t("./World")),o=(t("./Constraint"),t("interpolation").smoothstep),a=t("interpolation").lerp,s=t("text3d").util,l=t("text3d").Glyph,h=t("text3d").Text3D,c=t("cam3d").OrthographicCamera,u=(t("cam3d").PerspectiveCamera,t("klasse")),d=t("./typeface-stripped"),f=t("../vendor/uni_sans_bold_B.typeface");d.loadFace(f);
var p=t("./WebGLRenderer"),m=new n,g=new n,v=new n,y=new n,E=new n,x=(t("fs"),"attribute vec4 Position;\nattribute vec4 Color;\n// attribute vec2 TexCoord0;\n\nuniform mat4 u_projModelView;\n\nvarying vec4 v_col;\n// varying vec2 v_texCoord0;\n\nvoid main() {\n	gl_Position = u_projModelView * vec4(Position.xyz, 1.0);\n	v_col = Color;\n	// v_texCoord0 = TexCoord0;\n}"),T="#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec4 v_col;\n// varying vec2 v_texCoord0;\n// uniform sampler2D u_sampler0;\n\nvoid main() {\n	gl_FragColor = v_col; //* texture2D(u_sampler0, v_texCoord0);\n}",_="#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform sampler2D u_texture0;\n\nvarying vec4 vColor;\nvarying vec2 vTexCoord0;\n\nvoid main() {\n	float dist = smoothstep(0.5, 0.35, length(vTexCoord0.xy - 0.5));\n	gl_FragColor = vColor * texture2D(u_texture0, vTexCoord0);\n	gl_FragColor.a *= dist;\n}",b=JSON.parse('{\n  "preset": "Default",\n  "closed": false,\n  "remembered": {\n    "Default": {\n      "0": {\n        "steps": 30,\n        "simplify": 0,\n        "letterSpacing": 2.352231604342581,\n        "spaceWidth": 0,\n        "lineOffset": -12,\n        "periodKerning": 14,\n        "align": "CENTER",\n        "spinStrength": 17.20489402033431,\n        "mouseStrength": 10.91849043598139,\n        "mouseRadius": 24.153024297777012,\n        "minMouseMotion": 5,\n        "rigidness": 0.2,\n        "resetDuration": 1,\n        "resetDelay": 1.191108047561606,\n        "resetLinear": false,\n        "resetWhileIdle": false,\n        "resetByDistance": true\n      }\n    },\n    "Crows": {\n      "0": {\n        "steps": 10.44442529726004,\n        "simplify": 50,\n        "letterSpacing": 0,\n        "spaceWidth": 0,\n        "lineOffset": -12,\n        "periodKerning": 14,\n        "align": "CENTER",\n        "spinStrength": 11.91108047561606,\n        "mouseStrength": 0.6617266930897812,\n        "mouseRadius": 27.461657763225915,\n        "minMouseMotion": 2,\n        "rigidness": 0,\n        "resetDuration": 1,\n        "resetDelay": 1.0146475960709977,\n        "resetLinear": false,\n        "resetWhileIdle": false,\n        "resetByDistance": true\n      }\n    },\n    "Fling": {\n      "0": {\n        "steps": 10,\n        "simplify": 50,\n        "letterSpacing": 0,\n        "spaceWidth": 0,\n        "lineOffset": -12,\n        "periodKerning": 14,\n        "align": "CENTER",\n        "spinStrength": 17.86662071342409,\n        "mouseStrength": 3.308633465448906,\n        "mouseRadius": 15,\n        "minMouseMotion": 0.38600723763570566,\n        "rigidness": 0.04632086851628468,\n        "resetDuration": 1.146992934688954,\n        "resetDelay": 1.191108047561606,\n        "resetLinear": false,\n        "resetWhileIdle": false,\n        "resetByDistance": true\n      }\n    }\n  },\n  "folders": {\n    "Text Mesh": {\n      "preset": "Default",\n      "closed": false,\n      "folders": {}\n    },\n    "Physics": {\n      "preset": "Default",\n      "closed": false,\n      "folders": {}\n    },\n    "Reset Animation": {\n      "preset": "Default",\n      "closed": false,\n      "folders": {}\n    }\n  }\n}\n'),w=new u({initialize:function(t,e,i,o,a){this.options=this.toDefaults(e),this.text=t.trim(),this.datGUI=o,this.TweenLite=i,this.world=new r,this.camera=new c,this.face=s.getFace("uni sans bold"),this.webGLRenderer=null,this.scale=1,this.position=new n(0,0,0),this._finishTweenReset=this.finishTweenReset.bind(this),this._startTweenReset=this.startTweenReset.bind(this),this.glyphData=[],a&&(b.remembered.Default[0].steps=10,b.remembered.Default[0].simplify=50),this.color={r:15,g:0,b:0,a:1},this.create(),this.setupUI(),this.onCreated=null},animateOut:function(t){t=t||{};for(var e=t.delay||0,i=0===t.delayIncrement||t.delayIncrement?t.delayIncrement:.05,n=this.tweens.length-1;n>=0;n--)this.TweenLite.to(this.tweens[n],t.duration||.5,{alpha:0,y:0===t.yOff||t.yOff?t.yOff:100,delay:e,ease:t.ease||Expo.easeOut,onStart:n===this.tweens.length-1?t.onStart:void 0,onComplete:0===n?t.onComplete:void 0}),e+=i},animateIn:function(t,e){t=t||{},e=e||t;for(var i=t.delay||0,n=e.delay||0,r=0===t.delayIncrement||t.delayIncrement?t.delayIncrement:.15,o=0;o<this.tweens.length;o++)this.TweenLite.fromTo(this.tweens[o],t.duration||1,{y:0===t.yOff||t.yOff?t.yOff:100},{y:0,onStart:0===o?t.onStart:void 0,onComplete:o===this.tweens.length-1?t.onComplete:void 0,delay:i,ease:t.ease||Expo.easeOut}),this.TweenLite.fromTo(this.tweens[o],e.duration||1,{alpha:0},{alpha:1,delay:n,ease:e.ease||Expo.easeOut}),i+=r,n+=r},resetOptions:function(){this.options={},this.toDefaults(this.options)},uiRecreate:function(){},setupUI:function(){if(this.datGUI){var t=new this.datGUI.GUI({load:b});t.remember(this.options),this.gui=t;var e=t.addFolder("Text Mesh");e.add(this.options,"steps",3,30),e.add(this.options,"simplify",0,50),e.add(this.options,"letterSpacing",-10,10),e.add(this.options,"spaceWidth",0,100),e.add(this.options,"lineOffset",-20,20),e.add(this.options,"periodKerning",-50,50),e.add(this.options,"align",[h.Align.LEFT,h.Align.CENTER,h.Align.RIGHT]),e.add(this,"create"),e.add(this,"reset"),e.open(),this.guiMesh=e;var i=t.addFolder("Physics");i.add(this.options,"spinStrength",0,30),i.add(this.options,"mouseStrength",0,30),i.add(this.options,"mouseRadius",0,30),i.add(this.options,"minMouseMotion",0,5),i.add(this.options,"rigidness",0,.2),i.open();var n=t.addFolder("Reset Animation");n.add(this.options,"resetDuration",0,4),n.add(this.options,"resetDelay",0,4),n.add(this.options,"resetLinear"),n.add(this.options,"resetWhileIdle"),n.add(this.options,"resetByDistance"),n.open(),document.querySelector(".ac").style.zIndex=1e5,document.querySelector(".save-row").style.width="260px",document.querySelector(".gears").style.width="18px",document.querySelector(".gears").style.height="18px"}},toDefaults:function(t){if(t.text="string"==typeof t.text?t.text:"HEY.",t.style="number"==typeof t.style?t.style:0,t.spinStrength="number"==typeof t.spinStrength?t.spinStrength:10,t.mouseStrength="number"==typeof t.mouseStrength?t.mouseStrength:5,t.mouseRadius="number"==typeof t.mouseRadius?t.mouseRadius:15,t.minMouseMotion="number"==typeof t.minMouseMotion?t.minMouseMotion:2,t.resetLinear=!!t.resetLinear,t.resetDuration="number"==typeof t.resetDuration?t.resetDuration:1,t.resetDelay="number"==typeof t.resetDelay?t.resetDelay:.5,t.resetDelayIncrement="number"==typeof t.resetDelayIncrement?t.resetDelayIncrement:.05,t.resetWhileIdle="boolean"==typeof t.resetWhileIdle?t.resetWhileIdle:!0,t.resetByDistance="boolean"==typeof t.resetByDistance?t.resetByDistance:!0,t.rigidness="number"==typeof t.rigidness?t.rigidness:0,t.align=t.align||h.Align.CENTER,t.letterSpacing=t.letterSpacing||0,t.spaceWidth="number"==typeof t.spaceWidth?t.spaceWidth:0,t.periodKerning="number"==typeof t.periodKerning?t.periodKerning:14,t.lineOffset="number"==typeof t.lineOffset?t.lineOffset:-12,t.fill="boolean"==typeof t.fill?t.fill:!0,t.fontSize=document.documentElement.clientWidth<750?120:80,this.fontSize=t.fontSize||50,this.snap="number"==typeof t.snap?t.snap:.995,t.snap=this.snap,t.fontSize=this.fontSize,t.steps="number"==typeof t.steps?t.steps:10,t.simplify="number"==typeof t.simplify?t.simplify:50,b&&b.remembered&&b.remembered.Default)for(var e in t)"undefined"!=typeof b.remembered.Default[0][e]&&(t[e]=b.remembered.Default[0][e]);return t},reset:function(){var t=this.options;if(t.text=void 0,t.align=void 0,t.letterSpacing=void 0,t.spaceWidth=void 0,t.lineOffset=void 0,t.fill=void 0,t.steps=void 0,t.simplify=void 0,t.periodKerning=void 0,this.toDefaults(t),this.create(),this.guiMesh)for(var e in this.guiMesh.__controllers)this.guiMesh.__controllers[e].updateDisplay()},create:function(){var t=this.options.text||this.text;t=t.replace("<br>","\n");var e=this.options;this.toDefaults(this.options);var i=~~e.steps;simplify="number"==typeof e.simplify?0===e.simplify?0:this.fontSize/Math.max(10,~~e.simplify):this.fontSize/50,l.SAVE_CONTOUR=!1;var r=Math.round(e.spaceWidth||0)||void 0,o=Math.round(e.letterSpacing||0),a=Math.round(e.lineOffset||0)||void 0,s=e.align;h.PERIOD_KERNING=e.periodKerning||0,this.textMesh=new h(t,this.face,this.fontSize,i,simplify,s,r,o,a),this.tweens=[];for(var c=0;c<this.textMesh.wordCount;c++)this.tweens.push({y:0,alpha:1});this.mouse=new n,this.lastMouse=new n,this.world.particles.length=0,this.world.addText3D(this.textMesh),this.webGLRenderer&&this.webGLRenderer.setup(this.world.particles),this.width=this.textMesh.bounds.maxX-this.textMesh.bounds.minX,this.height=this.textMesh.bounds.maxY-this.textMesh.bounds.minY,this.glyphData.length=0;for(var c=0;c<this.textMesh.glyphs.length;c++)this.glyphData[c]={mouseOver:!1,tween:0,resetting:!1};this.textMesh.destroy(),this._createRandomForces(),"function"==typeof this.onCreated&&this.onCreated()},finishTweenReset:function(t){this.glyphData[t].resetting=!1,this.glyphData[t].tweening=!1,this.glyphData[t].tween=0},startTweenReset:function(t){this.glyphData[t].resetting=!0,this.glyphData[t].tweening=!0,this.glyphData[t].tween=0,this._saveGlyph(t)},update:function(t){var e=this.world;e.step(t),this._resolveTweens(),this._updateKillTweens();var i=this.options;0===i.style?this._updateMouseInteractions():1===i.style?this._updateMouseInteractions2():2===i.style&&this._updateMouseInteractions3()},_resolveTweens:function(){for(var t=this.world,e=0;e<t.particles.length;e++){var i=t.particles[e],n=i.glyphIndex,r=this.glyphData[n];if(r.resetting){var o=r.tween;i.position.copy(i.lastPosition).lerp(i.original,o),i.velocity.lerp(y,o),i.acceleration.lerp(y,o);for(var s=0;s<i.constraints.length;s++){var l=i.constraints[s];l.restingDistance=a(l.restingDistance,l.originalRestingDistance,o),l.stiffness=a(l.stiffness,l.originalStiffness,o)}}}},_createRandomForces:function(){for(var t=this.world,e=0;e<t.particles.length;e++){var i=this.options.spinStrength;m.random(),m.z=0,m.x*=i,m.y*=i,t.particles[e].finalPosition.add(m)}},_updateKillTweens:function(){for(var t=this.mouse,e=t.distance(this.lastMouse)>2,i=0;i<this.textMesh.glyphs.length;i++){{var n=this.glyphData[i],r=this.textMesh.glyphs[i],o=r.bounds;t.x>o.minX&&t.x<o.maxX&&t.y>o.minY&&t.y<o.maxY}if(e||!this.options.resetWhileIdle){var a=t.distance(m.set(o.minX+(o.maxX-o.minX)/2,o.minY+(o.maxY-o.minY)/2));a<this.options.mouseRadius?(this.TweenLite.killTweensOf(n),n.mouseOver=!0,n.tweening=!1,n.resetting=!1,n.tween=0):n.mouseOver&&(n.mouseOver=!1)}else n.mouseOver=!1,this._addTween(i,this.options.resetDelay)}},_addTween:function(t,e){e=e||0;var i=this.glyphData[t],n=this.options;if(n.resetByDistance){var r=this.mouse,o=this.textMesh.glyphs[t],a=o.bounds,s=r.distance(m.set(a.minX+(a.maxX-a.minX)/2,a.minY+(a.maxY-a.minY)/2));e+=s/this.screenLength}else e+=t*n.resetDelayIncrement;!i.mouseOver&&!i.tweening&&(i.tweening=!0,i.resetting=!1,this.TweenLite.to(i,n.resetDuration,{overwrite:1,tween:1,ease:n.resetLinear?Linear.easeNone:Expo.easeOut,delay:e+n.resetDelay,onStart:this._startTweenReset,onStartParams:[t],onComplete:this._finishTweenReset,onCompleteParams:[t]}))},_updateGlyphHitTest:function(){for(var t=(this.options,0),e=0;e<this.textMesh.glyphs.length;e++)this._addTween(e,t);this._updateKillTweens()},_updateMouseInteractions:function(){var t=this.mouse,e=this.lastMouse,i=this.world,n=(this.camera.viewportWidth,this.camera.viewportHeight,this.options),r=n.mouseStrength,o=n.mouseRadius,s=n.spinStrength;v.copy(t),v.sub(e),v.normalize(),v.scale(r);for(var l=t.distance(e)>n.minMouseMotion,h=0;h<i.particles.length;h++){var c=i.particles[h],u=c.position.distance(t);if(o>u&&l&&c.velocity.add(v),o/2>u){E.random();var d=this._normalizedDistanceFromMouse(c);if(.5>d){var f=a(s,0,d);E.scale(f),E.z=0,c.velocity.add(E)}}else if(n.rigidness>0){var p=n.rigidness;c.position.lerp(c.original,p),c.velocity.lerp(y,p),c.acceleration.lerp(y,p)}}e.copy(t)},_normalizedDistanceFromMouse:function(t){var e=.1,i=this.camera.viewportWidth,n=this.camera.viewportHeight;m.copy(t.position),m.x/=i,m.y/=n,g.copy(this.mouse),g.x/=i,g.y/=n;var r=m.distance(g);return r=o(0,e,r)},_updateMouseInteractions2:function(){var t=this.mouse,e=this.lastMouse,i=this.world;if(m.copy(t),m.sub(e),m.normalize(),m.scale(5),t.distance(e)>5)for(var n=0;n<i.particles.length;n++){var r=i.particles[n];r.position.distance(t)<50&&r.velocity.add(m)}e.copy(t)},_updateMouseInteractions3:function(){for(var t=this.mouse,e=(this.lastMouse,this.world),i=this.camera.viewportWidth,n=this.camera.viewportHeight,r=0;r<e.particles.length;r++){var s=e.particles[r];m.copy(s.position),m.x/=i,m.y/=n,g.copy(t),g.x/=i,g.y/=n;var l=m.distance(g);l=o(0,.1,l);var h=1,c=a(h,0,l);m.copy(s.original),m.lerp(s.finalPosition,l*c),s.position.copy(m)}},_savePosition:function(){for(var t=this.world,e=0;e<t.particles.length;e++){var i=t.particles[e];i.lastPosition.copy(i.position)}},_saveGlyph:function(t){for(var e=this.world,i=0;i<e.particles.length;i++){var n=e.particles[i];n.glyphIndex===t&&n.lastPosition.copy(n.position)}},initWebGL:function(t,e){this.webGLRenderer=new p(t,x,T,e,_),this.webGLRenderer.setup(this.world.particles),this.resize(t.width,t.height)},resize:function(t,e){var i=!!this.webGLRenderer;this.webGLRenderer&&this.webGLRenderer.resize(t,e);var n=1/this.scale;this.camera.zoom=n,this.camera.setToOrtho(i,t,e),this.camera.translate(-this.position.x*n,-this.position.y*n,this.position.z),this.camera.update(),this.screenLength=Math.sqrt(t*t+e*e)},updateCamera:function(){this.resize(this.camera.viewportWidth,this.camera.viewportHeight)},setPosition:function(t,e,i){this.position.set(t,e,i),this.resize(this.camera.viewportWidth,this.camera.viewportHeight)},setZoom:function(t){this.camera.zoom=t,this.camera.update()},onTouchMove:function(t,e){m.set(t,this.webGLRenderer?e:this.camera.viewportHeight-e,0),this.camera.unproject(m,g),this.mouse.set(g.x,g.y),this._updateGlyphHitTest()},onTouchStart:function(t,e){m.set(t,this.webGLRenderer?e:this.camera.viewportHeight-e,0),this.camera.unproject(m,g),this.mouse.set(g.x,g.y)},onTouchEnd:function(t,e){m.set(t,this.webGLRenderer?e:this.camera.viewportHeight-e,0),this.camera.unproject(m,g),this.mouse.set(g.x,g.y)},resetAll:function(){this.resetTime=0,this.resetting=!0,this._savePosition()},renderCanvas:function(t){var e=this.options.fill,n=!1;if(0!==this.color.a){var r="rgba("+~~(255*this.color.r)+","+~~(255*this.color.g)+","+~~(255*this.color.b)+","+this.color.a+")";t.fillStyle=r,t.strokeStyle=r,i(t,this.world.particles,this.camera,this.tweens,e,n)}},destroy:function(){this.world.particles.length=0,this.text=null,this.world=null,this.webGLRenderer=null,this.camera=null,this.face=null},renderWebGL:function(){var t=!this.options.fill;0!==this.color.a&&this.webGLRenderer&&this.webGLRenderer.render(this.width,this.height,this.world.particles,this.camera,this.tweens,this.color,t)}});e.exports=w},{"../vendor/uni_sans_bold_B.typeface":6,"./Constraint":1,"./WebGLRenderer":3,"./World":4,"./typeface-stripped":5,cam3d:17,fs:62,interpolation:19,klasse:34,text3d:"bRhrlU",vecmath:61}],3:[function(t,e){var i=t("klasse"),n=t("kami").WebGLContext,r=t("kami-mesh").MeshRenderer,o=t("kami").ShaderProgram,a=t("kami").SpriteBatch,s=t("kami").FrameBuffer,l=t("kami").Texture,h=(t("vecmath").Matrix4,t("cam3d").OrthographicCamera,t("cam3d").PerspectiveCamera,t("vecmath").Vector3),c=t("vecmath").Matrix3,u=(new c,new h,new h,new h,2048),d=new i({initialize:function(t,e,i,r,h){this.context=new n(t.width,t.height,t),this.mesh=null,this.useAA=r,this.shader=new o(this.context,e,i),this.shader.log&&0,this.useAA&&(a.DEFAULT_FRAG_SHADER=h,this.batch=new a(this.context,1),this.aaBuffer=new s(this.context,u,u),this.aaBuffer.texture.setFilter(l.Filter.LINEAR))},resize:function(t,e){this.context.width=t,this.context.height=e},setup:function(t){this.mesh=new r(this.context,{hasColors:!0,maxVertices:4*t.length,hasNormals:!1,numTexCoords:0})},destroy:function(){this.aaBuffer&&this.aaBuffer.destroy(),this.batch&&this.batch.destroy(),this.shader.destroy(),this.mesh&&this.mesh.destroy()},_renderNormal:function(t,e,i,n,r){var o=this.context.gl,a=this.mesh,s=this.shader;a.shader=s,a.begin(e.combined,r?o.LINES:o.TRIANGLES);for(var l=n.r,h=n.g,c=n.b,u=n.a,d=0;d<t.length;d++){var f=t[d],p=f.position,m=i[f.word];a.color(l,h,c,u*m.alpha),a.vertex(p.x,p.y+m.y,p.z)}a.end()},render:function(t,e,i,n,r,o,a){var s=this.useAA,l=this.context.gl;t*=1/n.zoom,e*=1/n.zoom;var h=.8*u;if((n.viewportWidth>h||n.viewportHeight>h||t>h/2||e>h/2)&&(s=!1),l.blendEquation(l.FUNC_ADD),l.activeTexture(l.TEXTURE0),l.disable(l.DEPTH_TEST),l.enable(l.BLEND),l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA),l.colorMask(!0,!0,!0,!0),l.depthMask(!1),l.disable(l.CULL_FACE),s){var c=this.aaBuffer,d=(this.fboCamera,n.viewportWidth),f=n.viewportHeight;n.viewportWidth=c.width/2,n.viewportHeight=-c.height/2,n.update(),c.begin(),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT),this._renderNormal(i,n,r,o,a),c.end();var p=u/2;this.batch.resize(d,f),this.batch.begin(),this.batch.draw(c.texture,(d-p)/2,(f-p)/2,p,p),this.batch.end(),n.viewportWidth=d,n.viewportHeight=f,n.update()}else this._renderNormal(i,n,r,o,a);l.depthMask(!0),l.enable(l.DEPTH_TEST)}});e.exports=d},{cam3d:17,kami:31,"kami-mesh":20,klasse:34,vecmath:61}],4:[function(t,e){var i=t("klasse"),n=t("vecmath").Vector3,r=t("./Constraint"),o=(new n,new i({initialize:function(t){this.particles=[],this.gravity=t||new n(0,0,0),this.floor=Number.MAX_VALUE,this.floorFriction=.98,this.accuracy=1,this.defaultStiffness=.5,this.defaultRestingDistance=void 0},clear:function(){this.particles.length=0},addTriangleList:function(t,e,i,o,a){e="number"==typeof e?e:1,i="number"==typeof i?i:-.5;for(var s=this.particles,l=this.defaultStiffness,h=this.defaultRestingDistance,c=0;c<t.length;c++){var u=t[c],d={position:new n(u),velocity:new n,acceleration:new n,original:new n(u),lastPosition:new n(u),finalPosition:new n(u),glyphIndex:o,word:a,mass:e,restitution:i,restingDistance:0,constraints:[]};if(s.push(d),(c+1)%3===0){var f=s[s.length-1],p=s[s.length-2],m=s[s.length-3];m.constraints=[new r(m,p,l,h),new r(m,f,l,h)],p.constraints=[new r(p,m,l,h),new r(p,f,l,h)],f.constraints=[new r(f,m,l,h),new r(f,p,l,h)]}}},addText3D:function(t,e,i){for(var n=(this.particles,this.defaultStiffness,this.defaultRestingDistance,0);n<t.glyphs.length;n++){var r=t.glyphs[n];this.addTriangleList(r.points,e,i,n,r.word)}},solveConstraints:function(t,e){for(var i=e.length;i--;){var n=e[i];n.solve()}},step:function(t){t=t||.16;for(var e=this.particles,i=this.gravity,n=(this.floor,this.floorFriction),r=this.accuracy;r--;)for(var o=0;o<e.length;o++){var a=e[o],s=a.constraints;this.solveConstraints(a,s)}for(var o=0;o<e.length;o++){var a=e[o];a.velocity.scale(.98),a.velocity.x+=i.x,a.velocity.y+=i.y,a.velocity.z+=i.z,a.position.x+=a.velocity.x*t,a.position.y+=a.velocity.y*t,a.position.z+=a.velocity.z*t,a.position.y>=this.floor&&(a.velocity.x*=n,a.velocity.y*=n,a.velocity.z*=n,a.velocity.y*=a.restitution,a.position.y=this.floor-.1)}}}));e.exports=o},{"./Constraint":1,klasse:34,vecmath:61}],5:[function(t,e){var i={faces:{},loadFace:function(t){var e=t.familyName.toLowerCase();this.faces[e]||(this.faces[e]={}),this.faces[e][t.cssFontWeight]||(this.faces[e][t.cssFontWeight]={});var i=this.faces[e][t.cssFontWeight][t.cssFontStyle]=t;i.loaded=!0},pixelsFromPoints:function(t,e,i,n){var r=i*parseInt(e.fontSize.toString(),10)*72/(100*t.resolution);return"horizontal"==n&&e.fontStretchPercent&&(r*=e.fontStretchPercent),r},pointsFromPixels:function(t,e,i,n){var r=i*t.resolution/(72*parseInt(e.fontSize.toString(),10)/100);return"horizontal"==n&&e.fontStretchPrecent&&(r*=e.fontStretchPercent),r}};e.exports=i},{}],6:[function(t,e){e.exports={glyphs:{S:{x_min:25,x_max:740.6875,ha:808,o:"m 25 173 b 366 -13 108 48 238 -13 b 740 270 545 -13 723 86 b 412 597 750 502 583 565 b 243 706 326 615 244 626 l 243 708 b 393 805 247 776 315 805 b 556 712 456 805 515 776 l 725 825 b 393 998 643 948 520 998 b 34 715 216 998 45 901 b 345 402 31 498 191 426 b 534 284 447 388 538 369 b 179 291 526 147 268 150 l 25 173 "},"/":{x_min:-45.828125,x_max:559.71875,ha:528,o:"m -45 -8 l 138 -75 l 559 994 l 377 1058 l -45 -8 "},K:{x_min:61.109375,x_max:863.890625,ha:858,o:"m 61 983 l 61 0 l 265 0 l 265 327 l 304 365 l 611 0 l 863 0 l 441 501 l 863 983 l 615 983 l 265 573 l 265 983 l 61 983 "},7:{x_min:-23.765625,x_max:672.0625,ha:685,o:"m 402 788 l -19 0 l 201 0 l 672 870 l 615 984 l -23 984 l -23 788 l 402 788 "},d:{x_min:31.921875,x_max:611.109375,ha:701,o:"m 416 982 l 416 700 b 31 481 259 772 29 680 l 31 232 b 330 -16 45 46 179 -16 b 611 38 420 -16 523 4 l 611 982 l 416 982 m 416 142 b 225 214 350 108 227 128 l 225 490 b 416 553 234 574 354 587 l 416 142 "},",":{x_min:-8.328125,x_max:315.28125,ha:392,o:"m -8 -169 l 187 -169 l 315 154 l 98 154 l -8 -169 "},Y:{x_min:-63.890625,x_max:825,ha:806,o:"m 825 983 l 587 983 l 379 572 l 170 983 l -63 983 l 277 376 l 277 0 l 481 0 l 481 376 l 825 983 "},E:{x_min:55.5625,x_max:722.21875,ha:794,o:"m 722 984 l 55 984 l 55 0 l 722 0 l 722 198 l 261 198 l 261 393 l 684 393 l 684 591 l 261 591 l 261 784 l 722 784 l 722 984 "},y:{x_min:35.984375,x_max:608.203125,ha:701,o:"m 413 719 l 413 163 b 222 226 351 129 231 143 l 222 719 l 35 719 l 35 223 b 416 9 35 25 244 -48 b 158 -55 416 -125 233 -126 l 62 -154 b 608 26 223 -341 608 -280 l 608 719 l 413 719 "},'"':{x_min:36.109375,x_max:480.5625,ha:529,o:"m 36 605 l 205 605 l 233 981 l 36 981 l 36 605 m 283 605 l 454 605 l 480 981 l 283 981 l 283 605 "},g:{x_min:26.03125,x_max:598.25,ha:696,o:"m 52 -154 b 598 26 213 -341 598 -280 l 598 675 b 26 494 403 772 26 783 l 26 223 b 406 9 26 24 234 -48 b 148 -52 406 -125 223 -123 l 52 -154 m 403 163 b 212 226 341 128 221 142 l 212 498 b 403 575 214 585 337 608 l 403 163 "},"":{x_min:-25.0625,x_max:626.171875,ha:704,o:"m -25 -128 b 324 28 124 -217 295 -141 l 404 458 l 542 458 l 542 617 l 431 617 l 455 747 b 559 807 466 805 505 834 l 626 943 b 487 986 569 973 522 986 b 258 762 334 986 276 869 l 258 764 l 231 617 l 88 617 l 88 458 l 202 458 b 127 68 179 333 151 192 b 19 1 116 0 70 -20 l -25 -128 "},e:{x_min:25,x_max:598.609375,ha:686,o:"m 416 419 l 219 419 l 219 483 b 416 484 216 584 416 584 l 416 419 m 440 211 b 219 241 391 130 219 141 l 219 276 l 598 276 l 598 476 b 315 730 598 650 455 730 b 25 476 170 730 25 650 l 25 241 b 315 -13 25 70 170 -13 b 566 122 400 -13 511 19 l 440 211 "},J:{x_min:-9.71875,x_max:731.953125,ha:847,o:"m 526 790 l 526 308 b 362 186 526 227 443 186 b 187 351 286 186 206 241 l -9 312 b 358 -13 18 90 194 -13 b 731 308 543 -13 731 94 l 731 983 l 294 983 l 294 790 l 526 790 "},"|":{x_min:48.609375,x_max:241.671875,ha:340,o:"m 48 988 l 48 -202 l 241 -202 l 241 988 l 48 988 "},"^":{x_min:-6.9375,x_max:769.453125,ha:824,o:"m -6 549 l 216 549 l 375 749 l 537 549 l 769 549 l 436 964 l 318 964 l -6 549 "},q:{x_min:27.75,x_max:606.9375,ha:704,o:"m 606 -263 l 606 681 b 326 735 519 714 416 735 b 27 486 175 735 41 672 l 27 238 b 412 18 25 38 255 -53 l 412 -263 l 606 -263 m 412 158 b 220 228 350 124 230 145 l 220 504 b 412 576 223 590 345 610 l 412 158 "},b:{x_min:37.5,x_max:616.703125,ha:701,o:"m 37 982 l 37 38 b 318 -16 125 4 227 -16 b 616 232 469 -16 602 46 l 616 481 b 231 700 619 680 388 772 l 231 982 l 37 982 m 231 553 b 423 490 294 587 413 574 l 423 214 b 231 142 420 128 298 108 l 231 553 "},D:{x_min:58.328125,x_max:794.453125,ha:876,o:"m 419 0 b 794 313 613 0 794 93 l 794 663 b 419 983 794 886 613 983 l 58 983 l 58 0 l 419 0 m 262 205 l 262 777 l 419 777 b 588 663 508 777 588 744 l 588 313 b 419 205 588 234 508 205 l 262 205 "},z:{x_min:-15.21875,x_max:548.578125,ha:596,o:"m 283 554 l -15 69 l 40 0 l 538 0 l 538 165 l 248 165 l 548 651 l 493 719 l 11 719 l 11 554 l 283 554 "},w:{x_min:-31.9375,x_max:922.21875,ha:929,o:"m 450 455 l 469 259 l 529 0 l 705 0 l 922 719 l 729 719 l 655 416 l 629 241 l 620 241 l 605 418 l 516 719 l 376 719 l 284 416 l 269 241 l 261 241 l 236 415 l 158 719 l -31 719 l 191 0 l 366 0 l 423 259 l 440 455 l 450 455 "},$:{x_min:17.78125,x_max:733.40625,ha:785,o:"m 313 -97 l 445 -97 l 445 -5 b 733 271 591 21 719 115 b 445 589 741 484 601 554 l 445 796 b 549 712 485 782 520 755 l 717 825 b 445 994 648 929 551 980 l 445 1078 l 313 1078 l 313 993 b 27 715 165 969 37 875 b 313 407 24 509 167 434 l 313 193 b 171 291 256 208 203 240 l 17 173 b 313 -10 91 64 201 1 l 313 -97 m 527 284 b 445 191 524 236 491 205 l 445 380 b 527 284 495 364 530 337 m 235 707 l 235 708 b 313 794 238 753 269 780 l 313 618 b 235 707 269 633 235 657 "},"\\":{x_min:-84.71875,x_max:523.609375,ha:522,o:"m 100 1058 l -84 993 l 338 -79 l 523 -16 l 100 1058 "},"~":{x_min:15.40625,x_max:597.34375,ha:647,o:"m 487 514 b 359 479 443 456 408 443 b 209 543 323 507 273 543 b 15 409 126 543 64 480 l 136 307 b 262 331 184 370 220 367 b 394 276 297 301 343 276 b 597 423 486 276 551 342 l 487 514 "},"-":{x_min:23.609375,x_max:433.328125,ha:489,o:"m 23 308 l 433 308 l 433 504 l 23 504 l 23 308 "},Q:{x_min:40.625,x_max:862.84375,ha:939,o:"m 743 -43 l 862 72 l 797 141 b 846 307 828 187 846 241 l 846 676 b 40 676 846 1112 40 1115 l 40 307 b 672 32 40 0 436 -90 l 743 -43 m 243 676 b 642 676 243 841 643 845 l 642 308 l 575 379 l 447 275 l 522 193 b 243 307 404 163 242 201 l 243 676 "},M:{x_min:61.265625,x_max:969.59375,ha:1088,o:"m 790 581 l 765 391 l 765 0 l 969 0 l 969 983 l 755 983 l 514 418 l 275 983 l 61 983 l 61 0 l 265 0 l 265 390 l 243 580 l 257 580 l 304 445 l 440 129 l 593 129 l 727 444 l 775 581 l 790 581 "},C:{x_min:19.4375,x_max:755.5625,ha:811,o:"m 579 294 b 222 316 495 133 222 165 l 222 667 b 583 693 222 819 498 854 l 747 782 b 405 993 680 926 536 993 b 19 667 211 993 19 882 l 19 316 b 401 -9 19 100 211 -9 b 755 196 531 -9 670 58 l 579 294 "},"[":{x_min:37.5,x_max:338.890625,ha:372,o:"m 338 990 l 37 990 l 37 -151 l 338 -151 l 338 36 l 234 36 l 234 801 l 338 801 l 338 990 "},L:{x_min:55.5625,x_max:684.71875,ha:721,o:"m 684 205 l 259 205 l 259 983 l 55 983 l 55 0 l 684 0 l 684 205 "},"!":{x_min:56.9375,x_max:295.828125,ha:403,o:"m 273 986 l 77 986 l 77 265 l 273 265 l 273 986 m 56 104 b 175 -15 56 37 108 -15 b 295 104 243 -15 295 37 b 175 225 295 170 243 225 b 56 104 108 225 56 170 "}," ":{x_min:0,x_max:0,ha:328},"{":{x_min:16.328125,x_max:382.890625,ha:404,o:"m 382 991 l 289 991 b 96 788 142 991 96 912 l 96 622 b 16 512 96 566 78 512 l 16 327 b 96 218 78 327 96 275 l 96 51 b 277 -150 96 -72 134 -150 l 382 -150 l 382 33 l 288 33 b 294 54 291 34 294 41 l 294 241 b 196 419 294 318 271 388 b 294 598 253 445 294 526 l 294 781 b 294 806 294 797 294 806 l 382 806 l 382 991 "},X:{x_min:-48.65625,x_max:831.90625,ha:826,o:"m 831 983 l 583 983 l 384 633 l 202 983 l -45 983 l 241 490 l -48 0 l 202 0 l 384 347 l 581 0 l 831 0 b 520 488 765 100 583 391 l 831 983 "},P:{x_min:59.71875,x_max:798.4375,ha:856,o:"m 262 304 l 448 304 b 447 983 912 304 918 981 l 59 983 l 59 0 l 262 0 l 262 304 m 447 495 l 262 495 l 262 777 l 447 777 b 447 495 648 777 645 495 "},"%":{x_min:18.0625,x_max:962.46875,ha:1038,o:"m 430 745 b 223 995 430 905 355 995 b 18 748 104 995 18 900 b 223 495 18 583 93 495 b 430 745 341 495 430 590 m 888 934 l 736 1034 l 56 -9 l 208 -104 l 888 934 m 286 745 b 220 641 286 675 262 641 b 154 747 181 641 154 670 b 220 851 154 819 181 851 b 286 745 261 851 286 819 m 962 244 b 755 494 962 404 887 494 b 549 247 636 494 549 398 b 755 -5 549 81 624 -5 b 962 244 873 -5 962 88 m 818 244 b 752 140 818 173 794 140 b 686 245 713 140 686 169 b 752 350 686 318 713 350 b 818 244 793 350 818 318 "},"#":{x_min:8.796875,x_max:950.6875,ha:988,o:"m 724 506 l 897 506 l 950 694 l 782 694 l 856 936 l 661 936 l 590 694 l 490 694 l 561 936 l 370 936 b 299 694 349 863 322 769 l 94 694 l 54 506 l 243 506 b 222 440 233 472 231 462 l 44 440 l 8 255 l 168 255 l 93 0 l 285 0 l 358 255 l 458 255 l 386 0 l 577 0 b 650 255 588 40 610 118 l 857 255 l 896 440 l 706 440 l 724 506 m 553 519 l 528 427 l 395 427 l 418 519 l 553 519 "},_:{x_min:-16.671875,x_max:681.953125,ha:756,o:"m -16 -181 l 681 -181 l 681 11 l -16 11 l -16 -181 "},"+":{x_min:36.109375,x_max:747.21875,ha:838,o:"m 36 355 l 300 355 l 300 97 l 494 97 l 494 355 l 747 355 l 747 551 l 494 551 l 494 806 l 300 806 l 300 551 l 36 551 l 36 355 "},")":{x_min:-48.609375,x_max:310.234375,ha:393,o:"m -48 1006 b -45 -65 191 701 190 274 l 98 -164 b 91 1101 381 234 381 774 l -48 1006 "},"'":{x_min:33.328125,x_max:227.78125,ha:299,o:"m 33 605 l 208 605 l 227 981 l 33 981 l 33 605 "},"}":{x_min:-9.3125,x_max:344.859375,ha:393,o:"m -9 806 l 62 806 b 67 781 67 806 67 797 l 67 598 b 167 420 65 526 111 455 b 67 241 94 390 65 315 l 67 54 b 60 33 67 40 65 33 l -9 33 l -9 -150 l 61 -150 b 262 51 226 -150 262 -72 l 262 218 b 344 327 262 275 279 327 l 344 512 b 262 622 279 512 262 566 l 262 788 b 64 991 262 912 243 991 l -9 991 l -9 806 "},a:{x_min:24.75,x_max:593.09375,ha:701,o:"m 288 466 b 322 -16 -66 466 -70 -16 b 593 35 409 -16 508 3 l 593 481 b 50 605 593 757 198 811 l 144 518 b 405 444 220 603 405 612 b 288 466 370 462 326 466 m 400 141 b 319 131 373 134 347 131 b 312 317 172 131 162 313 b 400 305 345 319 379 313 l 400 141 "},T:{x_min:-11.109375,x_max:758.328125,ha:783,o:"m -11 984 l -11 779 l 270 779 l 270 0 l 476 0 l 476 779 l 758 779 l 758 984 l -11 984 "},"=":{x_min:47.21875,x_max:640.28125,ha:738,o:"m 47 437 l 640 437 l 640 627 l 47 627 l 47 437 m 47 183 l 640 183 l 640 372 l 47 372 l 47 183 "},N:{x_min:59.71875,x_max:830.5625,ha:947,o:"m 641 269 l 572 447 l 261 983 l 59 983 l 59 0 l 265 0 l 265 479 l 238 647 l 252 650 l 312 516 l 612 0 l 830 0 l 830 983 l 626 983 l 626 480 b 655 272 627 459 644 336 l 641 269 "},2:{x_min:-13.671875,x_max:675.9375,ha:749,o:"m 161 688 b 464 759 234 819 397 850 b 414 575 500 712 471 634 l -13 106 l 37 1 l 673 1 l 673 196 l 439 195 b 298 180 429 194 298 180 l 296 188 l 553 433 b 347 997 772 656 694 983 b 5 794 212 1001 83 926 l 161 688 "},j:{x_min:-55.5625,x_max:252.78125,ha:332,o:"m 20 883 b 136 767 20 819 72 767 b 252 883 201 767 252 819 b 136 999 252 949 201 999 b 20 883 72 999 20 949 m -55 -105 b 41 -12 31 -114 41 -52 l 41 720 l 234 720 l 234 -12 b -55 -254 234 -169 147 -294 l -55 -105 "},Z:{x_min:-21.03125,x_max:755.296875,ha:776,o:"m 469 794 l -21 93 l 27 0 l 735 0 l 735 183 l 265 183 l 755 890 l 698 983 l 5 983 l 5 794 l 469 794 "},u:{x_min:38.890625,x_max:613.890625,ha:710,o:"m 613 720 l 422 720 l 422 154 b 231 251 334 124 236 164 l 231 720 l 38 720 l 38 253 b 613 42 38 -71 404 -34 l 613 720 "},1:{x_min:-56.9375,x_max:355.5625,ha:451,o:"m 194 986 l -56 720 l 70 612 l 163 693 l 163 0 l 355 0 l 355 986 l 194 986 "},k:{x_min:47.21875,x_max:675,ha:664,o:"m 47 981 l 47 0 l 240 0 l 240 251 l 252 262 l 451 0 l 675 0 b 387 372 587 116 477 252 l 673 719 l 448 719 l 240 447 l 240 981 l 47 981 "},"":{x_min:-26.390625,x_max:798.609375,ha:824,o:"m 1 647 l -26 509 l 62 509 l 62 456 l 1 456 l -26 320 l 62 320 l 62 317 b 444 -9 62 100 254 -9 b 798 196 575 -9 713 58 l 622 295 b 265 317 538 133 265 165 l 265 320 l 502 320 l 529 456 l 265 456 l 265 509 l 501 509 l 529 647 l 265 647 l 265 667 b 626 693 265 819 541 854 l 790 782 b 448 993 723 926 579 993 b 62 667 254 993 62 882 l 62 647 l 1 647 "},"<":{x_min:40.28125,x_max:531.9375,ha:608,o:"m 531 788 l 40 473 l 40 345 l 531 34 l 531 259 l 258 409 l 531 565 l 531 788 "},t:{x_min:37.484375,x_max:377.78125,ha:424,o:"m 377 150 b 229 254 284 132 229 172 l 229 526 l 356 526 l 356 720 l 229 720 l 229 983 l 37 983 l 37 253 b 377 10 36 29 186 -53 l 377 150 "},W:{x_min:-40.015625,x_max:1229.4375,ha:1283,o:"m 559 377 b 586 497 561 376 586 497 l 597 497 l 619 379 l 746 0 l 946 0 l 1229 983 l 1019 983 l 876 468 l 850 230 l 837 230 l 797 468 l 678 847 l 512 847 b 387 470 457 670 441 650 l 354 240 l 341 240 l 311 469 l 171 983 l -40 983 l 244 0 l 444 0 l 559 377 "},v:{x_min:-51.390625,x_max:643.0625,ha:649,o:"m 288 170 l 259 356 l 154 719 l -51 719 l 204 0 l 386 0 l 643 719 l 436 719 l 329 356 l 302 170 l 288 170 "},">":{x_min:47.21875,x_max:538.890625,ha:615,o:"m 47 565 l 320 409 l 47 259 l 47 34 l 538 345 l 538 473 l 47 788 l 47 565 "},s:{x_min:-7.84375,x_max:509.875,ha:551,o:"m -7 108 b 250 -13 60 18 150 -13 b 509 222 384 -13 509 65 b 302 433 509 358 394 410 b 207 507 272 439 202 464 b 388 521 215 601 345 562 l 484 653 b 255 728 411 712 320 729 b 245 276 -45 724 -94 335 b 315 185 311 267 333 226 b 83 233 290 126 168 153 l -7 108 "},B:{x_min:59.734375,x_max:799.53125,ha:861,o:"m 263 598 l 263 784 l 448 784 b 448 598 604 784 587 598 l 263 598 m 448 423 b 448 198 643 423 640 198 l 263 198 l 263 423 l 448 423 m 757 695 b 448 984 757 886 618 984 l 59 984 l 59 0 l 455 0 b 795 250 682 0 777 118 b 664 523 809 348 786 463 b 757 695 730 561 757 640 "},"?":{x_min:-11.109375,x_max:587.90625,ha:656,o:"m 113 717 b 231 787 145 762 188 783 b 236 522 437 805 430 522 b 150 531 222 522 188 522 l 162 244 l 330 244 l 344 401 b 266 970 712 455 644 970 b -11 823 170 970 69 928 l 113 717 m 143 95 b 252 -14 143 34 191 -14 b 362 95 313 -14 362 34 b 252 205 362 159 313 205 b 143 95 191 205 143 159 "},H:{x_min:70.828125,x_max:841.671875,ha:953,o:"m 637 0 l 841 0 l 841 983 l 637 983 l 637 593 l 275 593 l 275 983 l 70 983 l 70 0 l 275 0 l 275 388 l 637 388 l 637 0 "},c:{x_min:19.4375,x_max:588.890625,ha:628,o:"m 419 243 b 212 247 379 126 212 149 l 212 473 b 415 482 212 569 383 589 l 580 533 b 308 728 543 680 411 728 b 19 472 165 728 19 643 l 19 246 b 308 -7 19 75 165 -7 b 588 188 411 -7 538 42 l 419 243 "},"&":{x_min:19,x_max:900.828125,ha:871,o:"m 489 516 b 634 751 568 564 634 631 b 380 991 634 895 511 991 b 105 737 238 991 105 899 b 171 558 105 670 135 609 b 19 299 91 502 19 427 b 337 -5 19 112 159 -5 b 593 105 450 -5 524 31 l 663 20 l 900 20 l 707 256 l 806 371 l 682 491 l 598 389 l 489 516 m 455 239 b 212 299 363 133 212 180 b 300 414 212 348 255 384 l 455 239 m 374 816 b 443 748 414 816 443 788 b 350 633 443 702 399 658 b 298 741 321 667 298 709 b 374 816 298 784 331 816 "},I:{x_min:43.0625,x_max:247.21875,ha:364,o:"m 43 0 l 247 0 l 247 983 l 43 983 l 43 0 "},G:{x_min:28.25,x_max:797.703125,ha:910,o:"m 757 789 b 411 997 682 943 544 997 b 28 674 219 997 28 889 l 28 317 b 797 317 28 -123 797 -120 l 797 561 l 374 561 l 374 363 l 597 363 l 597 317 b 231 317 597 143 231 142 l 231 674 b 592 701 231 836 522 864 l 757 789 "},"(":{x_min:32.796875,x_max:391.671875,ha:417,o:"m 251 1101 b 244 -164 -38 774 -38 234 l 388 -65 b 391 1006 152 274 151 701 l 251 1101 "},"`":{x_min:-91.671875,x_max:323.609375,ha:357,o:"m 166 979 l -91 979 l 109 727 l 323 727 l 166 979 "},U:{x_min:61.109375,x_max:833.328125,ha:943,o:"m 61 983 l 61 322 b 833 322 61 -127 831 -126 l 833 983 l 627 983 l 627 322 b 266 322 627 138 266 137 l 266 983 l 61 983 "},"":{x_min:-13.984375,x_max:694.53125,ha:738,o:"m 694 470 l 412 975 l 272 975 l -13 468 l 263 -36 l 408 -36 l 694 470 m 482 469 l 340 204 b 195 472 284 306 249 375 b 338 745 245 568 290 651 l 482 469 "},F:{x_min:55.5625,x_max:720.828125,ha:765,o:"m 720 983 l 55 983 l 55 0 l 261 0 l 261 366 l 663 366 l 663 568 l 261 568 l 261 784 l 720 784 l 720 983 "},r:{x_min:34.71875,x_max:418.0625,ha:457,o:"m 172 698 b 34 474 94 658 34 578 l 34 0 l 227 0 l 227 471 b 418 560 236 553 336 582 l 418 717 b 316 730 375 727 344 730 b 248 723 295 730 265 728 l 247 723 b 172 698 220 717 193 707 "},":":{x_min:29.171875,x_max:268.0625,ha:338,o:"m 29 561 b 148 440 29 494 81 440 b 268 561 215 440 268 494 b 148 679 268 627 215 679 b 29 561 81 679 29 627 m 29 129 b 148 9 29 62 81 9 b 268 129 215 9 268 62 b 148 248 268 198 215 248 b 29 129 81 248 29 198 "},x:{x_min:-45.296875,x_max:657.515625,ha:657,o:"m 428 719 b 332 555 383 645 351 586 l 307 487 l 299 487 l 272 555 l 172 719 l -45 719 b 188 359 117 481 147 420 l -45 0 l 172 0 b 265 147 217 68 242 109 l 297 223 l 307 223 l 335 150 l 428 0 l 657 0 b 415 361 589 95 488 258 l 654 719 l 428 719 "},"*":{x_min:-1.234375,x_max:566.515625,ha:610,o:"m 373 984 l 193 984 l 207 820 l 48 886 l -1 711 l 155 676 l 47 547 l 195 440 l 281 590 l 373 440 l 516 548 l 405 677 l 566 708 l 515 883 l 356 822 l 373 984 "},V:{x_min:-56.9375,x_max:851.390625,ha:851,o:"m 387 236 l 347 438 l 161 984 l -56 984 l 298 1 l 495 1 l 851 984 l 633 984 l 440 438 l 402 236 l 387 236 "},h:{x_min:45.828125,x_max:620.828125,ha:733,o:"m 45 983 l 45 0 l 238 0 l 238 526 b 429 463 298 561 429 554 l 429 0 l 620 0 l 620 462 b 238 698 620 681 406 765 l 238 983 l 45 983 "},0:{x_min:41.671875,x_max:752.78125,ha:853,o:"m 237 286 l 237 695 b 556 695 248 841 545 841 l 556 286 b 237 286 545 143 248 143 m 397 -11 b 752 286 565 -11 752 80 l 752 695 b 397 994 752 902 565 994 b 41 695 230 994 41 902 l 41 286 b 397 -11 41 80 230 -11 "},".":{x_min:62.5,x_max:300,ha:379,o:"m 62 112 b 180 -8 62 44 113 -8 b 300 112 247 -8 300 44 b 180 231 300 179 247 231 b 62 112 113 231 62 179 "},"@":{x_min:17.84375,x_max:1004.359375,ha:1064,o:"m 721 315 l 795 719 l 686 745 l 656 710 b 319 238 376 957 89 447 b 578 208 386 177 500 151 b 868 243 665 140 801 183 b 961 759 1004 363 1043 599 b 676 976 907 863 806 944 b 19 477 289 1077 37 773 b 624 12 -4 111 311 -86 l 592 143 b 650 841 -20 -34 77 990 b 837 683 739 817 807 762 b 721 315 891 545 855 388 m 624 560 l 581 355 b 428 349 547 315 468 303 b 428 565 384 402 388 505 b 624 560 477 637 570 656 "},f:{x_min:30.5625,x_max:359.71875,ha:393,o:"m 359 986 b 30 731 176 998 30 904 l 30 0 l 223 0 l 223 423 l 351 423 l 351 618 l 223 618 l 223 731 b 359 797 223 772 273 797 l 359 986 "},";":{x_min:-13.890625,x_max:276.390625,ha:349,o:"m -13 -131 l 159 -131 l 276 190 l 63 190 l -13 -131 m 34 544 b 155 423 34 476 84 423 b 272 544 223 423 272 476 b 155 662 272 611 223 662 b 34 544 84 662 34 611 "},i:{x_min:30.5625,x_max:261.109375,ha:351,o:"m 30 895 b 144 779 30 830 80 779 b 261 895 213 779 261 830 b 144 1011 261 961 213 1011 b 30 895 80 1011 30 961 m 244 720 l 244 0 l 51 0 l 51 720 l 244 720 "},6:{x_min:33.328125,x_max:755.5625,ha:847,o:"m 734 791 b 397 991 654 935 530 991 b 33 692 213 992 33 892 l 33 289 b 397 -8 36 89 213 -10 b 755 289 580 -8 755 91 l 755 342 b 230 555 755 606 397 721 l 230 691 b 562 717 230 820 491 866 l 734 791 m 559 291 b 230 291 559 149 230 151 l 230 341 b 559 341 230 481 559 483 l 559 291 "},A:{x_min:-19.0625,x_max:873.953125,ha:886,o:"m -19 0 l 198 0 b 280 225 230 87 250 141 l 573 225 l 660 0 l 873 0 l 521 983 l 325 983 l -19 0 m 430 766 l 458 626 l 521 412 l 332 412 l 387 625 l 415 766 l 430 766 "},n:{x_min:47.21875,x_max:620.828125,ha:718,o:"m 47 0 l 240 0 l 240 555 b 429 479 309 594 429 578 l 429 0 l 620 0 l 620 480 b 306 743 620 669 469 743 b 47 680 219 743 126 719 l 47 0 "},O:{x_min:37.5,x_max:843.0625,ha:947,o:"m 37 676 l 37 306 b 843 306 37 -130 843 -129 l 843 676 b 37 676 843 1112 37 1115 m 240 676 b 638 676 240 841 640 845 l 638 306 b 240 306 638 143 238 141 l 240 676 "},3:{x_min:-5.640625,x_max:711.359375,ha:782,o:"m 151 712 b 342 794 209 784 287 794 b 466 698 406 794 466 758 b 363 598 466 640 420 598 l 226 598 l 226 425 l 363 425 b 340 188 561 413 558 188 b 145 306 270 188 191 230 l -5 195 b 336 -12 79 37 206 0 b 573 526 663 -44 858 327 b 645 809 680 612 687 723 b 30 819 523 1065 166 1031 l 151 712 "},"]":{x_min:-33.328125,x_max:266.671875,ha:367,o:"m -33 -150 l 266 -150 l 266 991 l -33 991 l -33 806 l 68 806 l 68 33 l -33 33 l -33 -150 "},m:{x_min:48.609375,x_max:952.78125,ha:1053,o:"m 48 0 l 237 0 l 237 537 b 405 497 283 587 405 565 l 405 0 l 590 0 l 590 494 b 761 493 590 576 761 579 l 761 0 l 952 0 l 952 489 b 684 735 952 653 816 735 b 498 644 616 735 544 707 b 305 743 459 718 379 742 b 48 654 211 744 111 708 l 48 0 "},9:{x_min:27.6875,x_max:749.90625,ha:840,o:"m 48 191 b 386 -8 129 47 252 -8 b 749 290 569 -9 749 90 l 749 693 b 386 991 747 893 569 993 b 27 693 202 991 27 891 l 27 640 b 552 427 27 376 381 263 l 552 291 b 220 265 552 162 291 116 l 48 191 m 223 691 b 552 691 223 833 552 832 l 552 641 b 223 641 552 501 223 500 l 223 691 "},l:{x_min:36.109375,x_max:344.4375,ha:375,o:"m 344 168 b 229 266 265 168 229 212 l 229 983 l 36 983 l 36 266 b 344 2 36 109 133 -29 l 344 168 "},8:{x_min:14.3125,x_max:747.125,ha:818,o:"m 369 176 b 208 300 296 176 208 219 b 369 429 208 394 284 429 l 390 429 b 551 300 475 429 551 394 b 390 176 551 219 463 176 l 369 176 m 390 -8 b 747 309 588 -8 742 105 b 617 527 747 391 713 480 b 708 687 680 565 708 636 b 390 962 708 881 551 962 l 369 962 b 75 805 246 962 128 909 b 139 523 36 729 36 588 b 14 309 46 462 14 376 b 369 -8 17 105 169 -8 l 390 -8 m 391 800 b 520 697 457 800 520 762 b 373 594 520 623 440 594 b 239 697 309 594 239 623 b 369 800 239 762 303 800 l 391 800 "},p:{x_min:31.9375,x_max:611.140625,ha:707,o:"m 226 -263 l 226 18 b 611 238 383 -53 613 38 l 611 486 b 312 735 597 672 463 735 b 31 681 222 735 119 714 l 31 -263 l 226 -263 m 226 576 b 418 504 293 610 415 590 l 418 228 b 226 158 408 145 288 124 l 226 576 "},4:{x_min:-8.375,x_max:708.46875,ha:767,o:"m 641 983 l 466 983 l -8 356 l 84 219 l 445 219 l 445 1 l 641 1 l 641 219 l 708 219 l 708 398 l 641 398 l 641 983 m 476 729 b 454 591 472 702 454 591 l 450 384 l 229 384 l 425 654 l 468 730 l 476 729 "},R:{x_min:60.046875,x_max:868.390625,ha:867,o:"m 575 373 b 798 669 717 401 798 488 b 447 983 793 893 644 983 l 60 983 l 60 0 l 265 0 l 265 359 l 337 359 l 617 0 l 868 0 l 575 373 m 265 545 l 265 777 l 447 777 b 594 668 533 780 594 751 b 447 545 594 581 537 545 l 265 545 "},o:{x_min:29.171875,x_max:605.5625,ha:694,o:"m 318 548 b 412 477 362 548 412 523 l 412 240 b 318 162 412 194 362 162 b 222 240 272 162 222 194 l 222 477 b 318 548 222 523 272 548 m 29 477 l 29 244 b 318 -11 29 70 173 -9 b 605 244 461 -9 605 70 l 605 477 b 318 734 605 648 461 733 b 29 477 173 733 29 648 "},5:{x_min:37.5,x_max:727.984375,ha:817,o:"m 37 191 b 356 -8 109 47 236 -2 b 554 643 751 -26 854 495 b 234 655 472 683 348 702 l 234 790 l 659 790 l 659 983 l 45 983 l 45 431 l 159 434 b 365 498 252 486 293 500 b 359 188 580 495 577 188 b 187 291 300 188 230 223 l 37 191 "}},cssFontWeight:"normal",ascender:1050,underlinePosition:-75,cssFontStyle:"normal",boundingBox:{yMin:-263.359375,xMin:-91.671875,yMax:1101.171875,xMax:1229.4375},resolution:1e3,original_font_information:{postscript_name:"Uni-Sans-Bold",version_string:"Version 001.001",vendor_url:"",full_font_name:"Uni-Sans-Bold",font_family_name:"Uni Sans Bold",copyright:"Copyright (c) 2009 by  2009 Designed by Svetoslav Simov  Fontfabric, Inc. All rights reserved.",description:"Copyright (c) 2002 by  2009 Designed by Svetoslav Simov  Fontfabric, Inc. All rights reserved.",trademark:"Uni Sans Bold is a trademark of  2009 Designed by Svetoslav Simov  Fontfabric, Inc.",designer:"Svetoslav Simov",designer_url:"http://fontfabric.com/",unique_font_identifier:"2009DesignedbySvetoslavSimovFontfabric,Inc: Uni Sans Bold: 2009",license_url:"",license_description:"",manufacturer_name:" 2009 Designed by Svetoslav Simov  Fontfabric, Inc",font_sub_family_name:"Regular"},descender:-339,familyName:"Uni Sans Bold",lineHeight:1667,underlineThickness:50}
},{}],7:[function(t,e){var i=t("klasse"),n=t("vecmath").Vector3,r=(t("vecmath").Matrix4,t("./triangulate")),o=t("./util"),a=(new n,new i({initialize:function(t,e,i,n,r,s){if(!e)throw new Error("must specify a valid character for this glyph");if(!t)throw new Error("must specify a typeface 'font face' for a Glyph");r="number"==typeof r?r:a.DEFAULT_SIMPLIFY,n="number"==typeof n?n:a.DEFAULT_STEPS,i="number"==typeof i?i:a.DEFAULT_SIZE,s="number"==typeof s?s:1,this.character=e;var l=o.getShapeList(t,i,e,n);if(!l&&(l=o.getShapeList(t,i,a.DEFAULT_CHARACTER,n),!l))throw new Error("could not find glyph '"+e+"' or the default '"+a.DEFAULT_CHARACTER+"'");if(r>0)for(var h=0;h<l.length;h++)l[h]=l[h].simplify(r);if(this.shapes=l,this.bounds={minX:0,maxX:0,minY:0,maxY:0},this.points=[],this.triangulate(this.shapes),!a.SAVE_CONTOUR){for(var h=0;h<this.shapes.length;h++)this.shapes[h].length=0;this.shapes.length=0,this.shapes=null}},triangulate:function(t){this.shapes=t||this.shapes,this.points.length=0;var e=r(this.shapes)||[];if(this.bounds.minX=0,this.bounds.minY=0,this.bounds.maxX=0,this.bounds.maxY=0,e.length>0){for(var i=Number.MAX_VALUE,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=-Number.MAX_VALUE,l=0;l<e.length;l++)for(var h=e[l],c=0;c<h.points_.length;c++){var u=new n(h.points_[c].x,h.points_[c].y,0);i=Math.min(i,u.x),o=Math.min(o,u.y),a=Math.max(a,u.x),s=Math.max(s,u.y),this.points.push(u)}this.bounds.minX=i,this.bounds.minY=o,this.bounds.maxX=a,this.bounds.maxY=s}},applyTransform:function(t){var e=this.points;if(0!==e.length){for(var i=Number.MAX_VALUE,n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=-Number.MAX_VALUE,a=0;a<e.length;a++){var s=e[a];s.transformMat4(t),i=Math.min(i,s.x),n=Math.min(n,s.y),r=Math.max(r,s.x),o=Math.max(o,s.y)}this.bounds.minX=i,this.bounds.minY=n,this.bounds.maxX=r,this.bounds.maxY=o}},destroyContour:function(){if(this.shapes){for(var t=0;t<this.shapes.length;t++)this.shapes[t].length=0;this.shapes.length=0,this.shapes=null}},destroy:function(){this.destroyContour(),this.points&&(this.points.length=0,this.points=null)}}));a.DEFAULT_SIZE=12,a.DEFAULT_STEPS=10,a.DEFAULT_SIMPLIFY=3,a.DEFAULT_CHARACTER="?",a.SAVE_CONTOUR=!1,e.exports=a},{"./triangulate":11,"./util":13,klasse:34,vecmath:61}],8:[function(t,e){var i=t("klasse"),n=(t("vecmath").Vector2,t("vecmath").Vector3),r=t("vecmath").Matrix4,o=(t("./triangulate"),t("./util")),a=t("./Glyph"),s=new n,l=new r,h=new i({initialize:function(t,e,i,n,r,s,l,c,u){if(i="number"==typeof i?i:a.DEFAULT_SIZE,this.size=i,this.text="",this.face=e,this.align=s||h.Align.LEFT,this.glyphs=[],"number"!=typeof l){var d=o.getGlyphMetrics(e,i,"W");this.spaceWidth=d?d.xadvance:i/2}else this.spaceWidth=l;this.letterSpacing=c||0,this.lineHeight=o.getFaceHeight(e,i)+u,this.wordCount=0,this.bounds={minX:0,minY:0,maxX:0,maxY:0},this.setText(t,n,r)},setText:function(t,e,i){t=(t||"").toString().trim(),this.text=t,this.glyphs.length=0;var n=this.size,r=this.face;if(this.bounds.minX=0,this.bounds.minY=0,this.bounds.maxX=0,this.bounds.maxY=0,0!==this.text.length){this.bounds.minX=Number.MAX_VALUE,this.bounds.minY=Number.MAX_VALUE,this.bounds.maxX=-Number.MAX_VALUE,this.bounds.maxY=-Number.MAX_VALUE;for(var c=0,u=[],d=[],f=0,p=0,m=0,g=[0],v=0,y=0,E=0;E<t.length;E++){var x=t.charAt(E);if("\r"!=x)if("\n"!=x)if(" "!=x&&"	"!=x){var T=new a(r,x,n,e,i);T.word=y;var _=o.getGlyphMetrics(r,n,x);_||(_={xadvance:0}),E>0&&(c+=u[E-1].xadvance+this.letterSpacing),m=Math.max(m,c+T.bounds.minX+(T.bounds.maxX-T.bounds.minX)),g[g.length-1]=m,v=Math.max(v,m),d.push({x:c,y:p,row:f}),u.push(_),this.glyphs.push(T)}else E>0&&"."===t.charAt(E-1)&&(c-=h.PERIOD_KERNING),u.push({xadvance:this.spaceWidth});else u.push({xadvance:0}),p+=this.lineHeight,c=0,m=0,g.push(0),f++,y++;else u.push({xadvance:0})}this.wordCount=0===this.glyphs.length?0:y+1;for(var E=0;E<this.glyphs.length;E++){var T=this.glyphs[E],c=d[E].x,p=d[E].y,b=d[E].row,w=g[b];this.align===h.Align.CENTER?c+=(v-w)/2:this.align===h.Align.RIGHT&&(c+=v-w),l.idt(),l.translate(s.set(c,p,0)),T.applyTransform(l),this.bounds.minX=Math.min(this.bounds.minX,c+T.bounds.minX),this.bounds.maxX=Math.max(this.bounds.maxX,T.bounds.minX+(T.bounds.maxX-T.bounds.minX)),this.bounds.minY=Math.min(this.bounds.minY,T.bounds.minY),this.bounds.maxY=Math.max(this.bounds.maxY,T.bounds.maxY)}this.bounds.minX=0,this.bounds.maxX=v}},_maxWidth:function(){},destroy:function(){if(this.glyphs)for(var t=0;t<this.glyphs.length;t++)this.glyphs[t].destroy()}});h.Align={CENTER:"CENTER",LEFT:"LEFT",RIGHT:"RIGHT"},h.PERIOD_KERNING=0,e.exports=h},{"./Glyph":7,"./triangulate":11,"./util":13,klasse:34,vecmath:61}],bRhrlU:[function(t,e){e.exports={triangulate:t("./triangulate"),util:t("./util"),Glyph:t("./Glyph"),Text3D:t("./Text3D")}},{"./Glyph":7,"./Text3D":8,"./triangulate":11,"./util":13}],text3d:[function(t,e){e.exports=t("bRhrlU")},{}],11:[function(t,e){function i(t,e){for(var i=0,r=0;r<e.length;++r){var o,a=e[r];o=r===e.length-1?e[0]:e[r+1],a.y<=t.y?o.y>t.y&&n(a,o,t)>0&&++i:o.y<=t.y&&n(a,o,t)<0&&--i}return i}function n(t,e,i){return(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y)}function r(t){for(var e=0,i=0;i<t.length;i++){var n=i===t.length-1?t[0]:t[i+1];e+=(n.x-t[i].x)*(n.y+t[i].y)}return e>0}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.x==t.x&&n.y==t.y)return i}return-1}function a(t,e,i){var n=(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y),r=1e-7;return Math.abs(n)<r}function s(t){for(var e=[],i=0;i<t.length;i++){var n=t[i].x,r=t[i].y,s=new h.Point(n,r);-1===o(s,e)&&(0===i||i===t.length-1||!a(t[i-1],t[i],t[i+1]))&&e.push(s)}return e}function l(){for(var t=0;10>t;t++);}var h=t("poly2tri");e.exports=function(t){for(var e=!1,n=null,o={holes:[],contour:[]},a=[],c=0;c<t.length;c++){var u=t[c].points,d=s(u);if(0==c){e=r(d);{i(u[0],u)}}try{if(null!==n){{var f=r(d);i(u[0],u)}e!==f?(n.addHole(d),o.holes.push(u)):(l(d,n),n.triangulate(),a=a.concat(n.getTriangles()),n=new h.SweepContext(d),o={holes:[],contour:u})}else n=new h.SweepContext(d),o={holes:[],contour:u}}catch(p){return null}}if(null!==n)try{l(d,n),n.triangulate(),a=a.concat(n.getTriangles())}catch(p){return null}return a}},{poly2tri:39}],12:[function(t,e){e.exports=t(5)},{}],13:[function(t,e){function i(t,e,i){var n=null,r=null;for(var o in t){var a=t[o];if(a){if(o===e)return a;null===n&&(n=a),i&&null===r&&o===i&&(r=a)}}return null!==r?r:n}function n(t,e,i){for(var n=t.points,r=0;r<n.length;r++)n[r].x=n[r].x*e.x+i.x,n[r].y=n[r].y*e.y+i.y}function r(t,e,i,r){r=r||10,l.fontSize=e;var h=t.glyphs[i];if(!h||!h.o)return null;var c=[],u=new a,d=!1,f=.5;u.approximateCurves=d,u.approximationFactor=f,u.steps=r;for(var p=s.pixelsFromPoints(t,l,1),m=new o(p*l.fontStretchPercent,-p),g=new o(0,t.ascender*p),v=h.o.split(" "),y=v.length,E=0;y>E;){var x=v[E++];switch(x){case"m":1!==E&&(n(u,m,g),c.push(u),u=new a,u.approximateCurves=d,u.approximationFactor=f,u.steps=r),u.moveTo(v[E++],v[E++]);break;case"l":u.lineTo(v[E++],v[E++]);break;case"q":var T=v[E++],_=v[E++];u.quadraticCurveTo(v[E++],v[E++],T,_);break;case"b":var b=v[E++],w=v[E++];u.bezierCurveTo(v[E++],v[E++],v[E++],v[E++],b,w)}}return n(u,m,g),c.push(u),c}var o=t("vecmath").Vector2,a=t("shape2d"),s=t("./typeface-stripped.js"),l={fontSize:12,fontStretchPercent:1,letterSpacing:0};e.exports.getFaces=function(){return s.faces},e.exports.getFace=function(t,e,n){t=(t||"").toLowerCase();var r=null;if(s&&s.faces){if(t&&!(t in s.faces))throw"No font with the name "+t;var o=t?s.faces[t]:i(s.faces,t);if(e&&!(e in o))throw"No '"+t+"' weight with the value "+e;var a=e?o[e]:i(o,e,"normal");if(n&&!(n in a))throw"No '"+t+"' style with the type "+n;r=n?a[n]:i(a,n,"normal")}return r},e.exports.getFaceHeight=function(t,e){return l.fontSize=e,Math.round(s.pixelsFromPoints(t,l,t.lineHeight))},e.exports.getFaceAscent=function(t,e){return l.fontSize=e,Math.round(s.pixelsFromPoints(t,l,t.ascender))},e.exports.pixelsFromPoints=function(t,e,i){return l.fontSize=e,s.pixelsFromPoints(t,l,"number"==typeof i?i:1)},e.exports.pointsFromPixels=function(t,e,i){return l.fontSize=e,s.pointsFromPixels(t,l,i)},e.exports.getGlyphMetrics=function(t,i,n){var r=t.glyphs[n];if(!r||!r.o)return null;var o=e.exports.pixelsFromPoints(t,i);return{xadvance:r.ha?r.ha*o:0,height:e.exports.getFaceHeight(t,i),ascent:e.exports.getFaceAscent(t,i)}},e.exports.getShapeList=r},{"./typeface-stripped.js":12,shape2d:45,vecmath:61}],14:[function(t,e){var i=t("klasse"),n=t("./vecutil"),r=(t("vecmath").Vector2,t("vecmath").Vector3),o=t("vecmath").Vector4,a=t("vecmath").Matrix4,s=new r,l=new o,h=new i({initialize:function(){this.direction=new r(0,0,-1),this.up=new r(0,1,0),this.position=new r,this.projection=new a,this.view=new a,this.combined=new a,this.invProjectionView=new a,this.near=1,this.far=100,this.ray={origin:new r,direction:new r},this.viewportWidth=0,this.viewportHeight=0},translate:function(t,e,i){"object"==typeof t?(this.position.x+=t.x||0,this.position.y+=t.y||0,this.position.z+=t.z||0):(this.position.x+=t||0,this.position.y+=e||0,this.position.z+=i||0)},lookAt:function(t,e,i){var n=this.direction,r=this.up;"object"==typeof t?n.copy(t):n.set(t,e,i),n.sub(this.position).normalize(),s.copy(n).cross(r).normalize(),r.copy(s).cross(n).normalize()},rotate:function(t,e){n.rotate(this.direction,e,t),n.rotate(this.up,e,t)},rotateAround:function(t,e,i){tmpVec.copy(t).sub(this.position),this.translate(tmpVec),this.rotate(e,i),this.translate(tmpVec.negate())},project:function(t,e){e||(e=new o);var i=this.viewportWidth,n=this.viewportHeight,r=h.NEAR_RANGE,a=h.FAR_RANGE;return l.set(t.x,t.y,t.z,1),l.transformMat4(this.combined),l.x=l.x/l.w,l.y=l.y/l.w,l.z=l.z/l.w,e.x=i/2*l.x+(0+i/2),e.y=n/2*l.y+(0+n/2),e.z=(a-r)/2*l.z+(a+r)/2,(0===e.w||e.w)&&(e.w=1/l.w),e},unproject:function(t,e){e||(e=new r);var i=l.set(0,0,this.viewportWidth,this.viewportHeight);return e.copy(t).unproject(i,this.invProjectionView)},getPickRay:function(t,e){var i=this.ray.origin.set(t,e,0),n=this.ray.direction.set(t,e,1),r=l.set(0,0,this.viewportWidth,this.viewportHeight),o=this.invProjectionView;return i.unproject(r,o),n.unproject(r,o),n.sub(i).normalize(),this.ray},update:function(){}});h.FAR_RANGE=1,h.NEAR_RANGE=0,e.exports=h},{"./vecutil":18,klasse:34,vecmath:61}],15:[function(t,e){var i=t("klasse"),n=t("vecmath").Vector3,r=(t("vecmath").Vector4,t("vecmath").Matrix4,t("./Camera")),o=new n,a=new i({Extends:r,initialize:function(t,e){r.call(this),this.viewportWidth=t||0,this.viewportHeight=e||0,this.zoom=1,this.near=0,this.update()},setToOrtho:function(t,e,i){var n=this.zoom;e="number"==typeof e?e:this.viewportWidth,i="number"==typeof i?i:this.viewportHeight,this.up.set(0,t?-1:1,0),this.direction.set(0,0,t?1:-1),this.position.set(n*e/2,n*i/2,0),this.viewportWidth=e,this.viewportHeight=i,this.update()},update:function(){var t=this.viewportWidth,e=this.viewportHeight,i=Math.abs(this.near),n=Math.abs(this.far),r=this.zoom;this.projection.ortho(r*-t/2,r*t/2,r*-e/2,r*e/2,i,n),o.copy(this.position).add(this.direction),this.view.lookAt(this.position,o,this.up),this.combined.copy(this.projection).mul(this.view),this.invProjectionView.copy(this.combined).invert()}});e.exports=a},{"./Camera":14,klasse:34,vecmath:61}],16:[function(t,e){var i=t("klasse"),n=t("vecmath").Matrix4,r=t("vecmath").Vector2,o=t("vecmath").Vector3,a=t("./Camera"),s=new o,l=null,h=null,c=null,u=new i({Extends:a,initialize:function(t,e,i){a.call(this),this.viewportWidth=e,this.viewportHeight=i,this.billboardMatrixDirty=!0,this.fieldOfView=t,this.update()},setViewport:function(t,e){this.viewportWidth=t,this.viewportHeight=e},updateBillboardMatrix:function(){l||(l=new o,h=new o,c=new n);var t=l.set(this.direction).negate(),e=h.set(this.up).cross(t).normalize(),i=s.set(t).cross(e).normalize(),r=c.val;r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=0,r[4]=i.x,r[5]=i.y,r[6]=i.z,r[7]=0,r[8]=t.x,r[9]=t.y,r[10]=t.z,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this.billboardMatrixDirty=!1},getPointSize:function(t,e,i){i||(i=new r),this.billboardMatrixDirty&&this.updateBillboardMatrix();var n=s,o=e.x/2,a=e.y/2;n.set(-o,-a,0).transformMat4(c).add(t),this.project(n,n);var l=n.x,h=n.y;n.set(o,a,0).transformMat4(c).add(t),this.project(n,n);var u=n.x,d=n.y,f=Math.abs(u-l),p=Math.abs(d-h);return i.set(f,p)},update:function(){var t=this.viewportWidth/this.viewportHeight;this.projection.perspective(this.fieldOfView,t,Math.abs(this.near),Math.abs(this.far)),s.copy(this.position).add(this.direction),this.view.lookAt(this.position,s,this.up),this.combined.copy(this.projection).mul(this.view),this.invProjectionView.copy(this.combined).invert(),this.billboardMatrixDirty=!0}});e.exports=u},{"./Camera":14,klasse:34,vecmath:61}],17:[function(t,e){e.exports={vecutil:t("./vecutil"),Camera:t("./Camera"),PerspectiveCamera:t("./PerspectiveCamera"),OrthographicCamera:t("./OrthographicCamera")}},{"./Camera":14,"./OrthographicCamera":15,"./PerspectiveCamera":16,"./vecutil":18}],18:[function(t,e){var i=t("vecmath").Vector3,n=t("vecmath").Matrix4,r=t("vecmath").Quaternion,o=new n,a=new r,s=new i,l={};l.rotate=function(t,e,i){return a.setAxisAngle(e,i),o.fromRotationTranslation(a,s.set(0,0,0)),t.transformMat4(o)},e.exports=l},{vecmath:61}],19:[function(t,e){e.exports.lerp=function(t,e,i){return t*(1-i)+e*i},e.exports.smoothstep=function(t,e,i){return i=Math.max(0,Math.min(1,(i-t)/(e-t))),i*i*(3-2*i)}},{}],20:[function(t,e){e.exports={MeshRenderer:t("./lib/MeshRenderer")}},{"./lib/MeshRenderer":21}],21:[function(t,e){var i=t("klasse"),n=t("kami").Mesh,r=t("kami").ShaderProgram,o=t("vecmath").Matrix4,a=t("number-util").colorToFloat,s=new i({initialize:function(t,e){if(this.context=t,!t)throw new Error("no WebGLContext specified to MeshRenderer");e=e||{};var i="undefined"!=typeof e.hasNormals?e.hasNormals:!1,r="undefined"!=typeof e.hasColors?e.hasColors:!1;this.numTexCoords=e.numTexCoords||0,this.maxVertices="number"==typeof e.maxVertices?e.maxVertices:500;var a=this._createVertexAttributes(i,r);this.mesh=new n(t,!1,this.maxVertices,0,a),this.normalOffset=i?3:0,this.colorOffset=r?this.normalOffset+3:0,this.texCoordOffset=this.numTexCoords>0?this.colorOffset+1:0,this.numSetTexCoords=0,this.vertices=this.mesh.vertices,this.vertexSize=this.mesh.vertexStride/4,this.primitiveType=t.gl.TRIANGLES,this.premultiplied=!0,this.vertexIdx=0,this.numVertices=0,this.projModelView=new o,this._shader=s.createDefaultShader(t,i,r,this.numTexCoords),this.defaultShader=this._shader,this.ownsShader=!0},destroy:function(){this.ownsShader&&this.defaultShader&&this.defaultShader.destroy(),this.mesh&&this.mesh.destroy(),this.defaultShader=null,this._shader=null,this.mesh=null,this.context=null},shader:{set:function(t){this._shader=t?t:this.defaultShader,this.drawing&&(this._shader.bind(),this.uploadMatrices())},get:function(){return this._shader}},_createVertexAttributes:function(t,e){var i=this.context.gl,o=[new n.Attrib(r.POSITION_ATTRIBUTE,3)];t&&o.push(new n.Attrib(r.NORMAL_ATTRIBUTE,3)),e&&o.push(new n.Attrib(r.COLOR_ATTRIBUTE,4,null,i.UNSIGNED_BYTE,!0,1));for(var a=0;a<this.numTexCoords;a++)o.push(new n.Attrib(r.TEXCOORD_ATTRIBUTE+a,2));return o},begin:function(t,e){if(this.drawing)throw"batch.end() must be called before begin";this.drawing=!0,t&&this.projModelView.set(t),this.primitiveType="undefined"==typeof e?this.context.gl.TRIANGLES:e;var i=this._shader;i.bind(),this.uploadMatrices()},uploadMatrices:function(){var t=this._shader;t.setUniformMatrix4("u_projModelView",this.projModelView);for(var e=0;e<this.numTexCoords;e++)t.setUniformi("u_sampler"+e,e)},color:function(t,e,i,n){var r="number"==typeof t;r&&"number"==typeof e&&"number"==typeof i?n=n||0===n?n:1:t=e=i=n=r?t:1,this.premultiplied&&(t*=n,e*=n,i*=n);var o=a(~~(255*t),~~(255*e),~~(255*i),~~(255*n));this.vertices[this.vertexIdx+this.colorOffset]=o},texCoord:function(t,e){var i=this.vertexIdx+this.texCoordOffset;this.vertices[i+this.numSetTexCoords]=t||0,this.vertices[i+this.numSetTexCoords+1]=e||0,this.numSetTexCoords+=2},normal:function(t,e,i){var n=this.vertexIdx+this.normalOffset;this.vertices[n]=t||0,this.vertices[n+1]=e||0,this.vertices[n+2]=i||0},vertex:function(t,e,i){var n=this.vertexIdx;this.vertices[n]=t||0,this.vertices[n+1]=e||0,this.vertices[n+2]=i||0,this.numSetTexCoords=0,this.vertexIdx+=this.vertexSize,this.numVertices++},end:function(){if(!this.drawing)throw"renderer.begin() must be called before end";if(this.drawing=!1,0!==this.numVertices){{var t=this._shader;this.context.gl}this.mesh.bind(t),this.mesh.verticesDirty=!0,this.mesh.draw(this.primitiveType,4*this.vertexIdx/this.mesh.vertexStride,0,this.vertexIdx),this.mesh.unbind(t),this.numSetTexCoords=0,this.vertexIdx=0,this.numVertices=0}}});s.createDefaultShader=function(t,e,i,n){var o=s.createVertexShader(e,i,n),a=s.createFragmentShader(i,n);return new r(t,o,a)},s.createVertexShader=function(t,e,i){i=i||0;var n="";n+="attribute vec4 "+r.POSITION_ATTRIBUTE+";\n"+(t?"attribute vec3 "+r.NORMAL_ATTRIBUTE+";\n":"")+(e?"attribute vec4 "+r.COLOR_ATTRIBUTE+";\n":"");var o;for(o=0;i>o;o++)n+="attribute vec2 "+r.TEXCOORD_ATTRIBUTE+o+";\n";for(n+="uniform mat4 u_projModelView;\n",n+=e?"varying vec4 v_col;\n":"",o=0;i>o;o++)n+="varying vec2 v_tex"+o+";\n";for(n+="void main() {\n   gl_Position = u_projModelView * "+r.POSITION_ATTRIBUTE+";\n"+(e?"   v_col = "+r.COLOR_ATTRIBUTE+";\n":""),o=0;i>o;o++)n+="   v_tex"+o+" = "+r.TEXCOORD_ATTRIBUTE+o+";\n";return n+="   gl_PointSize = 1.0;\n",n+="}\n"},s.createFragmentShader=function(t,e){e=e||0;var i="#ifdef GL_ES\nprecision mediump float;\n#endif\n";t&&(i+="varying vec4 v_col;\n");var n;for(n=0;e>n;n++)i+="varying vec2 v_tex"+n+";\n",i+="uniform sampler2D u_sampler"+n+";\n";for(i+="void main() {\n   gl_FragColor = "+(t?"v_col":"vec4(1, 1, 1, 1)"),e>0&&(i+=" * "),n=0;e>n;n++)i+=n==e-1?" texture2D(u_sampler"+n+",  v_tex"+n+")":" texture2D(u_sampler"+n+",  v_tex"+n+") *";return i+=";\n}"},e.exports=s},{kami:31,klasse:34,"number-util":22,vecmath:61}],22:[function(t,e){var i=new Int8Array(4),n=new Int32Array(i.buffer,0,1),r=new Float32Array(i.buffer,0,1),o=function(){};o.intBitsToFloat=function(t){return n[0]=t,r[0]},o.floatToIntBits=function(t){return r[0]=t,n[0]},o.intToFloatColor=function(t){return o.intBitsToFloat(4278190079&t)},o.colorToFloat=function(t,e,i,n){var r=n<<24|i<<16|e<<8|t;return o.intToFloatColor(r)},o.isPowerOfTwo=function(t){return 0===(t&t-1)},o.nextPowerOfTwo=function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1},e.exports=o},{}],23:[function(t,e){var i=t("klasse"),n=t("./glutils/Mesh"),r=t("number-util").colorToFloat,o=new i({initialize:function(t,e){if("object"!=typeof t)throw"GL context not specified to SpriteBatch";if(this.context=t,this.size=e||500,this.size>10922)throw"Can't have more than 10922 sprites per batch: "+this.size;this._blendSrc=this.context.gl.ONE,this._blendDst=this.context.gl.ONE_MINUS_SRC_ALPHA,this._blendingEnabled=!0,this._shader=this._createShader(),this.defaultShader=this._shader,this.ownsShader=!0,this.idx=0,this.drawing=!1,this.mesh=this._createMesh(this.size),this.color=r(255,255,255,255),this.premultiplied=!0},blendingEnabled:{set:function(t){var e=this._blendingEnabled;if(this.drawing&&this.flush(),this._blendingEnabled=t,this.drawing&&e!=t){var i=this.context.gl;t?i.enable(i.BLEND):i.disable(i.BLEND)}},get:function(){return this._blendingEnabled}},blendSrc:{set:function(t){this.drawing&&this.flush(),this._blendSrc=t},get:function(){return this._blendSrc}},blendDst:{set:function(t){this.drawing&&this.flush(),this._blendDst=t},get:function(){return this._blendDst}},setBlendFunction:function(t,e){this.blendSrc=t,this.blendDst=e},shader:{set:function(t){var e=this.drawing;e&&this.end(),this._shader=t?t:this.defaultShader,e&&this.begin()},get:function(){return this._shader}},setColor:function(t,e,i,n){var o="number"==typeof t;o&&"number"==typeof e&&"number"==typeof i?n=n||0===n?n:1:t=e=i=n=o?t:1,this.premultiplied&&(t*=n,e*=n,i*=n),this.color=r(~~(255*t),~~(255*e),~~(255*i),~~(255*n))},_createMesh:function(t){var e=4*t*this.getVertexSize(),i=6*t,r=this.context.gl;this.vertices=new Float32Array(e),this.indices=new Uint16Array(i);for(var o=0,a=0;i>o;o+=6,a+=4)this.indices[o+0]=a+0,this.indices[o+1]=a+1,this.indices[o+2]=a+2,this.indices[o+3]=a+0,this.indices[o+4]=a+2,this.indices[o+5]=a+3;var s=new n(this.context,!1,e,i,this._createVertexAttributes());return s.vertices=this.vertices,s.indices=this.indices,s.vertexUsage=r.DYNAMIC_DRAW,s.indexUsage=r.STATIC_DRAW,s.dirty=!0,s},_createShader:function(){throw"_createShader not implemented"},_createVertexAttributes:function(){throw"_createVertexAttributes not implemented"},getVertexSize:function(){throw"getVertexSize not implemented"},begin:function(){if(this.drawing)throw"batch.end() must be called before begin";if(this.drawing=!0,this.shader.bind(),this.mesh.bind(this.shader),this._blendingEnabled){var t=this.context.gl;t.enable(t.BLEND)}},end:function(){if(!this.drawing)throw"batch.begin() must be called before end";if(this.idx>0&&this.flush(),this.drawing=!1,this.mesh.unbind(this.shader),this._blendingEnabled){var t=this.context.gl;t.disable(t.BLEND)}},_preRender:function(){},flush:function(){if(0!==this.idx){var t=this.context.gl;this._blendingEnabled&&this._blendSrc&&this._blendDst&&t.blendFunc(this._blendSrc,this._blendDst),this._preRender();var e=this.getVertexSize(),i=this.idx/(4*e);this.mesh.verticesDirty=!0,this.mesh.draw(t.TRIANGLES,6*i,0,this.idx),this.idx=0}},draw:function(){},drawVertices:function(){},drawRegion:function(t,e,i,n,r){this.draw(t.texture,e,i,n,r,t.u,t.v,t.u2,t.v2)},destroy:function(){this.vertices=null,this.indices=null,this.size=this.maxVertices=0,this.ownsShader&&this.defaultShader&&this.defaultShader.destroy(),this.defaultShader=null,this._shader=null,this.mesh&&this.mesh.destroy(),this.mesh=null}});e.exports=o},{"./glutils/Mesh":29,klasse:34,"number-util":32}],24:[function(t,e){var i=t("klasse"),n=t("./BaseBatch"),r=t("./glutils/Mesh"),o=t("./glutils/ShaderProgram"),a=new i({Mixins:n,initialize:function(t,e){n.call(this,t,e),this.projection=new Float32Array(2),this.projection[0]=this.context.width/2,this.projection[1]=this.context.height/2,this.texture=null},resize:function(t,e){this.setProjection(t/2,e/2)},getVertexSize:function(){return a.VERTEX_SIZE},_createVertexAttributes:function(){var t=this.context.gl;return[new r.Attrib(o.POSITION_ATTRIBUTE,2),new r.Attrib(o.COLOR_ATTRIBUTE,4,null,t.UNSIGNED_BYTE,!0,1),new r.Attrib(o.TEXCOORD_ATTRIBUTE+"0",2)]},setProjection:function(t,e){var i=this.projection[0],n=this.projection[1];this.projection[0]=t,this.projection[1]=e,this.drawing&&(t!=i||e!=n)&&(this.flush(),this._updateMatrices())},_createShader:function(){var t=new o(this.context,a.DEFAULT_VERT_SHADER,a.DEFAULT_FRAG_SHADER);return t.log&&0,t},updateMatrices:function(){this.shader.setUniformfv("u_projection",this.projection)},_preRender:function(){this.texture&&this.texture.bind()},begin:function(){var t=this.context.gl;n.prototype.begin.call(this),this.updateMatrices(),this.shader.setUniformi("u_texture0",0),t.depthMask(!1)},end:function(){var t=this.context.gl;n.prototype.end.call(this),t.depthMask(!0)},flush:function(){this.texture&&0!==this.idx&&(n.prototype.flush.call(this),a.totalRenderCalls++)},draw:function(t,e,i,n,r,o,a,s,l){if(!this.drawing)throw"Illegal State: trying to draw a batch before begin()";if(t){null===this.texture||this.texture.id!==t.id?(this.flush(),this.texture=t):this.idx==this.vertices.length&&this.flush(),n=0===n?n:n||t.width,r=0===r?r:r||t.height,e=e||0,i=i||0;var h=e,c=e+n,u=i,d=i+r;o=o||0,s=0===s?s:s||1,a=a||0,l=0===l?l:l||1;var f=this.color;this.vertices[this.idx++]=h,this.vertices[this.idx++]=u,this.vertices[this.idx++]=f,this.vertices[this.idx++]=o,this.vertices[this.idx++]=a,this.vertices[this.idx++]=c,this.vertices[this.idx++]=u,this.vertices[this.idx++]=f,this.vertices[this.idx++]=s,this.vertices[this.idx++]=a,this.vertices[this.idx++]=c,this.vertices[this.idx++]=d,this.vertices[this.idx++]=f,this.vertices[this.idx++]=s,this.vertices[this.idx++]=l,this.vertices[this.idx++]=h,this.vertices[this.idx++]=d,this.vertices[this.idx++]=f,this.vertices[this.idx++]=o,this.vertices[this.idx++]=l}},drawVertices:function(t,e,i){if(!this.drawing)throw"Illegal State: trying to draw a batch before begin()";t&&(this.texture!=t?(this.flush(),this.texture=t):this.idx==this.vertices.length&&this.flush(),i=i||0,this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++],this.vertices[this.idx++]=e[i++])}});a.VERTEX_SIZE=5,a.totalRenderCalls=0,a.DEFAULT_FRAG_SHADER=["precision mediump float;","varying vec2 vTexCoord0;","varying vec4 vColor;","uniform sampler2D u_texture0;","void main(void) {","   gl_FragColor = texture2D(u_texture0, vTexCoord0) * vColor;","}"].join("\n"),a.DEFAULT_VERT_SHADER=["attribute vec2 "+o.POSITION_ATTRIBUTE+";","attribute vec4 "+o.COLOR_ATTRIBUTE+";","attribute vec2 "+o.TEXCOORD_ATTRIBUTE+"0;","uniform vec2 u_projection;","varying vec2 vTexCoord0;","varying vec4 vColor;","void main(void) {","   gl_Position = vec4( "+o.POSITION_ATTRIBUTE+".x / u_projection.x - 1.0, "+o.POSITION_ATTRIBUTE+".y / -u_projection.y + 1.0 , 0.0, 1.0);","   vTexCoord0 = "+o.TEXCOORD_ATTRIBUTE+"0;","   vColor = "+o.COLOR_ATTRIBUTE+";","}"].join("\n"),e.exports=a},{"./BaseBatch":23,"./glutils/Mesh":29,"./glutils/ShaderProgram":30,klasse:34}],25:[function(t,e){var i=t("klasse"),n=(t("signals"),t("number-util").nextPowerOfTwo,t("number-util").isPowerOfTwo),r=new i({initialize:function o(t){if("object"!=typeof t)throw"GL context not specified to Texture";this.context=t,this.id=null,this.target=t.gl.TEXTURE_2D,this.width=0,this.height=0,this.wrapS=o.DEFAULT_WRAP,this.wrapT=o.DEFAULT_WRAP,this.minFilter=o.DEFAULT_FILTER,this.magFilter=o.DEFAULT_FILTER,this.managedArgs=Array.prototype.slice.call(arguments,1),this.context.addManagedObject(this),this.create()},setup:function(t,e,i,n,o,a){var s=this.gl;if("string"==typeof t){var l=new Image,h=arguments[0],c="function"==typeof arguments[1]?arguments[1]:null,u="function"==typeof arguments[2]?arguments[2]:null;a=!!arguments[3];var d=this;r.USE_DUMMY_1x1_DATA&&(d.uploadData(1,1),this.width=this.height=0),l.onload=function(){d.uploadImage(l,void 0,void 0,a),c&&c()},l.onerror=function(){a&&s.generateMipmap(s.TEXTURE_2D),u&&u()},l.onabort=function(){a&&s.generateMipmap(s.TEXTURE_2D),u&&u()},l.src=h}else this.uploadData(t,e,i,n,o,a)},create:function(){this.gl=this.context.gl;var t=this.gl;this.id=t.createTexture(),this.width=this.height=0,this.target=t.TEXTURE_2D,this.bind(),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.UNPACK_PREMULTIPLY_ALPHA),t.pixelStorei(t.UNPACK_ALIGNMENT,r.UNPACK_ALIGNMENT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.UNPACK_FLIP_Y);var e=r.UNPACK_COLORSPACE_CONVERSION||t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,e),this.setWrap(this.wrapS,this.wrapT,!1),this.setFilter(this.minFilter,this.magFilter,!1),0!==this.managedArgs.length&&this.setup.apply(this,this.managedArgs)},destroy:function(){this.id&&this.gl&&this.gl.deleteTexture(this.id),this.context&&this.context.removeManagedObject(this),this.width=this.height=0,this.id=null,this.managedArgs=null,this.context=null,this.gl=null},setWrap:function(t,e,i){t&&e?(this.wrapS=t,this.wrapT=e):this.wrapS=this.wrapT=t,this._checkPOT(),i||this.bind();var n=this.gl;n.texParameteri(this.target,n.TEXTURE_WRAP_S,this.wrapS),n.texParameteri(this.target,n.TEXTURE_WRAP_T,this.wrapT)},setFilter:function(t,e,i){t&&e?(this.minFilter=t,this.magFilter=e):this.minFilter=this.magFilter=t,this._checkPOT(),i||this.bind();var n=this.gl;n.texParameteri(this.target,n.TEXTURE_MIN_FILTER,this.minFilter),n.texParameteri(this.target,n.TEXTURE_MAG_FILTER,this.magFilter)},uploadData:function(t,e,i,n,r,o){var a=this.gl;i=i||a.RGBA,n=n||a.UNSIGNED_BYTE,r=r||null,this.width=t||0==t?t:this.width,this.height=e||0==e?e:this.height,this._checkPOT(),this.bind(),a.texImage2D(this.target,0,i,this.width,this.height,0,i,n,r),o&&a.generateMipmap(this.target)},uploadImage:function(t,e,i,n){var r=this.gl;e=e||r.RGBA,i=i||r.UNSIGNED_BYTE,this.width=t.width,this.height=t.height,this._checkPOT(),this.bind(),r.texImage2D(this.target,0,e,e,i,t),n&&r.generateMipmap(this.target)},_checkPOT:function(){if(!r.FORCE_POT){var t=this.minFilter!==r.Filter.LINEAR&&this.minFilter!==r.Filter.NEAREST,e=this.wrapS!==r.Wrap.CLAMP_TO_EDGE||this.wrapT!==r.Wrap.CLAMP_TO_EDGE;if(!(!t&&!e||n(this.width)&&n(this.height)))throw new Error(t?"Non-power-of-two textures cannot use mipmapping as filter":"Non-power-of-two textures must use CLAMP_TO_EDGE as wrap")}},bind:function(t){var e=this.gl;(t||0===t)&&e.activeTexture(e.TEXTURE0+t),e.bindTexture(this.target,this.id)},toString:function(){return this.id+":"+this.width+"x"+this.height}});r.Filter={NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985},r.Wrap={CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},r.Format={DEPTH_COMPONENT:6402,ALPHA:6406,RGBA:6408,RGB:6407,LUMINANCE:6409,LUMINANCE_ALPHA:6410},r.DataType={BYTE:5120,SHORT:5122,INT:5124,FLOAT:5126,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635},r.DEFAULT_WRAP=r.Wrap.CLAMP_TO_EDGE,r.DEFAULT_FILTER=r.Filter.NEAREST,r.FORCE_POT=!1,r.UNPACK_FLIP_Y=!1,r.UNPACK_ALIGNMENT=1,r.UNPACK_PREMULTIPLY_ALPHA=!0,r.UNPACK_COLORSPACE_CONVERSION=void 0,r.USE_DUMMY_1x1_DATA=!0,r.getNumComponents=function(t){switch(t){case r.Format.DEPTH_COMPONENT:case r.Format.ALPHA:case r.Format.LUMINANCE:return 1;case r.Format.LUMINANCE_ALPHA:return 2;case r.Format.RGB:return 3;case r.Format.RGBA:return 4}return null},e.exports=r},{klasse:34,"number-util":32,signals:33}],26:[function(t,e){var i=t("klasse"),n=(t("./Texture"),new i({initialize:function(t,e,i,n,r){this.texture=t,this.setRegion(e,i,n,r)},setUVs:function(t,e,i,n){if(this.regionWidth=Math.round(Math.abs(i-t)*this.texture.width),this.regionHeight=Math.round(Math.abs(n-e)*this.texture.height),1==this.regionWidth&&1==this.regionHeight){var r=.25/this.texture.width;t+=r,i-=r;var o=.25/this.texture.height;e+=o,n-=o}this.u=t,this.v=e,this.u2=i,this.v2=n},setRegion:function(t,e,i,n){t=t||0,e=e||0,i=0===i||i?i:this.texture.width,n=0===n||n?n:this.texture.height;var r=1/this.texture.width,o=1/this.texture.height;this.setUVs(t*r,e*o,(t+i)*r,(e+n)*o),this.regionWidth=Math.abs(i),this.regionHeight=Math.abs(n)},setFromRegion:function(t,e,i,n,r){this.texture=t.texture,this.set(t.getRegionX()+e,t.getRegionY()+i,n,r)},regionX:{get:function(){return Math.round(this.u*this.texture.width)}},regionY:{get:function(){return Math.round(this.v*this.texture.height)}},flip:function(t,e){var i;t&&(i=this.u,this.u=this.u2,this.u2=i),e&&(i=this.v,this.v=this.v2,this.v2=i)}}));e.exports=n},{"./Texture":25,klasse:34}],27:[function(t,e){var i=t("klasse"),n=t("signals"),r=new i({initialize:function(t,e,i,r){this.managedObjects=[],this.gl=null,i&&"undefined"!=typeof window.WebGLRenderingContext&&i instanceof window.WebGLRenderingContext&&(i=i.canvas,this.gl=i,this.valid=!0,r=void 0),this.view=i||document.createElement("canvas"),this.width=this.view.width=t||300,this.height=this.view.height=e||150,this.contextAttributes=r,this.valid=!1,this.lost=new n,this.restored=new n,this.view.addEventListener("webglcontextlost",function(t){t.preventDefault(),this._contextLost(t)}.bind(this)),this.view.addEventListener("webglcontextrestored",function(t){t.preventDefault(),this._contextRestored(t)}.bind(this)),this.valid||this._initContext(),this.resize(this.width,this.height)
},_initContext:function(){this.valid=!1;try{this.gl=this.view.getContext("webgl",this.contextAttributes)||this.view.getContext("experimental-webgl",this.contextAttributes)}catch(t){this.gl=null}if(!this.gl)throw"WebGL Context Not Supported -- try enabling it or using a different browser";this.valid=!0},resize:function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e;var i=this.gl;i.viewport(0,0,this.width,this.height)},addManagedObject:function(t){this.managedObjects.push(t)},removeManagedObject:function(t){var e=this.managedObjects.indexOf(t);return e>-1?(this.managedObjects.splice(e,1),t):null},destroy:function(){for(var t=0;t<this.managedObjects.length;t++){var e=this.managedObjects[t];e&&"function"==typeof e.destroy&&e.destroy()}this.managedObjects.length=0,this.valid=!1,this.gl=null,this.view=null,this.width=this.height=0},_contextLost:function(){this.valid=!1,this.lost.dispatch(this)},_contextRestored:function(){this._initContext();for(var t=0;t<this.managedObjects.length;t++)this.managedObjects[t].create();this.resize(this.width,this.height),this.restored.dispatch(this)}});e.exports=r},{klasse:34,signals:33}],28:[function(t,e){var i=t("klasse"),n=t("../Texture"),r=new i({initialize:function(t,e,i,r){if("object"!=typeof t)throw"GL context not specified to FrameBuffer";this.id=null,this.context=t,this.texture=new n(t,e,i,r),this.context.addManagedObject(this),this.create()},width:{get:function(){return this.texture.width}},height:{get:function(){return this.texture.height}},create:function(){this.gl=this.context.gl;var t=this.gl,e=this.texture;e.bind(),this.id=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.id),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,e.target,e.id,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER);if(i!=t.FRAMEBUFFER_COMPLETE){this.destroy();var n="Framebuffer not complete";switch(i){case t.FRAMEBUFFER_UNSUPPORTED:throw new Error(n+": unsupported");case t.INCOMPLETE_DIMENSIONS:throw new Error(n+": incomplete dimensions");case t.INCOMPLETE_ATTACHMENT:throw new Error(n+": incomplete attachment");case t.INCOMPLETE_MISSING_ATTACHMENT:throw new Error(n+": missing attachment");default:throw new Error(n)}}t.bindFramebuffer(t.FRAMEBUFFER,null)},destroy:function(){this.gl;this.texture&&this.texture.destroy(),this.id&&this.gl&&this.gl.deleteFramebuffer(this.id),this.context&&this.context.removeManagedObject(this),this.id=null,this.gl=null,this.texture=null,this.context=null},begin:function(){var t=this.gl;t.viewport(0,0,this.texture.width,this.texture.height),t.bindFramebuffer(t.FRAMEBUFFER,this.id)},end:function(){var t=this.gl;t.viewport(0,0,this.context.width,this.context.height),t.bindFramebuffer(t.FRAMEBUFFER,null)}});e.exports=r},{"../Texture":25,klasse:34}],29:[function(t,e){var i=t("klasse"),n=new i({dirty:{set:function(t){this.verticesDirty=t,this.indicesDirty=t}},initialize:function(t,e,i,n,r){if("object"!=typeof t)throw"GL context not specified to Mesh";if(!i)throw"numVerts not specified, must be > 0";this.context=t,this.gl=t.gl,this.numVerts=null,this.numIndices=null,this.vertices=null,this.indices=null,this.vertexBuffer=null,this.indexBuffer=null,this.verticesDirty=!0,this.indicesDirty=!0,this.indexUsage=null,this.vertexUsage=null,this._vertexAttribs=null,this.vertexStride=null,this.numVerts=i,this.numIndices=n||0,this.vertexUsage=e?this.gl.STATIC_DRAW:this.gl.DYNAMIC_DRAW,this.indexUsage=e?this.gl.STATIC_DRAW:this.gl.DYNAMIC_DRAW,this._vertexAttribs=r||[],this.indicesDirty=!0,this.verticesDirty=!0;for(var o=0,a=0;a<this._vertexAttribs.length;a++)o+=this._vertexAttribs[a].offsetCount;this.vertexStride=4*o,this.vertices=new Float32Array(this.numVerts),this.indices=new Uint16Array(this.numIndices),this.context.addManagedObject(this),this.create()},create:function(){this.gl=this.context.gl;var t=this.gl;this.vertexBuffer=t.createBuffer(),this.indexBuffer=this.numIndices>0?t.createBuffer():null,this.dirty=!0},destroy:function(){this.vertices=null,this.indices=null,this.vertexBuffer&&this.gl&&this.gl.deleteBuffer(this.vertexBuffer),this.indexBuffer&&this.gl&&this.gl.deleteBuffer(this.indexBuffer),this.vertexBuffer=null,this.indexBuffer=null,this.context&&this.context.removeManagedObject(this),this.gl=null,this.context=null},_updateBuffers:function(t,e){var i=this.gl;if(this.numIndices>0&&(t||i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.indicesDirty&&(i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.indices,this.indexUsage),this.indicesDirty=!1)),t||i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),this.verticesDirty){if(e){var n=this.vertices.subarray(0,e);i.bufferSubData(i.ARRAY_BUFFER,0,n)}else i.bufferData(i.ARRAY_BUFFER,this.vertices,this.vertexUsage);this.verticesDirty=!1}},draw:function(t,e,i,n){if(0!==e){var r=this.gl;i=i||0,this._updateBuffers(!0,n),this.numIndices>0?r.drawElements(t,e,r.UNSIGNED_SHORT,2*i):r.drawArrays(t,i,e)}},bind:function(t){var e=this.gl,i=0,n=this.vertexStride;this._updateBuffers();for(var r=0;r<this._vertexAttribs.length;r++){var o=this._vertexAttribs[r],a=null===o.location?t.getAttributeLocation(o.name):o.location;e.enableVertexAttribArray(a),e.vertexAttribPointer(a,o.numComponents,o.type||e.FLOAT,o.normalize,n,i),i+=4*o.offsetCount}},unbind:function(t){for(var e=this.gl,i=0;i<this._vertexAttribs.length;i++){var n=this._vertexAttribs[i],r=null===n.location?t.getAttributeLocation(n.name):n.location;e.disableVertexAttribArray(r)}}});n.Attrib=new i({name:null,numComponents:null,location:null,type:null,initialize:function(t,e,i,n,r,o){this.name=t,this.numComponents=e,this.location="number"==typeof i?i:null,this.type=n,this.normalize=Boolean(r),this.offsetCount="number"==typeof o?o:this.numComponents}}),e.exports=n},{klasse:34}],30:[function(t,e){var i=t("klasse"),n=new i({initialize:function(t,e,i,n){if(!e||!i)throw"vertex and fragment shaders must be defined";if("object"!=typeof t)throw"GL context not specified to ShaderProgram";this.context=t,this.vertShader=null,this.fragShader=null,this.program=null,this.log="",this.uniformCache=null,this.attributeCache=null,this.attributeLocations=n,this.vertSource=e.trim(),this.fragSource=i.trim(),this.context.addManagedObject(this),this.create()},create:function(){this.gl=this.context.gl,this._compileShaders()},_compileShaders:function(){var t=this.gl;if(this.log="",this.vertShader=this._loadShader(t.VERTEX_SHADER,this.vertSource),this.fragShader=this._loadShader(t.FRAGMENT_SHADER,this.fragSource),!this.vertShader||!this.fragShader)throw"Error returned when calling createShader";if(this.program=t.createProgram(),t.attachShader(this.program,this.vertShader),t.attachShader(this.program,this.fragShader),this.attributeLocations)for(var e in this.attributeLocations)this.attributeLocations.hasOwnProperty(e)&&t.bindAttribLocation(this.program,Math.floor(this.attributeLocations[e]),e);if(t.linkProgram(this.program),this.log+=t.getProgramInfoLog(this.program)||"",!t.getProgramParameter(this.program,t.LINK_STATUS))throw"Error linking the shader program:\n"+this.log;this._fetchUniforms(),this._fetchAttributes()},_fetchUniforms:function(){var t=this.gl;this.uniformCache={};var e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS);if(e)for(var i=0;e>i;i++){var n=t.getActiveUniform(this.program,i);if(null!==n){var r=n.name,o=t.getUniformLocation(this.program,r);this.uniformCache[r]={size:n.size,type:n.type,location:o}}}},_fetchAttributes:function(){var t=this.gl;this.attributeCache={};var e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES);if(e)for(var i=0;e>i;i++){var n=t.getActiveAttrib(this.program,i);if(null!==n){var r=n.name,o=t.getAttribLocation(this.program,r);this.attributeCache[r]={size:n.size,type:n.type,location:o}}}},_loadShader:function(t,e){var i=this.gl,n=i.createShader(t);if(!n)return-1;i.shaderSource(n,e),i.compileShader(n);var r=i.getShaderInfoLog(n)||"";if(r){var o=t===i.VERTEX_SHADER?"vertex":"fragment";r="Error compiling "+o+" shader:\n"+r}if(this.log+=r,!i.getShaderParameter(n,i.COMPILE_STATUS))throw this.log;return n},bind:function(){this.gl.useProgram(this.program)},destroy:function(){if(this.context&&this.context.removeManagedObject(this),this.gl){var t=this.gl;t.detachShader(this.vertShader),t.detachShader(this.fragShader),t.deleteShader(this.vertShader),t.deleteShader(this.fragShader),t.deleteProgram(this.program)}this.attributeCache=null,this.uniformCache=null,this.vertShader=null,this.fragShader=null,this.program=null,this.gl=null,this.context=null},getUniformInfo:function(t){return this.uniformCache[t]||null},getAttributeInfo:function(t){return this.attributeCache[t]||null},getAttributeLocation:function(t){var e=this.getAttributeInfo(t);return e?e.location:null},getUniformLocation:function(t){var e=this.getUniformInfo(t);return e?e.location:null},hasUniform:function(t){return null!==this.getUniformInfo(t)},hasAttribute:function(t){return null!==this.getAttributeInfo(t)},getUniform:function(t){return this.gl.getUniform(this.program,this.getUniformLocation(t))},getUniformAt:function(t){return this.gl.getUniform(this.program,t)},setUniformi:function(t,e,i,n,r){var o=this.gl,a=this.getUniformLocation(t);if(!a)return!1;switch(arguments.length){case 2:return o.uniform1i(a,e),!0;case 3:return o.uniform2i(a,e,i),!0;case 4:return o.uniform3i(a,e,i,n),!0;case 5:return o.uniform4i(a,e,i,n,r),!0;default:throw"invalid arguments to setUniformi"}},setUniformf:function(t,e,i,n,r){var o=this.gl,a=this.getUniformLocation(t);if(!a)return!1;switch(arguments.length){case 2:return o.uniform1f(a,e),!0;case 3:return o.uniform2f(a,e,i),!0;case 4:return o.uniform3f(a,e,i,n),!0;case 5:return o.uniform4f(a,e,i,n,r),!0;default:throw"invalid arguments to setUniformf"}},setUniformfv:function(t,e,i){i=i||e.length;var n=this.gl,r=this.getUniformLocation(t);if(!r)return!1;switch(i){case 1:return n.uniform1fv(r,e),!0;case 2:return n.uniform2fv(r,e),!0;case 3:return n.uniform3fv(r,e),!0;case 4:return n.uniform4fv(r,e),!0;default:throw"invalid arguments to setUniformf"}},setUniformiv:function(t,e,i){i=i||e.length;var n=this.gl,r=this.getUniformLocation(t);if(!r)return!1;switch(i){case 1:return n.uniform1iv(r,e),!0;case 2:return n.uniform2iv(r,e),!0;case 3:return n.uniform3iv(r,e),!0;case 4:return n.uniform4iv(r,e),!0;default:throw"invalid arguments to setUniformf"}},setUniformMatrix3:function(t,e,i){var n="object"==typeof e&&e.val?e.val:e;i=!!i;var r=this.gl,o=this.getUniformLocation(t);return o?void r.uniformMatrix3fv(o,i,n):!1},setUniformMatrix4:function(t,e,i){var n="object"==typeof e&&e.val?e.val:e;i=!!i;var r=this.gl,o=this.getUniformLocation(t);return o?void r.uniformMatrix4fv(o,i,n):!1}});n.POSITION_ATTRIBUTE="Position",n.NORMAL_ATTRIBUTE="Normal",n.COLOR_ATTRIBUTE="Color",n.TEXCOORD_ATTRIBUTE="TexCoord",e.exports=n},{klasse:34}],31:[function(t,e){e.exports={BaseBatch:t("./BaseBatch.js"),SpriteBatch:t("./SpriteBatch.js"),Texture:t("./Texture.js"),TextureRegion:t("./TextureRegion.js"),WebGLContext:t("./WebGLContext.js"),FrameBuffer:t("./glutils/FrameBuffer.js"),Mesh:t("./glutils/Mesh.js"),ShaderProgram:t("./glutils/ShaderProgram.js")}},{"./BaseBatch.js":23,"./SpriteBatch.js":24,"./Texture.js":25,"./TextureRegion.js":26,"./WebGLContext.js":27,"./glutils/FrameBuffer.js":28,"./glutils/Mesh.js":29,"./glutils/ShaderProgram.js":30}],32:[function(t,e){e.exports=t(22)},{}],33:[function(e,i){!function(e){function n(t,e,i,n,r){this._listener=e,this._isOnce=i,this.context=n,this._signal=t,this._priority=r||0}function r(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function o(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){o.prototype.dispatch.apply(t,arguments)}}n.prototype={active:!0,params:null,execute:function(t){var e,i;return this.active&&!!this._listener&&(i=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,i),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},o.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,e,i,r){var o,a=this._indexOfListener(t,i);if(-1!==a){if(o=this._bindings[a],o.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else o=new n(this,t,e,i,r),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var i,n=this._bindings.length;n--;)if(i=this._bindings[n],i._listener===t&&i.context===e)return n;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,i){return r(t,"add"),this._registerListener(t,!1,e,i)},addOnce:function(t,e,i){return r(t,"addOnce"),this._registerListener(t,!0,e,i)},remove:function(t,e){r(t,"remove");var i=this._indexOfListener(t,e);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var t,e=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=e),i){t=this._bindings.slice(),this._shouldPropagate=!0;do i--;while(t[i]&&this._shouldPropagate&&t[i].execute(e)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var a=o;a.Signal=o,"function"==typeof t&&t.amd?t(function(){return a}):"undefined"!=typeof i&&i.exports?i.exports=a:e.signals=a}(this)},{}],34:[function(t,e){function i(t){return!!t.get&&"function"==typeof t.get||!!t.set&&"function"==typeof t.set}function n(t,e,n){var r=n?t[e]:Object.getOwnPropertyDescriptor(t,e);return!n&&r.value&&"object"==typeof r.value&&(r=r.value),r&&i(r)?("undefined"==typeof r.enumerable&&(r.enumerable=!0),"undefined"==typeof r.configurable&&(r.configurable=!0),r):!1}function r(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return i?(i.value&&"object"==typeof i.value&&(i=i.value),i.configurable===!1?!0:!1):!1}function o(t,e,i,o){for(var a in e)if(e.hasOwnProperty(a)){var l=n(e,a,i);if(l!==!1){var h=o||t;if(r(h.prototype,a)){if(s.ignoreFinals)continue;throw new Error("cannot override final property '"+a+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(t.prototype,a,l)}else t.prototype[a]=e[a]}}function a(t,e){if(e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)o(t,e[i].prototype||e[i])}}function s(t){t||(t={});var e,i;if(t.initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");e=t.initialize,delete t.initialize}else if(t.Extends){var n=t.Extends;e=function(){n.apply(this,arguments)}}else e=function(){};t.Extends?(e.prototype=Object.create(t.Extends.prototype),e.prototype.constructor=e,i=t.Extends,delete t.Extends):e.prototype.constructor=e;var r=null;return t.Mixins&&(r=t.Mixins,delete t.Mixins),a(e,r),o(e,t,!0,i),e}s.extend=o,s.mixin=a,s.ignoreFinals=!1,e.exports=s},{}],35:[function(t,e){e.exports={version:"1.3.3"}},{}],36:[function(t,e){var i=function(t,e){this.point=t,this.triangle=e||null,this.next=null,this.prev=null,this.value=t.x},n=function(t,e){this.head_=t,this.tail_=e,this.search_node_=t};n.prototype.head=function(){return this.head_},n.prototype.setHead=function(t){this.head_=t},n.prototype.tail=function(){return this.tail_},n.prototype.setTail=function(t){this.tail_=t},n.prototype.search=function(){return this.search_node_},n.prototype.setSearch=function(t){this.search_node_=t},n.prototype.findSearchNode=function(){return this.search_node_},n.prototype.locateNode=function(t){var e=this.search_node_;if(t<e.value){for(;e=e.prev;)if(t>=e.value)return this.search_node_=e,e}else for(;e=e.next;)if(t<e.value)return this.search_node_=e.prev,e.prev;return null},n.prototype.locatePoint=function(t){var e=t.x,i=this.findSearchNode(e),n=i.point.x;if(e===n){if(t!==i.point)if(t===i.prev.point)i=i.prev;else{if(t!==i.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");i=i.next}}else if(n>e)for(;(i=i.prev)&&t!==i.point;);else for(;(i=i.next)&&t!==i.point;);return i&&(this.search_node_=i),i},e.exports=n,e.exports.Node=i},{}],37:[function(t,e){var i=t("./xy"),n=function(t,e){this.x=+t||0,this.y=+e||0,this._p2t_edge_list=null};n.prototype.toString=function(){return i.toStringBase(this)},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.set_zero=function(){return this.x=0,this.y=0,this},n.prototype.set=function(t,e){return this.x=+t||0,this.y=+e||0,this},n.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},n.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},n.prototype.mul=function(t){return this.x*=t,this.y*=t,this},n.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.normalize=function(){var t=this.length();return this.x/=t,this.y/=t,t},n.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},n.negate=function(t){return new n(-t.x,-t.y)},n.add=function(t,e){return new n(t.x+e.x,t.y+e.y)},n.sub=function(t,e){return new n(t.x-e.x,t.y-e.y)},n.mul=function(t,e){return new n(t*e.x,t*e.y)},n.cross=function(t,e){return"number"==typeof t?"number"==typeof e?t*e:new n(-t*e.y,t*e.x):"number"==typeof e?new n(e*t.y,-e*t.x):t.x*e.y-t.y*e.x},n.toString=i.toString,n.compare=i.compare,n.cmp=i.compare,n.equals=i.equals,n.dot=function(t,e){return t.x*e.x+t.y*e.y},e.exports=n},{"./xy":44}],38:[function(t,e){var i=t("./xy"),n=function(t,e){this.name="PointError",this.points=e=e||[],this.message=t||"Invalid Points!";for(var n=0;n<e.length;n++)this.message+=" "+i.toString(e[n])};n.prototype=new Error,n.prototype.constructor=n,e.exports=n},{"./xy":44}],39:[function(t,e,i){(function(e){var n=e.poly2tri;i.noConflict=function(){return e.poly2tri=n,i},i.VERSION=t("../dist/version.json").version,i.PointError=t("./pointerror"),i.Point=t("./point"),i.Triangle=t("./triangle"),i.SweepContext=t("./sweepcontext");var r=t("./sweep");i.triangulate=r.triangulate,i.sweep={Triangulate:r.triangulate}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dist/version.json":35,"./point":37,"./pointerror":38,"./sweep":40,"./sweepcontext":41,"./triangle":42}],40:[function(t,e,i){function n(t){t.initTriangulation(),t.createAdvancingFront(),r(t),o(t)}function r(t){var e,i=t.pointCount();for(e=1;i>e;++e)for(var n=t.getPoint(e),r=a(t,n),o=n._p2t_edge_list,l=0;o&&l<o.length;++l)s(t,o[l],r)}function o(t){for(var e=t.front().head().next.triangle,i=t.front().head().next.point;!e.getConstrainedEdgeCW(i);)e=e.neighborCCW(i);t.meshClean(e)}function a(t,e){var i=t.locateNode(e),n=c(t,e,i);return e.x<=i.point.x+k&&u(t,i),d(t,n),n}function s(t,e,i){t.edge_event.constrained_edge=e,t.edge_event.right=e.p.x>e.q.x,h(i.triangle,e.p,e.q)||(T(t,e,i),l(t,e.p,e.q,i.triangle,e.q))}function l(t,e,i,n,r){if(!h(n,e,i)){var o=n.pointCCW(r),a=B(i,o,e);if(a===V.COLLINEAR)throw new D("poly2tri EdgeEvent: Collinear not supported!",[i,o,e]);var s=n.pointCW(r),c=B(i,s,e);if(c===V.COLLINEAR)throw new D("poly2tri EdgeEvent: Collinear not supported!",[i,s,e]);a===c?(n=a===V.CW?n.neighborCCW(r):n.neighborCW(r),l(t,e,i,n,r)):A(t,e,i,n,r)}}function h(t,e,i){var n=t.edgeIndex(e,i);if(-1!==n){t.markConstrainedEdgeByIndex(n);var r=t.getNeighbor(n);return r&&r.markConstrainedEdgeByPoints(e,i),!0}return!1}function c(t,e,i){var n=new z(e,i.point,i.next.point);n.markNeighbor(i.triangle),t.addToMap(n);var r=new N(e);return r.next=i.next,r.prev=i,i.next.prev=r,i.next=r,m(t,n)||t.mapTriangleToNodes(n),r}function u(t,e){var i=new z(e.prev.point,e.point,e.next.point);i.markNeighbor(e.prev.triangle),i.markNeighbor(e.triangle),t.addToMap(i),e.prev.next=e.next,e.next.prev=e.prev,m(t,i)||t.mapTriangleToNodes(i)}function d(t,e){for(var i,n=e.next;n.next&&(i=p(n),!(i>I||-I>i));)u(t,n),n=n.next;for(n=e.prev;n.prev&&(i=p(n),!(i>I||-I>i));)u(t,n),n=n.prev;e.next&&e.next.next&&(i=f(e),U>i&&y(t,e))}function f(t){var e=t.point.x-t.next.next.point.x,i=t.point.y-t.next.next.point.y;return Math.atan2(i,e)}function p(t){var e=t.next.point.x-t.point.x,i=t.next.point.y-t.point.y,n=t.prev.point.x-t.point.x,r=t.prev.point.y-t.point.y;return Math.atan2(e*r-i*n,e*n+i*r)}function m(t,e){for(var i=0;3>i;++i)if(!e.delaunay_edge[i]){var n=e.getNeighbor(i);if(n){var r=e.getPoint(i),o=n.oppositePoint(e,r),a=n.index(o);if(n.constrained_edge[a]||n.delaunay_edge[a]){e.constrained_edge[i]=n.constrained_edge[a];continue}var s=g(r,e.pointCCW(r),e.pointCW(r),o);if(s){e.delaunay_edge[i]=!0,n.delaunay_edge[a]=!0,v(e,r,n,o);var l=!m(t,e);return l&&t.mapTriangleToNodes(e),l=!m(t,n),l&&t.mapTriangleToNodes(n),e.delaunay_edge[i]=!1,n.delaunay_edge[a]=!1,!0}}}return!1}function g(t,e,i,n){var r=t.x-n.x,o=t.y-n.y,a=e.x-n.x,s=e.y-n.y,l=r*s,h=a*o,c=l-h;if(0>=c)return!1;var u=i.x-n.x,d=i.y-n.y,f=u*o,p=r*d,m=f-p;if(0>=m)return!1;var g=a*d,v=u*s,y=r*r+o*o,E=a*a+s*s,x=u*u+d*d,T=y*(g-v)+E*m+x*c;return T>0}function v(t,e,i,n){var r,o,a,s;r=t.neighborCCW(e),o=t.neighborCW(e),a=i.neighborCCW(n),s=i.neighborCW(n);var l,h,c,u;l=t.getConstrainedEdgeCCW(e),h=t.getConstrainedEdgeCW(e),c=i.getConstrainedEdgeCCW(n),u=i.getConstrainedEdgeCW(n);var d,f,p,m;d=t.getDelaunayEdgeCCW(e),f=t.getDelaunayEdgeCW(e),p=i.getDelaunayEdgeCCW(n),m=i.getDelaunayEdgeCW(n),t.legalize(e,n),i.legalize(n,e),i.setDelaunayEdgeCCW(e,d),t.setDelaunayEdgeCW(e,f),t.setDelaunayEdgeCCW(n,p),i.setDelaunayEdgeCW(n,m),i.setConstrainedEdgeCCW(e,l),t.setConstrainedEdgeCW(e,h),t.setConstrainedEdgeCCW(n,c),i.setConstrainedEdgeCW(n,u),t.clearNeigbors(),i.clearNeigbors(),r&&i.markNeighbor(r),o&&t.markNeighbor(o),a&&t.markNeighbor(a),s&&i.markNeighbor(s),t.markNeighbor(i)}function y(t,e){for(t.basin.left_node=B(e.point,e.next.point,e.next.next.point)===V.CCW?e.next.next:e.next,t.basin.bottom_node=t.basin.left_node;t.basin.bottom_node.next&&t.basin.bottom_node.point.y>=t.basin.bottom_node.next.point.y;)t.basin.bottom_node=t.basin.bottom_node.next;if(t.basin.bottom_node!==t.basin.left_node){for(t.basin.right_node=t.basin.bottom_node;t.basin.right_node.next&&t.basin.right_node.point.y<t.basin.right_node.next.point.y;)t.basin.right_node=t.basin.right_node.next;t.basin.right_node!==t.basin.bottom_node&&(t.basin.width=t.basin.right_node.point.x-t.basin.left_node.point.x,t.basin.left_highest=t.basin.left_node.point.y>t.basin.right_node.point.y,E(t,t.basin.bottom_node))}}function E(t,e){if(!x(t,e)){u(t,e);var i;if(e.prev!==t.basin.left_node||e.next!==t.basin.right_node){if(e.prev===t.basin.left_node){if(i=B(e.point,e.next.point,e.next.next.point),i===V.CW)return;e=e.next}else if(e.next===t.basin.right_node){if(i=B(e.point,e.prev.point,e.prev.prev.point),i===V.CCW)return;e=e.prev}else e=e.prev.point.y<e.next.point.y?e.prev:e.next;E(t,e)}}}function x(t,e){var i;return i=t.basin.left_highest?t.basin.left_node.point.y-e.point.y:t.basin.right_node.point.y-e.point.y,t.basin.width>i?!0:!1}function T(t,e,i){t.edge_event.right?_(t,e,i):S(t,e,i)}function _(t,e,i){for(;i.next.point.x<e.p.x;)B(e.q,i.next.point,e.p)===V.CCW?b(t,e,i):i=i.next}function b(t,e,i){i.point.x<e.p.x&&(B(i.point,i.next.point,i.next.next.point)===V.CCW?w(t,e,i):(R(t,e,i),b(t,e,i)))}function w(t,e,i){u(t,i.next),i.next.point!==e.p&&B(e.q,i.next.point,e.p)===V.CCW&&B(i.point,i.next.point,i.next.next.point)===V.CCW&&w(t,e,i)}function R(t,e,i){B(i.next.point,i.next.next.point,i.next.next.next.point)===V.CCW?w(t,e,i.next):B(e.q,i.next.next.point,e.p)===V.CCW&&R(t,e,i.next)}function S(t,e,i){for(;i.prev.point.x>e.p.x;)B(e.q,i.prev.point,e.p)===V.CW?M(t,e,i):i=i.prev}function M(t,e,i){i.point.x>e.p.x&&(B(i.point,i.prev.point,i.prev.prev.point)===V.CW?C(t,e,i):(H(t,e,i),M(t,e,i)))}function H(t,e,i){B(i.prev.point,i.prev.prev.point,i.prev.prev.prev.point)===V.CW?C(t,e,i.prev):B(e.q,i.prev.prev.point,e.p)===V.CW&&H(t,e,i.prev)}function C(t,e,i){u(t,i.prev),i.prev.point!==e.p&&B(e.q,i.prev.point,e.p)===V.CW&&B(i.point,i.prev.point,i.prev.prev.point)===V.CW&&C(t,e,i)}function A(t,e,i,n,r){var o=n.neighborAcross(r);if(!o)throw new Error("poly2tri [BUG:FIXME] FLIP failed due to missing triangle!");var a=o.oppositePoint(n,r);if(n.getConstrainedEdgeAcross(r)){var s=n.index(r);throw new D("poly2tri Intersecting Constraints",[r,a,n.getPoint((s+1)%3),n.getPoint((s+2)%3)])}if(j(r,n.pointCCW(r),n.pointCW(r),a))if(v(n,r,o,a),t.mapTriangleToNodes(n),t.mapTriangleToNodes(o),r===i&&a===e)i===t.edge_event.constrained_edge.q&&e===t.edge_event.constrained_edge.p&&(n.markConstrainedEdgeByPoints(e,i),o.markConstrainedEdgeByPoints(e,i),m(t,n),m(t,o));else{var h=B(i,a,e);n=P(t,h,n,o,r,a),A(t,e,i,n,r)}else{var c=L(e,i,o,a);O(t,e,i,n,o,c),l(t,e,i,n,r)}}function P(t,e,i,n,r,o){var a;return e===V.CCW?(a=n.edgeIndex(r,o),n.delaunay_edge[a]=!0,m(t,n),n.clearDelunayEdges(),i):(a=i.edgeIndex(r,o),i.delaunay_edge[a]=!0,m(t,i),i.clearDelunayEdges(),n)}function L(t,e,i,n){var r=B(e,n,t);if(r===V.CW)return i.pointCCW(n);if(r===V.CCW)return i.pointCW(n);throw new D("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[e,n,t])}function O(t,e,i,n,r,o){var a=r.neighborAcross(o);if(!a)throw new Error("poly2tri [BUG:FIXME] FLIP failed due to missing triangle");var s=a.oppositePoint(r,o);if(j(i,n.pointCCW(i),n.pointCW(i),s))A(t,i,s,a,s);else{var l=L(e,i,a,s);O(t,e,i,n,a,l)}}var D=t("./pointerror"),z=t("./triangle"),N=t("./advancingfront").Node,F=t("./utils"),U=3*Math.PI/4,I=Math.PI/2,k=F.EPSILON,V=F.Orientation,B=F.orient2d,j=F.inScanArea;i.triangulate=n},{"./advancingfront":36,"./pointerror":38,"./triangle":42,"./utils":43}],41:[function(t,e){var i=t("./pointerror"),n=t("./point"),r=t("./triangle"),o=t("./sweep"),a=t("./advancingfront"),s=a.Node,l=.3,h=function(t,e){if(this.p=t,this.q=e,t.y>e.y)this.q=t,this.p=e;else if(t.y===e.y)if(t.x>e.x)this.q=t,this.p=e;else if(t.x===e.x)throw new i("poly2tri Invalid Edge constructor: repeated points!",[t]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},c=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};c.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var u=function(){this.constrained_edge=null,this.right=!1},d=function(t,e){e=e||{},this.triangles_=[],this.map_=[],this.points_=e.cloneArrays?t.slice(0):t,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new c,this.edge_event=new u,this.initEdges(this.points_)};d.prototype.addHole=function(t){this.initEdges(t);var e,i=t.length;for(e=0;i>e;e++)this.points_.push(t[e]);return this},d.prototype.AddHole=d.prototype.addHole,d.prototype.addPoint=function(t){return this.points_.push(t),this},d.prototype.AddPoint=d.prototype.addPoint,d.prototype.addPoints=function(t){return this.points_=this.points_.concat(t),this},d.prototype.triangulate=function(){return o.triangulate(this),this},d.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},d.prototype.getTriangles=function(){return this.triangles_},d.prototype.GetTriangles=d.prototype.getTriangles,d.prototype.front=function(){return this.front_},d.prototype.pointCount=function(){return this.points_.length},d.prototype.head=function(){return this.head_},d.prototype.setHead=function(t){this.head_=t},d.prototype.tail=function(){return this.tail_},d.prototype.setTail=function(t){this.tail_=t},d.prototype.getMap=function(){return this.map_},d.prototype.initTriangulation=function(){var t,e=this.points_[0].x,i=this.points_[0].x,r=this.points_[0].y,o=this.points_[0].y,a=this.points_.length;for(t=1;a>t;t++){var s=this.points_[t];s.x>e&&(e=s.x),s.x<i&&(i=s.x),s.y>r&&(r=s.y),s.y<o&&(o=s.y)}this.pmin_=new n(i,o),this.pmax_=new n(e,r);var h=l*(e-i),c=l*(r-o);this.head_=new n(e+h,o-c),this.tail_=new n(i-h,o-c),this.points_.sort(n.compare)},d.prototype.initEdges=function(t){var e,i=t.length;for(e=0;i>e;++e)this.edge_list.push(new h(t[e],t[(e+1)%i]))},d.prototype.getPoint=function(t){return this.points_[t]},d.prototype.addToMap=function(t){this.map_.push(t)},d.prototype.locateNode=function(t){return this.front_.locateNode(t.x)},d.prototype.createAdvancingFront=function(){var t,e,i,n=new r(this.points_[0],this.tail_,this.head_);this.map_.push(n),t=new s(n.getPoint(1),n),e=new s(n.getPoint(0),n),i=new s(n.getPoint(2)),this.front_=new a(t,i),t.next=e,e.next=i,e.prev=t,i.prev=e},d.prototype.removeNode=function(){},d.prototype.mapTriangleToNodes=function(t){for(var e=0;3>e;++e)if(!t.getNeighbor(e)){var i=this.front_.locatePoint(t.pointCW(t.getPoint(e)));i&&(i.triangle=t)}},d.prototype.removeFromMap=function(t){var e,i=this.map_,n=i.length;for(e=0;n>e;e++)if(i[e]===t){i.splice(e,1);break}},d.prototype.meshClean=function(t){for(var e,i,n=[t];e=n.pop();)if(!e.isInterior())for(e.setInterior(!0),this.triangles_.push(e),i=0;3>i;i++)e.constrained_edge[i]||n.push(e.getNeighbor(i))},e.exports=d},{"./advancingfront":36,"./point":37,"./pointerror":38,"./sweep":40,"./triangle":42}],42:[function(t,e){var i=t("./xy"),n=function(t,e,i){this.points_=[t,e,i],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},r=i.toString;n.prototype.toString=function(){return"["+r(this.points_[0])+r(this.points_[1])+r(this.points_[2])+"]"},n.prototype.getPoint=function(t){return this.points_[t]},n.prototype.GetPoint=n.prototype.getPoint,n.prototype.getPoints=function(){return this.points_},n.prototype.getNeighbor=function(t){return this.neighbors_[t]},n.prototype.containsPoint=function(t){var e=this.points_;return t===e[0]||t===e[1]||t===e[2]},n.prototype.containsEdge=function(t){return this.containsPoint(t.p)&&this.containsPoint(t.q)},n.prototype.containsPoints=function(t,e){return this.containsPoint(t)&&this.containsPoint(e)},n.prototype.isInterior=function(){return this.interior_},n.prototype.setInterior=function(t){return this.interior_=t,this},n.prototype.markNeighborPointers=function(t,e,i){var n=this.points_;if(t===n[2]&&e===n[1]||t===n[1]&&e===n[2])this.neighbors_[0]=i;else if(t===n[0]&&e===n[2]||t===n[2]&&e===n[0])this.neighbors_[1]=i;else{if(!(t===n[0]&&e===n[1]||t===n[1]&&e===n[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=i}},n.prototype.markNeighbor=function(t){var e=this.points_;t.containsPoints(e[1],e[2])?(this.neighbors_[0]=t,t.markNeighborPointers(e[1],e[2],this)):t.containsPoints(e[0],e[2])?(this.neighbors_[1]=t,t.markNeighborPointers(e[0],e[2],this)):t.containsPoints(e[0],e[1])&&(this.neighbors_[2]=t,t.markNeighborPointers(e[0],e[1],this))},n.prototype.clearNeigbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},n.prototype.clearDelunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},n.prototype.pointCW=function(t){var e=this.points_;return t===e[0]?e[2]:t===e[1]?e[0]:t===e[2]?e[1]:null},n.prototype.pointCCW=function(t){var e=this.points_;return t===e[0]?e[1]:t===e[1]?e[2]:t===e[2]?e[0]:null},n.prototype.neighborCW=function(t){return t===this.points_[0]?this.neighbors_[1]:t===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]
},n.prototype.neighborCCW=function(t){return t===this.points_[0]?this.neighbors_[2]:t===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},n.prototype.getConstrainedEdgeCW=function(t){return t===this.points_[0]?this.constrained_edge[1]:t===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},n.prototype.getConstrainedEdgeCCW=function(t){return t===this.points_[0]?this.constrained_edge[2]:t===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},n.prototype.getConstrainedEdgeAcross=function(t){return t===this.points_[0]?this.constrained_edge[0]:t===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},n.prototype.setConstrainedEdgeCW=function(t,e){t===this.points_[0]?this.constrained_edge[1]=e:t===this.points_[1]?this.constrained_edge[2]=e:this.constrained_edge[0]=e},n.prototype.setConstrainedEdgeCCW=function(t,e){t===this.points_[0]?this.constrained_edge[2]=e:t===this.points_[1]?this.constrained_edge[0]=e:this.constrained_edge[1]=e},n.prototype.getDelaunayEdgeCW=function(t){return t===this.points_[0]?this.delaunay_edge[1]:t===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},n.prototype.getDelaunayEdgeCCW=function(t){return t===this.points_[0]?this.delaunay_edge[2]:t===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},n.prototype.setDelaunayEdgeCW=function(t,e){t===this.points_[0]?this.delaunay_edge[1]=e:t===this.points_[1]?this.delaunay_edge[2]=e:this.delaunay_edge[0]=e},n.prototype.setDelaunayEdgeCCW=function(t,e){t===this.points_[0]?this.delaunay_edge[2]=e:t===this.points_[1]?this.delaunay_edge[0]=e:this.delaunay_edge[1]=e},n.prototype.neighborAcross=function(t){return t===this.points_[0]?this.neighbors_[0]:t===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},n.prototype.oppositePoint=function(t,e){var i=t.pointCW(e);return this.pointCW(i)},n.prototype.legalize=function(t,e){var i=this.points_;if(t===i[0])i[1]=i[0],i[0]=i[2],i[2]=e;else if(t===i[1])i[2]=i[1],i[1]=i[0],i[0]=e;else{if(t!==i[2])throw new Error("poly2tri Invalid Triangle.legalize() call");i[0]=i[2],i[2]=i[1],i[1]=e}},n.prototype.index=function(t){var e=this.points_;if(t===e[0])return 0;if(t===e[1])return 1;if(t===e[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},n.prototype.edgeIndex=function(t,e){var i=this.points_;if(t===i[0]){if(e===i[1])return 2;if(e===i[2])return 1}else if(t===i[1]){if(e===i[2])return 0;if(e===i[0])return 2}else if(t===i[2]){if(e===i[0])return 1;if(e===i[1])return 0}return-1},n.prototype.markConstrainedEdgeByIndex=function(t){this.constrained_edge[t]=!0},n.prototype.markConstrainedEdgeByEdge=function(t){this.markConstrainedEdgeByPoints(t.p,t.q)},n.prototype.markConstrainedEdgeByPoints=function(t,e){var i=this.points_;e===i[0]&&t===i[1]||e===i[1]&&t===i[0]?this.constrained_edge[2]=!0:e===i[0]&&t===i[2]||e===i[2]&&t===i[0]?this.constrained_edge[1]=!0:(e===i[1]&&t===i[2]||e===i[2]&&t===i[1])&&(this.constrained_edge[0]=!0)},e.exports=n},{"./xy":44}],43:[function(t,e){function i(t,e,i){var n=(t.x-i.x)*(e.y-i.y),a=(t.y-i.y)*(e.x-i.x),s=n-a;return s>-r&&r>s?o.COLLINEAR:s>0?o.CCW:o.CW}function n(t,e,i,n){var o=(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y);if(o>=-r)return!1;var a=(t.x-i.x)*(n.y-i.y)-(n.x-i.x)*(t.y-i.y);return r>=a?!1:!0}var r=1e-12,o={CW:1,CCW:-1,COLLINEAR:0};e.exports={EPSILON:r,Orientation:o,orient2d:i,inScanArea:n}},{}],44:[function(t,e){function i(t){return"("+t.x+";"+t.y+")"}function n(t){var e=t.toString();return"[object Object]"===e?i(t):e}function r(t,e){return t.y===e.y?t.x-e.x:t.y-e.y}function o(t,e){return t.x===e.x&&t.y===e.y}e.exports={toString:n,toStringBase:i,compare:r,equals:o}},{}],45:[function(t,e){function i(t,e,i,n){var r=i-t,o=n-e;return Math.sqrt(r*r+o*o)}var n=t("vecmath").Vector2,r=t("klasse"),o=t("interpolation").lerp,a=new n,s=new n,l=new r({initialize:function(){this.steps=1,this.points=[],this.approximateCurves=!0,this.approximationFactor=.5,this._move=new n,this._start=new n,this._hasMoved=!1,this._newPath=!0},reset:function(){this.points.length=0,this._newPath=!0,this._hasMoved=!1,this._move.x=this._move.y=0,this._start.x=this._start.y=0},beginPath:function(){this.reset()},moveTo:function(t,e){this._newPath=!0,this._move.x=t,this._move.y=e,this._start.x=t,this._start.y=e,this._hasMoved=!0},__newPoint:function(t,e){this.points.push(new n(t,e)),this._newPath=!1},closePath:function(t){0!==this.points.length&&this.lineTo(this._start.x,this._start.y,t)},lineTo:function(t,e,i){if(!this._hasMoved)return void this.moveTo(t,e);i=Math.max(1,i||this.steps);for(var n=0;i>=n;n++)if(this._newPath||0!=n){var r=n/i,a=o(this._move.x,t,r),s=o(this._move.y,e,r);this.__newPoint(a,s)}this._move.x=t,this._move.y=e},bezierCurveTo:function(t,e,n,r,o,a,s){if(!this._hasMoved)return void this.moveTo(x,T);var l=this._move.x,h=this._move.y;if(!s)if(this.approximateCurves){var c=i(l,h,t,e),u=i(t,e,n,r),d=i(n,r,o,a);s=~~((c+u+d)*this.approximationFactor)}else s=Math.max(1,this.steps);for(var f=0;s>f;f++){var p=f/(s-1),m=1-p,g=m*m,v=g*m,y=p*p,E=y*p,x=v*l+3*g*p*t+3*m*y*n+E*o,T=v*h+3*g*p*e+3*m*y*r+E*a;this.__newPoint(x,T)}this._move.x=o,this._move.y=a},quadraticCurveTo:function(t,e,i,n,r){if(!this._hasMoved)return void this.moveTo(g,v);var o=this._move.x,l=this._move.y;if(!r)if(this.approximateCurves){var h=a.set(o,l).distance(s.set(t,e)),c=a.set(t,e).distance(s.set(i,n));r=~~((h+c)*this.approximationFactor)}else r=Math.max(1,this.steps);for(var u=0;r>u;u++){var d=u/(r-1),f=1-d,p=f*f,m=d*d,g=p*o+2*f*d*t+m*i,v=p*l+2*f*d*e+m*n;this.__newPoint(g,v)}this._move.x=i,this._move.y=n},calculateBoundingBox:function(){for(var t=this.points,e=Number.MAX_VALUE,i=Number.MAX_VALUE,n=-Number.MAX_VALUE,r=-Number.MAX_VALUE,o=0;o<t.length;o++){var a=t[o];e=Math.min(e,a.x),i=Math.min(i,a.y),n=Math.max(n,a.x),r=Math.max(r,a.y)}return{x:e,y:i,width:n-e,height:r-i}},contains:function(t,e){var i=t,n=e;"object"==typeof t&&(i=t.x,n=t.y);var r,o,a=this.points,s=a.length,l=0;for(r=0,o=s-1;s>r;o=r++)a[r].y>n!=a[o].y>n&&i<(a[o].x-a[r].x)*(n-a[r].y)/(a[o].y-a[r].y)+a[r].x&&(l=!l);return l},simplify:function(t,e){var i=this.points,r=i.length,o=new n,a=t*t,s=new n(i[0]);e||(e=new l);var h=[];h.push(s);for(var c=1;r>c;c++)o=i[c],o.distanceSq(s)>a&&(h.push(new n(o)),s=o);return(s.x!==o.x||s.y!==o.y)&&h.push(new n(o)),e.points=h,e}});e.exports=l},{interpolation:19,klasse:34,vecmath:53}],46:[function(t,e){function i(t){this.val=new n(9),t?this.copy(t):this.idt()}var n="undefined"!=typeof Float32Array?Float32Array:Array,r=i.prototype;r.clone=function(){return new i(this)},r.set=function(t){return this.copy(t)},r.copy=function(t){var e=this.val,i=t.val;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},r.fromMat4=function(t){var e=t.val,i=this.val;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],this},r.fromArray=function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},r.identity=function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},r.transpose=function(){var t=this.val,e=t[1],i=t[2],n=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=i,t[7]=n,this},r.invert=function(){var t=this.val,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8],c=h*o-a*l,u=-h*r+a*s,d=l*r-o*s,f=e*c+i*u+n*d;return f?(f=1/f,t[0]=c*f,t[1]=(-h*i+n*l)*f,t[2]=(a*i-n*o)*f,t[3]=u*f,t[4]=(h*e-n*s)*f,t[5]=(-a*e+n*r)*f,t[6]=d*f,t[7]=(-l*e+i*s)*f,t[8]=(o*e-i*r)*f,this):null},r.adjoint=function(){var t=this.val,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8];return t[0]=o*h-a*l,t[1]=n*l-i*h,t[2]=i*a-n*o,t[3]=a*s-r*h,t[4]=e*h-n*s,t[5]=n*r-e*a,t[6]=r*l-o*s,t[7]=i*s-e*l,t[8]=e*o-i*r,this},r.determinant=function(){var t=this.val,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8];return e*(h*o-a*l)+i*(-h*r+a*s)+n*(l*r-o*s)},r.multiply=function(t){var e=this.val,i=t.val,n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],h=e[6],c=e[7],u=e[8],d=i[0],f=i[1],p=i[2],m=i[3],g=i[4],v=i[5],y=i[6],E=i[7],x=i[8];return e[0]=d*n+f*a+p*h,e[1]=d*r+f*s+p*c,e[2]=d*o+f*l+p*u,e[3]=m*n+g*a+v*h,e[4]=m*r+g*s+v*c,e[5]=m*o+g*l+v*u,e[6]=y*n+E*a+x*h,e[7]=y*r+E*s+x*c,e[8]=y*o+E*l+x*u,this},r.translate=function(t){var e=this.val,i=t.x,n=t.y;return e[6]=i*e[0]+n*e[3]+e[6],e[7]=i*e[1]+n*e[4]+e[7],e[8]=i*e[2]+n*e[5]+e[8],this},r.rotate=function(t){var e=this.val,i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=Math.sin(t),h=Math.cos(t);return e[0]=h*i+l*o,e[1]=h*n+l*a,e[2]=h*r+l*s,e[3]=h*o-l*i,e[4]=h*a-l*n,e[5]=h*s-l*r,this},r.scale=function(t){var e=this.val,i=t.x,n=t.y;return e[0]=i*e[0],e[1]=i*e[1],e[2]=i*e[2],e[3]=n*e[3],e[4]=n*e[4],e[5]=n*e[5],this},r.fromQuat=function(t){var e=t.x,i=t.y,n=t.z,r=t.w,o=e+e,a=i+i,s=n+n,l=e*o,h=e*a,c=e*s,u=i*a,d=i*s,f=n*s,p=r*o,m=r*a,g=r*s,v=this.val;return v[0]=1-(u+f),v[3]=h+g,v[6]=c-m,v[1]=h-g,v[4]=1-(l+f),v[7]=d+p,v[2]=c+m,v[5]=d-p,v[8]=1-(l+u),this},r.normalFromMat4=function(t){var e=t.val,i=this.val,n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],h=e[6],c=e[7],u=e[8],d=e[9],f=e[10],p=e[11],m=e[12],g=e[13],v=e[14],y=e[15],E=n*l-r*s,x=n*h-o*s,T=n*c-a*s,_=r*h-o*l,b=r*c-a*l,w=o*c-a*h,R=u*g-d*m,S=u*v-f*m,M=u*y-p*m,H=d*v-f*g,C=d*y-p*g,A=f*y-p*v,P=E*A-x*C+T*H+_*M-b*S+w*R;return P?(P=1/P,i[0]=(l*A-h*C+c*H)*P,i[1]=(h*M-s*A-c*S)*P,i[2]=(s*C-l*M+c*R)*P,i[3]=(o*C-r*A-a*H)*P,i[4]=(n*A-o*M+a*S)*P,i[5]=(r*M-n*C-a*R)*P,i[6]=(g*w-v*b+y*_)*P,i[7]=(v*T-m*w-y*x)*P,i[8]=(m*b-g*T+y*E)*P,this):null},r.mul=r.multiply,r.idt=r.identity,r.reset=r.idt,r.toString=function(){var t=this.val;return"Matrix3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.str=r.toString,e.exports=i},{}],47:[function(t,e){function i(t){this.val=new n(16),t?this.copy(t):this.idt()}var n="undefined"!=typeof Float32Array?Float32Array:Array,r=1e-6,o=i.prototype;o.clone=function(){return new i(this)},o.set=function(t){return this.copy(t)},o.copy=function(t){var e=this.val,i=t.val;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},o.fromArray=function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},o.identity=function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},o.transpose=function(){var t=this.val,e=t[1],i=t[2],n=t[3],r=t[6],o=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=i,t[9]=r,t[11]=t[14],t[12]=n,t[13]=o,t[14]=a,this},o.invert=function(){var t=this.val,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],v=e*a-i*o,y=e*s-n*o,E=e*l-r*o,x=i*s-n*a,T=i*l-r*a,_=n*l-r*s,b=h*p-c*f,w=h*m-u*f,R=h*g-d*f,S=c*m-u*p,M=c*g-d*p,H=u*g-d*m,C=v*H-y*M+E*S+x*R-T*w+_*b;return C?(C=1/C,t[0]=(a*H-s*M+l*S)*C,t[1]=(n*M-i*H-r*S)*C,t[2]=(p*_-m*T+g*x)*C,t[3]=(u*T-c*_-d*x)*C,t[4]=(s*R-o*H-l*w)*C,t[5]=(e*H-n*R+r*w)*C,t[6]=(m*E-f*_-g*y)*C,t[7]=(h*_-u*E+d*y)*C,t[8]=(o*M-a*R+l*b)*C,t[9]=(i*R-e*M-r*b)*C,t[10]=(f*T-p*E+g*v)*C,t[11]=(c*E-h*T-d*v)*C,t[12]=(a*w-o*S-s*b)*C,t[13]=(e*S-i*w+n*b)*C,t[14]=(p*y-f*x-m*v)*C,t[15]=(h*x-c*y+u*v)*C,this):null},o.adjoint=function(){var t=this.val,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15];return t[0]=a*(u*g-d*m)-c*(s*g-l*m)+p*(s*d-l*u),t[1]=-(i*(u*g-d*m)-c*(n*g-r*m)+p*(n*d-r*u)),t[2]=i*(s*g-l*m)-a*(n*g-r*m)+p*(n*l-r*s),t[3]=-(i*(s*d-l*u)-a*(n*d-r*u)+c*(n*l-r*s)),t[4]=-(o*(u*g-d*m)-h*(s*g-l*m)+f*(s*d-l*u)),t[5]=e*(u*g-d*m)-h*(n*g-r*m)+f*(n*d-r*u),t[6]=-(e*(s*g-l*m)-o*(n*g-r*m)+f*(n*l-r*s)),t[7]=e*(s*d-l*u)-o*(n*d-r*u)+h*(n*l-r*s),t[8]=o*(c*g-d*p)-h*(a*g-l*p)+f*(a*d-l*c),t[9]=-(e*(c*g-d*p)-h*(i*g-r*p)+f*(i*d-r*c)),t[10]=e*(a*g-l*p)-o*(i*g-r*p)+f*(i*l-r*a),t[11]=-(e*(a*d-l*c)-o*(i*d-r*c)+h*(i*l-r*a)),t[12]=-(o*(c*m-u*p)-h*(a*m-s*p)+f*(a*u-s*c)),t[13]=e*(c*m-u*p)-h*(i*m-n*p)+f*(i*u-n*c),t[14]=-(e*(a*m-s*p)-o*(i*m-n*p)+f*(i*s-n*a)),t[15]=e*(a*u-s*c)-o*(i*u-n*c)+h*(i*s-n*a),this},o.determinant=function(){var t=this.val,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],v=e*a-i*o,y=e*s-n*o,E=e*l-r*o,x=i*s-n*a,T=i*l-r*a,_=n*l-r*s,b=h*p-c*f,w=h*m-u*f,R=h*g-d*f,S=c*m-u*p,M=c*g-d*p,H=u*g-d*m;return v*H-y*M+E*S+x*R-T*w+_*b},o.multiply=function(t){var e=this.val,i=t.val,n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],h=e[6],c=e[7],u=e[8],d=e[9],f=e[10],p=e[11],m=e[12],g=e[13],v=e[14],y=e[15],E=i[0],x=i[1],T=i[2],_=i[3];return e[0]=E*n+x*s+T*u+_*m,e[1]=E*r+x*l+T*d+_*g,e[2]=E*o+x*h+T*f+_*v,e[3]=E*a+x*c+T*p+_*y,E=i[4],x=i[5],T=i[6],_=i[7],e[4]=E*n+x*s+T*u+_*m,e[5]=E*r+x*l+T*d+_*g,e[6]=E*o+x*h+T*f+_*v,e[7]=E*a+x*c+T*p+_*y,E=i[8],x=i[9],T=i[10],_=i[11],e[8]=E*n+x*s+T*u+_*m,e[9]=E*r+x*l+T*d+_*g,e[10]=E*o+x*h+T*f+_*v,e[11]=E*a+x*c+T*p+_*y,E=i[12],x=i[13],T=i[14],_=i[15],e[12]=E*n+x*s+T*u+_*m,e[13]=E*r+x*l+T*d+_*g,e[14]=E*o+x*h+T*f+_*v,e[15]=E*a+x*c+T*p+_*y,this},o.translate=function(t){var e=t.x,i=t.y,n=t.z,r=this.val;return r[12]=r[0]*e+r[4]*i+r[8]*n+r[12],r[13]=r[1]*e+r[5]*i+r[9]*n+r[13],r[14]=r[2]*e+r[6]*i+r[10]*n+r[14],r[15]=r[3]*e+r[7]*i+r[11]*n+r[15],this},o.scale=function(t){var e=t.x,i=t.y,n=t.z,r=this.val;return r[0]=r[0]*e,r[1]=r[1]*e,r[2]=r[2]*e,r[3]=r[3]*e,r[4]=r[4]*i,r[5]=r[5]*i,r[6]=r[6]*i,r[7]=r[7]*i,r[8]=r[8]*n,r[9]=r[9]*n,r[10]=r[10]*n,r[11]=r[11]*n,r[12]=r[12],r[13]=r[13],r[14]=r[14],r[15]=r[15],this},o.rotate=function(t,e){var i,n,o,a,s,l,h,c,u,d,f,p,m,g,v,y,E,x,T,_,b,w,R,S,M=this.val,H=e.x,C=e.y,A=e.z,P=Math.sqrt(H*H+C*C+A*A);return Math.abs(P)<r?null:(P=1/P,H*=P,C*=P,A*=P,i=Math.sin(t),n=Math.cos(t),o=1-n,a=M[0],s=M[1],l=M[2],h=M[3],c=M[4],u=M[5],d=M[6],f=M[7],p=M[8],m=M[9],g=M[10],v=M[11],y=H*H*o+n,E=C*H*o+A*i,x=A*H*o-C*i,T=H*C*o-A*i,_=C*C*o+n,b=A*C*o+H*i,w=H*A*o+C*i,R=C*A*o-H*i,S=A*A*o+n,M[0]=a*y+c*E+p*x,M[1]=s*y+u*E+m*x,M[2]=l*y+d*E+g*x,M[3]=h*y+f*E+v*x,M[4]=a*T+c*_+p*b,M[5]=s*T+u*_+m*b,M[6]=l*T+d*_+g*b,M[7]=h*T+f*_+v*b,M[8]=a*w+c*R+p*S,M[9]=s*w+u*R+m*S,M[10]=l*w+d*R+g*S,M[11]=h*w+f*R+v*S,this)},o.rotateX=function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),r=e[4],o=e[5],a=e[6],s=e[7],l=e[8],h=e[9],c=e[10],u=e[11];return e[4]=r*n+l*i,e[5]=o*n+h*i,e[6]=a*n+c*i,e[7]=s*n+u*i,e[8]=l*n-r*i,e[9]=h*n-o*i,e[10]=c*n-a*i,e[11]=u*n-s*i,this},o.rotateY=function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),r=e[0],o=e[1],a=e[2],s=e[3],l=e[8],h=e[9],c=e[10],u=e[11];return e[0]=r*n-l*i,e[1]=o*n-h*i,e[2]=a*n-c*i,e[3]=s*n-u*i,e[8]=r*i+l*n,e[9]=o*i+h*n,e[10]=a*i+c*n,e[11]=s*i+u*n,this},o.rotateZ=function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),r=e[0],o=e[1],a=e[2],s=e[3],l=e[4],h=e[5],c=e[6],u=e[7];return e[0]=r*n+l*i,e[1]=o*n+h*i,e[2]=a*n+c*i,e[3]=s*n+u*i,e[4]=l*n-r*i,e[5]=h*n-o*i,e[6]=c*n-a*i,e[7]=u*n-s*i,this},o.fromRotationTranslation=function(t,e){var i=this.val,n=t.x,r=t.y,o=t.z,a=t.w,s=n+n,l=r+r,h=o+o,c=n*s,u=n*l,d=n*h,f=r*l,p=r*h,m=o*h,g=a*s,v=a*l,y=a*h;return i[0]=1-(f+m),i[1]=u+y,i[2]=d-v,i[3]=0,i[4]=u-y,i[5]=1-(c+m),i[6]=p+g,i[7]=0,i[8]=d+v,i[9]=p-g,i[10]=1-(c+f),i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this},o.fromQuat=function(t){var e=this.val,i=t.x,n=t.y,r=t.z,o=t.w,a=i+i,s=n+n,l=r+r,h=i*a,c=i*s,u=i*l,d=n*s,f=n*l,p=r*l,m=o*a,g=o*s,v=o*l;return e[0]=1-(d+p),e[1]=c+v,e[2]=u-g,e[3]=0,e[4]=c-v,e[5]=1-(h+p),e[6]=f+m,e[7]=0,e[8]=u+g,e[9]=f-m,e[10]=1-(h+d),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},o.frustum=function(t,e,i,n,r,o){var a=this.val,s=1/(e-t),l=1/(n-i),h=1/(r-o);return a[0]=2*r*s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*r*l,a[6]=0,a[7]=0,a[8]=(e+t)*s,a[9]=(n+i)*l,a[10]=(o+r)*h,a[11]=-1,a[12]=0,a[13]=0,a[14]=o*r*2*h,a[15]=0,this},o.perspective=function(t,e,i,n){var r=this.val,o=1/Math.tan(t/2),a=1/(i-n);return r[0]=o/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(n+i)*a,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*n*i*a,r[15]=0,this},o.ortho=function(t,e,i,n,r,o,a){var t=this.val,s=1/(e-i),l=1/(n-r),h=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(a+o)*h,t[15]=1,this},o.lookAt=function(t,e,i){var n,o,a,s,l,h,c,u,d,f,p=this.val,m=t.x,g=t.y,v=t.z,y=i.x,E=i.y,x=i.z,T=e.x,_=e.y,b=e.z;return Math.abs(m-T)<r&&Math.abs(g-_)<r&&Math.abs(v-b)<r?this.identity():(c=m-T,u=g-_,d=v-b,f=1/Math.sqrt(c*c+u*u+d*d),c*=f,u*=f,d*=f,n=E*d-x*u,o=x*c-y*d,a=y*u-E*c,f=Math.sqrt(n*n+o*o+a*a),f?(f=1/f,n*=f,o*=f,a*=f):(n=0,o=0,a=0),s=u*a-d*o,l=d*n-c*a,h=c*o-u*n,f=Math.sqrt(s*s+l*l+h*h),f?(f=1/f,s*=f,l*=f,h*=f):(s=0,l=0,h=0),p[0]=n,p[1]=s,p[2]=c,p[3]=0,p[4]=o,p[5]=l,p[6]=u,p[7]=0,p[8]=a,p[9]=h,p[10]=d,p[11]=0,p[12]=-(n*m+o*g+a*v),p[13]=-(s*m+l*g+h*v),p[14]=-(c*m+u*g+d*v),p[15]=1,this)},o.mul=o.multiply,o.idt=o.identity,o.reset=o.idt,o.toString=function(){var t=this.val;return"Matrix4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},o.str=o.toString,e.exports=i},{}],48:[function(t,e){function i(t,e,i,n){"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)}var n=t("./Vector3"),r=t("./Matrix3"),o=t("./common"),a="undefined"!=typeof Int8Array?new Int8Array([1,2,0]):[1,2,0],s="undefined"!=typeof Float32Array?new Float32Array([0,0,0]):[0,0,0],l=new n(1,0,0),h=new n(0,1,0),c=new n,u=new r,d=i.prototype;for(var f in o)d[f]=o[f];d.rotationTo=function(t,e){var i=t.x*e.x+t.y*e.y+t.z*e.z;return-.999999>i?(c.copy(l).cross(t).len()<1e-6&&c.copy(h).cross(t),c.normalize(),this.setAxisAngle(c,Math.PI)):i>.999999?(this.x=0,this.y=0,this.z=0,this.w=1,this):(c.copy(t).cross(e),this.x=c.x,this.y=c.y,this.z=c.z,this.w=1+i,this.normalize())},d.setAxes=function(t,e){var i=u.val;return i[0]=e.x,i[3]=e.y,i[6]=e.z,i[1]=uquat.x,i[4]=uquat.y,i[7]=uquat.z,i[2]=t.x,i[5]=t.y,i[8]=t.z,this.fromMat3(u).normalize()},d.identity=function(){return this.x=this.y=this.z=0,this.w=1,this},d.setAxisAngle=function(t,e){e*=.5;var i=Math.sin(e);return this.x=i*t.x,this.y=i*t.y,this.z=i*t.z,this.w=Math.cos(e),this},d.multiply=function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.x,a=t.y,s=t.z,l=t.w;return this.x=e*l+r*o+i*s-n*a,this.y=i*l+r*a+n*o-e*s,this.z=n*l+r*s+e*a-i*o,this.w=r*l-e*o-i*a-n*s,this},d.slerp=function(t,e){var i,n,r,o,a,s=this.x,l=this.y,h=this.y,c=this.y,u=t.x,d=t.y,f=t.z,p=t.w;return n=s*u+l*d+h*f+c*p,0>n&&(n=-n,u=-u,d=-d,f=-f,p=-p),1-n>1e-6?(i=Math.acos(n),r=Math.sin(i),o=Math.sin((1-e)*i)/r,a=Math.sin(e*i)/r):(o=1-e,a=e),this.x=o*s+a*u,this.y=o*l+a*d,this.z=o*h+a*f,this.w=o*c+a*p,this},d.invert=function(){var t=this.x,e=this.y,i=this.z,n=this.w,r=t*t+e*e+i*i+n*n,o=r?1/r:0;return this.x=-t*o,this.y=-e*o,this.z=-i*o,this.w=n*o,this},d.conjugate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},d.rotateX=function(t){t*=.5;var e=this.x,i=this.y,n=this.z,r=this.w,o=Math.sin(t),a=Math.cos(t);return this.x=e*a+r*o,this.y=i*a+n*o,this.z=n*a-i*o,this.w=r*a-e*o,this},d.rotateY=function(t){t*=.5;var e=this.x,i=this.y,n=this.z,r=this.w,o=Math.sin(t),a=Math.cos(t);return this.x=e*a-n*o,this.y=i*a+r*o,this.z=n*a+e*o,this.w=r*a-i*o,this},d.rotateZ=function(t){t*=.5;var e=this.x,i=this.y,n=this.z,r=this.w,o=Math.sin(t),a=Math.cos(t);return this.x=e*a+i*o,this.y=i*a-e*o,this.z=n*a+r*o,this.w=r*a-n*o,this},d.calculateW=function(){var t=this.x,e=this.y,i=this.z;return this.x=t,this.y=e,this.z=i,this.w=-Math.sqrt(Math.abs(1-t*t-e*e-i*i)),this},d.fromMat3=function(t){var e,i=t.val,n=i[0]+i[4]+i[8];if(n>0)e=Math.sqrt(n+1),this.w=.5*e,e=.5/e,this.x=(i[7]-i[5])*e,this.y=(i[2]-i[6])*e,this.z=(i[3]-i[1])*e;else{var r=0;i[4]>i[0]&&(r=1),i[8]>i[3*r+r]&&(r=2);var o=a[r],l=a[o];e=Math.sqrt(i[3*r+r]-i[3*o+o]-i[3*l+l]+1),s[r]=.5*e,e=.5/e,s[o]=(i[3*o+r]+i[3*r+o])*e,s[l]=(i[3*l+r]+i[3*r+l])*e,this.x=s[0],this.y=s[1],this.z=s[2],this.w=(i[3*l+o]-i[3*o+l])*e}return this},d.idt=d.identity,d.sub=d.subtract,d.mul=d.multiply,d.len=d.length,d.lenSq=d.lengthSq,d.reset=d.idt,d.toString=function(){return"Quaternion("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},d.str=d.toString,e.exports=i},{"./Matrix3":46,"./Vector3":50,"./common":52}],49:[function(t,e){function i(t,e){"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(this.x=t||0,this.y=e||0)}var n=i.prototype;n.clone=function(){return new i(this.x,this.y)},n.copy=function(t){return this.x=t.x||0,this.y=t.y||0,this},n.set=function(t,e){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(this.x=t||0,this.y=e||0),this},n.add=function(t){return this.x+=t.x,this.y+=t.y,this},n.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},n.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},n.scale=function(t){return this.x*=t,this.y*=t,this},n.divide=function(t){return this.x/=t.x,this.y/=t.y,this},n.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.distance=function(t){var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},n.distanceSq=function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},n.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},n.lengthSq=function(){var t=this.x,e=this.y;return t*t+e*e},n.normalize=function(){var t=this.x,e=this.y,i=t*t+e*e;return i>0&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i),this},n.dot=function(t){return this.x*t.x+this.y*t.y},n.cross=function(t){return this.x*t.y-this.y*t.x},n.lerp=function(t,e){var i=this.x,n=this.y;return e=e||0,this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this},n.transformMat3=function(t){var e=this.x,i=this.y,n=t.val;return this.x=n[0]*e+n[2]*i+n[4],this.y=n[1]*e+n[3]*i+n[5],this},n.transformMat4=function(t){var e=this.x,i=this.y,n=t.val;return this.x=n[0]*e+n[4]*i+n[12],this.y=n[1]*e+n[5]*i+n[13],this},n.reset=function(){return this.x=0,this.y=0,this},n.sub=n.subtract,n.mul=n.multiply,n.div=n.divide,n.dist=n.distance,n.distSq=n.distanceSq,n.len=n.length,n.lenSq=n.lengthSq,n.toString=function(){return"Vector2("+this.x+", "+this.y+")"},n.random=function(t){t=t||1;var e=2*Math.random()*Math.PI;return this.x=Math.cos(e)*t,this.y=Math.sin(e)*t,this},n.str=n.toString,e.exports=i},{}],50:[function(t,e){function i(t,e,i){"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=i||0)}var n=i.prototype;n.clone=function(){return new i(this.x,this.y,this.z)},n.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},n.set=function(t,e,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=i||0),this},n.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},n.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},n.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},n.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},n.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},n.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},n.distance=function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return Math.sqrt(e*e+i*i+n*n)},n.distanceSq=function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return e*e+i*i+n*n},n.length=function(){var t=this.x,e=this.y,i=this.z;return Math.sqrt(t*t+e*e+i*i)},n.lengthSq=function(){var t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i},n.normalize=function(){var t=this.x,e=this.y,i=this.z,n=t*t+e*e+i*i;return n>0&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n,this.z=i*n),this},n.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.cross=function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z;return this.x=i*a-n*o,this.y=n*r-e*a,this.z=e*o-i*r,this},n.lerp=function(t,e){var i=this.x,n=this.y,r=this.z;return e=e||0,this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=r+e*(t.z-r),this},n.transformMat4=function(t){var e=this.x,i=this.y,n=this.z,r=t.val;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12],this.y=r[1]*e+r[5]*i+r[9]*n+r[13],this.z=r[2]*e+r[6]*i+r[10]*n+r[14],this},n.transformMat3=function(t){var e=this.x,i=this.y,n=this.z,r=t.val;return this.x=e*r[0]+i*r[3]+n*r[6],this.y=e*r[1]+i*r[4]+n*r[7],this.z=e*r[2]+i*r[5]+n*r[8],this},n.transformQuat=function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*n-a*i,h=s*i+a*e-r*n,c=s*n+r*i-o*e,u=-r*e-o*i-a*n;return this.x=l*s+u*-r+h*-a-c*-o,this.y=h*s+u*-o+c*-r-l*-a,this.z=c*s+u*-a+l*-o-h*-r,this},n.project=function(t){var e=this.x,i=this.y,n=this.z,r=t.val,o=r[0],a=r[1],s=r[2],l=r[3],h=r[4],c=r[5],u=r[6],d=r[7],f=r[8],p=r[9],m=r[10],g=r[11],v=r[12],y=r[13],E=r[14],x=r[15],T=1/(e*l+i*d+n*g+x);return this.x=(e*o+i*h+n*f+v)*T,this.y=(e*a+i*c+n*p+y)*T,this.z=(e*s+i*u+n*m+E)*T,this},n.unproject=function(t,e){var i=t.x,n=t.y,r=t.z,o=t.w,a=this.x,s=this.y,l=this.z;return a-=i,s=o-s-1,s-=n,this.x=2*a/r-1,this.y=2*s/o-1,this.z=2*l-1,this.project(e)},n.random=function(t){t=t||1;var e=2*Math.random()*Math.PI,i=2*Math.random()-1,n=Math.sqrt(1-i*i)*t;return this.x=Math.cos(e)*n,this.y=Math.sin(e)*n,this.z=i*t,this},n.reset=function(){return this.x=0,this.y=0,this.z=0,this},n.sub=n.subtract,n.mul=n.multiply,n.div=n.divide,n.dist=n.distance,n.distSq=n.distanceSq,n.len=n.length,n.lenSq=n.lengthSq,n.toString=function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},n.str=n.toString,e.exports=i},{}],51:[function(t,e){function i(t,e,i,n){"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)}var n=t("./common"),r=i.prototype;for(var o in n)r[o]=n[o];r.clone=function(){return new i(this.x,this.y,this.z,this.w)},r.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},r.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this},r.distance=function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z,r=t.w-this.w;return Math.sqrt(e*e+i*i+n*n+r*r)},r.distanceSq=function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z,r=t.w-this.w;return e*e+i*i+n*n+r*r},r.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},r.transformMat4=function(t){var e=t.val,i=this.x,n=this.y,r=this.z,o=this.w;return this.x=e[0]*i+e[4]*n+e[8]*r+e[12]*o,this.y=e[1]*i+e[5]*n+e[9]*r+e[13]*o,this.z=e[2]*i+e[6]*n+e[10]*r+e[14]*o,this.w=e[3]*i+e[7]*n+e[11]*r+e[15]*o,this},r.transformQuat=function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*n-a*i,h=s*i+a*e-r*n,c=s*n+r*i-o*e,u=-r*e-o*i-a*n;return this.x=l*s+u*-r+h*-a-c*-o,this.y=h*s+u*-o+c*-r-l*-a,this.z=c*s+u*-a+l*-o-h*-r,out},r.random=function(t){return t=t||1,this.x=(2*Math.random()-1)*t,this.y=(2*Math.random()-1)*t,this.z=(2*Math.random()-1)*t,this.w=(2*Math.random()-1)*t,this},r.reset=function(){return this.x=0,this.y=0,this.z=0,this.w=0,this},r.sub=r.subtract,r.mul=r.multiply,r.div=r.divide,r.dist=r.distance,r.distSq=r.distanceSq,r.len=r.length,r.lenSq=r.lengthSq,r.toString=function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},r.str=r.toString,e.exports=i},{"./common":52}],52:[function(t,e){e.exports={copy:function(t){return this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0,this},set:function(t,e,i,n){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)},lengthSq:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n},normalize:function(){var t=this.x,e=this.y,i=this.z,n=this.w,r=t*t+e*e+i*i+n*n;return r>0&&(r=1/Math.sqrt(r),this.x=t*r,this.y=e*r,this.z=i*r,this.w=n*r),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){var i=this.x,n=this.y,r=this.z,o=this.w;return e=e||0,this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=r+e*(t.z-r),this.w=o+e*(t.w-o),this}}},{}],53:[function(t,e){e.exports={Vector2:t("./Vector2"),Vector3:t("./Vector3"),Vector4:t("./Vector4"),Matrix3:t("./Matrix3"),Matrix4:t("./Matrix4"),Quaternion:t("./Quaternion")}},{"./Matrix3":46,"./Matrix4":47,"./Quaternion":48,"./Vector2":49,"./Vector3":50,"./Vector4":51}],54:[function(t,e){e.exports=t(46)},{}],55:[function(t,e){function i(t){this.val=new n(16),t?this.copy(t):this.idt()}var n="undefined"!=typeof Float32Array?Float32Array:Array,r=1e-6,o=i.prototype;o.clone=function(){return new i(this)},o.set=function(t){return this.copy(t)},o.copy=function(t){var e=this.val,i=t.val;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},o.fromArray=function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},o.identity=function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},o.transpose=function(){var t=this.val,e=t[1],i=t[2],n=t[3],r=t[6],o=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=i,t[9]=r,t[11]=t[14],t[12]=n,t[13]=o,t[14]=a,this},o.invert=function(){var t=this.val,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],v=e*a-i*o,y=e*s-n*o,E=e*l-r*o,x=i*s-n*a,T=i*l-r*a,_=n*l-r*s,b=h*p-c*f,w=h*m-u*f,R=h*g-d*f,S=c*m-u*p,M=c*g-d*p,H=u*g-d*m,C=v*H-y*M+E*S+x*R-T*w+_*b;return C?(C=1/C,t[0]=(a*H-s*M+l*S)*C,t[1]=(n*M-i*H-r*S)*C,t[2]=(p*_-m*T+g*x)*C,t[3]=(u*T-c*_-d*x)*C,t[4]=(s*R-o*H-l*w)*C,t[5]=(e*H-n*R+r*w)*C,t[6]=(m*E-f*_-g*y)*C,t[7]=(h*_-u*E+d*y)*C,t[8]=(o*M-a*R+l*b)*C,t[9]=(i*R-e*M-r*b)*C,t[10]=(f*T-p*E+g*v)*C,t[11]=(c*E-h*T-d*v)*C,t[12]=(a*w-o*S-s*b)*C,t[13]=(e*S-i*w+n*b)*C,t[14]=(p*y-f*x-m*v)*C,t[15]=(h*x-c*y+u*v)*C,this):null},o.adjoint=function(){var t=this.val,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15];return t[0]=a*(u*g-d*m)-c*(s*g-l*m)+p*(s*d-l*u),t[1]=-(i*(u*g-d*m)-c*(n*g-r*m)+p*(n*d-r*u)),t[2]=i*(s*g-l*m)-a*(n*g-r*m)+p*(n*l-r*s),t[3]=-(i*(s*d-l*u)-a*(n*d-r*u)+c*(n*l-r*s)),t[4]=-(o*(u*g-d*m)-h*(s*g-l*m)+f*(s*d-l*u)),t[5]=e*(u*g-d*m)-h*(n*g-r*m)+f*(n*d-r*u),t[6]=-(e*(s*g-l*m)-o*(n*g-r*m)+f*(n*l-r*s)),t[7]=e*(s*d-l*u)-o*(n*d-r*u)+h*(n*l-r*s),t[8]=o*(c*g-d*p)-h*(a*g-l*p)+f*(a*d-l*c),t[9]=-(e*(c*g-d*p)-h*(i*g-r*p)+f*(i*d-r*c)),t[10]=e*(a*g-l*p)-o*(i*g-r*p)+f*(i*l-r*a),t[11]=-(e*(a*d-l*c)-o*(i*d-r*c)+h*(i*l-r*a)),t[12]=-(o*(c*m-u*p)-h*(a*m-s*p)+f*(a*u-s*c)),t[13]=e*(c*m-u*p)-h*(i*m-n*p)+f*(i*u-n*c),t[14]=-(e*(a*m-s*p)-o*(i*m-n*p)+f*(i*s-n*a)),t[15]=e*(a*u-s*c)-o*(i*u-n*c)+h*(i*s-n*a),this},o.determinant=function(){var t=this.val,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],v=e*a-i*o,y=e*s-n*o,E=e*l-r*o,x=i*s-n*a,T=i*l-r*a,_=n*l-r*s,b=h*p-c*f,w=h*m-u*f,R=h*g-d*f,S=c*m-u*p,M=c*g-d*p,H=u*g-d*m;return v*H-y*M+E*S+x*R-T*w+_*b},o.multiply=function(t){var e=this.val,i=t.val,n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],h=e[6],c=e[7],u=e[8],d=e[9],f=e[10],p=e[11],m=e[12],g=e[13],v=e[14],y=e[15],E=i[0],x=i[1],T=i[2],_=i[3];return e[0]=E*n+x*s+T*u+_*m,e[1]=E*r+x*l+T*d+_*g,e[2]=E*o+x*h+T*f+_*v,e[3]=E*a+x*c+T*p+_*y,E=i[4],x=i[5],T=i[6],_=i[7],e[4]=E*n+x*s+T*u+_*m,e[5]=E*r+x*l+T*d+_*g,e[6]=E*o+x*h+T*f+_*v,e[7]=E*a+x*c+T*p+_*y,E=i[8],x=i[9],T=i[10],_=i[11],e[8]=E*n+x*s+T*u+_*m,e[9]=E*r+x*l+T*d+_*g,e[10]=E*o+x*h+T*f+_*v,e[11]=E*a+x*c+T*p+_*y,E=i[12],x=i[13],T=i[14],_=i[15],e[12]=E*n+x*s+T*u+_*m,e[13]=E*r+x*l+T*d+_*g,e[14]=E*o+x*h+T*f+_*v,e[15]=E*a+x*c+T*p+_*y,this
},o.translate=function(t){var e=t.x,i=t.y,n=t.z,r=this.val;return r[12]=r[0]*e+r[4]*i+r[8]*n+r[12],r[13]=r[1]*e+r[5]*i+r[9]*n+r[13],r[14]=r[2]*e+r[6]*i+r[10]*n+r[14],r[15]=r[3]*e+r[7]*i+r[11]*n+r[15],this},o.scale=function(t){var e=t.x,i=t.y,n=t.z,r=this.val;return r[0]=r[0]*e,r[1]=r[1]*e,r[2]=r[2]*e,r[3]=r[3]*e,r[4]=r[4]*i,r[5]=r[5]*i,r[6]=r[6]*i,r[7]=r[7]*i,r[8]=r[8]*n,r[9]=r[9]*n,r[10]=r[10]*n,r[11]=r[11]*n,r[12]=r[12],r[13]=r[13],r[14]=r[14],r[15]=r[15],this},o.rotate=function(t,e){var i,n,o,a,s,l,h,c,u,d,f,p,m,g,v,y,E,x,T,_,b,w,R,S,M=this.val,H=e.x,C=e.y,A=e.z,P=Math.sqrt(H*H+C*C+A*A);return Math.abs(P)<r?null:(P=1/P,H*=P,C*=P,A*=P,i=Math.sin(t),n=Math.cos(t),o=1-n,a=M[0],s=M[1],l=M[2],h=M[3],c=M[4],u=M[5],d=M[6],f=M[7],p=M[8],m=M[9],g=M[10],v=M[11],y=H*H*o+n,E=C*H*o+A*i,x=A*H*o-C*i,T=H*C*o-A*i,_=C*C*o+n,b=A*C*o+H*i,w=H*A*o+C*i,R=C*A*o-H*i,S=A*A*o+n,M[0]=a*y+c*E+p*x,M[1]=s*y+u*E+m*x,M[2]=l*y+d*E+g*x,M[3]=h*y+f*E+v*x,M[4]=a*T+c*_+p*b,M[5]=s*T+u*_+m*b,M[6]=l*T+d*_+g*b,M[7]=h*T+f*_+v*b,M[8]=a*w+c*R+p*S,M[9]=s*w+u*R+m*S,M[10]=l*w+d*R+g*S,M[11]=h*w+f*R+v*S,this)},o.rotateX=function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),r=e[4],o=e[5],a=e[6],s=e[7],l=e[8],h=e[9],c=e[10],u=e[11];return e[4]=r*n+l*i,e[5]=o*n+h*i,e[6]=a*n+c*i,e[7]=s*n+u*i,e[8]=l*n-r*i,e[9]=h*n-o*i,e[10]=c*n-a*i,e[11]=u*n-s*i,this},o.rotateY=function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),r=e[0],o=e[1],a=e[2],s=e[3],l=e[8],h=e[9],c=e[10],u=e[11];return e[0]=r*n-l*i,e[1]=o*n-h*i,e[2]=a*n-c*i,e[3]=s*n-u*i,e[8]=r*i+l*n,e[9]=o*i+h*n,e[10]=a*i+c*n,e[11]=s*i+u*n,this},o.rotateZ=function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),r=e[0],o=e[1],a=e[2],s=e[3],l=e[4],h=e[5],c=e[6],u=e[7];return e[0]=r*n+l*i,e[1]=o*n+h*i,e[2]=a*n+c*i,e[3]=s*n+u*i,e[4]=l*n-r*i,e[5]=h*n-o*i,e[6]=c*n-a*i,e[7]=u*n-s*i,this},o.fromRotationTranslation=function(t,e){var i=this.val,n=t.x,r=t.y,o=t.z,a=t.w,s=n+n,l=r+r,h=o+o,c=n*s,u=n*l,d=n*h,f=r*l,p=r*h,m=o*h,g=a*s,v=a*l,y=a*h;return i[0]=1-(f+m),i[1]=u+y,i[2]=d-v,i[3]=0,i[4]=u-y,i[5]=1-(c+m),i[6]=p+g,i[7]=0,i[8]=d+v,i[9]=p-g,i[10]=1-(c+f),i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this},o.fromQuat=function(t){var e=this.val,i=t.x,n=t.y,r=t.z,o=t.w,a=i+i,s=n+n,l=r+r,h=i*a,c=i*s,u=i*l,d=n*s,f=n*l,p=r*l,m=o*a,g=o*s,v=o*l;return e[0]=1-(d+p),e[1]=c+v,e[2]=u-g,e[3]=0,e[4]=c-v,e[5]=1-(h+p),e[6]=f+m,e[7]=0,e[8]=u+g,e[9]=f-m,e[10]=1-(h+d),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},o.frustum=function(t,e,i,n,r,o){var a=this.val,s=1/(e-t),l=1/(n-i),h=1/(r-o);return a[0]=2*r*s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*r*l,a[6]=0,a[7]=0,a[8]=(e+t)*s,a[9]=(n+i)*l,a[10]=(o+r)*h,a[11]=-1,a[12]=0,a[13]=0,a[14]=o*r*2*h,a[15]=0,this},o.perspective=function(t,e,i,n){var r=this.val,o=1/Math.tan(t/2),a=1/(i-n);return r[0]=o/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(n+i)*a,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*n*i*a,r[15]=0,this},o.ortho=function(t,e,i,n,r,o){var a=this.val,s=1/(t-e),l=1/(i-n),h=1/(r-o);return a[0]=-2*s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*h,a[11]=0,a[12]=(t+e)*s,a[13]=(n+i)*l,a[14]=(o+r)*h,a[15]=1,this},o.lookAt=function(t,e,i){var n,o,a,s,l,h,c,u,d,f,p=this.val,m=t.x,g=t.y,v=t.z,y=i.x,E=i.y,x=i.z,T=e.x,_=e.y,b=e.z;return Math.abs(m-T)<r&&Math.abs(g-_)<r&&Math.abs(v-b)<r?this.identity():(c=m-T,u=g-_,d=v-b,f=1/Math.sqrt(c*c+u*u+d*d),c*=f,u*=f,d*=f,n=E*d-x*u,o=x*c-y*d,a=y*u-E*c,f=Math.sqrt(n*n+o*o+a*a),f?(f=1/f,n*=f,o*=f,a*=f):(n=0,o=0,a=0),s=u*a-d*o,l=d*n-c*a,h=c*o-u*n,f=Math.sqrt(s*s+l*l+h*h),f?(f=1/f,s*=f,l*=f,h*=f):(s=0,l=0,h=0),p[0]=n,p[1]=s,p[2]=c,p[3]=0,p[4]=o,p[5]=l,p[6]=u,p[7]=0,p[8]=a,p[9]=h,p[10]=d,p[11]=0,p[12]=-(n*m+o*g+a*v),p[13]=-(s*m+l*g+h*v),p[14]=-(c*m+u*g+d*v),p[15]=1,this)},o.mul=o.multiply,o.idt=o.identity,o.reset=o.idt,o.toString=function(){var t=this.val;return"Matrix4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},o.str=o.toString,e.exports=i},{}],56:[function(t,e){function i(t,e,i,n){"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)}var n=t("./Vector3"),r=t("./Matrix3"),o=t("./common"),a="undefined"!=typeof Int8Array?new Int8Array([1,2,0]):[1,2,0],s="undefined"!=typeof Float32Array?new Float32Array([0,0,0]):[0,0,0],l=new n(1,0,0),h=new n(0,1,0),c=new n,u=new r,d=i.prototype;for(var f in o)d[f]=o[f];d.rotationTo=function(t,e){var i=t.x*e.x+t.y*e.y+t.z*e.z;return-.999999>i?(c.copy(l).cross(t).len()<1e-6&&c.copy(h).cross(t),c.normalize(),this.setAxisAngle(c,Math.PI)):i>.999999?(this.x=0,this.y=0,this.z=0,this.w=1,this):(c.copy(t).cross(e),this.x=c.x,this.y=c.y,this.z=c.z,this.w=1+i,this.normalize())},d.setAxes=function(t,e,i){var n=u.val;return n[0]=e.x,n[3]=e.y,n[6]=e.z,n[1]=i.x,n[4]=i.y,n[7]=i.z,n[2]=-t.x,n[5]=-t.y,n[8]=-t.z,this.fromMat3(u).normalize()},d.identity=function(){return this.x=this.y=this.z=0,this.w=1,this},d.setAxisAngle=function(t,e){e*=.5;var i=Math.sin(e);return this.x=i*t.x,this.y=i*t.y,this.z=i*t.z,this.w=Math.cos(e),this},d.multiply=function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.x,a=t.y,s=t.z,l=t.w;return this.x=e*l+r*o+i*s-n*a,this.y=i*l+r*a+n*o-e*s,this.z=n*l+r*s+e*a-i*o,this.w=r*l-e*o-i*a-n*s,this},d.slerp=function(t,e){var i,n,r,o,a,s=this.x,l=this.y,h=this.y,c=this.y,u=t.x,d=t.y,f=t.z,p=t.w;return n=s*u+l*d+h*f+c*p,0>n&&(n=-n,u=-u,d=-d,f=-f,p=-p),1-n>1e-6?(i=Math.acos(n),r=Math.sin(i),o=Math.sin((1-e)*i)/r,a=Math.sin(e*i)/r):(o=1-e,a=e),this.x=o*s+a*u,this.y=o*l+a*d,this.z=o*h+a*f,this.w=o*c+a*p,this},d.invert=function(){var t=this.x,e=this.y,i=this.z,n=this.w,r=t*t+e*e+i*i+n*n,o=r?1/r:0;return this.x=-t*o,this.y=-e*o,this.z=-i*o,this.w=n*o,this},d.conjugate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},d.rotateX=function(t){t*=.5;var e=this.x,i=this.y,n=this.z,r=this.w,o=Math.sin(t),a=Math.cos(t);return this.x=e*a+r*o,this.y=i*a+n*o,this.z=n*a-i*o,this.w=r*a-e*o,this},d.rotateY=function(t){t*=.5;var e=this.x,i=this.y,n=this.z,r=this.w,o=Math.sin(t),a=Math.cos(t);return this.x=e*a-n*o,this.y=i*a+r*o,this.z=n*a+e*o,this.w=r*a-i*o,this},d.rotateZ=function(t){t*=.5;var e=this.x,i=this.y,n=this.z,r=this.w,o=Math.sin(t),a=Math.cos(t);return this.x=e*a+i*o,this.y=i*a-e*o,this.z=n*a+r*o,this.w=r*a-n*o,this},d.calculateW=function(){var t=this.x,e=this.y,i=this.z;return this.x=t,this.y=e,this.z=i,this.w=-Math.sqrt(Math.abs(1-t*t-e*e-i*i)),this},d.fromMat3=function(t){var e,i=t.val,n=i[0]+i[4]+i[8];if(n>0)e=Math.sqrt(n+1),this.w=.5*e,e=.5/e,this.x=(i[7]-i[5])*e,this.y=(i[2]-i[6])*e,this.z=(i[3]-i[1])*e;else{var r=0;i[4]>i[0]&&(r=1),i[8]>i[3*r+r]&&(r=2);var o=a[r],l=a[o];e=Math.sqrt(i[3*r+r]-i[3*o+o]-i[3*l+l]+1),s[r]=.5*e,e=.5/e,s[o]=(i[3*o+r]+i[3*r+o])*e,s[l]=(i[3*l+r]+i[3*r+l])*e,this.x=s[0],this.y=s[1],this.z=s[2],this.w=(i[3*l+o]-i[3*o+l])*e}return this},d.idt=d.identity,d.sub=d.subtract,d.mul=d.multiply,d.len=d.length,d.lenSq=d.lengthSq,d.reset=d.idt,d.toString=function(){return"Quaternion("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},d.str=d.toString,e.exports=i},{"./Matrix3":54,"./Vector3":58,"./common":60}],57:[function(t,e){e.exports=t(49)},{}],58:[function(t,e){e.exports=t(50)},{}],59:[function(t,e){function i(t,e,i,n){"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)}var n=t("./common"),r=i.prototype;for(var o in n)r[o]=n[o];r.clone=function(){return new i(this.x,this.y,this.z,this.w)},r.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},r.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this},r.distance=function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z,r=t.w-this.w;return Math.sqrt(e*e+i*i+n*n+r*r)},r.distanceSq=function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z,r=t.w-this.w;return e*e+i*i+n*n+r*r},r.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},r.transformMat4=function(t){var e=t.val,i=this.x,n=this.y,r=this.z,o=this.w;return this.x=e[0]*i+e[4]*n+e[8]*r+e[12]*o,this.y=e[1]*i+e[5]*n+e[9]*r+e[13]*o,this.z=e[2]*i+e[6]*n+e[10]*r+e[14]*o,this.w=e[3]*i+e[7]*n+e[11]*r+e[15]*o,this},r.transformQuat=function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*n-a*i,h=s*i+a*e-r*n,c=s*n+r*i-o*e,u=-r*e-o*i-a*n;return this.x=l*s+u*-r+h*-a-c*-o,this.y=h*s+u*-o+c*-r-l*-a,this.z=c*s+u*-a+l*-o-h*-r,this},r.random=function(t){return t=t||1,this.x=(2*Math.random()-1)*t,this.y=(2*Math.random()-1)*t,this.z=(2*Math.random()-1)*t,this.w=(2*Math.random()-1)*t,this},r.reset=function(){return this.x=0,this.y=0,this.z=0,this.w=0,this},r.sub=r.subtract,r.mul=r.multiply,r.div=r.divide,r.dist=r.distance,r.distSq=r.distanceSq,r.len=r.length,r.lenSq=r.lengthSq,r.toString=function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},r.str=r.toString,e.exports=i},{"./common":60}],60:[function(t,e){e.exports=t(52)},{}],61:[function(t,e,i){arguments[4][53][0].apply(i,arguments)},{"./Matrix3":54,"./Matrix4":55,"./Quaternion":56,"./Vector2":57,"./Vector3":58,"./Vector4":59}],62:[function(){},{}]},{},[2])(2)}),define("utils/URLParamUtils",["Class"],function(t){var e=new t({});return e.urlParam=function(t){var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(window.location.href);return null==e?void 0:"true"==e[1]?!0:"false"==e[1]?!1:isNaN(e[1])?e[1]||!1:parseInt(e[1])},e}),define("lib/LibJS/signals/Signal",[],function(){function t(){this._signalID="signal"+t.nextSignalID,this._addOnceList={},this._listeners=[],t.nextSignalID++,0===arguments.length&&(this.onListenerAdded=new t(!1),this.onListenerRemoved=new t(!1))}return t.nextSignalID=0,t.nextListenerID=0,t.prototype.countListeners=0,t.prototype._signalID=0,t.prototype._addOnceList=null,t.prototype._listeners=null,t.prototype._dispatchStopped=!1,t.prototype.onListenerAdded=null,t.prototype.onListenerRemoved=null,t.prototype.addOnce=function(t,e){this.add(t,e),this._addOnceList[t.listenerIDX[this._signalID]]=!0},t.prototype.add=function(e,i){void 0===e.listenerIDX&&(e.listenerID=t.nextListenerID++,e.listenerIDX={},e.targets={}),void 0===e.listenerIDX[this._signalID]&&(e.listenerIDX[this._signalID]=this._listeners.length,e.targets[this._signalID]=i,this._listeners[this._listeners.length]=e,this.countListeners++,null!==this.onListenerAdded&&this.onListenerAdded.dispatch())},t.prototype.remove=function(t){if("undefined"!=typeof t&&this._checkHasId(t)){var e=t.listenerIDX[this._signalID];this._listeners.splice(e,1);for(var i=e;i<this._listeners.length;i++)this._listeners[i].listenerIDX[this._signalID]=i;this.countListeners--,null!==this.onListenerRemoved&&this.onListenerRemoved.dispatch(),delete t.listenerIDX[this._signalID],delete t.targets[this._signalID]}},t.prototype.dispatch=function(){for(var t=this._listeners.concat(),e=0;!this._dispatchStopped&&e<t.length;e++)t[e].apply(t[e].targets[this._signalID],arguments),void 0!==this._addOnceList[e]&&(this.remove(this._listeners[e]),delete this._addOnceList[e]);this._dispatchStopped=!1},t.prototype.stopDispatch=function(){this._dispatchStopped=!0},t.prototype._checkHasId=function(t){return void 0!==t.listenerIDX&&void 0!==t.listenerIDX[this._signalID]},t}),define("managers/RenderManager",["jquery","Class","core/BaseObject","three","Global","stats","RendererStats","detector","managers/SceneManager","performance/PerformanceTweaker","performance/FPS","TextManager","utils/URLParamUtils","lib/LibJS/signals/Signal"],function(t,e,i,n,r,o,a,s,l,h,c,u,d){var f=new e({Extends:i,renderer:void 0,rendererWebGL:void 0,rendererCanvas:void 0,antialias:!0,camera:void 0,scene:void 0,stats:void 0,rendererStats:void 0,bgColor:"#ffffff",showStats:!1,forceCanvas:!1,clearAlpha:1,alpha:!1,performanceScale:1,performanceTweaker:void 0,warmupCounter:5,initialize:function(t){if(f.instance)throw"Singleton enforcer!";f.instance=this,new c,this.parent(t),r.setSize(),r.startTime=.001*Date.now(),this.camera=l.instance.camera,this.scene=l.instance.scene,this._canvasContext=null,s.webgl&&!this.forceCanvas?(this.rendererWebGL=new n.WebGLRenderer({antialias:this.antialias,preserveDrawingBuffer:!0,alpha:this.alpha,clearColor:this.bgColor}),this.renderer=this.rendererWebGL,r.rendererType="webGL",this.showStats&&(this.rendererStats=new THREEx.RendererStats,this.rendererStats.domElement.style.position="absolute",this.rendererStats.domElement.style.left="0px",this.rendererStats.domElement.style.bottom="0px",document.body.appendChild(this.rendererStats.domElement))):(this.warmupCounter=25,this.rendererCanvas=new n.CanvasRenderer({alpha:this.clearAlpha,clearColor:this.bgColor}),this.renderer=this.rendererCanvas,this._canvasContext=this.rendererCanvas.domElement.getContext("2d"),r.rendererType="canvas"),this.renderer.setClearColor(this.bgColor,this.clearAlpha);var e=document.getElementById("particles");e.appendChild(this.renderer.domElement),this.showStats&&(this.stats=new o,this.stats.domElement.style.position="absolute",this.stats.domElement.style.top="0px",e.appendChild(this.stats.domElement)),window.addEventListener("resize",this.onWindowResize.bind(this),!1),this.performanceTweaker=new h({degradeWhen:t.qualityDegradeWhenFPSBelow,upgradeWhen:t.qualityUpgradeWhenFPSAbove}),this.performanceTweaker.onChange.add(this.adjustPerformance.bind(this)),this.hasRenderedOnce=!1,this.initText()},setParams:function(t){t.bgColor||(t.bgColor=this.bgColor),this.parent(t),this.renderer&&(this.renderer.setClearColor(this.bgColor.value,this.clearAlpha),this.bgColor.onChangedSignal.add(function(t){this.renderer.setClearColor(t,this.clearAlpha)}.bind(this)))},adjustPerformance:function(e){if(e=1,e!==this.performanceScale){this.performanceScale=e;var i=~~(r.width*this.performanceScale),n=~~(r.height*this.performanceScale);this.renderer.setSize(i,n),t(this.renderer.domElement).css("width",r.width+"px").css("height",r.height+"px"),this.resizeText(r.width,r.height)}},onWindowResize:function(){r.setSize();var e=~~(r.width*this.performanceScale),i=~~(r.height*this.performanceScale);this.renderer.setSize(e,i),t(this.renderer.domElement).css("width",r.width+"px").css("height",r.height+"px"),this.camera.aspect=r.aspectRatio,this.camera.updateProjectionMatrix(),this.camera.far=r.cameraDistanceFar,this.resizeText(r.width,r.height)},render:function(){return this.performanceTweaker.update(),this.warmupCounter>0?(this.warmupCounter--,void this.renderer.clear()):(this._canvasContext&&(this._canvasContext.clearRect(0,0,r.width,r.height),this.renderer.clear()),this.renderer.render(this.scene,this.camera),this._canvasContext,this.renderText(),this.showStats&&(this.stats.update(),"webGL"==r.rendererType&&this.rendererStats.update(this.renderer)),this.hasRenderedOnce||(this.hasRenderedOnce=!0,this.animateInText()),void 0)},screenshot:function(t,e){this.renderer.setSize(t,e),this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.camera.far=r.cameraDistanceFar,this.renderer.render(this.scene,this.camera)},screenshotCleanup:function(){var t=r.width,e=r.height;this.renderer.setSize(~~(t*this.performanceScale),~~(e*this.performanceScale)),this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.camera.far=r.cameraDistanceFar},toggleCanvas:function(){if(!this.rendererCanvas){this.rendererCanvas=new n.CanvasRenderer;var e=document.getElementById("particles");e.appendChild(this.rendererCanvas.domElement),this.rendererCanvas.setClearColor(this.bgColor.value,this.clearAlpha),t(this.rendererCanvas.domElement).css("position","absolute").css("top","0px").css("left","0px").css("z-index","-10"),this.rendererCanvas.setSize(r.width,r.height)}this.renderer==this.rendererWebGL?(r.rendererType="canvas",t(this.rendererWebGL.domElement).css("visibility","hidden"),t(this.rendererCanvas.domElement).css("visibility","visible"),this.renderer=this.rendererCanvas):(r.rendererType="webGL",t(this.rendererWebGL.domElement).css("visibility","visible"),t(this.rendererCanvas.domElement).css("visibility","hidden"),this.renderer=this.rendererWebGL)},setClearAlpha:function(t){this.clearAlpha=t,this.renderer.alpha=1!=t,this.renderer.setClearColor(this.bgColor.value,this.clearAlpha)},initText:function(){this.forceTextAntialiasing=!0,this.renderer.devicePixelRatio>1&&(this.forceTextAntialiasing=!1);var e=d.urlParam("textUI"),i=!this.rendererWebGL;this.textManager=new u(r.renderText,{fontSize:50,snap:.999,text:r.renderText},TweenLite,null,i),this.textManager.style=parseInt(d.urlParam("textEffect")||"0",10)||0;~~(r.width*this.performanceScale),~~(r.height*this.performanceScale);if(this.rendererWebGL){var n=this.rendererWebGL.domElement;this.textManager.resize(r.width,r.height),this.textManager.initWebGL(n,this.forceTextAntialiasing)}this.resizeText(r.width,r.height),t(window).on("mousemove.textfx",function(e){var i=1;(this.forceTextAntialiasing||this._canvasContext)&&(i=this.renderer.devicePixelRatio*this.performanceScale);var n=t(this.renderer.domElement).offset();this.textManager.onTouchMove(e.pageX*i-n.left,e.pageY*i-n.top)}.bind(this)),t(window).on("touchmove",function(e){var i=1;(this.forceTextAntialiasing||this._canvasContext)&&(i=this.renderer.devicePixelRatio*this.performanceScale);var n=t(this.renderer.domElement).offset();this.textManager.onTouchMove(e.originalEvent.targetTouches[0].pageX*i-n.left,e.originalEvent.targetTouches[0].pageY*i-n.top)}.bind(this)),t(window).on("touchstart",function(e){var i=1;(this.forceTextAntialiasing||this._canvasContext)&&(i=this.renderer.devicePixelRatio*this.performanceScale);var n=t(this.renderer.domElement).offset();this.textManager.onTouchMove(e.originalEvent.targetTouches[0].pageX*i-n.left,e.originalEvent.targetTouches[0].pageY*i-n.top)}.bind(this)),t(window).on("keydown.textfx",function(t){32===t.which&&this.textManager.resetAll()}.bind(this)),this.textManager.color.a=0},setTextAlpha:function(t){this.textManager.color.a=t},animateInText:function(){this.textManager.animateIn({onStart:this.setTextAlpha.bind(this,1),delay:1,delayIncrement:.2,duration:.8,yOff:30,ease:Expo.easeOut,onComplete:r.introTextAnimatedIn.dispatch.bind(r.introTextAnimatedIn)},{ease:Linear.easeNone,duration:.3,delay:1})},destroyText:function(){t(window).off("mousemove.textfx"),t(window).off("touchmove")},resizeText:function(t,e){if(this.textManager){(this.forceTextAntialiasing||this._canvasContext)&&(t*=this.renderer.devicePixelRatio*this.performanceScale,e*=this.renderer.devicePixelRatio*this.performanceScale);var i=1024,n=t/i;n=Math.max(.75,Math.min(2.2,n)),this._canvasContext&&(n*=this.performanceScale);var o=this.textManager;o.resize(t,e);var a=(o.height*n+155*this.performanceScale,(e-o.height*n)/2);o.scale=n,o.setPosition((t-o.width*n)/2,a),o.updateCamera(),r.introTextWidth=this.getTextWidth(),r.introTextHeight=this.getTextHeight(),r.introTextResized.dispatch(r.introTextWidth,r.introTextHeight)}},getTextHeight:function(){return Math.round(this.textManager.scale*this.textManager.height*1/this.performanceScale)},getTextWidth:function(){return Math.round(this.textManager.scale*this.textManager.width*1/this.performanceScale)},renderText:function(){this.textManager.update(Math.min(.3,10*r.timeSinceLastFrame)),this.rendererWebGL?(this.textManager.renderWebGL(),this.renderer.setClearColor(this.bgColor.value,this.clearAlpha)):this._canvasContext&&(this._canvasContext.fillStyle="black",this._canvasContext.strokeStyle="black",this._canvasContext.globalCompositeOperation="source-over",this.textManager.renderCanvas(this._canvasContext),this._canvasContext.fillStyle="white",this._canvasContext.strokeStyle="white")}});return f}),define("managers/ModelManager",["Class","three","core/BaseObject","jquery","GUI","Signal","utils/ModelUtils","utils/ColorUtils","Global","managers/SceneManager","managers/LayerManager","managers/LensOverlayManager","managers/VectorFieldManager","managers/LightManager","managers/RenderManager","objects/MeshParticles","objects/ShardParticles"],function(t,e,i,n,r,o,a,s,l,h,c,u,d,f,p,m,g){var v=new t({Extends:i,fileControls:void 0,onLoadCallback:void 0,godMode:!1,quickNav:!1,gui:void 0,choices:void 0,templates:void 0,presetName:"Default",preset:"Default",archive:"Default",modelData:void 0,toolParams:void 0,firstTime:!0,tween:!0,guiRebuildTimeoutID:void 0,onLoadCompleteSignal:void 0,onTransitionCompleteSignal:void 0,initialize:function(t){if(v.instance)throw"Singleton enforcer!";if(v.instance=this,this.worldManager=t.worldManager,this.parent(t),this.onLoadCompleteSignal=new o,this.onTransitionCompleteSignal=new o,this.godMode){this.quickNav=!1,this.gui=new datCustom.GUI,this.fileControls=this.gui.addFolder("File");var e=this.fileControls.add(this,"presetName");e.listen();var i=this.fileControls.add(this,"loadButtonFunc");i.name("LOAD");var n=this.fileControls.add(this,"saveToDB");n.name("SAVE");var r=this.fileControls.add(this,"export");r.name("EXPORT");var a=this.fileControls.add(t.worldManager,"pause");a.name("PAUSE");var s=this.fileControls.add(t.worldManager,"unpause");s.name("UNPAUSE");var h=this.fileControls.add(this,"archive");h.name("ARCHIVE");var p=this.fileControls.add(this,"unarchive");p.name("UNARCHIVE");var m=this.fileControls.add(this,"canvasify");m.name("CANVASIFY");var g=this.fileControls.add(this,"captureBG");g.name("Capture BG"),this.choices={},this.choices.test=["eeny","meeny","miny","moe"],this.loadListFromDB()}else this.quickNav&&(this.gui=new datCustom.GUI,this.loadListFromDB());this.toolParams={path:l.assetsPath+"images/tool/icons/",lights:{manager:f.instance,types:{ambient:{icon:"lightAmbient.png"},directional:{icon:"lightDirectional.png"},point:{icon:"lightPoint.png"}}},layers:{manager:c.instance,types:{meshObject:{icon:"meshObject.png"},meshParticles:{icon:"meshParticles.png"},shardParticles:{icon:"shardParticles.png"},spriteParticles:{icon:"spriteParticles.png"},canvasParticles:{icon:"canvasParticles.png"}}},vectorFields:{manager:d.instance,types:{vectorField:{icon:"vectorField.png"}}},lensOverlays:{manager:u.instance,types:{lensOverlay:{icon:"lensOverlay.png"}}}}},loadChoices:function(t){this.choicesLoaded=!1,n.getJSON(t,this.onLoadChoicesComplete.bind(this))},loadTemplates:function(t){this.templatesLoaded=!1,n.getJSON(t,this.onLoadTemplatesComplete.bind(this))},loadButtonFunc:function(){this.currentPreset=void 0,this.smartLoad(this.presetName)},smartLoad:function(t){var e,i=t.lastIndexOf(".json");return-1!=i&&i==t.length-5?("webGL"!=l.rendererType&&t.lastIndexOf("CANVAS")!=t.length-11&&(t=t.replace(".json","CANVAS.json")),e=!1):("webGL"!=l.rendererType&&t.lastIndexOf("CANVAS")!=t.length-6&&(t+="CANVAS"),e=!0),t&&this.currentPreset!=t?void(e?this.loadFromDB(t):this.load(t)):(this.onLoadCompleteSignal.dispatch(),void this.onTransitionCompleteSignal.dispatch())},load:function(t){t&&(this.presetName=t),!this.choicesLoaded&&this.godMode?this.defferedURL=t:(this.currentPreset=t,n.getJSON(l.assetsPath+"presets/"+t,this.onLoadComplete.bind(this)))},loadFromDB:function(t){t&&(this.presetName=t),this.currentPreset=t,this.historyOffset=0,n.ajax({type:"GET",url:l.particleDBLoadPath+"/"+this.presetName,dataType:"json",success:this.onLoadComplete.bind(this),error:function(){this.onLoadCompleteSignal.dispatch(),this.onTransitionCompleteSignal.dispatch()}.bind(this)})},loadListFromDB:function(){n.ajax({type:"GET",url:l.particleDBLoadPath,dataType:"json",success:this.onLoadListComplete.bind(this),xhrFields:{withCredentials:!0},error:function(){}})},validateName:function(t){for(var e=" !@#$%^&*(){}[]|\\/.,<>;:`~",i=e.length-1;i>=0;i--)if(-1!=t.indexOf(e[i]))return!1;return!0},saveToDB:function(t,e){if(t||(t=this.presetName),!this.validateName(t))return void window.alert("No spaces or commas in a name, please.");if(!e){var i=n.extend(!0,{},this.modelData);this.deactivate(i),e=JSON.stringify(i,null)}n.ajax({type:"POST",url:l.particleDBSavePath+"/add",data:{name:t,json:e},dataType:"json",success:function(){},xhrFields:{withCredentials:!0},statusCode:{401:function(){window.alert("Please go to /_ah/login to log in.")}}})},"export":function(t){var e=n.extend(!0,{},this.modelData);return this.deactivate(e,!t),jsonString=JSON.stringify(e,null,"	")},archive:function(){n.ajax({type:"POST",url:l.particleDBSavePath+"/"+this.presetName+"/archive",data:{},dataType:"json",success:function(){},error:function(){}})},unarchive:function(){n.ajax({type:"POST",url:l.particleDBSavePath+"/"+this.presetName+"/unarchive",data:{},dataType:"json",success:function(){},error:function(){}})},copyToClipboard:function(t){window.prompt("Copy to clipboard: Ctrl+C, Enter",t)},onLoadListComplete:function(t){t.names.sort(),this.pruneList(t.names),this.pruneList(t.archived),this.list=t.names,t.archived.sort(),this.archivedList=t.archived,-1!=this.list.indexOf(this.presetName)&&(this.preset=this.presetName);var e=(this.quickNav?this.gui:this.fileControls).add(this,"preset",this.list);if(e.onChange(function(t){this.presetName=t,this.quickNav&&this.loadFromDB()}.bind(this)),this.archivedList&&!this.quickNav){-1!=this.archivedList.indexOf(this.presetName)&&(this.presetArchived=this.presetName);var i=this.fileControls.add(this,"archive",this.archivedList);i.onChange(function(t){this.presetName=t}.bind(this))}},pruneList:function(t){for(var e=t.length-1;e>=0;e--){var i=t[e].lastIndexOf("CANVAS")==t[e].length-6;"webGL"==l.rendererType?i&&t.splice(e,1):i||t.splice(e,1)}},onLoadChoicesComplete:function(t){this.choices=t,this.choicesLoaded=!0,this.defferedURL&&(this.load(this.defferedURL),delete this.defferedURL)},onLoadTemplatesComplete:function(t){this.templates=t,this.templatesLoaded=!0},onLoadComplete:function(t){if(p.instance._canvasContext&&this.worldManager.degradeAmount&&t.layers)for(var i in t.layers){var n=t.layers[i];n&&n.total&&(n.total.value/=this.worldManager.degradeAmount)}this.patchData(t),a.recursiveEncapsulateAndActivate(t);var r=0;if(this.modelData){var o=0,s=2;r=a.recursiveCopy(this.modelData,t,this.tween,o,s,0)+s+.1,this.tween||(r=.1);for(var l in t)if(this.toolParams.hasOwnProperty(l)){var h=(this.toolParams[l],t[l]),c=this.modelData[l];for(var u in h)c.hasOwnProperty(u)||(a.recursiveEncapsulateAndActivate(h[u]),c.collectionSignals.add.dispatch(u,h[u]));for(var u in c)"collectionSignals"!=u&&(h.hasOwnProperty(u)||c.collectionSignals.remove.dispatch(u))}if(this.godMode&&void 0===this.guiRebuildTimeoutID){for(u in this.modelData)this.gui.removeFolder(u);this.gui.addFolder("TWEENING. PLEASE WAIT.")}}else{this.modelData=t;for(var l in t)this.injectCollectionSignals(l,t[l])}this.onLoadCallback&&(this.onLoadCallback(this.modelData),this.onLoadCallback=void 0),this.godMode&&(void 0!==this.guiRebuildTimeoutID&&clearTimeout(this.guiRebuildTimeoutID),this.guiRebuildTimeoutID=setTimeout(function(){var t=new e.Color;t.setHSL(0,.75,.05),this.gui.removeFolder("TWEENING. PLEASE WAIT.",!0),this.activate(this.modelData,this.gui,t,2,.05,.05),void 0!==this.guiRebuildTimeoutID&&(this.guiRebuildTimeoutID=void 0)}.bind(this),1e3*r)),setTimeout(function(){this.onTransitionCompleteSignal.dispatch()}.bind(this),1e3*r),this.onLoadCompleteSignal.dispatch()},activate:function(t,e,i,r,o,a){e.color={hex:"#"+i.getHexString(),dH:r,dS:o,dL:a};var l=n(e.__ul.children[0]);l.css("background-color",e.color.hex),l.css("position","relative"),e.data=t,this.injectTools(e),s.incrementL(i,a),r*=.25;for(key in t){var h=t[key];if(!(h instanceof Array)&&h instanceof Object&&!this.addValueObject(h,key,e)){var c;this.godMode&&(s.incrementH(i,r),c=e.addFolder(key),c.parentFolder=e),this.activate(h,c,i.clone(),r,o,a)}}this.injectHelpers(e)},injectCollectionSignals:function(t,e){this.toolParams.hasOwnProperty(t)&&(e.hasOwnProperty("collectionSignals")||(e.collectionSignals={doNotGUI:!0,doNotEncapsulate:!0,doNotExport:!0,add:new o,remove:new o}))},injectTools:function(t){if(this.toolParams.hasOwnProperty(t.name)){var i=this.toolParams[t.name].types;t.manager=this.toolParams[t.name].manager,t.collection=this.modelData[t.name];var r=[];for(var o in i){var s=i[o],l=n(document.createElement("div"));l.css("display","block").css("width","20px").css("height","20px").css("background-image","url("+this.toolParams.path+s.icon+")").css("position","relative").css("right",23*r.length+3+"px").css("top","3px").css("position","absolute"),l.data="test",l.bind("click",{type:o},function(i){var r=window.prompt("Name your new object.","thing");if(r)if(t.collection.hasOwnProperty(r))window.alert("Already exists. Try another name.");else{var o=n.extend(!0,{},this.templates[t.name][i.data.type]);a.recursiveEncapsulateAndActivate(o);var s=t.addFolder(r);s.parentFolder=t,this.activate(o,s,new e.Color(t.color.hex),t.color.dH,t.color.sH,t.color.lH),t.collection.collectionSignals.add.dispatch(r,o)}i.stopPropagation(),i.preventDefault()}.bind(this)),r.push(l)}var h=n(t.__ul.children[0]);h.append(r)}else if(t.hasOwnProperty("parentFolder")&&this.toolParams.hasOwnProperty(t.parentFolder.name)){var l=n(document.createElement("div"));l.css("display","block").css("width","20px").css("height","20px").css("background-image","url("+this.toolParams.path+"delete.png)").css("position","relative").css("right","3px").css("top","3px").css("position","absolute"),l.bind("click",function(e){e.stopPropagation(),e.preventDefault(),window.confirm("Are you sure you want to delete this?")&&(t.parentFolder.data.collectionSignals.remove.dispatch(t.name),t.parentFolder.removeFolder(t.name))});var h=n(t.__ul.children[0]);h.append(l)}},injectHelpers:function(t){if("blendMode"==t.name){for(var e,i,n,r=t.__controllers.length-1;r>=0;r--){var o=t.__controllers[r];switch(o.listen(),o.object.choicesSource){case"blendSrc":e=o;break;case"blendDst":i=o;break;case"blendEquation":n=o}}for(var a={jumpToCombo:.5,max:215,controllerSrc:e,controllerDst:i,controllerEquation:n,onChange:function(t){e.object.value=this.choices.blendSrc[~~t%9],i.object.value=this.choices.blendDst[~~(t/9)%8],n.object.value=this.choices.blendEquation[~~(t/72)%3]}},s=new Array,r=a.max;r>=0;r--)s.push(r);var l=[11,29,47,56,155,191,200],h=t.add(a,"jumpToCombo",0,a.max,.25);h.onChange(a.onChange.bind(this)),h.name("jump");var h=t.add(a,"jumpToCombo",s);h.onChange(a.onChange.bind(this)),h.name("jump");var h=t.add(a,"jumpToCombo",l);h.onChange(a.onChange.bind(this)),h.name("jump (tween support)")}},addValueObject:function(t,e,i){var r=!1,o="default";if(t.hasOwnProperty("doNotGUI"))return!0;if(t.hasOwnProperty("value")){if(r=!0,""===t.value||isNaN(t.value)||t.value===!0||t.value===!1?t.hasOwnProperty("choicesSource")?o="dropdown":7==t.value.length&&"#"==t.value[0]?o="color":"true"==t.value?(o="boolean",t.value=!0):"false"==t.value&&(o="boolean",t.value=!1):(t.value=parseFloat(t.value),t.hasOwnProperty("min")&&t.hasOwnProperty("max")&&t.hasOwnProperty("step")?(t.min=parseFloat(t.min),t.max=parseFloat(t.max),t.step=parseFloat(t.step),o="numberWithRestrictions"):o="number"),this.godMode){var a;if(r){switch(o){case"number":a=i.add(t,"value");break;case"numberWithRestrictions":a=i.add(t,"value").min(t.min).max(t.max).step(t.step);break;case"dropdown":a=i.add(t,"value",this.choices[t.choicesSource]);break;case"color":a=i.addColor(t,"value");break;default:a=i.add(t,"value")}a.name(e),n(a.__li).css("background-color",i.color.hex)}}return"total"==e&&a.listen(),!0}return!1},deactivate:function(t,e){a.recursiveDeactivateAndDecapsulate(t,e)},screenshot:function(t,e,i){void 0===e&&void 0===i?e=i=1024:(i=void 0!==i?i:e,e=void 0!==e?e:i),p.instance.screenshot(e,i),t=t.replace(".jpg",".jpeg");var n=t.substring(t.lastIndexOf(".")+1,t.length);if("png"!=n&&"jpeg"!=n)throw"Unknown image format";var r="image/"+n,o=p.instance.renderer.domElement.toDataURL(r,1);this.upload(t,o),setTimeout(function(){},500),p.instance.screenshotCleanup()},upload:function(t,e){var i=t.substring(t.indexOf(".")+1,t.length),r=t.substring(0,t.lastIndexOf("/")+1),o=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("."));n.ajax({type:"POST",url:"static/upload.php",data:{uploadPath:l.phpUploadPath,filePath:r,fileName:o,fileFormat:i,fileData:e}}).done(function(){})},canvasify:function(){u.instance.preventRotation(),l.setSize(1024,1024),u.instance.onWindowResize(),c.instance.hideAll();
var t=l.assetsAutoGeneratedSubPath,e=t+this.presetName+"/bg.jpeg";this.screenshot(e,1024,1024),u.instance.allowRotation(),u.instance.hideAll();var i=n.extend(!0,{},this.modelData);this.deactivate(i),i.lights={},i.layers={},i.lensOverlays={},p.instance.setClearAlpha(0);var r=c.instance.collection,o=h.instance.camera.fov,a=h.instance.camera;for(var s in r){var d=r[s],f=0,v=1,y=1,E=d.total.value;d instanceof m?(f=6,y=1.5,v=.5):d instanceof g&&(f=8,y=4,v=.125),a.fov=o/y,a.updateProjectionMatrix(),a.far=l.cameraDistanceFar;for(var x=0,T=1;f>=T;T++){var _=~~(T/f*E*v);d.showOne();var b=t+this.presetName+"/"+s+"_"+T+".png";this.screenshot(b),d.hide();var w=n.extend(!0,{},this.templates.layers.canvasParticles);w.image=b,w.physics.vectorField=d.physics.vectorField.value,w.physics.drag.value=d.physics.drag.value,w.physics.responsiveness.value=d.physics.responsiveness.value,w.total.value=_-x,w.scale.max.value=w.scale.min.value=.15/y,i.layers[s+T]=w,x=_}d.hide()}var R=n.extend(!0,{},this.templates.lensOverlays.lensOverlay);R.z.value=-2999,R.image=e,R.fitToScreenKeepAspect=!0,i.lensOverlays.bg=R,this.upload(t+this.presetName+"/presetCANVAS.json",JSON.stringify(i,null,"	")),this.saveToDB(this.presetName+"CANVAS",JSON.stringify(i,null)),p.instance.setClearAlpha(1),u.instance.showAll(),c.instance.showAll(),l.setSize(),a.fov=o,a.updateProjectionMatrix(),a.far=l.cameraDistanceFar,u.instance.onWindowResize()},captureBG:function(){this.screenshot(this.presetName+"-BG.png",1920,1080)},getOverrideLayer:function(t){return this.templates.overrides.layers[l.rendererType][t]},patchData:function(t){t.tiltSettings||(t.tiltSettings={speed:{value:.1,min:0,max:1,step:.001},panRange:{value:1.2,min:0,max:5,step:.001},angleRange:{value:2,min:0,max:5,step:.001},rangeScaleX:{value:1,min:0,max:1,step:.001},rangeScaleY:{value:.5,min:0,max:1,step:.001}})}});return v}),define("utils/ArrayUtils",["Class"],function(t){var e=new t({});return e.findIncrementalValue=function(t,e,i){var n=e.indexOf(t);return n+=i,n+=e.length,n%=e.length,e[n]},e}),define("utils/BlendModeExplorer",["Class","three","core/BaseObject","Global","utils/ArrayUtils"],function(t,e,i,n,r){var o=new t({Extends:i,target:void 0,initialize:function(t){this.parent(t),window.addEventListener("mousewheel",this.onMouseWheelHandler.bind(this),!1),window.addEventListener("DOMMouseScroll",this.onMouseWheelHandler.bind(this),!1),window.addEventListener("keypress",this.onKeyboardPressHandler.bind(this),!1)},update:function(){this.target},onMouseWheelHandler:function(t){var t=window.event||t,e=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));e>0?e=1:0>e&&(e=-1);var i=this.target.material;n.keyboard.pressed("shift")&&n.keyboard.pressed("alt")?i.blendEquation=r.findIncrementalValue(i.blendEquation,o.equations,e):n.keyboard.pressed("shift")?i.blendSrc=r.findIncrementalValue(i.blendSrc,o.srcs,e):n.keyboard.pressed("alt")&&(i.blendDst=r.findIncrementalValue(i.blendDst,o.dsts,e))},onKeyboardPressHandler:function(t){this.target.material;switch(t.keyCode){case 112:}}});return o.equations=[e.AddEquation,e.SubtractEquation,e.ReverseSubtractEquation],o.srcs=[e.ZeroFactor,e.OneFactor,e.SrcAlphaFactor,e.OneMinusSrcAlphaFactor,e.DstAlphaFactor,e.OneMinusDstAlphaFactor,e.DstColorFactor,e.OneMinusDstColorFactor,e.SrcAlphaSaturateFactor],o.dsts=[e.ZeroFactor,e.OneFactor,e.SrcColorFactor,e.OneMinusSrcColorFactor,e.SrcAlphaFactor,e.OneMinusSrcAlphaFactor,e.DstAlphaFactor,e.OneMinusDstAlphaFactor],o.equationLabels=["AddEquation","SubtractEquation","ReverseSubtractEquation"],o.srcLabels=["ZeroFactor","OneFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor"],o.dstLabels=["ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor"],o});var THREEx=THREEx||{};THREEx.KeyboardState=function(){this.keyCodes={},this.modifiers={};var t=this;this._onKeyDown=function(e){t._onKeyChange(e,!0)},this._onKeyUp=function(e){t._onKeyChange(e,!1)},document.addEventListener("keydown",this._onKeyDown,!1),document.addEventListener("keyup",this._onKeyUp,!1)},THREEx.KeyboardState.prototype.destroy=function(){document.removeEventListener("keydown",this._onKeyDown,!1),document.removeEventListener("keyup",this._onKeyUp,!1)},THREEx.KeyboardState.MODIFIERS=["shift","ctrl","alt","meta"],THREEx.KeyboardState.ALIAS={left:37,up:38,right:39,down:40,space:32,pageup:33,pagedown:34,tab:9},THREEx.KeyboardState.prototype._onKeyChange=function(t,e){var i=t.keyCode;this.keyCodes[i]=e,this.modifiers.shift=t.shiftKey,this.modifiers.ctrl=t.ctrlKey,this.modifiers.alt=t.altKey,this.modifiers.meta=t.metaKey},THREEx.KeyboardState.prototype.pressed=function(t){for(var e=t.split("+"),i=0;i<e.length;i++){var n,r=e[i];if(n=-1!==THREEx.KeyboardState.MODIFIERS.indexOf(r)?this.modifiers[r]:-1!=Object.keys(THREEx.KeyboardState.ALIAS).indexOf(r)?this.keyCodes[THREEx.KeyboardState.ALIAS[r]]:this.keyCodes[r.toUpperCase().charCodeAt(0)],!n)return!1}return!0},define("KeyboardState",function(){}),define("managers/WorldManager",["Class","three","core/BaseObject","Global","jquery","managers/ModelManager","managers/SceneManager","managers/LayerManager","managers/LensOverlayManager","managers/VectorFieldManager","managers/ColliderManager","managers/LightManager","managers/RenderManager","managers/TiltManager","utils/BlendModeExplorer","detector","KeyboardState","utils/ModelUtils","utils/URLParamUtils"],function(t,e,i,n,r,o,a,s,l,h,c,u,d,f,p,m,g,v,y){var E=new t({Extends:i,godMode:!1,quickNav:!1,showStats:!1,defaultPreset:"galaxy",forceCanvas:!1,lastMoto:"galaxy",doNotEncapsulate:!0,doNotGUI:!0,waitBeforeMasterControl:10,delayParticlesFrames:100,animationActive:!1,_mcDesiredPreset:"galaxy",_currentPage:"",initialize:function(t){if(this.particlesPaused=!1,t.alpha=y.urlParam("alpha")||t.alpha,t.godMode=y.urlParam("godMode")||t.godMode,t.quickNav=y.urlParam("quickNav")||t.quickNav,t.forceCanvas=y.urlParam("forceCanvas")||t.forceCanvas,t.showStats=y.urlParam("showStats")||t.showStats,t.defaultPreset=y.urlParam("preset")||t.defaultPreset,t.qualityDegradeWhenFPSBelow=y.urlParam("fpsLow")||t.qualityDegradeWhenFPSBelow,t.qualityUpgradeWhenFPSAbove=y.urlParam("fpsHigh")||t.qualityUpgradeWhenFPSAbove,this.degradeAmount=t.degradeAmount,E.instance)throw"Singleton enforcer!";E.instance=this,this.parent(t),e.ImageUtils.crossOrigin="",n.assetsPath=t.assetsPath||n.assetsPath,n.assetsAutoGeneratedPath=t.assetsAutoGeneratedPath||n.assetsAutoGeneratedPath,n.startTime=.001*Date.now(),n.keyboard=new THREEx.KeyboardState,n.width=r(document).width(),n.height=r(document).height(),n.widthHalf=.5*n.width,n.heightHalf=.5*n.height,n.aspectRatio=n.width/n.height,n.worldManager=this;var i=(new f({}),new a({cameraFOV:37,distanceNear:1,distanceFar:3e3,camDefaultRotation:{x:0,y:0,z:0},camDefaultPosition:{x:0,y:0,z:400}}),new h,new d({showStats:this.showStats,forceCanvas:this.forceCanvas,qualityDegradeWhenFPSBelow:t.qualityDegradeWhenFPSBelow,qualityUpgradeWhenFPSAbove:t.qualityUpgradeWhenFPSAbove,alpha:t.alpha,bgColor:t.bgColor,warmupCounter:t.warmupCounter}),new l({camera:a.instance.camera}),new s({scene:a.instance.scene})),c=new u({});c.onLightResetSignal.add(function(){i.onLightReset()});new o({onLoadCallback:this.loadActivePreset.bind(this),godMode:this.godMode,quickNav:this.quickNav,tween:t.tween,worldManager:this});this.godMode&&(o.instance.loadChoices(n.assetsPath+"presets/choices.json"),o.instance.loadTemplates(n.assetsPath+"presets/templates.json")),o.instance.smartLoad(this.defaultPreset),d.instance.onWindowResize(),l.instance.onWindowResize(),this.animateBound=this.animate.bind(this),requestAnimationFrame(this.animateBound)},loadActivePreset:function(t){this.data=t,a.instance.setParams(t.sceneProperties),f.instance.setParams(t.tiltSettings),d.instance.setParams(t.sceneProperties),h.instance.addMany(t.vectorFields),u.instance.addMany(t.lights),l.instance.addMany(t.lensOverlays),s.instance.addMany(t.layers)},animate:function(t,e){var i=.001*Date.now()-n.startTime;n.timeSinceLastFrame=i-n.now,n.now=i,this.delayParticlesFrames>0?this.delayParticlesFrames--:this.animationActive=!0,this.paused||(this.animationActive&&f.instance.update(),a.instance.update(),this.blendModeExplorer&&this.blendModeExplorer.update(),l.instance.update(),this.animationActive&&h.instance.update(),d.instance.render(this.particlesPaused)),e||requestAnimationFrame(this.animateBound)},pause:function(){this.paused=!0},unpause:function(){this.paused=!1},renderOnce:function(){var t=this.paused,e=this.particlesPaused;this.paused=!1,this.particlesPaused=!1,this.animate(0,!0),this.paused=t,this.particlesPaused=e}});return E}),define("ui/BorderButtons",["Class","jquery","TweenLite","TimelineLite"],function(t,e,i,n){var r=new t({width:null,height:null,paddingX:null,paddingY:null,direction:null,txt:null,img:null,offset:3,topMask:null,rightMask:null,bottomMask:null,leftMask:null,button:null,buttonTimeline:null,initialize:function(t,e,i,n,r,o,a,s){return this.width=t,this.height=e,this.button=i,this.direction=n,this.txt=r,this.paddingX=o?o:0,this.paddingY=a?a:0,this.img=s,this.init(),this.animate(),this.button},init:function(){this.txt,this.topMask=e("<div>").addClass("btnBorder").appendTo(this.button),this.rightMask=e("<div>").addClass("btnBorder").appendTo(this.button),this.bottomMask=e("<div>").addClass("btnBorder").appendTo(this.button),this.leftMask=e("<div>").addClass("btnBorder").appendTo(this.button),e(this.button).css({padding:this.paddingY+"px "+this.paddingX+"px"}),this.button.width(this.width),this.button.height(this.height),this.width-=this.offset,this.height-=this.offset,this.img&&(this.bg=e("<img>").attr("src",this.img).appendTo(this.button))},animate:function(){var t=.1,e=this.width+2*this.paddingX;switch(this.height=this.height+2*this.paddingY,this.buttonTimeline=new n({paused:!0}),this.buttonTimeline.add(i.fromTo(this.button,.2,{opacity:0},{opacity:100,delay:.35})),this.direction){case"right":this.buttonTimeline.add(i.fromTo(this.topMask,t,{width:e+4*this.offset,right:-this.offset,top:-this.offset},{width:0,delay:-.2})),this.buttonTimeline.add(i.fromTo(this.rightMask,t/2,{height:this.height+2*this.offset,left:e+this.offset,bottom:-this.offset},{height:0})),this.buttonTimeline.add(i.fromTo(this.bottomMask,t/1.2,{width:e+this.offset,left:0,top:this.height+this.offset},{width:0})),this.buttonTimeline.add(i.fromTo(this.leftMask,t/3,{height:this.height+2*this.offset,left:-this.offset,top:0},{height:0}));break;case"left":this.buttonTimeline.add(i.fromTo(this.topMask,t,{width:e+4*this.offset,left:-this.offset,top:-this.offset},{width:0,delay:-.2})),this.buttonTimeline.add(i.fromTo(this.leftMask,t/2,{height:this.height+2*this.offset,left:-this.offset,bottom:-this.offset},{height:0})),this.buttonTimeline.add(i.fromTo(this.bottomMask,t/1.2,{width:e+this.offset,right:0,top:this.height+this.offset},{width:0})),this.buttonTimeline.add(i.fromTo(this.rightMask,t/3,{height:this.height+2*this.offset,left:e+this.offset,top:0},{height:0}));break;case"up":this.buttonTimeline.add(i.fromTo(this.rightMask,t/1.2,{height:this.height+2*this.offset,left:e+this.offset,top:0},{height:0,delay:-.2})),this.buttonTimeline.add(i.fromTo(this.topMask,t,{width:e+3*this.offset,left:-this.offset,top:-this.offset},{width:0,delay:-.05})),this.buttonTimeline.add(i.fromTo(this.leftMask,t/2,{height:this.height+2*this.offset,left:-this.offset,bottom:-this.offset},{height:0})),this.buttonTimeline.add(i.fromTo(this.bottomMask,t/1.2,{width:e+2*this.offset,right:0,top:this.height+this.offset},{width:0}));break;case"down":this.buttonTimeline.add(i.fromTo(this.leftMask,t/1.2,{height:this.height+2*this.offset,left:-this.offset,bottom:0},{height:0,delay:-.2})),this.buttonTimeline.add(i.fromTo(this.bottomMask,t,{width:e+2*this.offset,right:0,top:this.height+this.offset},{width:0})),this.buttonTimeline.add(i.fromTo(this.rightMask,t/2,{height:this.height+2*this.offset,left:e+this.offset,top:0},{height:0})),this.buttonTimeline.add(i.fromTo(this.topMask,t/1.2,{width:e+2*this.offset,left:0,top:-this.offset},{width:0}))}this.img&&this.buttonTimeline.add(i.fromTo(this.bg,.8,{opacity:0},{opacity:1,delay:-.1})),this.buttonTimeline.play()}});return r}),define("utils/GA",["Class","Global"],function(t){"use strict";var e,i=new t({pageID:null,initialize:function(){e=this},init:function(){},setPageID:function(t){this.pageID=t},trackEvent:function(){try{__gaTracker&&__gaTracker("send",{hitType:"event",eventCategory:arguments[0],eventAction:arguments[1],eventLabel:arguments[2]})}catch(t){}},trackWorkItem:function(t){this.trackEvent("Work","WorkClick",t.toLowerCase())}});return new i}),define("utils/FullscreenController",["Class","lib/LibJS/signals/Signal","Global"],function(t,e,i){var n=new t({newSpec:!1,available:!0,target:null,prefix:"",active:!1,onChange:null,initialize:function(t){this.target=t,this.findPrefix(),this.onChange=new e,document.addEventListener(this.prefix+"fullscreenchange",this._onChange.bind(this))},findPrefix:function(){if("undefined"!=typeof document.exitFullscreen)this.newSpec=!0;else{for(var t=["webkit","moz","ms","o"],e=0;e<t.length;e++)if("undefined"!=typeof document[t[e]+"CancelFullScreen"])return void(this.prefix=t[e]);"undefined"==typeof document.cancelFullScreen&&(this.available=!1)}},_onChange:function(){this.newSpec?null==document.fullscreenElement&&this.onChange.dispatch():null==document[""!=this.prefix?this.prefix+"FullScreenElement":"fullScreenElement"]&&this.onChange.dispatch()},start:function(t){i.videoInFullScreen=!0;var e=null!=t?t:this.target;this.newSpec?e.requestFullscreen():e[""!=this.prefix?this.prefix+"RequestFullScreen":"requestFullScreen"](),i.onVideoFullScreenChange.dispatch()},stop:function(){i.videoInFullScreen=!1,this.newSpec?document.exitFullscreen():document[""!=this.prefix?this.prefix+"CancelFullScreen":"cancelFullScreen"](),i.onVideoFullScreenChange.dispatch()},active:function(){return this.newSpec?null!=document.fullscreenElement:""==this.prefix?document.fullScreen:"undefined"!=typeof document[this.prefix+"IsFullScreen"]?document[this.prefix+"IsFullScreen"]:document[this.prefix+"FullScreen"]}});return n}),define("libjs/utils/Util",[],function(){var t=function(){var e={PRODUCTION:"production",DEV:"dev",env:"production",support:{isHandheld:!1,isIPhone:!1,isRetina:!1,prefix:null}};/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)&&(e.support.isHandheld=!0,e.support.isIPhone=/iPhone/.test(navigator.userAgent),e.support.isAndroid=/Android/.test(navigator.userAgent),e.support.isWebOS=/webOS/.test(navigator.userAgent),e.support.isIPad=/iPad/.test(navigator.userAgent),e.support.isIPod=/iPod/.test(navigator.userAgent),e.support.isBlackberry=/BlackBerry/.test(navigator.userAgent)),window.devicePixelRatio>1&&(e.support.isRetina=!0);var i=window.getComputedStyle(document.documentElement,""),n=(Array.prototype.slice.call(i).join("").match(/-(moz|webkit|ms)-/)||""===i.OLink&&["","o"])[1],r="WebKit|Moz|MS|O".match(new RegExp("("+n+")","i"))[1];return e.support.prefix={dom:r,lowercase:n,css:"-"+n+"-",js:n[0].toUpperCase()+n.substr(1)},e.truncate=function(t,e,i){var n=t.substring(0,e);return t.length>e&&i!==!1&&(n+="&#8230;"),n},e.defer=function(t){var e=Array.prototype.slice.call(arguments,1);return setTimeout(function(){t.apply(null,e)},0)},e.getImageURL=function(e){return t.support.isRetina&&e&&e.length?e.replace(/(\.\w+$)/,"@2x$1"):e},e.format=function(){var t=arguments;return 0==t.length?"":1==t.length?t[0]:t[0].replace(/{(\d+)}/g,function(e,i){return"undefined"!=typeof t[+i+1]?t[+i+1]:e})},e.shuffle=function(t){for(var e,i,n=t.length;n--;)i=Math.random()*n|0,e=t[n],t[n]=t[i],t[i]=e;return t},e}();return t}),define("ui/VideoControls",["Class","jquery","utils/FullscreenController","Global","libjs/utils/Util","utils/GA"],function(){return!1}),(window._gsQueue||(window._gsQueue=[])).push(function(){"use strict";var t=/(\d|\.)+/g,e={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},i=function(t,e,i){return t=0>t?t+1:t>1?t-1:t,255*(1>6*t?e+(i-e)*t*6:.5>t?i:2>3*t?e+(i-e)*(2/3-t)*6:e)+.5|0},n=function(n){var r={};if(r.format="whoCares",""===n||null==n||"none"===n)return r.color=e.transparent,r;if(e[n])return r.color=e[n],r;if("number"==typeof n)return r.color=[n>>16,n>>8&255,255&n],r;if("#"===n.charAt(0))return r.format="hex",4===n.length&&(n="#"+n.charAt(1)+n.charAt(1)+n.charAt(2)+n.charAt(2)+n.charAt(3)+n.charAt(3)),n=parseInt(n.substr(1),16),r.color=[n>>16,n>>8&255,255&n],r;if("hsl"===n.substr(0,3)){n=n.match(t);var o=Number(n[0])%360/360,a=Number(n[1])/100,s=Number(n[2])/100,l=.5>=s?s*(a+1):s+a-s*a,h=2*s-l;return n.length>3&&(n[3]=Number(n[3])),n[0]=i(o+1/3,h,l),n[1]=i(o,h,l),n[2]=i(o-1/3,h,l),r.color=n,r}return r.color=n.match(t)||e.transparent,r};window._gsDefine.plugin({propName:"colorProps",priority:-1,API:2,init:function(t,e){this._target=t;var i,r,o,a;for(i in e){var s=n(e[i]);o=s.color,this._firstPT=a={_next:this._firstPT,p:i,f:"function"==typeof t[i],n:i,r:!1},this._format=s.format,r=n(a.f?t[i.indexOf("set")||"function"!=typeof t["get"+i.substr(3)]?i:"get"+i.substr(3)]():t[i]).color,a.s=Number(r[0]),a.c=Number(o[0])-a.s,a.gs=Number(r[1]),a.gc=Number(o[1])-a.gs,a.bs=Number(r[2]),a.bc=Number(o[2])-a.bs,(a.rgba=r.length>3||o.length>3)&&(a.as=r.length<4?1:Number(r[3]),a.ac=(o.length<4?1:Number(o[3]))-a.as),a._next&&(a._next._prev=a)}return!0},set:function(t){for(var e,i=this._firstPT;i;){if("hex"==this._format){for(e=(i.s+t*i.c<<16|i.gs+t*i.gc<<8|i.bs+t*i.bc).toString(16);e.length<6;)e="0"+e;e="#"+e}else e=(i.rgba?"rgba(":"rgb(")+(i.s+t*i.c>>0)+", "+(i.gs+t*i.gc>>0)+", "+(i.bs+t*i.bc>>0)+(i.rgba?", "+(i.as+t*i.ac):"")+")";i.f?this._target[i.p](e):this._target[i.p]=e,i=i._next}}})}),window._gsDefine&&window._gsQueue.pop()(),define("ColorPropsPlugin",["TweenLite"],function(t){return function(){var e;return e||t.ColorPropsPlugin}}(this)),require(["jquery","Global","managers/WorldManager","ui/BorderButtons","TweenLite","utils/GA","underscore","ui/VideoControls","ColorPropsPlugin"],function(t,e,i,n,r,o,a,s){function l(){t(".front-page").attr("id","particles"),t(".front-page").empty();var n,r=t(".homeVideoPlayer");r.length>0&&(n=new s(r.last()));var l=function(){var t=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;t||(r.css({display:"none"}),n.video.pause(),n.video.currentTime=0,h.unpause())};e.introTextResized.add(function(e,i){var n=38;TweenLite.to(t(".homeButtons"),.3,{paddingTop:i+n,width:e,marginLeft:-(.5*e),marginTop:-(.5*i)})}),TweenLite.set(t(".homeButtons #work-btn"),{x:40,opacity:0}),TweenLite.set(t(".homeButtons #reel-btn"),{x:-40,opacity:0}),TweenLite.set(t(".homeButtons .divider"),{scaleX:0}),t(".homeButtons").on("mouseover",function(){t("#work-btn").addClass("btn-hover")}),h=new i({defaultPreset:"garcia_6",bgColor:16777215,delayParticlesFrames:100,degradeAmount:4}),h.particlesPaused=!0;var c=a.throttle(h.renderOnce.bind(h),100,{leading:!0,trailing:!0});e.onResize.add(function(){e.menuOpen&&c()}),e.introTextAnimatedIn.add(function(){h.particlesPaused=!1,TweenLite.to(t(".homeButtons .divider"),.5,{scaleX:1,ease:Expo.easeOut}),TweenLite.to(t(".homeButtons #work-btn"),.75,{delay:.5,x:0,opacity:1,ease:Expo.easeOut}),TweenLite.to(t(".homeButtons #reel-btn"),.75,{delay:.7,x:0,opacity:1,ease:Expo.easeOut})}),e.navOpened.add(function(){t(".homeButtons")[0].style.pointerEvents="none",h.pause()}),e.navClosed.add(function(){t(".homeButtons")[0].style.pointerEvents="visible",h.unpause()}),t(".homeButtons").on("click",function(){o.trackEvent("Navigation","IntroClick","View Work"),h.pause(),TweenLite.to(t("main.front-page"),.3,{autoAlpha:0,ease:Expo.easeOut})}),r.on("fullscreenchange",l),r.on("webkitfullscreenchange",l),r.on("mozfullscreenchange",l),r.on("MSFullscreenChange",l),t("#reel-btn").click(function(t){return t.stopPropagation(),h.pause(),r.css({display:"block"}),n.toggleFullscreen(),n.play(),!1})}var h;l()}),define("particle",function(){});